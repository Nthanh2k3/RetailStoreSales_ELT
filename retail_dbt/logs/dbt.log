[0m15:32:05.443117 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."dim_employees_scd"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:05.672886 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.241 seconds
[0m15:32:05.674755 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3: ROLLBACK
[0m15:32:05.676545 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac: Close
[0m15:32:05.677606 [info ] [Thread-4 (]: 59 of 262 PASS not_null_dim_employees_scd_valid_from ........................... [[32mPASS[0m in 2.99s]
[0m15:32:05.678342 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac
[0m15:32:05.678832 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m15:32:05.679286 [info ] [Thread-4 (]: 62 of 262 START test not_null_dim_loyalty_programs_scd_dbt_updated_at .......... [RUN]
[0m15:32:05.679739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2)
[0m15:32:05.680067 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m15:32:05.685453 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m15:32:05.686026 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m15:32:05.688038 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m15:32:05.688603 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m15:32:05.688961 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: BEGIN
[0m15:32:05.689267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:05.690172 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.246 seconds
[0m15:32:05.691972 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: ROLLBACK
[0m15:32:05.935674 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3: Close
[0m15:32:05.936844 [error] [Thread-3 (]: 60 of 262 FAIL 200 not_null_dim_employees_scd_valid_to ......................... [[31mFAIL 200[0m in 2.73s]
[0m15:32:05.937624 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3
[0m15:32:05.938161 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m15:32:05.938718 [info ] [Thread-3 (]: 63 of 262 START test not_null_dim_loyalty_programs_scd_dbt_valid_from .......... [RUN]
[0m15:32:05.939355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210)
[0m15:32:05.939780 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m15:32:05.944468 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m15:32:05.945185 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m15:32:05.947552 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m15:32:05.948149 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m15:32:05.948491 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: BEGIN
[0m15:32:05.948803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:05.952656 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: Close
[0m15:32:05.953380 [info ] [Thread-1 (]: 58 of 262 PASS not_null_dim_employees_scd_store_id ............................. [[32mPASS[0m in 4.61s]
[0m15:32:05.953899 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15
[0m15:32:05.954273 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m15:32:05.954754 [info ] [Thread-1 (]: 64 of 262 START test not_null_dim_loyalty_programs_scd_dbt_valid_to ............ [RUN]
[0m15:32:05.955370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4)
[0m15:32:05.955908 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m15:32:05.960945 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m15:32:05.961633 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m15:32:05.964526 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m15:32:05.965211 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m15:32:05.965632 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: BEGIN
[0m15:32:05.966087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:06.354197 [debug] [Thread-2 (]: SQL status: BEGIN in 2.516 seconds
[0m15:32:06.354679 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"
[0m15:32:06.355061 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:06.642071 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.286 seconds
[0m15:32:06.643535 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: ROLLBACK
[0m15:32:06.919826 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: Close
[0m15:32:06.920772 [info ] [Thread-2 (]: 61 of 262 PASS not_null_dim_loyalty_programs_scd_dbt_scd_id .................... [[32mPASS[0m in 3.09s]
[0m15:32:06.921344 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b
[0m15:32:06.921766 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m15:32:06.922210 [info ] [Thread-2 (]: 65 of 262 START test not_null_dim_loyalty_programs_scd_is_current .............. [RUN]
[0m15:32:06.922645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b, now test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11)
[0m15:32:06.923075 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m15:32:06.926582 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m15:32:06.927130 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m15:32:06.929546 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m15:32:06.930214 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m15:32:06.930692 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: BEGIN
[0m15:32:06.931144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:08.146533 [debug] [Thread-3 (]: SQL status: BEGIN in 2.198 seconds
[0m15:32:08.147332 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m15:32:08.147996 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:08.379497 [debug] [Thread-4 (]: SQL status: BEGIN in 2.690 seconds
[0m15:32:08.380003 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m15:32:08.380385 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m15:32:08.391515 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.243 seconds
[0m15:32:08.393329 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: ROLLBACK
[0m15:32:08.557624 [debug] [Thread-1 (]: SQL status: BEGIN in 2.591 seconds
[0m15:32:08.558106 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m15:32:08.558465 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:08.634372 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: Close
[0m15:32:08.635297 [info ] [Thread-3 (]: 63 of 262 PASS not_null_dim_loyalty_programs_scd_dbt_valid_from ................ [[32mPASS[0m in 2.70s]
[0m15:32:08.635866 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m15:32:08.636277 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m15:32:08.636747 [info ] [Thread-3 (]: 66 of 262 START test not_null_dim_loyalty_programs_scd_loyalty_program_id ...... [RUN]
[0m15:32:08.637215 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210, now test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa)
[0m15:32:08.637547 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m15:32:08.642963 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m15:32:08.643563 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m15:32:08.645569 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m15:32:08.646123 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m15:32:08.646440 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: BEGIN
[0m15:32:08.646742 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:08.662081 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.281 seconds
[0m15:32:08.663472 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: ROLLBACK
[0m15:32:08.838451 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.279 seconds
[0m15:32:08.839906 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: ROLLBACK
[0m15:32:08.968062 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: Close
[0m15:32:08.968936 [info ] [Thread-4 (]: 62 of 262 PASS not_null_dim_loyalty_programs_scd_dbt_updated_at ................ [[32mPASS[0m in 3.29s]
[0m15:32:08.969513 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m15:32:08.969930 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m15:32:08.970352 [info ] [Thread-4 (]: 67 of 262 START test not_null_dim_loyalty_programs_scd_loyalty_program_sk ...... [RUN]
[0m15:32:08.970789 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2, now test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4)
[0m15:32:08.971155 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m15:32:08.974605 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m15:32:08.975150 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m15:32:08.977244 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m15:32:08.977814 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m15:32:08.978130 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: BEGIN
[0m15:32:08.978461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:09.123601 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: Close
[0m15:32:09.124625 [error] [Thread-1 (]: 64 of 262 FAIL 5 not_null_dim_loyalty_programs_scd_dbt_valid_to ................ [[31mFAIL 5[0m in 3.17s]
[0m15:32:09.125298 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m15:32:09.125711 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m15:32:09.126195 [info ] [Thread-1 (]: 68 of 262 START test not_null_dim_loyalty_programs_scd_name .................... [RUN]
[0m15:32:09.126681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4, now test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a)
[0m15:32:09.127115 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m15:32:09.130470 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m15:32:09.131000 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m15:32:09.132912 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m15:32:09.133478 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m15:32:09.133787 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: BEGIN
[0m15:32:09.134123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:09.201817 [debug] [Thread-2 (]: SQL status: BEGIN in 2.271 seconds
[0m15:32:09.202361 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m15:32:09.202759 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m15:32:09.452963 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.250 seconds
[0m15:32:09.454353 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: ROLLBACK
[0m15:32:09.699571 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: Close
[0m15:32:09.700500 [info ] [Thread-2 (]: 65 of 262 PASS not_null_dim_loyalty_programs_scd_is_current .................... [[32mPASS[0m in 2.78s]
[0m15:32:09.701076 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m15:32:09.701574 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m15:32:09.702022 [info ] [Thread-2 (]: 69 of 262 START test not_null_dim_loyalty_programs_scd_points_per_dollar ....... [RUN]
[0m15:32:09.702500 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11, now test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c)
[0m15:32:09.702840 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m15:32:09.706504 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m15:32:09.707058 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m15:32:09.709850 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m15:32:09.710397 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m15:32:09.710758 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: BEGIN
[0m15:32:09.711112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:11.359209 [debug] [Thread-3 (]: SQL status: BEGIN in 2.712 seconds
[0m15:32:11.359764 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m15:32:11.360344 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_id
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where loyalty_program_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:11.593370 [debug] [Thread-1 (]: SQL status: BEGIN in 2.459 seconds
[0m15:32:11.594061 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m15:32:11.594631 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m15:32:11.639730 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.279 seconds
[0m15:32:11.641207 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: ROLLBACK
[0m15:32:11.642600 [debug] [Thread-4 (]: SQL status: BEGIN in 2.664 seconds
[0m15:32:11.643157 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m15:32:11.643650 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_sk
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where loyalty_program_sk is null



  
  
      
    ) dbt_internal_test
[0m15:32:11.854712 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.259 seconds
[0m15:32:11.856727 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: ROLLBACK
[0m15:32:11.926906 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: Close
[0m15:32:11.928163 [info ] [Thread-3 (]: 66 of 262 PASS not_null_dim_loyalty_programs_scd_loyalty_program_id ............ [[32mPASS[0m in 3.29s]
[0m15:32:11.929127 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m15:32:11.929755 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m15:32:11.930375 [info ] [Thread-3 (]: 70 of 262 START test not_null_dim_loyalty_programs_scd_valid_from .............. [RUN]
[0m15:32:11.930901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa, now test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f)
[0m15:32:11.931273 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m15:32:11.935203 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m15:32:11.935860 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m15:32:11.938017 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m15:32:11.938606 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m15:32:11.938970 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: BEGIN
[0m15:32:11.939408 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:11.960927 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.317 seconds
[0m15:32:11.962731 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: ROLLBACK
[0m15:32:12.055502 [debug] [Thread-2 (]: SQL status: BEGIN in 2.344 seconds
[0m15:32:12.056076 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m15:32:12.056561 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select points_per_dollar
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where points_per_dollar is null



  
  
      
    ) dbt_internal_test
[0m15:32:12.113267 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: Close
[0m15:32:12.114215 [info ] [Thread-1 (]: 68 of 262 PASS not_null_dim_loyalty_programs_scd_name .......................... [[32mPASS[0m in 2.99s]
[0m15:32:12.114874 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m15:32:12.115342 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m15:32:12.115789 [info ] [Thread-1 (]: 71 of 262 START test not_null_dim_loyalty_programs_scd_valid_to ................ [RUN]
[0m15:32:12.116262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a, now test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182)
[0m15:32:12.116596 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m15:32:12.120133 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m15:32:12.120689 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m15:32:12.122765 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m15:32:12.123364 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m15:32:12.123726 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: BEGIN
[0m15:32:12.124029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:12.245119 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: Close
[0m15:32:12.245996 [info ] [Thread-4 (]: 67 of 262 PASS not_null_dim_loyalty_programs_scd_loyalty_program_sk ............ [[32mPASS[0m in 3.28s]
[0m15:32:12.246582 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m15:32:12.247013 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m15:32:12.247501 [info ] [Thread-4 (]: 72 of 262 START test not_null_dim_products_scd_brand_id ........................ [RUN]
[0m15:32:12.247949 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4, now test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3)
[0m15:32:12.248257 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m15:32:12.251881 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m15:32:12.252438 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m15:32:12.254400 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m15:32:12.254970 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m15:32:12.255368 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: BEGIN
[0m15:32:12.255668 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:12.299359 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.242 seconds
[0m15:32:12.300750 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: ROLLBACK
[0m15:32:12.543665 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: Close
[0m15:32:12.544632 [info ] [Thread-2 (]: 69 of 262 PASS not_null_dim_loyalty_programs_scd_points_per_dollar ............. [[32mPASS[0m in 2.84s]
[0m15:32:12.545235 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m15:32:12.545656 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m15:32:12.546083 [info ] [Thread-2 (]: 73 of 262 START test not_null_dim_products_scd_category_id ..................... [RUN]
[0m15:32:12.546543 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c, now test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5)
[0m15:32:12.546889 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m15:32:12.551492 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m15:32:12.552064 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m15:32:12.554152 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m15:32:12.554702 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m15:32:12.555120 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: BEGIN
[0m15:32:12.555465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:14.414131 [debug] [Thread-1 (]: SQL status: BEGIN in 2.290 seconds
[0m15:32:14.414670 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m15:32:14.415014 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:14.665710 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.250 seconds
[0m15:32:14.667539 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: ROLLBACK
[0m15:32:14.699935 [debug] [Thread-3 (]: SQL status: BEGIN in 2.760 seconds
[0m15:32:14.700432 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m15:32:14.700816 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:14.727808 [debug] [Thread-2 (]: SQL status: BEGIN in 2.172 seconds
[0m15:32:14.728441 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m15:32:14.728958 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from "postgres"."silver_to_golden"."dim_products_scd"
where category_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:14.932436 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: Close
[0m15:32:14.933448 [error] [Thread-1 (]: 71 of 262 FAIL 5 not_null_dim_loyalty_programs_scd_valid_to .................... [[31mFAIL 5[0m in 2.82s]
[0m15:32:14.934165 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m15:32:14.934690 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m15:32:14.935374 [info ] [Thread-1 (]: 74 of 262 START test not_null_dim_products_scd_created_at ...................... [RUN]
[0m15:32:14.935986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182, now test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39)
[0m15:32:14.936485 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m15:32:14.940747 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m15:32:14.941381 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m15:32:14.943952 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m15:32:14.944538 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m15:32:14.944859 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: BEGIN
[0m15:32:14.945178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:14.957614 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.256 seconds
[0m15:32:14.959206 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: ROLLBACK
[0m15:32:14.975134 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.246 seconds
[0m15:32:14.976723 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: ROLLBACK
[0m15:32:15.185811 [debug] [Thread-4 (]: SQL status: BEGIN in 2.930 seconds
[0m15:32:15.186399 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m15:32:15.186907 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select brand_id
from "postgres"."silver_to_golden"."dim_products_scd"
where brand_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:15.204120 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: Close
[0m15:32:15.205253 [info ] [Thread-3 (]: 70 of 262 PASS not_null_dim_loyalty_programs_scd_valid_from .................... [[32mPASS[0m in 3.27s]
[0m15:32:15.206008 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m15:32:15.206452 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m15:32:15.206909 [info ] [Thread-3 (]: 75 of 262 START test not_null_dim_products_scd_dbt_scd_id ...................... [RUN]
[0m15:32:15.207414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f, now test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e)
[0m15:32:15.207744 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m15:32:15.211349 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m15:32:15.211742 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: Close
[0m15:32:15.212409 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m15:32:15.215623 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m15:32:15.213109 [info ] [Thread-2 (]: 73 of 262 PASS not_null_dim_products_scd_category_id ........................... [[32mPASS[0m in 2.67s]
[0m15:32:15.216550 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m15:32:15.217113 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m15:32:15.218184 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m15:32:15.217695 [info ] [Thread-2 (]: 76 of 262 START test not_null_dim_products_scd_dbt_updated_at .................. [RUN]
[0m15:32:15.218792 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: BEGIN
[0m15:32:15.219363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5, now test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9)
[0m15:32:15.219835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:15.220309 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m15:32:15.224478 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m15:32:15.225038 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m15:32:15.226937 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m15:32:15.227527 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m15:32:15.229099 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: BEGIN
[0m15:32:15.229398 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:15.433705 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.246 seconds
[0m15:32:15.435348 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: ROLLBACK
[0m15:32:15.695228 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: Close
[0m15:32:15.696076 [info ] [Thread-4 (]: 72 of 262 PASS not_null_dim_products_scd_brand_id .............................. [[32mPASS[0m in 3.45s]
[0m15:32:15.696677 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m15:32:15.697096 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m15:32:15.697534 [info ] [Thread-4 (]: 77 of 262 START test not_null_dim_products_scd_dbt_valid_from .................. [RUN]
[0m15:32:15.698013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3, now test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468)
[0m15:32:15.698333 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m15:32:15.702070 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m15:32:15.702650 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m15:32:15.704903 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m15:32:15.705493 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m15:32:15.705813 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: BEGIN
[0m15:32:15.706157 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:20.306102 [debug] [Thread-4 (]: SQL status: BEGIN in 4.600 seconds
[0m15:32:20.306603 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m15:32:20.306964 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:20.395435 [debug] [Thread-1 (]: SQL status: BEGIN in 5.450 seconds
[0m15:32:20.395917 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m15:32:20.396260 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from "postgres"."silver_to_golden"."dim_products_scd"
where created_at is null



  
  
      
    ) dbt_internal_test
[0m15:32:20.559613 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.252 seconds
[0m15:32:20.561093 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: ROLLBACK
[0m15:32:20.654691 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.258 seconds
[0m15:32:20.656049 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: ROLLBACK
[0m15:32:20.800245 [debug] [Thread-2 (]: SQL status: BEGIN in 5.571 seconds
[0m15:32:20.801092 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m15:32:20.801739 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m15:32:20.843595 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: Close
[0m15:32:20.844425 [info ] [Thread-4 (]: 77 of 262 PASS not_null_dim_products_scd_dbt_valid_from ........................ [[32mPASS[0m in 5.15s]
[0m15:32:20.844984 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m15:32:20.845391 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m15:32:20.845818 [info ] [Thread-4 (]: 78 of 262 START test not_null_dim_products_scd_dbt_valid_to .................... [RUN]
[0m15:32:20.846222 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468, now test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3)
[0m15:32:20.846581 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m15:32:20.850078 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m15:32:20.850646 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m15:32:20.852599 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m15:32:20.853141 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m15:32:20.853488 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: BEGIN
[0m15:32:20.853821 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:20.912634 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: Close
[0m15:32:20.913638 [info ] [Thread-1 (]: 74 of 262 PASS not_null_dim_products_scd_created_at ............................ [[32mPASS[0m in 5.98s]
[0m15:32:20.914288 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m15:32:20.914705 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m15:32:20.915140 [info ] [Thread-1 (]: 79 of 262 START test not_null_dim_products_scd_is_current ...................... [RUN]
[0m15:32:20.915560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39, now test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d)
[0m15:32:20.915906 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m15:32:20.919421 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m15:32:20.919956 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m15:32:20.921925 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m15:32:20.922434 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m15:32:20.922842 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: BEGIN
[0m15:32:20.923152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:21.105310 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.303 seconds
[0m15:32:21.107017 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: ROLLBACK
[0m15:32:21.155296 [debug] [Thread-3 (]: SQL status: BEGIN in 5.935 seconds
[0m15:32:21.155814 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m15:32:21.156263 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:21.411614 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: Close
[0m15:32:21.412593 [info ] [Thread-2 (]: 76 of 262 PASS not_null_dim_products_scd_dbt_updated_at ........................ [[32mPASS[0m in 6.19s]
[0m15:32:21.413271 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m15:32:21.413747 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m15:32:21.414271 [info ] [Thread-2 (]: 80 of 262 START test not_null_dim_products_scd_name ............................ [RUN]
[0m15:32:21.414785 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9, now test.retail_dbt.not_null_dim_products_scd_name.2e07a01976)
[0m15:32:21.415234 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m15:32:21.418953 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m15:32:21.419487 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m15:32:21.422673 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m15:32:21.423253 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m15:32:21.423575 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: BEGIN
[0m15:32:21.423893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:21.450285 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.294 seconds
[0m15:32:21.451706 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: ROLLBACK
[0m15:32:21.718937 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: Close
[0m15:32:21.719923 [info ] [Thread-3 (]: 75 of 262 PASS not_null_dim_products_scd_dbt_scd_id ............................ [[32mPASS[0m in 6.51s]
[0m15:32:21.720775 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m15:32:21.721287 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m15:32:21.721952 [info ] [Thread-3 (]: 81 of 262 START test not_null_dim_products_scd_price ........................... [RUN]
[0m15:32:21.722667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e, now test.retail_dbt.not_null_dim_products_scd_price.d616170fd5)
[0m15:32:21.723468 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m15:32:21.727676 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m15:32:21.728228 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m15:32:21.730191 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m15:32:21.730745 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m15:32:21.731119 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: BEGIN
[0m15:32:21.731462 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:23.345678 [debug] [Thread-1 (]: SQL status: BEGIN in 2.422 seconds
[0m15:32:23.346263 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m15:32:23.346729 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_products_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m15:32:23.460737 [debug] [Thread-4 (]: SQL status: BEGIN in 2.607 seconds
[0m15:32:23.461249 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m15:32:23.461602 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:23.596741 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.249 seconds
[0m15:32:23.598414 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: ROLLBACK
[0m15:32:23.707321 [debug] [Thread-2 (]: SQL status: BEGIN in 2.283 seconds
[0m15:32:23.707830 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m15:32:23.708175 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_products_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m15:32:23.736513 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.274 seconds
[0m15:32:23.737934 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: ROLLBACK
[0m15:32:23.846808 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: Close
[0m15:32:23.847799 [info ] [Thread-1 (]: 79 of 262 PASS not_null_dim_products_scd_is_current ............................ [[32mPASS[0m in 2.93s]
[0m15:32:23.848346 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m15:32:23.848751 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m15:32:23.849183 [info ] [Thread-1 (]: 82 of 262 START test not_null_dim_products_scd_product_id ...................... [RUN]
[0m15:32:23.849619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d, now test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7)
[0m15:32:23.849947 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m15:32:23.853797 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m15:32:23.854532 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m15:32:23.857522 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m15:32:23.858417 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m15:32:23.858927 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: BEGIN
[0m15:32:23.859396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:23.949202 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.241 seconds
[0m15:32:23.950609 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: ROLLBACK
[0m15:32:23.990938 [debug] [Thread-3 (]: SQL status: BEGIN in 2.259 seconds
[0m15:32:23.991451 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m15:32:23.991802 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "postgres"."silver_to_golden"."dim_products_scd"
where price is null



  
  
      
    ) dbt_internal_test
[0m15:32:24.012851 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: Close
[0m15:32:24.013696 [error] [Thread-4 (]: 78 of 262 FAIL 400 not_null_dim_products_scd_dbt_valid_to ...................... [[31mFAIL 400[0m in 3.17s]
[0m15:32:24.014335 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m15:32:24.014760 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m15:32:24.015459 [info ] [Thread-4 (]: 83 of 262 START test not_null_dim_products_scd_product_sk ...................... [RUN]
[0m15:32:24.015976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3, now test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef)
[0m15:32:24.016361 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m15:32:24.020484 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m15:32:24.021029 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m15:32:24.022957 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m15:32:24.023564 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m15:32:24.023885 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: BEGIN
[0m15:32:24.024222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:24.194538 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: Close
[0m15:32:24.195436 [info ] [Thread-2 (]: 80 of 262 PASS not_null_dim_products_scd_name .................................. [[32mPASS[0m in 2.78s]
[0m15:32:24.196005 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m15:32:24.196387 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m15:32:24.196822 [info ] [Thread-2 (]: 84 of 262 START test not_null_dim_products_scd_season .......................... [RUN]
[0m15:32:24.197218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_name.2e07a01976, now test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2)
[0m15:32:24.197570 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m15:32:24.201969 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m15:32:24.202530 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m15:32:24.204493 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m15:32:24.205053 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m15:32:24.205385 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: BEGIN
[0m15:32:24.205687 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:24.237539 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.245 seconds
[0m15:32:24.238918 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: ROLLBACK
[0m15:32:24.481047 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: Close
[0m15:32:24.481951 [info ] [Thread-3 (]: 81 of 262 PASS not_null_dim_products_scd_price ................................. [[32mPASS[0m in 2.76s]
[0m15:32:24.482532 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m15:32:24.482938 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m15:32:24.483417 [info ] [Thread-3 (]: 85 of 262 START test not_null_dim_products_scd_supplier_id ..................... [RUN]
[0m15:32:24.483869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_price.d616170fd5, now test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf)
[0m15:32:24.484220 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m15:32:24.487824 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m15:32:24.488354 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m15:32:24.490233 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m15:32:24.490753 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m15:32:24.491254 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: BEGIN
[0m15:32:24.491587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:26.332210 [debug] [Thread-4 (]: SQL status: BEGIN in 2.308 seconds
[0m15:32:26.332838 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m15:32:26.333306 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "postgres"."silver_to_golden"."dim_products_scd"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m15:32:26.582658 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.249 seconds
[0m15:32:26.584155 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: ROLLBACK
[0m15:32:26.687846 [debug] [Thread-1 (]: SQL status: BEGIN in 2.828 seconds
[0m15:32:26.688435 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m15:32:26.688818 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."dim_products_scd"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:26.814349 [debug] [Thread-2 (]: SQL status: BEGIN in 2.608 seconds
[0m15:32:26.814859 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m15:32:26.815282 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "postgres"."silver_to_golden"."dim_products_scd"
where season is null



  
  
      
    ) dbt_internal_test
[0m15:32:26.835670 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: Close
[0m15:32:26.836892 [info ] [Thread-4 (]: 83 of 262 PASS not_null_dim_products_scd_product_sk ............................ [[32mPASS[0m in 2.82s]
[0m15:32:26.837510 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m15:32:26.837937 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m15:32:26.838439 [info ] [Thread-4 (]: 86 of 262 START test not_null_dim_products_scd_valid_from ...................... [RUN]
[0m15:32:26.839068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef, now test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b)
[0m15:32:26.839409 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m15:32:26.843321 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m15:32:26.843838 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m15:32:26.845713 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m15:32:26.846296 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m15:32:26.846643 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: BEGIN
[0m15:32:26.846943 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:26.958014 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.269 seconds
[0m15:32:26.959529 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: ROLLBACK
[0m15:32:27.100367 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.285 seconds
[0m15:32:27.101880 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: ROLLBACK
[0m15:32:27.102474 [debug] [Thread-3 (]: SQL status: BEGIN in 2.674 seconds
[0m15:32:27.103238 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m15:32:27.103718 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."dim_products_scd"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:27.152258 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: Close
[0m15:32:27.153126 [info ] [Thread-1 (]: 82 of 262 PASS not_null_dim_products_scd_product_id ............................ [[32mPASS[0m in 3.30s]
[0m15:32:27.153872 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m15:32:27.154280 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m15:32:27.154727 [info ] [Thread-1 (]: 87 of 262 START test not_null_dim_products_scd_valid_to ........................ [RUN]
[0m15:32:27.155163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7, now test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34)
[0m15:32:27.155608 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m15:32:27.159710 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m15:32:27.160352 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m15:32:27.164100 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m15:32:27.164647 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m15:32:27.165012 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: BEGIN
[0m15:32:27.165316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:27.323435 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: Close
[0m15:32:27.324314 [info ] [Thread-2 (]: 84 of 262 PASS not_null_dim_products_scd_season ................................ [[32mPASS[0m in 3.13s]
[0m15:32:27.324936 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m15:32:27.325373 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m15:32:27.325852 [info ] [Thread-2 (]: 88 of 262 START test not_null_dim_promotions_scd_dbt_scd_id .................... [RUN]
[0m15:32:27.326370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2, now test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f)
[0m15:32:27.326714 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m15:32:27.330124 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m15:32:27.330689 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m15:32:27.332816 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m15:32:27.333364 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m15:32:27.333717 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: BEGIN
[0m15:32:27.334017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:27.383883 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.280 seconds
[0m15:32:27.385608 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: ROLLBACK
[0m15:32:28.065369 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: Close
[0m15:32:28.066260 [info ] [Thread-3 (]: 85 of 262 PASS not_null_dim_products_scd_supplier_id ........................... [[32mPASS[0m in 3.58s]
[0m15:32:28.066870 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m15:32:28.067342 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m15:32:28.067780 [info ] [Thread-3 (]: 89 of 262 START test not_null_dim_promotions_scd_dbt_updated_at ................ [RUN]
[0m15:32:28.068411 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf, now test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439)
[0m15:32:28.068818 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m15:32:28.072464 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m15:32:28.073067 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m15:32:28.074941 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m15:32:28.075494 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m15:32:28.075829 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: BEGIN
[0m15:32:28.076166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:29.922507 [debug] [Thread-2 (]: SQL status: BEGIN in 2.588 seconds
[0m15:32:29.923008 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m15:32:29.923461 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:29.987342 [debug] [Thread-1 (]: SQL status: BEGIN in 2.822 seconds
[0m15:32:29.987851 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m15:32:29.988191 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_products_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:30.205699 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.282 seconds
[0m15:32:30.207179 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: ROLLBACK
[0m15:32:30.244778 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.256 seconds
[0m15:32:30.246340 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: ROLLBACK
[0m15:32:30.484667 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: Close
[0m15:32:30.485924 [info ] [Thread-2 (]: 88 of 262 PASS not_null_dim_promotions_scd_dbt_scd_id .......................... [[32mPASS[0m in 3.16s]
[0m15:32:30.486530 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m15:32:30.486949 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m15:32:30.487406 [info ] [Thread-2 (]: 90 of 262 START test not_null_dim_promotions_scd_dbt_valid_from ................ [RUN]
[0m15:32:30.487827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f, now test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8)
[0m15:32:30.488197 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m15:32:30.491982 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m15:32:30.492510 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m15:32:30.494299 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m15:32:30.494826 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m15:32:30.495168 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: BEGIN
[0m15:32:30.495537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:30.498208 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: Close
[0m15:32:30.499046 [error] [Thread-1 (]: 87 of 262 FAIL 400 not_null_dim_products_scd_valid_to .......................... [[31mFAIL 400[0m in 3.34s]
[0m15:32:30.499626 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m15:32:30.500027 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m15:32:30.500448 [info ] [Thread-1 (]: 91 of 262 START test not_null_dim_promotions_scd_dbt_valid_to .................. [RUN]
[0m15:32:30.500852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34, now test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7)
[0m15:32:30.501156 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m15:32:30.504607 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m15:32:30.505118 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m15:32:30.573876 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m15:32:30.574551 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m15:32:30.574964 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: BEGIN
[0m15:32:30.575390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:30.628138 [debug] [Thread-3 (]: SQL status: BEGIN in 2.552 seconds
[0m15:32:30.628628 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m15:32:30.628964 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m15:32:30.911345 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.282 seconds
[0m15:32:30.912768 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: ROLLBACK
[0m15:32:31.195644 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: Close
[0m15:32:31.196508 [info ] [Thread-3 (]: 89 of 262 PASS not_null_dim_promotions_scd_dbt_updated_at ...................... [[32mPASS[0m in 3.13s]
[0m15:32:31.197067 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m15:32:31.197474 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m15:32:31.197898 [info ] [Thread-3 (]: 92 of 262 START test not_null_dim_promotions_scd_end_date ...................... [RUN]
[0m15:32:31.198290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439, now test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5)
[0m15:32:31.198642 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m15:32:31.202069 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m15:32:31.202611 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m15:32:31.204486 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m15:32:31.205032 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m15:32:31.205383 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: BEGIN
[0m15:32:31.205682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:31.956216 [debug] [Thread-4 (]: SQL status: BEGIN in 5.173 seconds
[0m15:32:31.956734 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m15:32:31.957088 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_products_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:32.236169 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.279 seconds
[0m15:32:32.237559 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: ROLLBACK
[0m15:32:32.521351 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: Close
[0m15:32:32.522537 [info ] [Thread-4 (]: 86 of 262 PASS not_null_dim_products_scd_valid_from ............................ [[32mPASS[0m in 5.68s]
[0m15:32:32.523171 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m15:32:32.523741 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m15:32:32.524176 [info ] [Thread-4 (]: 93 of 262 START test not_null_dim_promotions_scd_is_current .................... [RUN]
[0m15:32:32.524655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b, now test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247)
[0m15:32:32.525050 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m15:32:32.529089 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m15:32:32.529616 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m15:32:32.531712 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m15:32:32.532273 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m15:32:32.532590 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: BEGIN
[0m15:32:32.532934 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:32.689385 [debug] [Thread-2 (]: SQL status: BEGIN in 2.194 seconds
[0m15:32:32.689881 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m15:32:32.690252 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:32.932955 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.242 seconds
[0m15:32:32.935207 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: ROLLBACK
[0m15:32:32.935862 [debug] [Thread-1 (]: SQL status: BEGIN in 2.360 seconds
[0m15:32:32.936442 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m15:32:32.936914 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:33.177122 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: Close
[0m15:32:33.178002 [info ] [Thread-2 (]: 90 of 262 PASS not_null_dim_promotions_scd_dbt_valid_from ...................... [[32mPASS[0m in 2.69s]
[0m15:32:33.178574 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m15:32:33.178978 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m15:32:33.179413 [info ] [Thread-2 (]: 94 of 262 START test not_null_dim_promotions_scd_name .......................... [RUN]
[0m15:32:33.179857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8, now test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a)
[0m15:32:33.180220 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m15:32:33.183657 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m15:32:33.184191 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m15:32:33.186038 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m15:32:33.186563 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m15:32:33.186903 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: BEGIN
[0m15:32:33.187196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:33.198657 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.261 seconds
[0m15:32:33.200078 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: ROLLBACK
[0m15:32:33.454944 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: Close
[0m15:32:33.455921 [error] [Thread-1 (]: 91 of 262 FAIL 248 not_null_dim_promotions_scd_dbt_valid_to .................... [[31mFAIL 248[0m in 2.95s]
[0m15:32:33.456489 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m15:32:33.456903 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m15:32:33.457349 [info ] [Thread-1 (]: 95 of 262 START test not_null_dim_promotions_scd_promotion_id .................. [RUN]
[0m15:32:33.457805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7, now test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4)
[0m15:32:33.458137 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m15:32:33.462664 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m15:32:33.463200 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m15:32:33.464989 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m15:32:33.465519 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m15:32:33.465869 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: BEGIN
[0m15:32:33.466217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:33.567855 [debug] [Thread-3 (]: SQL status: BEGIN in 2.362 seconds
[0m15:32:33.568378 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m15:32:33.568710 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "postgres"."silver_to_golden"."dim_promotions_scd"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m15:32:33.827082 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.258 seconds
[0m15:32:33.828697 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: ROLLBACK
[0m15:32:34.086614 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: Close
[0m15:32:34.087861 [info ] [Thread-3 (]: 92 of 262 PASS not_null_dim_promotions_scd_end_date ............................ [[32mPASS[0m in 2.89s]
[0m15:32:34.088502 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m15:32:34.088928 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m15:32:34.089390 [info ] [Thread-3 (]: 96 of 262 START test not_null_dim_promotions_scd_promotion_sk .................. [RUN]
[0m15:32:34.089815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5, now test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5)
[0m15:32:34.090180 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m15:32:34.093914 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m15:32:34.094547 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m15:32:34.096942 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m15:32:34.097611 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m15:32:34.097975 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: BEGIN
[0m15:32:34.098320 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:35.188857 [debug] [Thread-4 (]: SQL status: BEGIN in 2.656 seconds
[0m15:32:35.189339 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m15:32:35.190000 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_promotions_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m15:32:35.468568 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.278 seconds
[0m15:32:35.470146 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: ROLLBACK
[0m15:32:35.749497 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: Close
[0m15:32:35.750445 [info ] [Thread-4 (]: 93 of 262 PASS not_null_dim_promotions_scd_is_current .......................... [[32mPASS[0m in 3.23s]
[0m15:32:35.751151 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m15:32:35.751669 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m15:32:35.752126 [info ] [Thread-4 (]: 97 of 262 START test not_null_dim_promotions_scd_start_date .................... [RUN]
[0m15:32:35.752629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247, now test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5)
[0m15:32:35.752997 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m15:32:35.756365 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m15:32:35.756903 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m15:32:35.758826 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m15:32:35.759383 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m15:32:35.759750 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: BEGIN
[0m15:32:35.760056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:36.034409 [debug] [Thread-1 (]: SQL status: BEGIN in 2.568 seconds
[0m15:32:36.034914 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m15:32:36.035350 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select promotion_id
from "postgres"."silver_to_golden"."dim_promotions_scd"
where promotion_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:36.255427 [debug] [Thread-2 (]: SQL status: BEGIN in 3.068 seconds
[0m15:32:36.255974 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m15:32:36.256398 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_promotions_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m15:32:36.316944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.281 seconds
[0m15:32:36.318649 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: ROLLBACK
[0m15:32:36.490582 [debug] [Thread-3 (]: SQL status: BEGIN in 2.392 seconds
[0m15:32:36.491174 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m15:32:36.491715 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select promotion_sk
from "postgres"."silver_to_golden"."dim_promotions_scd"
where promotion_sk is null



  
  
      
    ) dbt_internal_test
[0m15:32:36.599031 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: Close
[0m15:32:36.600095 [info ] [Thread-1 (]: 95 of 262 PASS not_null_dim_promotions_scd_promotion_id ........................ [[32mPASS[0m in 3.14s]
[0m15:32:36.600951 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m15:32:36.601455 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m15:32:36.601975 [info ] [Thread-1 (]: 98 of 262 START test not_null_dim_promotions_scd_valid_from .................... [RUN]
[0m15:32:36.602439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4, now test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f)
[0m15:32:36.602759 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m15:32:36.606680 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m15:32:36.607418 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m15:32:36.609548 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m15:32:36.610107 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m15:32:36.610466 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: BEGIN
[0m15:32:36.610783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:36.757165 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.265 seconds
[0m15:32:36.758851 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: ROLLBACK
[0m15:32:36.961577 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.705 seconds
[0m15:32:36.963189 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: ROLLBACK
[0m15:32:37.006433 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: Close
[0m15:32:37.007578 [info ] [Thread-3 (]: 96 of 262 PASS not_null_dim_promotions_scd_promotion_sk ........................ [[32mPASS[0m in 2.92s]
[0m15:32:37.008352 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m15:32:37.008838 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m15:32:37.009421 [info ] [Thread-3 (]: 99 of 262 START test not_null_dim_promotions_scd_valid_to ...................... [RUN]
[0m15:32:37.009994 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5, now test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417)
[0m15:32:37.010401 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m15:32:37.016213 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m15:32:37.016843 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m15:32:37.019094 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m15:32:37.019747 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m15:32:37.020187 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: BEGIN
[0m15:32:37.020567 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:37.226903 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: Close
[0m15:32:37.227925 [info ] [Thread-2 (]: 94 of 262 PASS not_null_dim_promotions_scd_name ................................ [[32mPASS[0m in 4.05s]
[0m15:32:37.228725 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m15:32:37.229122 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m15:32:37.229630 [info ] [Thread-2 (]: 100 of 262 START test not_null_dim_stores_scd_dbt_scd_id ....................... [RUN]
[0m15:32:37.230150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a, now test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5)
[0m15:32:37.230510 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m15:32:37.233890 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m15:32:37.234563 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m15:32:37.237470 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m15:32:37.238365 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m15:32:37.238795 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: BEGIN
[0m15:32:37.239179 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:38.140671 [debug] [Thread-4 (]: SQL status: BEGIN in 2.380 seconds
[0m15:32:38.141250 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m15:32:38.141757 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "postgres"."silver_to_golden"."dim_promotions_scd"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m15:32:38.936465 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.794 seconds
[0m15:32:38.937997 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: ROLLBACK
[0m15:32:39.188622 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: Close
[0m15:32:39.189533 [info ] [Thread-4 (]: 97 of 262 PASS not_null_dim_promotions_scd_start_date .......................... [[32mPASS[0m in 3.44s]
[0m15:32:39.190199 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m15:32:39.190649 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m15:32:39.191188 [info ] [Thread-4 (]: 101 of 262 START test not_null_dim_stores_scd_dbt_updated_at ................... [RUN]
[0m15:32:39.191744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5, now test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59)
[0m15:32:39.192117 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m15:32:39.195822 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m15:32:39.196354 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m15:32:39.198376 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m15:32:39.198896 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m15:32:39.199243 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: BEGIN
[0m15:32:39.199555 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:39.391621 [debug] [Thread-1 (]: SQL status: BEGIN in 2.781 seconds
[0m15:32:39.392179 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m15:32:39.392577 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_promotions_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:39.656136 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.263 seconds
[0m15:32:39.657599 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: ROLLBACK
[0m15:32:39.766539 [debug] [Thread-3 (]: SQL status: BEGIN in 2.746 seconds
[0m15:32:39.767076 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m15:32:39.767681 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_promotions_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:39.950975 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: Close
[0m15:32:39.951972 [info ] [Thread-1 (]: 98 of 262 PASS not_null_dim_promotions_scd_valid_from .......................... [[32mPASS[0m in 3.35s]
[0m15:32:39.952648 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m15:32:39.953178 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m15:32:39.953696 [info ] [Thread-1 (]: 102 of 262 START test not_null_dim_stores_scd_dbt_valid_from ................... [RUN]
[0m15:32:39.954213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f, now test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787)
[0m15:32:39.954660 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m15:32:39.958408 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m15:32:39.958936 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m15:32:39.961867 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m15:32:39.962397 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m15:32:39.962752 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: BEGIN
[0m15:32:39.963058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:40.404412 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.636 seconds
[0m15:32:40.406116 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: ROLLBACK
[0m15:32:40.566648 [debug] [Thread-2 (]: SQL status: BEGIN in 3.327 seconds
[0m15:32:40.567169 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m15:32:40.567619 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:40.874582 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.306 seconds
[0m15:32:40.876076 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: ROLLBACK
[0m15:32:41.038579 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: Close
[0m15:32:41.039504 [error] [Thread-3 (]: 99 of 262 FAIL 248 not_null_dim_promotions_scd_valid_to ........................ [[31mFAIL 248[0m in 4.03s]
[0m15:32:41.040078 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m15:32:41.040486 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m15:32:41.040969 [info ] [Thread-3 (]: 103 of 262 START test not_null_dim_stores_scd_dbt_valid_to ..................... [RUN]
[0m15:32:41.041421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417, now test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc)
[0m15:32:41.041756 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m15:32:41.045594 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m15:32:41.046141 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m15:32:41.048235 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m15:32:41.048883 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m15:32:41.049195 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: BEGIN
[0m15:32:41.049544 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:41.153216 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: Close
[0m15:32:41.154126 [info ] [Thread-2 (]: 100 of 262 PASS not_null_dim_stores_scd_dbt_scd_id ............................. [[32mPASS[0m in 3.92s]
[0m15:32:41.154682 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m15:32:41.155096 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m15:32:41.155582 [info ] [Thread-2 (]: 104 of 262 START test not_null_dim_stores_scd_is_current ....................... [RUN]
[0m15:32:41.156176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5, now test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257)
[0m15:32:41.156553 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m15:32:41.160292 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m15:32:41.160863 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m15:32:41.162769 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m15:32:41.163349 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m15:32:41.163717 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: BEGIN
[0m15:32:41.164041 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:41.793587 [debug] [Thread-4 (]: SQL status: BEGIN in 2.594 seconds
[0m15:32:41.794104 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m15:32:41.794484 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m15:32:42.063655 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.269 seconds
[0m15:32:42.065548 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: ROLLBACK
[0m15:32:42.324922 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: Close
[0m15:32:42.325925 [info ] [Thread-4 (]: 101 of 262 PASS not_null_dim_stores_scd_dbt_updated_at ......................... [[32mPASS[0m in 3.13s]
[0m15:32:42.326539 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m15:32:42.326923 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m15:32:42.327364 [info ] [Thread-4 (]: 105 of 262 START test not_null_dim_stores_scd_location ......................... [RUN]
[0m15:32:42.327788 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59, now test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58)
[0m15:32:42.328146 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m15:32:42.331516 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m15:32:42.332046 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m15:32:42.333970 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m15:32:42.334618 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m15:32:42.335033 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: BEGIN
[0m15:32:42.335463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:43.215012 [debug] [Thread-1 (]: SQL status: BEGIN in 3.252 seconds
[0m15:32:43.215508 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m15:32:43.215841 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:43.424261 [debug] [Thread-3 (]: SQL status: BEGIN in 2.375 seconds
[0m15:32:43.424773 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m15:32:43.425202 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:43.500982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.285 seconds
[0m15:32:43.502615 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: ROLLBACK
[0m15:32:43.692045 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.266 seconds
[0m15:32:43.693750 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: ROLLBACK
[0m15:32:43.784796 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: Close
[0m15:32:43.785796 [info ] [Thread-1 (]: 102 of 262 PASS not_null_dim_stores_scd_dbt_valid_from ......................... [[32mPASS[0m in 3.83s]
[0m15:32:43.786523 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m15:32:43.786987 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m15:32:43.787498 [info ] [Thread-1 (]: 106 of 262 START test not_null_dim_stores_scd_manager_id ....................... [RUN]
[0m15:32:43.788009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787, now test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8)
[0m15:32:43.788412 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m15:32:43.793212 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m15:32:43.793786 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m15:32:43.795719 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m15:32:43.796253 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m15:32:43.796595 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: BEGIN
[0m15:32:43.796900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:43.965135 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: Close
[0m15:32:43.966107 [error] [Thread-3 (]: 103 of 262 FAIL 20 not_null_dim_stores_scd_dbt_valid_to ........................ [[31mFAIL 20[0m in 2.92s]
[0m15:32:43.966731 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m15:32:43.967137 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m15:32:43.967600 [info ] [Thread-3 (]: 107 of 262 START test not_null_dim_stores_scd_name ............................. [RUN]
[0m15:32:43.968156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc, now test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999)
[0m15:32:43.968570 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m15:32:43.972242 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m15:32:43.972776 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m15:32:43.974927 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m15:32:43.975491 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m15:32:43.975815 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: BEGIN
[0m15:32:43.976146 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:44.686116 [debug] [Thread-4 (]: SQL status: BEGIN in 2.350 seconds
[0m15:32:44.686774 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m15:32:44.687584 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location
from "postgres"."silver_to_golden"."dim_stores_scd"
where location is null



  
  
      
    ) dbt_internal_test
[0m15:32:44.940613 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.252 seconds
[0m15:32:44.942264 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: ROLLBACK
[0m15:32:45.101637 [debug] [Thread-2 (]: SQL status: BEGIN in 3.937 seconds
[0m15:32:45.102136 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m15:32:45.102528 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_stores_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m15:32:45.210129 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: Close
[0m15:32:45.211036 [info ] [Thread-4 (]: 105 of 262 PASS not_null_dim_stores_scd_location ............................... [[32mPASS[0m in 2.88s]
[0m15:32:45.211759 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m15:32:45.212165 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m15:32:45.212664 [info ] [Thread-4 (]: 108 of 262 START test not_null_dim_stores_scd_store_id ......................... [RUN]
[0m15:32:45.213190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58, now test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f)
[0m15:32:45.213563 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m15:32:45.217458 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m15:32:45.218043 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m15:32:45.220180 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m15:32:45.220820 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m15:32:45.221182 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: BEGIN
[0m15:32:45.221510 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:45.427326 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.324 seconds
[0m15:32:45.429175 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: ROLLBACK
[0m15:32:45.747771 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: Close
[0m15:32:45.748748 [info ] [Thread-2 (]: 104 of 262 PASS not_null_dim_stores_scd_is_current ............................. [[32mPASS[0m in 4.59s]
[0m15:32:45.749375 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m15:32:45.749831 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m15:32:45.750473 [info ] [Thread-2 (]: 109 of 262 START test not_null_dim_stores_scd_store_sk ......................... [RUN]
[0m15:32:45.751199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257, now test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c)
[0m15:32:45.751763 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m15:32:45.756384 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m15:32:45.757062 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m15:32:45.759753 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m15:32:45.760411 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m15:32:45.760750 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: BEGIN
[0m15:32:45.761060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:46.293350 [debug] [Thread-3 (]: SQL status: BEGIN in 2.317 seconds
[0m15:32:46.293940 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m15:32:46.294288 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_stores_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m15:32:46.540648 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.246 seconds
[0m15:32:46.543474 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: ROLLBACK
[0m15:32:46.791038 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: Close
[0m15:32:46.791987 [info ] [Thread-3 (]: 107 of 262 PASS not_null_dim_stores_scd_name ................................... [[32mPASS[0m in 2.82s]
[0m15:32:46.792570 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m15:32:46.792993 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m15:32:46.793436 [info ] [Thread-3 (]: 110 of 262 START test not_null_dim_stores_scd_valid_from ....................... [RUN]
[0m15:32:46.793936 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999, now test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f)
[0m15:32:46.794334 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m15:32:46.797832 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m15:32:46.798404 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m15:32:46.800448 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m15:32:46.800988 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m15:32:46.801306 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: BEGIN
[0m15:32:46.801650 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:47.409685 [debug] [Thread-1 (]: SQL status: BEGIN in 3.613 seconds
[0m15:32:47.410260 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m15:32:47.410647 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manager_id
from "postgres"."silver_to_golden"."dim_stores_scd"
where manager_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:47.547385 [debug] [Thread-4 (]: SQL status: BEGIN in 2.326 seconds
[0m15:32:47.548010 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m15:32:47.548386 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."dim_stores_scd"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:47.658494 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.247 seconds
[0m15:32:47.659951 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: ROLLBACK
[0m15:32:47.795136 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.246 seconds
[0m15:32:47.796631 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: ROLLBACK
[0m15:32:47.926729 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: Close
[0m15:32:47.927717 [info ] [Thread-1 (]: 106 of 262 PASS not_null_dim_stores_scd_manager_id ............................. [[32mPASS[0m in 4.14s]
[0m15:32:47.928319 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m15:32:47.928742 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m15:32:47.929233 [info ] [Thread-1 (]: 111 of 262 START test not_null_dim_stores_scd_valid_to ......................... [RUN]
[0m15:32:47.929733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8, now test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24)
[0m15:32:47.930096 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m15:32:47.933483 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m15:32:47.934020 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m15:32:47.936019 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m15:32:47.936576 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m15:32:47.936885 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: BEGIN
[0m15:32:47.937275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:48.075620 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: Close
[0m15:32:48.076586 [info ] [Thread-4 (]: 108 of 262 PASS not_null_dim_stores_scd_store_id ............................... [[32mPASS[0m in 2.86s]
[0m15:32:48.077169 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m15:32:48.077577 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m15:32:48.078019 [info ] [Thread-4 (]: 112 of 262 START test not_null_dim_suppliers_scd_contact_info .................. [RUN]
[0m15:32:48.078490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f, now test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6)
[0m15:32:48.078829 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m15:32:48.082617 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m15:32:48.083407 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m15:32:48.085316 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m15:32:48.085905 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m15:32:48.086220 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: BEGIN
[0m15:32:48.086566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:48.388257 [debug] [Thread-2 (]: SQL status: BEGIN in 2.627 seconds
[0m15:32:48.388742 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m15:32:48.389074 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "postgres"."silver_to_golden"."dim_stores_scd"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m15:32:48.677562 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.288 seconds
[0m15:32:48.679042 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: ROLLBACK
[0m15:32:48.999485 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: Close
[0m15:32:49.000349 [info ] [Thread-2 (]: 109 of 262 PASS not_null_dim_stores_scd_store_sk ............................... [[32mPASS[0m in 3.25s]
[0m15:32:49.000962 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m15:32:49.001372 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m15:32:49.001837 [info ] [Thread-2 (]: 113 of 262 START test not_null_dim_suppliers_scd_dbt_scd_id .................... [RUN]
[0m15:32:49.002299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e)
[0m15:32:49.002648 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m15:32:49.006115 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m15:32:49.006667 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m15:32:49.009843 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m15:32:49.010396 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m15:32:49.010736 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: BEGIN
[0m15:32:49.011040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:50.249479 [debug] [Thread-3 (]: SQL status: BEGIN in 3.448 seconds
[0m15:32:50.250027 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m15:32:50.250454 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_stores_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:50.437665 [debug] [Thread-4 (]: SQL status: BEGIN in 2.351 seconds
[0m15:32:50.438192 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m15:32:50.438729 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select contact_info
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where contact_info is null



  
  
      
    ) dbt_internal_test
[0m15:32:50.555563 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.305 seconds
[0m15:32:50.557328 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: ROLLBACK
[0m15:32:50.700233 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.261 seconds
[0m15:32:50.701628 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: ROLLBACK
[0m15:32:50.868942 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: Close
[0m15:32:50.869909 [info ] [Thread-3 (]: 110 of 262 PASS not_null_dim_stores_scd_valid_from ............................. [[32mPASS[0m in 4.08s]
[0m15:32:50.870537 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m15:32:50.871229 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m15:32:50.871926 [info ] [Thread-3 (]: 114 of 262 START test not_null_dim_suppliers_scd_dbt_updated_at ................ [RUN]
[0m15:32:50.872505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372)
[0m15:32:50.872877 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m15:32:50.876527 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m15:32:50.877109 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m15:32:50.879413 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m15:32:50.880080 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m15:32:50.880483 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: BEGIN
[0m15:32:50.880899 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:50.958402 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: Close
[0m15:32:50.959490 [info ] [Thread-4 (]: 112 of 262 PASS not_null_dim_suppliers_scd_contact_info ........................ [[32mPASS[0m in 2.88s]
[0m15:32:50.960123 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m15:32:50.960551 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m15:32:50.961009 [info ] [Thread-4 (]: 115 of 262 START test not_null_dim_suppliers_scd_dbt_valid_from ................ [RUN]
[0m15:32:50.961479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710)
[0m15:32:50.961854 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m15:32:50.965367 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m15:32:50.965931 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m15:32:50.967889 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m15:32:50.968437 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m15:32:50.968795 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: BEGIN
[0m15:32:50.969106 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:51.143969 [debug] [Thread-1 (]: SQL status: BEGIN in 3.207 seconds
[0m15:32:51.144671 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m15:32:51.145023 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_stores_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:51.466312 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.321 seconds
[0m15:32:51.467869 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: ROLLBACK
[0m15:32:51.803818 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: Close
[0m15:32:51.804710 [error] [Thread-1 (]: 111 of 262 FAIL 20 not_null_dim_stores_scd_valid_to ............................ [[31mFAIL 20[0m in 3.87s]
[0m15:32:51.805304 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m15:32:51.805688 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m15:32:51.806132 [info ] [Thread-1 (]: 116 of 262 START test not_null_dim_suppliers_scd_dbt_valid_to .................. [RUN]
[0m15:32:51.806563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93)
[0m15:32:51.806902 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m15:32:51.810373 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m15:32:51.810911 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m15:32:51.812936 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m15:32:51.813461 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m15:32:51.813804 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: BEGIN
[0m15:32:51.814103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:53.216497 [debug] [Thread-3 (]: SQL status: BEGIN in 2.336 seconds
[0m15:32:53.216989 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m15:32:53.217326 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m15:32:53.460386 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.243 seconds
[0m15:32:53.462002 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: ROLLBACK
[0m15:32:53.729488 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: Close
[0m15:32:53.730591 [info ] [Thread-3 (]: 114 of 262 PASS not_null_dim_suppliers_scd_dbt_updated_at ...................... [[32mPASS[0m in 2.86s]
[0m15:32:53.731386 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m15:32:53.731910 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m15:32:53.732453 [info ] [Thread-3 (]: 117 of 262 START test not_null_dim_suppliers_scd_is_current .................... [RUN]
[0m15:32:53.733004 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372, now test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1)
[0m15:32:53.733439 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m15:32:53.738414 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m15:32:53.738970 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m15:32:53.740822 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m15:32:53.741400 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m15:32:53.741727 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: BEGIN
[0m15:32:53.742053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:53.742800 [debug] [Thread-2 (]: SQL status: BEGIN in 4.732 seconds
[0m15:32:53.743254 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m15:32:53.743729 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:53.905161 [debug] [Thread-4 (]: SQL status: BEGIN in 2.936 seconds
[0m15:32:53.905717 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m15:32:53.906169 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:32:54.046486 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.302 seconds
[0m15:32:54.048143 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: ROLLBACK
[0m15:32:54.171901 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.265 seconds
[0m15:32:54.173547 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: ROLLBACK
[0m15:32:54.456066 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: Close
[0m15:32:54.457624 [info ] [Thread-4 (]: 115 of 262 PASS not_null_dim_suppliers_scd_dbt_valid_from ...................... [[32mPASS[0m in 3.50s]
[0m15:32:54.458281 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m15:32:54.458774 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m15:32:54.459232 [info ] [Thread-4 (]: 118 of 262 START test not_null_dim_suppliers_scd_name .......................... [RUN]
[0m15:32:54.459731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710, now test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1)
[0m15:32:54.460100 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m15:32:54.463853 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m15:32:54.464403 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m15:32:54.466881 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m15:32:54.467542 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m15:32:54.467864 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: BEGIN
[0m15:32:54.468211 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:54.791692 [debug] [Thread-1 (]: SQL status: BEGIN in 2.977 seconds
[0m15:32:54.792249 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m15:32:54.792704 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:32:54.897794 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: Close
[0m15:32:54.898639 [info ] [Thread-2 (]: 113 of 262 PASS not_null_dim_suppliers_scd_dbt_scd_id .......................... [[32mPASS[0m in 5.90s]
[0m15:32:54.899204 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m15:32:54.899613 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m15:32:54.900024 [info ] [Thread-2 (]: 119 of 262 START test not_null_dim_suppliers_scd_supplier_id ................... [RUN]
[0m15:32:54.900428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e, now test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a)
[0m15:32:54.900791 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m15:32:54.904327 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m15:32:54.904891 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m15:32:54.906732 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m15:32:54.907246 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m15:32:54.907686 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: BEGIN
[0m15:32:54.908030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:55.075749 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.283 seconds
[0m15:32:55.077356 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: ROLLBACK
[0m15:32:55.342012 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: Close
[0m15:32:55.343080 [error] [Thread-1 (]: 116 of 262 FAIL 10 not_null_dim_suppliers_scd_dbt_valid_to ..................... [[31mFAIL 10[0m in 3.54s]
[0m15:32:55.343943 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m15:32:55.344418 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m15:32:55.344945 [info ] [Thread-1 (]: 120 of 262 START test not_null_dim_suppliers_scd_supplier_sk ................... [RUN]
[0m15:32:55.345472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93, now test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773)
[0m15:32:55.345917 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m15:32:55.349951 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m15:32:55.350589 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m15:32:55.353861 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m15:32:55.354386 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m15:32:55.354732 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: BEGIN
[0m15:32:55.355032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:57.263615 [debug] [Thread-2 (]: SQL status: BEGIN in 2.425 seconds
[0m15:32:57.264134 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m15:32:57.264475 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m15:32:57.407792 [debug] [Thread-4 (]: SQL status: BEGIN in 3.009 seconds
[0m15:32:57.408355 [debug] [Thread-3 (]: SQL status: BEGIN in 3.736 seconds
[0m15:32:57.408762 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m15:32:57.409151 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m15:32:57.409570 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m15:32:57.410071 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m15:32:57.521692 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.257 seconds
[0m15:32:57.523052 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: ROLLBACK
[0m15:32:57.704596 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.294 seconds
[0m15:32:57.705160 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.295 seconds
[0m15:32:57.706519 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: ROLLBACK
[0m15:32:57.707716 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: ROLLBACK
[0m15:32:57.712901 [debug] [Thread-1 (]: SQL status: BEGIN in 2.427 seconds
[0m15:32:57.713308 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m15:32:57.713708 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_sk
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where supplier_sk is null



  
  
      
    ) dbt_internal_test
[0m15:32:57.806178 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: Close
[0m15:32:57.807186 [info ] [Thread-2 (]: 119 of 262 PASS not_null_dim_suppliers_scd_supplier_id ......................... [[32mPASS[0m in 2.91s]
[0m15:32:57.807842 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m15:32:57.808257 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m15:32:57.808750 [info ] [Thread-2 (]: 121 of 262 START test not_null_dim_suppliers_scd_valid_from .................... [RUN]
[0m15:32:57.809329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a, now test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209)
[0m15:32:57.809810 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m15:32:57.813832 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m15:32:57.814478 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m15:32:57.816761 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m15:32:57.817347 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m15:32:57.817766 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: BEGIN
[0m15:32:57.818103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:32:57.986703 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.273 seconds
[0m15:32:57.988074 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: ROLLBACK
[0m15:32:58.003239 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: Close
[0m15:32:58.004012 [info ] [Thread-3 (]: 117 of 262 PASS not_null_dim_suppliers_scd_is_current .......................... [[32mPASS[0m in 4.27s]
[0m15:32:58.004465 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: Close
[0m15:32:58.005002 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m15:32:58.005497 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m15:32:58.006039 [info ] [Thread-4 (]: 118 of 262 PASS not_null_dim_suppliers_scd_name ................................ [[32mPASS[0m in 3.55s]
[0m15:32:58.006469 [info ] [Thread-3 (]: 122 of 262 START test not_null_dim_suppliers_scd_valid_to ...................... [RUN]
[0m15:32:58.007174 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m15:32:58.007596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1, now test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917)
[0m15:32:58.008051 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m15:32:58.008502 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m15:32:58.012349 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m15:32:58.008871 [info ] [Thread-4 (]: 123 of 262 START test not_null_dim_tax_rules_product_id ........................ [RUN]
[0m15:32:58.013015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1, now test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297)
[0m15:32:58.013524 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m15:32:58.017147 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m15:32:58.017542 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m15:32:58.019712 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m15:32:58.020191 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m15:32:58.022385 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m15:32:58.022918 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m15:32:58.023342 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: BEGIN
[0m15:32:58.023774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:32:58.024177 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m15:32:58.024670 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: BEGIN
[0m15:32:58.024991 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:32:58.249331 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: Close
[0m15:32:58.250230 [info ] [Thread-1 (]: 120 of 262 PASS not_null_dim_suppliers_scd_supplier_sk ......................... [[32mPASS[0m in 2.90s]
[0m15:32:58.250794 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m15:32:58.251214 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m15:32:58.251651 [info ] [Thread-1 (]: 124 of 262 START test not_null_dim_tax_rules_region ............................ [RUN]
[0m15:32:58.252147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773, now test.retail_dbt.not_null_dim_tax_rules_region.0377b55149)
[0m15:32:58.252495 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m15:32:58.256335 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m15:32:58.256878 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m15:32:58.260051 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m15:32:58.260590 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m15:32:58.260907 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: BEGIN
[0m15:32:58.261231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:00.555997 [debug] [Thread-2 (]: SQL status: BEGIN in 2.738 seconds
[0m15:33:00.556628 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m15:33:00.556970 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m15:33:00.849299 [debug] [Thread-1 (]: SQL status: BEGIN in 2.588 seconds
[0m15:33:00.849915 [debug] [Thread-3 (]: SQL status: BEGIN in 2.826 seconds
[0m15:33:00.850337 [debug] [Thread-4 (]: SQL status: BEGIN in 2.825 seconds
[0m15:33:00.850799 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.293 seconds
[0m15:33:00.851252 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m15:33:00.851729 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m15:33:00.852191 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m15:33:00.853631 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: ROLLBACK
[0m15:33:00.854059 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "postgres"."silver_to_golden"."dim_tax_rules"
where region is null



  
  
      
    ) dbt_internal_test
[0m15:33:00.854536 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m15:33:00.854972 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."dim_tax_rules"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:01.128689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.273 seconds
[0m15:33:01.129257 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.274 seconds
[0m15:33:01.130981 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: ROLLBACK
[0m15:33:01.132313 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: ROLLBACK
[0m15:33:01.134198 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: Close
[0m15:33:01.134920 [info ] [Thread-2 (]: 121 of 262 PASS not_null_dim_suppliers_scd_valid_from .......................... [[32mPASS[0m in 3.33s]
[0m15:33:01.135789 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m15:33:01.136139 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.280 seconds
[0m15:33:01.136607 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m15:33:01.137929 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: ROLLBACK
[0m15:33:01.138356 [info ] [Thread-2 (]: 125 of 262 START test not_null_dim_tax_rules_tax_id ............................ [RUN]
[0m15:33:01.138937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209, now test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b)
[0m15:33:01.139280 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m15:33:01.143177 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m15:33:01.144095 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m15:33:01.146719 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m15:33:01.147319 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m15:33:01.147678 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: BEGIN
[0m15:33:01.148024 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:01.459617 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: Close
[0m15:33:01.460136 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: Close
[0m15:33:01.460540 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: Close
[0m15:33:01.461174 [info ] [Thread-1 (]: 124 of 262 PASS not_null_dim_tax_rules_region .................................. [[32mPASS[0m in 3.21s]
[0m15:33:01.462896 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m15:33:01.461930 [error] [Thread-3 (]: 122 of 262 FAIL 10 not_null_dim_suppliers_scd_valid_to ......................... [[31mFAIL 10[0m in 3.45s]
[0m15:33:01.463491 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m15:33:01.462409 [info ] [Thread-4 (]: 123 of 262 PASS not_null_dim_tax_rules_product_id .............................. [[32mPASS[0m in 3.45s]
[0m15:33:01.464334 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m15:33:01.464747 [info ] [Thread-1 (]: 126 of 262 START test not_null_dim_tax_rules_tax_rate .......................... [RUN]
[0m15:33:01.465371 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m15:33:01.465852 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m15:33:01.466334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_region.0377b55149, now test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1)
[0m15:33:01.466838 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m15:33:01.467381 [info ] [Thread-3 (]: 127 of 262 START test not_null_fct_customer_feedback_comments .................. [RUN]
[0m15:33:01.468082 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m15:33:01.468564 [info ] [Thread-4 (]: 128 of 262 START test not_null_fct_customer_feedback_customer_id ............... [RUN]
[0m15:33:01.469082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917, now test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d)
[0m15:33:01.472700 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m15:33:01.473123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297, now test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3)
[0m15:33:01.473674 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m15:33:01.474255 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m15:33:01.477788 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m15:33:01.478240 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m15:33:01.481173 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m15:33:01.483289 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m15:33:01.484008 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m15:33:01.487119 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m15:33:01.487740 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m15:33:01.488164 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m15:33:01.488583 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: BEGIN
[0m15:33:01.490956 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m15:33:01.491361 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m15:33:01.491746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:01.492287 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: BEGIN
[0m15:33:01.492914 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m15:33:01.493322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:01.493761 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: BEGIN
[0m15:33:01.494311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:03.939350 [debug] [Thread-1 (]: SQL status: BEGIN in 2.447 seconds
[0m15:33:03.939832 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m15:33:03.940164 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_rate
from "postgres"."silver_to_golden"."dim_tax_rules"
where tax_rate is null



  
  
      
    ) dbt_internal_test
[0m15:33:03.971143 [debug] [Thread-4 (]: SQL status: BEGIN in 2.477 seconds
[0m15:33:03.971629 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m15:33:03.971998 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:04.024828 [debug] [Thread-3 (]: SQL status: BEGIN in 2.531 seconds
[0m15:33:04.025303 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m15:33:04.025673 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select comments
from "postgres"."silver_to_golden"."fct_customer_feedback"
where comments is null



  
  
      
    ) dbt_internal_test
[0m15:33:04.044247 [debug] [Thread-2 (]: SQL status: BEGIN in 2.896 seconds
[0m15:33:04.044726 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m15:33:04.045276 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_id
from "postgres"."silver_to_golden"."dim_tax_rules"
where tax_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:04.184733 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.244 seconds
[0m15:33:04.186149 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: ROLLBACK
[0m15:33:04.232627 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.260 seconds
[0m15:33:04.234130 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: ROLLBACK
[0m15:33:04.308114 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.282 seconds
[0m15:33:04.309357 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: ROLLBACK
[0m15:33:04.323341 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.278 seconds
[0m15:33:04.324678 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: ROLLBACK
[0m15:33:04.430741 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: Close
[0m15:33:04.431742 [info ] [Thread-1 (]: 126 of 262 PASS not_null_dim_tax_rules_tax_rate ................................ [[32mPASS[0m in 2.97s]
[0m15:33:04.432328 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m15:33:04.432787 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m15:33:04.433271 [info ] [Thread-1 (]: 129 of 262 START test not_null_fct_customer_feedback_customer_name ............. [RUN]
[0m15:33:04.433734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1, now test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63)
[0m15:33:04.434143 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m15:33:04.437659 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m15:33:04.438209 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m15:33:04.440066 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m15:33:04.440620 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m15:33:04.440970 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: BEGIN
[0m15:33:04.441292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:04.580541 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: Close
[0m15:33:04.581468 [info ] [Thread-3 (]: 127 of 262 PASS not_null_fct_customer_feedback_comments ........................ [[32mPASS[0m in 3.11s]
[0m15:33:04.582076 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m15:33:04.582520 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m15:33:04.582946 [info ] [Thread-3 (]: 130 of 262 START test not_null_fct_customer_feedback_feedback_date ............. [RUN]
[0m15:33:04.583379 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d, now test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41)
[0m15:33:04.583758 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m15:33:04.587261 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m15:33:04.587777 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m15:33:04.589541 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m15:33:04.590282 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m15:33:04.590672 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: BEGIN
[0m15:33:04.591085 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:04.597919 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: Close
[0m15:33:04.598876 [info ] [Thread-2 (]: 125 of 262 PASS not_null_dim_tax_rules_tax_id .................................. [[32mPASS[0m in 3.46s]
[0m15:33:04.599560 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m15:33:04.600051 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m15:33:04.600540 [info ] [Thread-2 (]: 131 of 262 START test not_null_fct_customer_feedback_feedback_day .............. [RUN]
[0m15:33:04.600996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b, now test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83)
[0m15:33:04.601448 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m15:33:04.604740 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m15:33:04.605453 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m15:33:04.608681 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m15:33:04.609263 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m15:33:04.609582 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: BEGIN
[0m15:33:04.609961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:04.920128 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: Close
[0m15:33:04.921138 [info ] [Thread-4 (]: 128 of 262 PASS not_null_fct_customer_feedback_customer_id ..................... [[32mPASS[0m in 3.45s]
[0m15:33:04.921762 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m15:33:04.922135 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m15:33:04.922625 [info ] [Thread-4 (]: 132 of 262 START test not_null_fct_customer_feedback_feedback_id ............... [RUN]
[0m15:33:04.923085 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3, now test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca)
[0m15:33:04.923445 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m15:33:04.927237 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m15:33:04.927820 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m15:33:04.929974 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m15:33:04.930598 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m15:33:04.930966 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: BEGIN
[0m15:33:04.931274 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:06.892101 [debug] [Thread-3 (]: SQL status: BEGIN in 2.301 seconds
[0m15:33:06.892590 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m15:33:06.892960 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_date
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_date is null



  
  
      
    ) dbt_internal_test
[0m15:33:07.140758 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.247 seconds
[0m15:33:07.142562 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: ROLLBACK
[0m15:33:07.287742 [debug] [Thread-2 (]: SQL status: BEGIN in 2.678 seconds
[0m15:33:07.288525 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m15:33:07.288929 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_day
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_day is null



  
  
      
    ) dbt_internal_test
[0m15:33:07.393270 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: Close
[0m15:33:07.394200 [info ] [Thread-3 (]: 130 of 262 PASS not_null_fct_customer_feedback_feedback_date ................... [[32mPASS[0m in 2.81s]
[0m15:33:07.394828 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m15:33:07.395415 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m15:33:07.395971 [info ] [Thread-3 (]: 133 of 262 START test not_null_fct_customer_feedback_feedback_month ............ [RUN]
[0m15:33:07.396436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41, now test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87)
[0m15:33:07.396803 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m15:33:07.400593 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m15:33:07.401133 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m15:33:07.402979 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m15:33:07.403514 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m15:33:07.403821 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: BEGIN
[0m15:33:07.404167 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:07.585489 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.296 seconds
[0m15:33:07.586017 [debug] [Thread-4 (]: SQL status: BEGIN in 2.655 seconds
[0m15:33:07.587628 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: ROLLBACK
[0m15:33:07.588039 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m15:33:07.588484 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:07.842312 [debug] [Thread-1 (]: SQL status: BEGIN in 3.401 seconds
[0m15:33:07.842878 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m15:33:07.843317 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "postgres"."silver_to_golden"."fct_customer_feedback"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:07.868971 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: Close
[0m15:33:07.869816 [info ] [Thread-2 (]: 131 of 262 PASS not_null_fct_customer_feedback_feedback_day .................... [[32mPASS[0m in 3.27s]
[0m15:33:07.870445 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m15:33:07.870833 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.282 seconds
[0m15:33:07.871259 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m15:33:07.872635 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: ROLLBACK
[0m15:33:07.873079 [info ] [Thread-2 (]: 134 of 262 START test not_null_fct_customer_feedback_feedback_year ............. [RUN]
[0m15:33:07.873681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83, now test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577)
[0m15:33:07.874107 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m15:33:07.877715 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m15:33:07.878260 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m15:33:07.880259 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m15:33:07.880815 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m15:33:07.881123 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: BEGIN
[0m15:33:07.881460 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:08.091319 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.247 seconds
[0m15:33:08.092777 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: ROLLBACK
[0m15:33:08.154172 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: Close
[0m15:33:08.155064 [info ] [Thread-4 (]: 132 of 262 PASS not_null_fct_customer_feedback_feedback_id ..................... [[32mPASS[0m in 3.23s]
[0m15:33:08.155708 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m15:33:08.156153 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m15:33:08.156624 [info ] [Thread-4 (]: 135 of 262 START test not_null_fct_customer_feedback_product_id ................ [RUN]
[0m15:33:08.157141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca, now test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d)
[0m15:33:08.157515 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m15:33:08.161020 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m15:33:08.161653 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m15:33:08.232801 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m15:33:08.233460 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m15:33:08.233821 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: BEGIN
[0m15:33:08.234123 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:08.342144 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: Close
[0m15:33:08.343142 [info ] [Thread-1 (]: 129 of 262 PASS not_null_fct_customer_feedback_customer_name ................... [[32mPASS[0m in 3.91s]
[0m15:33:08.343732 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m15:33:08.344203 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m15:33:08.344683 [info ] [Thread-1 (]: 136 of 262 START test not_null_fct_customer_feedback_product_name .............. [RUN]
[0m15:33:08.345188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63, now test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1)
[0m15:33:08.345559 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m15:33:08.349302 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m15:33:08.349865 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m15:33:08.351843 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m15:33:08.352402 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m15:33:08.352767 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: BEGIN
[0m15:33:08.353104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:10.211948 [debug] [Thread-2 (]: SQL status: BEGIN in 2.330 seconds
[0m15:33:10.212505 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m15:33:10.213006 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_year
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_year is null



  
  
      
    ) dbt_internal_test
[0m15:33:10.481655 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.268 seconds
[0m15:33:10.483351 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: ROLLBACK
[0m15:33:10.762142 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: Close
[0m15:33:10.763078 [debug] [Thread-1 (]: SQL status: BEGIN in 2.410 seconds
[0m15:33:10.763796 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m15:33:10.765433 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_customer_feedback"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:10.764860 [info ] [Thread-2 (]: 134 of 262 PASS not_null_fct_customer_feedback_feedback_year ................... [[32mPASS[0m in 2.89s]
[0m15:33:10.766744 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m15:33:10.767478 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m15:33:10.768181 [info ] [Thread-2 (]: 137 of 262 START test not_null_fct_customer_feedback_rating .................... [RUN]
[0m15:33:10.768899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577, now test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d)
[0m15:33:10.769481 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m15:33:10.774557 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m15:33:10.775122 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m15:33:10.777254 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m15:33:10.777867 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m15:33:10.778210 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: BEGIN
[0m15:33:10.778562 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:11.360956 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.595 seconds
[0m15:33:11.361750 [debug] [Thread-4 (]: SQL status: BEGIN in 3.128 seconds
[0m15:33:11.363530 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: ROLLBACK
[0m15:33:11.364088 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m15:33:11.364661 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:11.697388 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: Close
[0m15:33:11.699040 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.334 seconds
[0m15:33:11.700369 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: ROLLBACK
[0m15:33:11.698583 [info ] [Thread-1 (]: 136 of 262 PASS not_null_fct_customer_feedback_product_name .................... [[32mPASS[0m in 3.35s]
[0m15:33:11.701186 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m15:33:11.701735 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m15:33:11.702244 [info ] [Thread-1 (]: 138 of 262 START test not_null_fct_customer_feedback_store_id .................. [RUN]
[0m15:33:11.702794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1, now test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee)
[0m15:33:11.703192 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m15:33:11.707386 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m15:33:11.708046 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m15:33:11.710214 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m15:33:11.710839 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m15:33:11.711185 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: BEGIN
[0m15:33:11.711503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:11.988183 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: Close
[0m15:33:11.989174 [info ] [Thread-4 (]: 135 of 262 PASS not_null_fct_customer_feedback_product_id ...................... [[32mPASS[0m in 3.83s]
[0m15:33:11.989851 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m15:33:11.990263 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m15:33:11.990720 [info ] [Thread-4 (]: 139 of 262 START test not_null_fct_customer_feedback_store_name ................ [RUN]
[0m15:33:11.991157 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d, now test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8)
[0m15:33:11.991546 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m15:33:11.996073 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m15:33:11.996639 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m15:33:11.998704 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m15:33:11.999254 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m15:33:11.999607 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: BEGIN
[0m15:33:11.999917 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:12.459213 [debug] [Thread-3 (]: SQL status: BEGIN in 5.055 seconds
[0m15:33:12.459765 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m15:33:12.460175 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_month
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_month is null



  
  
      
    ) dbt_internal_test
[0m15:33:12.769894 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.309 seconds
[0m15:33:12.771675 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: ROLLBACK
[0m15:33:13.018197 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: Close
[0m15:33:13.019217 [info ] [Thread-3 (]: 133 of 262 PASS not_null_fct_customer_feedback_feedback_month .................. [[32mPASS[0m in 5.62s]
[0m15:33:13.019864 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m15:33:13.020300 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m15:33:13.020763 [info ] [Thread-3 (]: 140 of 262 START test not_null_fct_inventory_inventory_id ...................... [RUN]
[0m15:33:13.021284 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87, now test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab)
[0m15:33:13.021673 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m15:33:13.025282 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m15:33:13.025887 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m15:33:13.028023 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m15:33:13.028657 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m15:33:13.029024 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: BEGIN
[0m15:33:13.029366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:14.560534 [debug] [Thread-1 (]: SQL status: BEGIN in 2.849 seconds
[0m15:33:14.561096 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m15:33:14.561681 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:14.816747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.255 seconds
[0m15:33:14.818128 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: ROLLBACK
[0m15:33:15.104281 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: Close
[0m15:33:15.105249 [info ] [Thread-1 (]: 138 of 262 PASS not_null_fct_customer_feedback_store_id ........................ [[32mPASS[0m in 3.40s]
[0m15:33:15.105964 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m15:33:15.106382 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m15:33:15.106836 [info ] [Thread-1 (]: 141 of 262 START test not_null_fct_inventory_last_updated ...................... [RUN]
[0m15:33:15.107309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee, now test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9)
[0m15:33:15.107678 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m15:33:15.111475 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m15:33:15.112017 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m15:33:15.114053 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m15:33:15.114599 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m15:33:15.114920 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: BEGIN
[0m15:33:15.115292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:15.880156 [debug] [Thread-2 (]: SQL status: BEGIN in 5.101 seconds
[0m15:33:15.880703 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m15:33:15.881225 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from "postgres"."silver_to_golden"."fct_customer_feedback"
where rating is null



  
  
      
    ) dbt_internal_test
[0m15:33:16.164316 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.283 seconds
[0m15:33:16.165773 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: ROLLBACK
[0m15:33:16.453763 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: Close
[0m15:33:16.454737 [info ] [Thread-2 (]: 137 of 262 PASS not_null_fct_customer_feedback_rating .......................... [[32mPASS[0m in 5.69s]
[0m15:33:16.455308 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m15:33:16.455733 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m15:33:16.456208 [info ] [Thread-2 (]: 142 of 262 START test not_null_fct_inventory_last_updated_day .................. [RUN]
[0m15:33:16.456758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d, now test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d)
[0m15:33:16.457222 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m15:33:16.460859 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m15:33:16.461514 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m15:33:16.463513 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m15:33:16.464065 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m15:33:16.464377 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: BEGIN
[0m15:33:16.465823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:16.616114 [debug] [Thread-4 (]: SQL status: BEGIN in 4.616 seconds
[0m15:33:16.616627 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m15:33:16.616972 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_customer_feedback"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:16.696888 [debug] [Thread-3 (]: SQL status: BEGIN in 3.667 seconds
[0m15:33:16.697324 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m15:33:16.697780 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select inventory_id
from "postgres"."silver_to_golden"."fct_inventory"
where inventory_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:16.958336 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.341 seconds
[0m15:33:16.959768 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: ROLLBACK
[0m15:33:17.099712 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.401 seconds
[0m15:33:17.101168 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: ROLLBACK
[0m15:33:17.323855 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: Close
[0m15:33:17.324702 [info ] [Thread-4 (]: 139 of 262 PASS not_null_fct_customer_feedback_store_name ...................... [[32mPASS[0m in 5.33s]
[0m15:33:17.325253 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m15:33:17.325710 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m15:33:17.326182 [info ] [Thread-4 (]: 143 of 262 START test not_null_fct_inventory_last_updated_month ................ [RUN]
[0m15:33:17.326638 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8, now test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc)
[0m15:33:17.326984 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m15:33:17.330922 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m15:33:17.331464 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m15:33:17.333737 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m15:33:17.334247 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m15:33:17.334598 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: BEGIN
[0m15:33:17.334950 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:17.387611 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: Close
[0m15:33:17.388470 [info ] [Thread-3 (]: 140 of 262 PASS not_null_fct_inventory_inventory_id ............................ [[32mPASS[0m in 4.37s]
[0m15:33:17.389041 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m15:33:17.389458 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m15:33:17.389986 [info ] [Thread-3 (]: 144 of 262 START test not_null_fct_inventory_last_updated_year ................. [RUN]
[0m15:33:17.390511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab, now test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65)
[0m15:33:17.390937 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m15:33:17.394392 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m15:33:17.394985 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m15:33:17.397507 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m15:33:17.398124 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m15:33:17.398460 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: BEGIN
[0m15:33:17.398783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:18.416434 [debug] [Thread-1 (]: SQL status: BEGIN in 3.301 seconds
[0m15:33:18.416989 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m15:33:18.417364 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated is null



  
  
      
    ) dbt_internal_test
[0m15:33:18.702867 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.285 seconds
[0m15:33:18.704381 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: ROLLBACK
[0m15:33:18.982024 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: Close
[0m15:33:18.983060 [info ] [Thread-1 (]: 141 of 262 PASS not_null_fct_inventory_last_updated ............................ [[32mPASS[0m in 3.88s]
[0m15:33:18.983874 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m15:33:18.984390 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m15:33:18.984929 [info ] [Thread-1 (]: 145 of 262 START test not_null_fct_inventory_product_id ........................ [RUN]
[0m15:33:18.985492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9, now test.retail_dbt.not_null_fct_inventory_product_id.55271876bd)
[0m15:33:18.985991 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m15:33:18.989590 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m15:33:18.990273 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m15:33:18.992236 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m15:33:18.992788 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m15:33:18.993141 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: BEGIN
[0m15:33:18.993441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:20.287298 [debug] [Thread-2 (]: SQL status: BEGIN in 3.821 seconds
[0m15:33:20.287784 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m15:33:20.288125 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated_day
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated_day is null



  
  
      
    ) dbt_internal_test
[0m15:33:20.423791 [debug] [Thread-4 (]: SQL status: BEGIN in 3.089 seconds
[0m15:33:20.424507 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m15:33:20.424891 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated_month
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated_month is null



  
  
      
    ) dbt_internal_test
[0m15:33:20.603321 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.315 seconds
[0m15:33:20.604962 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: ROLLBACK
[0m15:33:20.846382 [debug] [Thread-3 (]: SQL status: BEGIN in 3.447 seconds
[0m15:33:20.847057 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m15:33:20.847666 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated_year
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated_year is null



  
  
      
    ) dbt_internal_test
[0m15:33:20.922314 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: Close
[0m15:33:20.923211 [info ] [Thread-2 (]: 142 of 262 PASS not_null_fct_inventory_last_updated_day ........................ [[32mPASS[0m in 4.47s]
[0m15:33:20.923782 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m15:33:20.924189 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m15:33:20.924611 [info ] [Thread-2 (]: 146 of 262 START test not_null_fct_inventory_product_name ...................... [RUN]
[0m15:33:20.925049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d, now test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6)
[0m15:33:20.925414 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m15:33:20.928910 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m15:33:20.929455 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m15:33:20.932467 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m15:33:20.933008 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m15:33:20.933362 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: BEGIN
[0m15:33:20.933730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:21.125673 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.277 seconds
[0m15:33:21.127223 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: ROLLBACK
[0m15:33:21.406275 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: Close
[0m15:33:21.407212 [info ] [Thread-3 (]: 144 of 262 PASS not_null_fct_inventory_last_updated_year ....................... [[32mPASS[0m in 4.02s]
[0m15:33:21.407778 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m15:33:21.408189 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m15:33:21.408624 [info ] [Thread-3 (]: 147 of 262 START test not_null_fct_inventory_quantity .......................... [RUN]
[0m15:33:21.409066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65, now test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b)
[0m15:33:21.409400 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m15:33:21.412911 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m15:33:21.413434 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m15:33:21.415408 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m15:33:21.415950 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m15:33:21.416265 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: BEGIN
[0m15:33:21.416601 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:21.939221 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.514 seconds
[0m15:33:21.940976 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: ROLLBACK
[0m15:33:22.239588 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: Close
[0m15:33:22.240552 [info ] [Thread-4 (]: 143 of 262 PASS not_null_fct_inventory_last_updated_month ...................... [[32mPASS[0m in 4.91s]
[0m15:33:22.241122 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m15:33:22.241546 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m15:33:22.242036 [info ] [Thread-4 (]: 148 of 262 START test not_null_fct_inventory_store_id .......................... [RUN]
[0m15:33:22.242498 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc, now test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718)
[0m15:33:22.242831 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m15:33:22.246679 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m15:33:22.247233 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m15:33:22.249697 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m15:33:22.250291 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m15:33:22.250787 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: BEGIN
[0m15:33:22.251120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:23.051254 [debug] [Thread-1 (]: SQL status: BEGIN in 4.058 seconds
[0m15:33:23.051789 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m15:33:23.052123 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_inventory"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:23.417740 [debug] [Thread-2 (]: SQL status: BEGIN in 2.484 seconds
[0m15:33:23.418219 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m15:33:23.418556 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_inventory"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:23.691808 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.273 seconds
[0m15:33:23.693543 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: ROLLBACK
[0m15:33:23.748242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.695 seconds
[0m15:33:23.749493 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: ROLLBACK
[0m15:33:23.958987 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: Close
[0m15:33:23.959954 [info ] [Thread-2 (]: 146 of 262 PASS not_null_fct_inventory_product_name ............................ [[32mPASS[0m in 3.03s]
[0m15:33:23.960555 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m15:33:23.960969 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m15:33:23.961396 [info ] [Thread-2 (]: 149 of 262 START test not_null_fct_inventory_store_name ........................ [RUN]
[0m15:33:23.961871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6, now test.retail_dbt.not_null_fct_inventory_store_name.36742932e5)
[0m15:33:23.962209 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m15:33:23.966158 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m15:33:23.966749 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m15:33:23.968772 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m15:33:23.969311 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m15:33:23.969863 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: BEGIN
[0m15:33:23.970168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:24.055346 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: Close
[0m15:33:24.056199 [info ] [Thread-1 (]: 145 of 262 PASS not_null_fct_inventory_product_id .............................. [[32mPASS[0m in 5.07s]
[0m15:33:24.056753 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m15:33:24.057153 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m15:33:24.057574 [info ] [Thread-1 (]: 150 of 262 START test not_null_fct_pricing_history_effective_date .............. [RUN]
[0m15:33:24.058089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_product_id.55271876bd, now test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a)
[0m15:33:24.058442 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m15:33:24.063083 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m15:33:24.063717 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m15:33:24.065971 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m15:33:24.066558 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m15:33:24.066925 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: BEGIN
[0m15:33:24.067271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:24.631389 [debug] [Thread-3 (]: SQL status: BEGIN in 3.215 seconds
[0m15:33:24.631874 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m15:33:24.632233 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver_to_golden"."fct_inventory"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m15:33:24.746052 [debug] [Thread-4 (]: SQL status: BEGIN in 2.495 seconds
[0m15:33:24.746556 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m15:33:24.747166 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_inventory"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:24.956878 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.324 seconds
[0m15:33:24.958471 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: ROLLBACK
[0m15:33:25.009001 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.261 seconds
[0m15:33:25.010636 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: ROLLBACK
[0m15:33:25.264459 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: Close
[0m15:33:25.265324 [info ] [Thread-3 (]: 147 of 262 PASS not_null_fct_inventory_quantity ................................ [[32mPASS[0m in 3.86s]
[0m15:33:25.266068 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m15:33:25.266520 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m15:33:25.267039 [info ] [Thread-3 (]: 151 of 262 START test not_null_fct_pricing_history_effective_month ............. [RUN]
[0m15:33:25.267571 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b, now test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff)
[0m15:33:25.268000 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m15:33:25.271584 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m15:33:25.272134 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m15:33:25.274000 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m15:33:25.274528 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m15:33:25.274873 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: BEGIN
[0m15:33:25.275172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:25.390786 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: Close
[0m15:33:25.391742 [info ] [Thread-4 (]: 148 of 262 PASS not_null_fct_inventory_store_id ................................ [[32mPASS[0m in 3.15s]
[0m15:33:25.392306 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m15:33:25.392702 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m15:33:25.393147 [info ] [Thread-4 (]: 152 of 262 START test not_null_fct_pricing_history_effective_year .............. [RUN]
[0m15:33:25.393600 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718, now test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8)
[0m15:33:25.393970 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m15:33:25.397364 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m15:33:25.397918 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m15:33:25.399810 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m15:33:25.400387 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m15:33:25.400732 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: BEGIN
[0m15:33:25.401086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:26.664475 [debug] [Thread-1 (]: SQL status: BEGIN in 2.597 seconds
[0m15:33:26.665001 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m15:33:26.665488 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "postgres"."silver_to_golden"."fct_pricing_history"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m15:33:26.944331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.278 seconds
[0m15:33:26.946075 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: ROLLBACK
[0m15:33:27.171536 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: Close
[0m15:33:27.172690 [info ] [Thread-1 (]: 150 of 262 PASS not_null_fct_pricing_history_effective_date .................... [[32mPASS[0m in 3.11s]
[0m15:33:27.173366 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m15:33:27.174089 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m15:33:27.174698 [info ] [Thread-1 (]: 153 of 262 START test not_null_fct_pricing_history_history_id .................. [RUN]
[0m15:33:27.175231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a, now test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc)
[0m15:33:27.175598 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m15:33:27.179167 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m15:33:27.179712 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m15:33:27.183265 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m15:33:27.183820 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m15:33:27.184192 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: BEGIN
[0m15:33:27.184506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:28.016300 [debug] [Thread-4 (]: SQL status: BEGIN in 2.667 seconds
[0m15:33:28.016786 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m15:33:28.017332 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_year
from "postgres"."silver_to_golden"."fct_pricing_history"
where effective_year is null



  
  
      
    ) dbt_internal_test
[0m15:33:28.059391 [debug] [Thread-3 (]: SQL status: BEGIN in 2.836 seconds
[0m15:33:28.059919 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m15:33:28.060338 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_month
from "postgres"."silver_to_golden"."fct_pricing_history"
where effective_month is null



  
  
      
    ) dbt_internal_test
[0m15:33:28.288358 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.271 seconds
[0m15:33:28.289716 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: ROLLBACK
[0m15:33:28.370451 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.310 seconds
[0m15:33:28.371826 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: ROLLBACK
[0m15:33:28.573665 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: Close
[0m15:33:28.574680 [info ] [Thread-4 (]: 152 of 262 PASS not_null_fct_pricing_history_effective_year .................... [[32mPASS[0m in 3.18s]
[0m15:33:28.575252 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m15:33:28.575675 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m15:33:28.576099 [info ] [Thread-4 (]: 154 of 262 START test not_null_fct_pricing_history_price ....................... [RUN]
[0m15:33:28.576543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8, now test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b)
[0m15:33:28.576862 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m15:33:28.580440 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m15:33:28.580976 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m15:33:28.582854 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m15:33:28.583390 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m15:33:28.583703 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: BEGIN
[0m15:33:28.584057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:28.611493 [debug] [Thread-2 (]: SQL status: BEGIN in 4.693 seconds
[0m15:33:28.612002 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m15:33:28.612324 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_inventory"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:28.671497 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: Close
[0m15:33:28.672292 [info ] [Thread-3 (]: 151 of 262 PASS not_null_fct_pricing_history_effective_month ................... [[32mPASS[0m in 3.40s]
[0m15:33:28.672863 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m15:33:28.673276 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m15:33:28.673694 [info ] [Thread-3 (]: 155 of 262 START test not_null_fct_pricing_history_product_id .................. [RUN]
[0m15:33:28.674142 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff, now test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865)
[0m15:33:28.674467 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m15:33:28.677911 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m15:33:28.678489 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m15:33:28.680313 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m15:33:28.680865 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m15:33:28.681192 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: BEGIN
[0m15:33:28.681548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:28.881296 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.269 seconds
[0m15:33:28.882848 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: ROLLBACK
[0m15:33:29.157149 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: Close
[0m15:33:29.158152 [info ] [Thread-2 (]: 149 of 262 PASS not_null_fct_inventory_store_name .............................. [[32mPASS[0m in 5.20s]
[0m15:33:29.158817 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m15:33:29.159277 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m15:33:29.159725 [info ] [Thread-2 (]: 156 of 262 START test not_null_fct_pricing_history_product_name ................ [RUN]
[0m15:33:29.160162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_store_name.36742932e5, now test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6)
[0m15:33:29.160520 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m15:33:29.163914 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m15:33:29.164440 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m15:33:29.166325 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m15:33:29.166859 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m15:33:29.167171 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: BEGIN
[0m15:33:29.167504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:30.874063 [debug] [Thread-1 (]: SQL status: BEGIN in 3.689 seconds
[0m15:33:30.874543 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m15:33:30.874880 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select history_id
from "postgres"."silver_to_golden"."fct_pricing_history"
where history_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:31.177529 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.302 seconds
[0m15:33:31.178998 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: ROLLBACK
[0m15:33:31.278383 [debug] [Thread-3 (]: SQL status: BEGIN in 2.597 seconds
[0m15:33:31.278908 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m15:33:31.279249 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_pricing_history"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:31.482208 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: Close
[0m15:33:31.483170 [info ] [Thread-1 (]: 153 of 262 PASS not_null_fct_pricing_history_history_id ........................ [[32mPASS[0m in 4.31s]
[0m15:33:31.483732 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m15:33:31.484136 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m15:33:31.484603 [info ] [Thread-1 (]: 157 of 262 START test not_null_fct_purchase_orders_order_date .................. [RUN]
[0m15:33:31.485053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc, now test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960)
[0m15:33:31.485420 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m15:33:31.490138 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m15:33:31.490718 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m15:33:31.492604 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m15:33:31.493164 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m15:33:31.493475 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: BEGIN
[0m15:33:31.493800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:31.588745 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.309 seconds
[0m15:33:31.590369 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: ROLLBACK
[0m15:33:31.896531 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: Close
[0m15:33:31.897667 [info ] [Thread-3 (]: 155 of 262 PASS not_null_fct_pricing_history_product_id ........................ [[32mPASS[0m in 3.22s]
[0m15:33:31.898572 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m15:33:31.899020 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m15:33:31.899474 [info ] [Thread-3 (]: 158 of 262 START test not_null_fct_purchase_orders_order_day ................... [RUN]
[0m15:33:31.900044 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865, now test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa)
[0m15:33:31.900494 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m15:33:31.904107 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m15:33:31.904654 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m15:33:31.906633 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m15:33:31.907182 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m15:33:31.907492 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: BEGIN
[0m15:33:31.907859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:31.962526 [debug] [Thread-4 (]: SQL status: BEGIN in 3.378 seconds
[0m15:33:31.963024 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m15:33:31.963403 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "postgres"."silver_to_golden"."fct_pricing_history"
where price is null



  
  
      
    ) dbt_internal_test
[0m15:33:32.248429 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.285 seconds
[0m15:33:32.250279 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: ROLLBACK
[0m15:33:32.855674 [debug] [Thread-2 (]: SQL status: BEGIN in 3.688 seconds
[0m15:33:32.856162 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m15:33:32.856539 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_pricing_history"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:32.953208 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: Close
[0m15:33:32.954231 [info ] [Thread-4 (]: 154 of 262 PASS not_null_fct_pricing_history_price ............................. [[32mPASS[0m in 4.38s]
[0m15:33:32.954891 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m15:33:32.955320 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m15:33:32.955775 [info ] [Thread-4 (]: 159 of 262 START test not_null_fct_purchase_orders_order_id .................... [RUN]
[0m15:33:32.956260 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b, now test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa)
[0m15:33:32.956584 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m15:33:32.960066 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m15:33:32.960613 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m15:33:32.962572 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m15:33:32.963135 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m15:33:32.963443 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: BEGIN
[0m15:33:32.963775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:33.134221 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.277 seconds
[0m15:33:33.135845 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: ROLLBACK
[0m15:33:33.415541 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: Close
[0m15:33:33.416456 [info ] [Thread-2 (]: 156 of 262 PASS not_null_fct_pricing_history_product_name ...................... [[32mPASS[0m in 4.26s]
[0m15:33:33.417020 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m15:33:33.417439 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m15:33:33.417850 [info ] [Thread-2 (]: 160 of 262 START test not_null_fct_purchase_orders_order_month ................. [RUN]
[0m15:33:33.418486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6, now test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e)
[0m15:33:33.418916 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m15:33:33.422493 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m15:33:33.423219 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m15:33:33.425078 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m15:33:33.425614 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m15:33:33.425925 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: BEGIN
[0m15:33:33.426307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:34.139996 [debug] [Thread-3 (]: SQL status: BEGIN in 2.232 seconds
[0m15:33:34.140477 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m15:33:34.140808 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m15:33:34.213119 [debug] [Thread-1 (]: SQL status: BEGIN in 2.719 seconds
[0m15:33:34.213603 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m15:33:34.213932 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m15:33:34.378538 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.237 seconds
[0m15:33:34.380110 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: ROLLBACK
[0m15:33:34.490194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.276 seconds
[0m15:33:34.491561 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: ROLLBACK
[0m15:33:34.614206 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: Close
[0m15:33:34.615178 [info ] [Thread-3 (]: 158 of 262 PASS not_null_fct_purchase_orders_order_day ......................... [[32mPASS[0m in 2.72s]
[0m15:33:34.615809 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m15:33:34.616180 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m15:33:34.616659 [info ] [Thread-3 (]: 161 of 262 START test not_null_fct_purchase_orders_order_year .................. [RUN]
[0m15:33:34.617119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa, now test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640)
[0m15:33:34.617488 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m15:33:34.623293 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m15:33:34.623980 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m15:33:34.626156 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m15:33:34.626757 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m15:33:34.627108 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: BEGIN
[0m15:33:34.627413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:34.758860 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: Close
[0m15:33:34.759975 [info ] [Thread-1 (]: 157 of 262 PASS not_null_fct_purchase_orders_order_date ........................ [[32mPASS[0m in 3.27s]
[0m15:33:34.760696 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m15:33:34.761173 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m15:33:34.761724 [info ] [Thread-1 (]: 162 of 262 START test not_null_fct_purchase_orders_status ...................... [RUN]
[0m15:33:34.762458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960, now test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636)
[0m15:33:34.762905 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m15:33:34.767532 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m15:33:34.768164 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m15:33:34.770430 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m15:33:34.771024 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m15:33:34.771414 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: BEGIN
[0m15:33:34.771793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:35.350378 [debug] [Thread-4 (]: SQL status: BEGIN in 2.386 seconds
[0m15:33:35.350867 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m15:33:35.351199 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:35.618693 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.267 seconds
[0m15:33:35.620376 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: ROLLBACK
[0m15:33:35.891374 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: Close
[0m15:33:35.892509 [info ] [Thread-4 (]: 159 of 262 PASS not_null_fct_purchase_orders_order_id .......................... [[32mPASS[0m in 2.94s]
[0m15:33:35.893117 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m15:33:35.893525 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m15:33:35.893926 [info ] [Thread-4 (]: 163 of 262 START test not_null_fct_purchase_orders_supplier_id ................. [RUN]
[0m15:33:35.894399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa, now test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb)
[0m15:33:35.894778 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m15:33:35.898127 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m15:33:35.898674 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m15:33:35.900753 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m15:33:35.901332 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m15:33:35.901682 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: BEGIN
[0m15:33:35.901992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:36.365732 [debug] [Thread-2 (]: SQL status: BEGIN in 2.939 seconds
[0m15:33:36.366293 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m15:33:36.366686 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_month
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_month is null



  
  
      
    ) dbt_internal_test
[0m15:33:36.675222 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.308 seconds
[0m15:33:36.676944 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: ROLLBACK
[0m15:33:36.974878 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: Close
[0m15:33:36.975734 [info ] [Thread-2 (]: 160 of 262 PASS not_null_fct_purchase_orders_order_month ....................... [[32mPASS[0m in 3.56s]
[0m15:33:36.976323 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m15:33:36.976764 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m15:33:36.977209 [info ] [Thread-2 (]: 164 of 262 START test not_null_fct_purchase_orders_supplier_name ............... [RUN]
[0m15:33:36.977674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e, now test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e)
[0m15:33:36.978085 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m15:33:36.981704 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m15:33:36.982342 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m15:33:36.985785 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m15:33:36.986367 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m15:33:36.986717 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: BEGIN
[0m15:33:36.987017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:37.134868 [debug] [Thread-3 (]: SQL status: BEGIN in 2.507 seconds
[0m15:33:37.135468 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m15:33:37.135831 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_year
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_year is null



  
  
      
    ) dbt_internal_test
[0m15:33:37.413223 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.277 seconds
[0m15:33:37.414660 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: ROLLBACK
[0m15:33:37.689041 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: Close
[0m15:33:37.690088 [info ] [Thread-3 (]: 161 of 262 PASS not_null_fct_purchase_orders_order_year ........................ [[32mPASS[0m in 3.07s]
[0m15:33:37.690696 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m15:33:37.691125 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m15:33:37.691575 [info ] [Thread-3 (]: 165 of 262 START test not_null_fct_returns_customer_id ......................... [RUN]
[0m15:33:37.692035 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640, now test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5)
[0m15:33:37.692428 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m15:33:37.696150 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m15:33:37.696733 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m15:33:37.698719 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m15:33:37.699260 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m15:33:37.699621 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: BEGIN
[0m15:33:37.699947 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:38.390102 [debug] [Thread-4 (]: SQL status: BEGIN in 2.488 seconds
[0m15:33:38.390581 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m15:33:38.390920 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."fct_purchase_orders"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:38.448203 [debug] [Thread-1 (]: SQL status: BEGIN in 3.676 seconds
[0m15:33:38.448724 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m15:33:38.449233 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "postgres"."silver_to_golden"."fct_purchase_orders"
where status is null



  
  
      
    ) dbt_internal_test
[0m15:33:38.660682 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.269 seconds
[0m15:33:38.662102 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: ROLLBACK
[0m15:33:38.747562 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.298 seconds
[0m15:33:38.748915 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: ROLLBACK
[0m15:33:38.922510 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: Close
[0m15:33:38.923620 [info ] [Thread-4 (]: 163 of 262 PASS not_null_fct_purchase_orders_supplier_id ....................... [[32mPASS[0m in 3.03s]
[0m15:33:38.924271 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m15:33:38.924655 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m15:33:38.925148 [info ] [Thread-4 (]: 166 of 262 START test not_null_fct_returns_item_id ............................. [RUN]
[0m15:33:38.925627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb, now test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9)
[0m15:33:38.926018 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m15:33:38.929406 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m15:33:38.929988 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m15:33:38.931921 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m15:33:38.932435 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m15:33:38.932773 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: BEGIN
[0m15:33:38.933076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:39.013113 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: Close
[0m15:33:39.014027 [info ] [Thread-1 (]: 162 of 262 PASS not_null_fct_purchase_orders_status ............................ [[32mPASS[0m in 4.25s]
[0m15:33:39.014599 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m15:33:39.015010 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m15:33:39.015456 [info ] [Thread-1 (]: 167 of 262 START test not_null_fct_returns_product_id .......................... [RUN]
[0m15:33:39.015892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636, now test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8)
[0m15:33:39.016219 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m15:33:39.019825 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m15:33:39.020385 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m15:33:39.022249 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m15:33:39.022775 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m15:33:39.023084 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: BEGIN
[0m15:33:39.023425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:39.436417 [debug] [Thread-2 (]: SQL status: BEGIN in 2.449 seconds
[0m15:33:39.436962 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m15:33:39.437339 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_name
from "postgres"."silver_to_golden"."fct_purchase_orders"
where supplier_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:39.678087 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.240 seconds
[0m15:33:39.679476 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: ROLLBACK
[0m15:33:39.918485 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: Close
[0m15:33:39.919391 [info ] [Thread-2 (]: 164 of 262 PASS not_null_fct_purchase_orders_supplier_name ..................... [[32mPASS[0m in 2.94s]
[0m15:33:39.920032 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m15:33:39.920448 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m15:33:39.920898 [info ] [Thread-2 (]: 168 of 262 START test not_null_fct_returns_product_name ........................ [RUN]
[0m15:33:39.921386 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e, now test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c)
[0m15:33:39.921724 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m15:33:39.926955 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m15:33:39.927737 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m15:33:39.929800 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m15:33:39.930364 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m15:33:39.930680 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: BEGIN
[0m15:33:39.931034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:40.165015 [debug] [Thread-3 (]: SQL status: BEGIN in 2.465 seconds
[0m15:33:40.165593 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m15:33:40.166110 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_returns"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:40.420088 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.253 seconds
[0m15:33:40.421783 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: ROLLBACK
[0m15:33:41.212856 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: Close
[0m15:33:41.213747 [info ] [Thread-3 (]: 165 of 262 PASS not_null_fct_returns_customer_id ............................... [[32mPASS[0m in 3.52s]
[0m15:33:41.214337 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m15:33:41.214739 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m15:33:41.215164 [info ] [Thread-3 (]: 169 of 262 START test not_null_fct_returns_reason .............................. [RUN]
[0m15:33:41.215633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5, now test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf)
[0m15:33:41.215980 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m15:33:41.219693 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m15:33:41.220239 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m15:33:41.222223 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m15:33:41.222773 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m15:33:41.223095 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: BEGIN
[0m15:33:41.223452 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:41.320086 [debug] [Thread-4 (]: SQL status: BEGIN in 2.387 seconds
[0m15:33:41.320580 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m15:33:41.320967 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "postgres"."silver_to_golden"."fct_returns"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:41.574752 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.253 seconds
[0m15:33:41.576164 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: ROLLBACK
[0m15:33:41.828072 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: Close
[0m15:33:41.828927 [info ] [Thread-4 (]: 166 of 262 PASS not_null_fct_returns_item_id ................................... [[32mPASS[0m in 2.90s]
[0m15:33:41.829490 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m15:33:41.829894 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m15:33:41.830492 [info ] [Thread-4 (]: 170 of 262 START test not_null_fct_returns_return_date ......................... [RUN]
[0m15:33:41.830956 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9, now test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2)
[0m15:33:41.831340 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m15:33:41.835938 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m15:33:41.836876 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m15:33:41.839739 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m15:33:41.840599 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m15:33:41.841053 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: BEGIN
[0m15:33:41.841609 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:41.842708 [debug] [Thread-1 (]: SQL status: BEGIN in 2.819 seconds
[0m15:33:41.843156 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m15:33:41.843621 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_returns"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:42.107769 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.264 seconds
[0m15:33:42.109473 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: ROLLBACK
[0m15:33:42.164621 [debug] [Thread-2 (]: SQL status: BEGIN in 2.234 seconds
[0m15:33:42.165202 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m15:33:42.165628 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_returns"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:42.382171 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: Close
[0m15:33:42.383158 [info ] [Thread-1 (]: 167 of 262 PASS not_null_fct_returns_product_id ................................ [[32mPASS[0m in 3.37s]
[0m15:33:42.383894 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m15:33:42.384285 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m15:33:42.384802 [info ] [Thread-1 (]: 171 of 262 START test not_null_fct_returns_return_day .......................... [RUN]
[0m15:33:42.385401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8, now test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e)
[0m15:33:42.385844 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m15:33:42.389663 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m15:33:42.390363 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m15:33:42.393514 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m15:33:42.394299 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m15:33:42.394661 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: BEGIN
[0m15:33:42.395059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:42.429621 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.263 seconds
[0m15:33:42.433135 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: ROLLBACK
[0m15:33:42.687603 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: Close
[0m15:33:42.688692 [info ] [Thread-2 (]: 168 of 262 PASS not_null_fct_returns_product_name .............................. [[32mPASS[0m in 2.77s]
[0m15:33:42.689450 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m15:33:42.689946 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m15:33:42.690520 [info ] [Thread-2 (]: 172 of 262 START test not_null_fct_returns_return_id ........................... [RUN]
[0m15:33:42.691073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c, now test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0)
[0m15:33:42.691514 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m15:33:42.696590 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m15:33:42.697374 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m15:33:42.700848 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m15:33:42.701752 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m15:33:42.702316 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: BEGIN
[0m15:33:42.702851 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:43.496147 [debug] [Thread-3 (]: SQL status: BEGIN in 2.273 seconds
[0m15:33:43.496720 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m15:33:43.497206 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reason
from "postgres"."silver_to_golden"."fct_returns"
where reason is null



  
  
      
    ) dbt_internal_test
[0m15:33:43.745904 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.248 seconds
[0m15:33:43.747504 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: ROLLBACK
[0m15:33:43.998307 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: Close
[0m15:33:43.999407 [info ] [Thread-3 (]: 169 of 262 PASS not_null_fct_returns_reason .................................... [[32mPASS[0m in 2.78s]
[0m15:33:44.000235 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m15:33:44.000792 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m15:33:44.001379 [info ] [Thread-3 (]: 173 of 262 START test not_null_fct_returns_return_month ........................ [RUN]
[0m15:33:44.001866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf, now test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54)
[0m15:33:44.002250 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m15:33:44.005813 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m15:33:44.006392 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m15:33:44.008303 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m15:33:44.008871 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m15:33:44.009220 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: BEGIN
[0m15:33:44.009521 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:44.487988 [debug] [Thread-4 (]: SQL status: BEGIN in 2.646 seconds
[0m15:33:44.488536 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m15:33:44.488964 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_date
from "postgres"."silver_to_golden"."fct_returns"
where return_date is null



  
  
      
    ) dbt_internal_test
[0m15:33:44.772389 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.283 seconds
[0m15:33:44.774039 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: ROLLBACK
[0m15:33:44.852896 [debug] [Thread-1 (]: SQL status: BEGIN in 2.458 seconds
[0m15:33:44.853495 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m15:33:44.853988 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_day
from "postgres"."silver_to_golden"."fct_returns"
where return_day is null



  
  
      
    ) dbt_internal_test
[0m15:33:45.062666 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: Close
[0m15:33:45.063718 [info ] [Thread-4 (]: 170 of 262 PASS not_null_fct_returns_return_date ............................... [[32mPASS[0m in 3.23s]
[0m15:33:45.064450 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m15:33:45.064979 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m15:33:45.065546 [info ] [Thread-4 (]: 174 of 262 START test not_null_fct_returns_return_year ......................... [RUN]
[0m15:33:45.066077 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2, now test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8)
[0m15:33:45.066448 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m15:33:45.070456 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m15:33:45.071042 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m15:33:45.073116 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m15:33:45.073693 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m15:33:45.074084 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: BEGIN
[0m15:33:45.074410 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:45.126628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.272 seconds
[0m15:33:45.128219 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: ROLLBACK
[0m15:33:45.359507 [debug] [Thread-2 (]: SQL status: BEGIN in 2.657 seconds
[0m15:33:45.360094 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m15:33:45.360577 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_id
from "postgres"."silver_to_golden"."fct_returns"
where return_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:45.403961 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: Close
[0m15:33:45.405173 [info ] [Thread-1 (]: 171 of 262 PASS not_null_fct_returns_return_day ................................ [[32mPASS[0m in 3.02s]
[0m15:33:45.406124 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m15:33:45.406639 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m15:33:45.407144 [info ] [Thread-1 (]: 175 of 262 START test not_null_fct_returns_returned_quantity ................... [RUN]
[0m15:33:45.407636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e, now test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150)
[0m15:33:45.408004 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m15:33:45.411802 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m15:33:45.412387 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m15:33:45.415676 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m15:33:45.416233 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m15:33:45.416572 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: BEGIN
[0m15:33:45.416880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:45.649480 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.288 seconds
[0m15:33:45.651244 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: ROLLBACK
[0m15:33:45.943635 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: Close
[0m15:33:45.944669 [info ] [Thread-2 (]: 172 of 262 PASS not_null_fct_returns_return_id ................................. [[32mPASS[0m in 3.25s]
[0m15:33:45.945368 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m15:33:45.945782 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m15:33:45.946269 [info ] [Thread-2 (]: 176 of 262 START test not_null_fct_returns_store_name .......................... [RUN]
[0m15:33:45.946742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0, now test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0)
[0m15:33:45.947103 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m15:33:45.950852 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m15:33:45.951490 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m15:33:45.953874 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m15:33:45.954709 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m15:33:45.955275 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: BEGIN
[0m15:33:45.955587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:47.468546 [debug] [Thread-4 (]: SQL status: BEGIN in 2.394 seconds
[0m15:33:47.469241 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m15:33:47.469619 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_year
from "postgres"."silver_to_golden"."fct_returns"
where return_year is null



  
  
      
    ) dbt_internal_test
[0m15:33:47.667447 [debug] [Thread-3 (]: SQL status: BEGIN in 3.658 seconds
[0m15:33:47.667926 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m15:33:47.668265 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_month
from "postgres"."silver_to_golden"."fct_returns"
where return_month is null



  
  
      
    ) dbt_internal_test
[0m15:33:47.725051 [debug] [Thread-1 (]: SQL status: BEGIN in 2.308 seconds
[0m15:33:47.725537 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m15:33:47.725883 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.256 seconds
[0m15:33:47.726318 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select returned_quantity
from "postgres"."silver_to_golden"."fct_returns"
where returned_quantity is null



  
  
      
    ) dbt_internal_test
[0m15:33:47.727951 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: ROLLBACK
[0m15:33:47.953579 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.285 seconds
[0m15:33:47.955025 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: ROLLBACK
[0m15:33:47.975457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.247 seconds
[0m15:33:47.976666 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: ROLLBACK
[0m15:33:47.982867 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: Close
[0m15:33:47.983705 [info ] [Thread-4 (]: 174 of 262 PASS not_null_fct_returns_return_year ............................... [[32mPASS[0m in 2.92s]
[0m15:33:47.984293 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m15:33:47.984764 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m15:33:47.985185 [info ] [Thread-4 (]: 177 of 262 START test not_null_fct_sales_items_business_validation_flag ........ [RUN]
[0m15:33:47.985624 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8, now test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6)
[0m15:33:47.986012 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m15:33:47.989449 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m15:33:47.990014 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m15:33:47.992215 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m15:33:47.992759 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m15:33:47.993106 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: BEGIN
[0m15:33:47.993408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:48.224973 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: Close
[0m15:33:48.226011 [info ] [Thread-1 (]: 175 of 262 PASS not_null_fct_returns_returned_quantity ......................... [[32mPASS[0m in 2.82s]
[0m15:33:48.226646 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m15:33:48.227157 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m15:33:48.227595 [info ] [Thread-1 (]: 178 of 262 START test not_null_fct_sales_items_category_name ................... [RUN]
[0m15:33:48.228037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150, now test.retail_dbt.not_null_fct_sales_items_category_name.3951967161)
[0m15:33:48.228388 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m15:33:48.231885 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m15:33:48.232494 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m15:33:48.234530 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m15:33:48.235098 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m15:33:48.235453 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: BEGIN
[0m15:33:48.235793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:48.251137 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: Close
[0m15:33:48.251935 [info ] [Thread-3 (]: 173 of 262 PASS not_null_fct_returns_return_month .............................. [[32mPASS[0m in 4.25s]
[0m15:33:48.252493 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m15:33:48.252892 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m15:33:48.253351 [info ] [Thread-3 (]: 179 of 262 START test not_null_fct_sales_items_customer_id ..................... [RUN]
[0m15:33:48.253906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54, now test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d)
[0m15:33:48.254269 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m15:33:48.258645 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m15:33:48.259205 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m15:33:48.334209 [debug] [Thread-2 (]: SQL status: BEGIN in 2.379 seconds
[0m15:33:48.336162 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m15:33:48.336551 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m15:33:48.337169 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_returns"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:48.337694 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m15:33:48.338158 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: BEGIN
[0m15:33:48.338613 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:48.592882 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.255 seconds
[0m15:33:48.594584 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: ROLLBACK
[0m15:33:48.841671 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: Close
[0m15:33:48.842677 [info ] [Thread-2 (]: 176 of 262 PASS not_null_fct_returns_store_name ................................ [[32mPASS[0m in 2.90s]
[0m15:33:48.843217 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m15:33:48.843614 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m15:33:48.844060 [info ] [Thread-2 (]: 180 of 262 START test not_null_fct_sales_items_discount ........................ [RUN]
[0m15:33:48.844470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0, now test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6)
[0m15:33:48.844824 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m15:33:48.848245 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m15:33:48.848772 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m15:33:48.850639 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m15:33:48.851213 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m15:33:48.851525 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: BEGIN
[0m15:33:48.851837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:50.548200 [debug] [Thread-4 (]: SQL status: BEGIN in 2.555 seconds
[0m15:33:50.548702 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m15:33:50.549069 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business_validation_flag
from "postgres"."silver_to_golden"."fct_sales_items"
where business_validation_flag is null



  
  
      
    ) dbt_internal_test
[0m15:33:50.837669 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.288 seconds
[0m15:33:50.839476 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: ROLLBACK
[0m15:33:50.914782 [debug] [Thread-1 (]: SQL status: BEGIN in 2.679 seconds
[0m15:33:50.915254 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m15:33:50.915627 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_name
from "postgres"."silver_to_golden"."fct_sales_items"
where category_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:51.122236 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: Close
[0m15:33:51.123263 [info ] [Thread-4 (]: 177 of 262 PASS not_null_fct_sales_items_business_validation_flag .............. [[32mPASS[0m in 3.14s]
[0m15:33:51.123899 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m15:33:51.124299 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m15:33:51.124861 [info ] [Thread-4 (]: 181 of 262 START test not_null_fct_sales_items_gross_amount .................... [RUN]
[0m15:33:51.125584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6, now test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261)
[0m15:33:51.126169 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m15:33:51.131742 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m15:33:51.132671 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m15:33:51.135968 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m15:33:51.136841 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m15:33:51.137359 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: BEGIN
[0m15:33:51.137798 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:51.177803 [debug] [Thread-3 (]: SQL status: BEGIN in 2.839 seconds
[0m15:33:51.178308 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m15:33:51.178685 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_sales_items"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:51.229893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.314 seconds
[0m15:33:51.231294 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: ROLLBACK
[0m15:33:51.263705 [debug] [Thread-2 (]: SQL status: BEGIN in 2.412 seconds
[0m15:33:51.264170 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m15:33:51.264506 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select discount
from "postgres"."silver_to_golden"."fct_sales_items"
where discount is null



  
  
      
    ) dbt_internal_test
[0m15:33:51.439677 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.261 seconds
[0m15:33:51.441370 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: ROLLBACK
[0m15:33:51.517553 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.252 seconds
[0m15:33:51.519243 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: ROLLBACK
[0m15:33:51.537906 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: Close
[0m15:33:51.538886 [info ] [Thread-1 (]: 178 of 262 PASS not_null_fct_sales_items_category_name ......................... [[32mPASS[0m in 3.31s]
[0m15:33:51.539526 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m15:33:51.539942 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m15:33:51.540366 [info ] [Thread-1 (]: 182 of 262 START test not_null_fct_sales_items_item_id ......................... [RUN]
[0m15:33:51.540802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_category_name.3951967161, now test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674)
[0m15:33:51.541125 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m15:33:51.544868 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m15:33:51.545662 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m15:33:51.547914 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m15:33:51.548432 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m15:33:51.548775 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: BEGIN
[0m15:33:51.549069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:51.686787 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: Close
[0m15:33:51.687755 [info ] [Thread-3 (]: 179 of 262 PASS not_null_fct_sales_items_customer_id ........................... [[32mPASS[0m in 3.43s]
[0m15:33:51.688363 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m15:33:51.688779 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m15:33:51.689190 [info ] [Thread-3 (]: 183 of 262 START test not_null_fct_sales_items_net_amount ...................... [RUN]
[0m15:33:51.689628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d, now test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c)
[0m15:33:51.690050 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m15:33:51.694772 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m15:33:51.695326 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m15:33:51.697176 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m15:33:51.697705 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m15:33:51.698073 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: BEGIN
[0m15:33:51.698397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:51.764279 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: Close
[0m15:33:51.765109 [info ] [Thread-2 (]: 180 of 262 PASS not_null_fct_sales_items_discount .............................. [[32mPASS[0m in 2.92s]
[0m15:33:51.765703 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m15:33:51.766192 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m15:33:51.766611 [info ] [Thread-2 (]: 184 of 262 START test not_null_fct_sales_items_product_id ...................... [RUN]
[0m15:33:51.767066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6, now test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6)
[0m15:33:51.767386 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m15:33:51.770884 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m15:33:51.771419 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m15:33:51.773390 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m15:33:51.773946 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m15:33:51.774278 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: BEGIN
[0m15:33:51.774619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:53.695554 [debug] [Thread-4 (]: SQL status: BEGIN in 2.558 seconds
[0m15:33:53.696069 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m15:33:53.696457 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gross_amount
from "postgres"."silver_to_golden"."fct_sales_items"
where gross_amount is null



  
  
      
    ) dbt_internal_test
[0m15:33:53.986478 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.290 seconds
[0m15:33:53.988046 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: ROLLBACK
[0m15:33:54.029347 [debug] [Thread-2 (]: SQL status: BEGIN in 2.255 seconds
[0m15:33:54.029839 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m15:33:54.030466 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_sales_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:54.174305 [debug] [Thread-3 (]: SQL status: BEGIN in 2.476 seconds
[0m15:33:54.174847 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m15:33:54.175219 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select net_amount
from "postgres"."silver_to_golden"."fct_sales_items"
where net_amount is null



  
  
      
    ) dbt_internal_test
[0m15:33:54.272877 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: Close
[0m15:33:54.273781 [info ] [Thread-4 (]: 181 of 262 PASS not_null_fct_sales_items_gross_amount .......................... [[32mPASS[0m in 3.15s]
[0m15:33:54.274362 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m15:33:54.274776 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m15:33:54.275224 [info ] [Thread-4 (]: 185 of 262 START test not_null_fct_sales_items_product_name .................... [RUN]
[0m15:33:54.275676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261, now test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1)
[0m15:33:54.276002 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m15:33:54.279549 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m15:33:54.280259 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m15:33:54.282386 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m15:33:54.282944 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m15:33:54.283370 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: BEGIN
[0m15:33:54.283850 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:54.284346 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.253 seconds
[0m15:33:54.285848 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: ROLLBACK
[0m15:33:54.455206 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.279 seconds
[0m15:33:54.456828 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: ROLLBACK
[0m15:33:54.530398 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: Close
[0m15:33:54.531352 [info ] [Thread-2 (]: 184 of 262 PASS not_null_fct_sales_items_product_id ............................ [[32mPASS[0m in 2.76s]
[0m15:33:54.532006 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m15:33:54.532476 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m15:33:54.532927 [info ] [Thread-2 (]: 186 of 262 START test not_null_fct_sales_items_quantity ........................ [RUN]
[0m15:33:54.533368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6, now test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f)
[0m15:33:54.533740 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m15:33:54.537805 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m15:33:54.538391 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m15:33:54.541801 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m15:33:54.542364 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m15:33:54.542681 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: BEGIN
[0m15:33:54.542980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:54.732310 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: Close
[0m15:33:54.733324 [info ] [Thread-3 (]: 183 of 262 PASS not_null_fct_sales_items_net_amount ............................ [[32mPASS[0m in 3.04s]
[0m15:33:54.734212 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m15:33:54.734777 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m15:33:54.735296 [info ] [Thread-3 (]: 187 of 262 START test not_null_fct_sales_items_store_name ...................... [RUN]
[0m15:33:54.735872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c, now test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422)
[0m15:33:54.736323 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m15:33:54.740416 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m15:33:54.741043 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m15:33:54.743162 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m15:33:54.743719 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m15:33:54.744083 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: BEGIN
[0m15:33:54.744488 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:33:55.589883 [debug] [Thread-1 (]: SQL status: BEGIN in 4.041 seconds
[0m15:33:55.590405 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m15:33:55.590740 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "postgres"."silver_to_golden"."fct_sales_items"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m15:33:55.898300 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.307 seconds
[0m15:33:55.899716 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: ROLLBACK
[0m15:33:56.599618 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: Close
[0m15:33:56.601230 [info ] [Thread-1 (]: 182 of 262 PASS not_null_fct_sales_items_item_id ............................... [[32mPASS[0m in 5.06s]
[0m15:33:56.602067 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m15:33:56.602620 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m15:33:56.603301 [info ] [Thread-1 (]: 188 of 262 START test not_null_fct_sales_items_tax ............................. [RUN]
[0m15:33:56.603875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674, now test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a)
[0m15:33:56.604325 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m15:33:56.608322 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m15:33:56.608884 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m15:33:56.611065 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m15:33:56.611625 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m15:33:56.611972 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: BEGIN
[0m15:33:56.612280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:56.749242 [debug] [Thread-4 (]: SQL status: BEGIN in 2.465 seconds
[0m15:33:56.749831 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m15:33:56.750396 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_sales_items"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:33:56.827299 [debug] [Thread-2 (]: SQL status: BEGIN in 2.284 seconds
[0m15:33:56.828046 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m15:33:56.828528 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver_to_golden"."fct_sales_items"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m15:33:56.929011 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.250 seconds
[0m15:33:56.930439 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: ROLLBACK
[0m15:33:57.006218 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.249 seconds
[0m15:33:57.007534 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: ROLLBACK
[0m15:33:57.173303 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: Close
[0m15:33:57.174477 [info ] [Thread-4 (]: 185 of 262 PASS not_null_fct_sales_items_product_name .......................... [[32mPASS[0m in 2.90s]
[0m15:33:57.175286 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m15:33:57.175783 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m15:33:57.176320 [info ] [Thread-4 (]: 189 of 262 START test not_null_fct_sales_items_transaction_id .................. [RUN]
[0m15:33:57.176897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1, now test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05)
[0m15:33:57.177373 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m15:33:57.181938 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m15:33:57.182704 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m15:33:57.184829 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m15:33:57.185560 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m15:33:57.185881 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: BEGIN
[0m15:33:57.186205 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:33:57.248443 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: Close
[0m15:33:57.249385 [info ] [Thread-2 (]: 186 of 262 PASS not_null_fct_sales_items_quantity .............................. [[32mPASS[0m in 2.72s]
[0m15:33:57.250216 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m15:33:57.250582 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m15:33:57.251006 [info ] [Thread-2 (]: 190 of 262 START test not_null_fct_sales_items_transaction_month ............... [RUN]
[0m15:33:57.251417 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f, now test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4)
[0m15:33:57.251768 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m15:33:57.257003 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m15:33:57.258064 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m15:33:57.260073 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m15:33:57.260609 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m15:33:57.260923 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: BEGIN
[0m15:33:57.261225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:59.253542 [debug] [Thread-1 (]: SQL status: BEGIN in 2.713 seconds
[0m15:33:59.254156 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m15:33:59.254601 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax
from "postgres"."silver_to_golden"."fct_sales_items"
where tax is null



  
  
      
    ) dbt_internal_test
[0m15:33:59.545407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.290 seconds
[0m15:33:59.547098 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: ROLLBACK
[0m15:33:59.830055 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: Close
[0m15:33:59.831137 [info ] [Thread-1 (]: 188 of 262 PASS not_null_fct_sales_items_tax ................................... [[32mPASS[0m in 3.23s]
[0m15:33:59.831826 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m15:33:59.832331 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m15:33:59.832823 [info ] [Thread-1 (]: 191 of 262 START test not_null_fct_sales_items_transaction_year ................ [RUN]
[0m15:33:59.833440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a, now test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5)
[0m15:33:59.833879 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m15:33:59.838254 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m15:33:59.838803 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m15:33:59.841018 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m15:33:59.841562 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m15:33:59.841914 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: BEGIN
[0m15:33:59.842259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:00.172044 [debug] [Thread-4 (]: SQL status: BEGIN in 2.986 seconds
[0m15:34:00.172584 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m15:34:00.173048 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "postgres"."silver_to_golden"."fct_sales_items"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:00.317889 [debug] [Thread-2 (]: SQL status: BEGIN in 3.056 seconds
[0m15:34:00.318722 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m15:34:00.319379 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_month
from "postgres"."silver_to_golden"."fct_sales_items"
where transaction_month is null



  
  
      
    ) dbt_internal_test
[0m15:34:00.477549 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.304 seconds
[0m15:34:00.479012 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: ROLLBACK
[0m15:34:00.655407 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.336 seconds
[0m15:34:00.656794 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: ROLLBACK
[0m15:34:00.753394 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: Close
[0m15:34:00.754313 [info ] [Thread-4 (]: 189 of 262 PASS not_null_fct_sales_items_transaction_id ........................ [[32mPASS[0m in 3.58s]
[0m15:34:00.754892 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m15:34:00.755298 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m15:34:00.755722 [info ] [Thread-4 (]: 192 of 262 START test not_null_fct_sales_items_unit_price ...................... [RUN]
[0m15:34:00.756163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05, now test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee)
[0m15:34:00.756493 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m15:34:00.760008 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m15:34:00.760534 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m15:34:00.762502 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m15:34:00.763038 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m15:34:00.763343 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: BEGIN
[0m15:34:00.763677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:00.968137 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: Close
[0m15:34:00.969000 [info ] [Thread-2 (]: 190 of 262 PASS not_null_fct_sales_items_transaction_month ..................... [[32mPASS[0m in 3.72s]
[0m15:34:00.969640 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m15:34:00.970295 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m15:34:00.970894 [info ] [Thread-2 (]: 193 of 262 START test not_null_fct_sales_transactions_customer_id .............. [RUN]
[0m15:34:00.971290 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4, now test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63)
[0m15:34:00.971649 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m15:34:00.975196 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m15:34:00.975727 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m15:34:00.977713 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m15:34:00.978275 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m15:34:00.978581 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: BEGIN
[0m15:34:00.979107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:01.971228 [debug] [Thread-3 (]: SQL status: BEGIN in 7.299 seconds
[0m15:34:01.971727 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m15:34:01.972062 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_sales_items"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:02.314651 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.342 seconds
[0m15:34:02.316094 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: ROLLBACK
[0m15:34:02.618766 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: Close
[0m15:34:02.619653 [info ] [Thread-3 (]: 187 of 262 PASS not_null_fct_sales_items_store_name ............................ [[32mPASS[0m in 7.88s]
[0m15:34:02.620256 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m15:34:02.620678 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m15:34:02.621132 [info ] [Thread-3 (]: 194 of 262 START test not_null_fct_sales_transactions_customer_name ............ [RUN]
[0m15:34:02.621612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422, now test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa)
[0m15:34:02.621948 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m15:34:02.626961 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m15:34:02.627509 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m15:34:02.629323 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m15:34:02.629867 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m15:34:02.630253 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: BEGIN
[0m15:34:02.630636 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:02.701043 [debug] [Thread-1 (]: SQL status: BEGIN in 2.859 seconds
[0m15:34:02.701617 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m15:34:02.702003 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_year
from "postgres"."silver_to_golden"."fct_sales_items"
where transaction_year is null



  
  
      
    ) dbt_internal_test
[0m15:34:02.997793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.295 seconds
[0m15:34:02.999405 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: ROLLBACK
[0m15:34:03.241066 [debug] [Thread-4 (]: SQL status: BEGIN in 2.477 seconds
[0m15:34:03.241558 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m15:34:03.241888 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from "postgres"."silver_to_golden"."fct_sales_items"
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m15:34:03.283005 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: Close
[0m15:34:03.284233 [info ] [Thread-1 (]: 191 of 262 PASS not_null_fct_sales_items_transaction_year ...................... [[32mPASS[0m in 3.45s]
[0m15:34:03.284963 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m15:34:03.285385 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m15:34:03.285840 [info ] [Thread-1 (]: 195 of 262 START test not_null_fct_sales_transactions_employee_id .............. [RUN]
[0m15:34:03.286327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5, now test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0)
[0m15:34:03.286651 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m15:34:03.290407 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m15:34:03.290992 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m15:34:03.293085 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m15:34:03.293697 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m15:34:03.294047 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: BEGIN
[0m15:34:03.294429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:03.476176 [debug] [Thread-2 (]: SQL status: BEGIN in 2.497 seconds
[0m15:34:03.476716 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m15:34:03.477066 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:03.538028 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.296 seconds
[0m15:34:03.539526 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: ROLLBACK
[0m15:34:03.761784 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.284 seconds
[0m15:34:03.763252 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: ROLLBACK
[0m15:34:03.812439 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: Close
[0m15:34:03.813363 [info ] [Thread-4 (]: 192 of 262 PASS not_null_fct_sales_items_unit_price ............................ [[32mPASS[0m in 3.06s]
[0m15:34:03.813936 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m15:34:03.814375 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m15:34:03.814827 [info ] [Thread-4 (]: 196 of 262 START test not_null_fct_sales_transactions_employee_name ............ [RUN]
[0m15:34:03.815288 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee, now test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a)
[0m15:34:03.815613 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m15:34:03.819225 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m15:34:03.819790 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m15:34:03.821787 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m15:34:03.822343 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m15:34:03.822658 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: BEGIN
[0m15:34:03.822999 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:04.037132 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: Close
[0m15:34:04.038145 [info ] [Thread-2 (]: 193 of 262 PASS not_null_fct_sales_transactions_customer_id .................... [[32mPASS[0m in 3.07s]
[0m15:34:04.038737 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m15:34:04.039161 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m15:34:04.039586 [info ] [Thread-2 (]: 197 of 262 START test not_null_fct_sales_transactions_payment_id ............... [RUN]
[0m15:34:04.040027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63, now test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8)
[0m15:34:04.040349 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m15:34:04.043916 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m15:34:04.044522 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m15:34:04.047936 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m15:34:04.048489 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m15:34:04.048805 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: BEGIN
[0m15:34:04.049103 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:05.230167 [debug] [Thread-3 (]: SQL status: BEGIN in 2.599 seconds
[0m15:34:05.230650 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m15:34:05.230986 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "postgres"."silver_to_golden"."fct_sales_transactions"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:05.522565 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.291 seconds
[0m15:34:05.523916 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: ROLLBACK
[0m15:34:05.525696 [debug] [Thread-1 (]: SQL status: BEGIN in 2.231 seconds
[0m15:34:05.526190 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m15:34:05.526670 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:05.783065 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.256 seconds
[0m15:34:05.784559 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: ROLLBACK
[0m15:34:05.812568 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: Close
[0m15:34:05.813380 [info ] [Thread-3 (]: 194 of 262 PASS not_null_fct_sales_transactions_customer_name .................. [[32mPASS[0m in 3.19s]
[0m15:34:05.813981 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m15:34:05.814458 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m15:34:05.814899 [info ] [Thread-3 (]: 198 of 262 START test not_null_fct_sales_transactions_payment_method ........... [RUN]
[0m15:34:05.815351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa, now test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5)
[0m15:34:05.815674 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m15:34:05.819256 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m15:34:05.819820 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m15:34:05.821897 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m15:34:05.822475 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m15:34:05.822914 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: BEGIN
[0m15:34:05.823242 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:06.060088 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: Close
[0m15:34:06.061197 [info ] [Thread-1 (]: 195 of 262 PASS not_null_fct_sales_transactions_employee_id .................... [[32mPASS[0m in 2.77s]
[0m15:34:06.061815 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m15:34:06.062290 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m15:34:06.062736 [info ] [Thread-1 (]: 199 of 262 START test not_null_fct_sales_transactions_store_id ................. [RUN]
[0m15:34:06.063185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0, now test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb)
[0m15:34:06.063549 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m15:34:06.067308 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m15:34:06.067844 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m15:34:06.069744 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m15:34:06.070272 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m15:34:06.070631 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: BEGIN
[0m15:34:06.070959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:06.603596 [debug] [Thread-4 (]: SQL status: BEGIN in 2.780 seconds
[0m15:34:06.604194 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m15:34:06.604589 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_name
from "postgres"."silver_to_golden"."fct_sales_transactions"
where employee_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:06.888962 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.284 seconds
[0m15:34:06.891574 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: ROLLBACK
[0m15:34:07.166790 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: Close
[0m15:34:07.167801 [info ] [Thread-4 (]: 196 of 262 PASS not_null_fct_sales_transactions_employee_name .................. [[32mPASS[0m in 3.35s]
[0m15:34:07.168400 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m15:34:07.168794 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m15:34:07.169317 [info ] [Thread-4 (]: 200 of 262 START test not_null_fct_sales_transactions_store_name ............... [RUN]
[0m15:34:07.169935 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a, now test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b)
[0m15:34:07.170370 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m15:34:07.174072 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m15:34:07.174630 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m15:34:07.176638 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m15:34:07.177173 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m15:34:07.177549 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: BEGIN
[0m15:34:07.177900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:07.291274 [debug] [Thread-2 (]: SQL status: BEGIN in 3.242 seconds
[0m15:34:07.291765 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m15:34:07.292125 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:07.566109 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.273 seconds
[0m15:34:07.567662 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: ROLLBACK
[0m15:34:07.834506 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: Close
[0m15:34:07.835401 [info ] [Thread-2 (]: 197 of 262 PASS not_null_fct_sales_transactions_payment_id ..................... [[32mPASS[0m in 3.80s]
[0m15:34:07.836100 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m15:34:07.836517 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m15:34:07.837026 [info ] [Thread-2 (]: 201 of 262 START test not_null_fct_sales_transactions_total_amount ............. [RUN]
[0m15:34:07.837486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8, now test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b)
[0m15:34:07.837847 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m15:34:07.842981 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m15:34:07.843802 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m15:34:07.845774 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m15:34:07.846320 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m15:34:07.846641 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: BEGIN
[0m15:34:07.846942 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:09.266053 [debug] [Thread-1 (]: SQL status: BEGIN in 3.195 seconds
[0m15:34:09.266580 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m15:34:09.266926 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:09.550398 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.283 seconds
[0m15:34:09.552548 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: ROLLBACK
[0m15:34:09.552981 [debug] [Thread-3 (]: SQL status: BEGIN in 3.730 seconds
[0m15:34:09.553397 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m15:34:09.553807 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_method
from "postgres"."silver_to_golden"."fct_sales_transactions"
where payment_method is null



  
  
      
    ) dbt_internal_test
[0m15:34:09.569077 [debug] [Thread-4 (]: SQL status: BEGIN in 2.391 seconds
[0m15:34:09.569691 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m15:34:09.570165 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_sales_transactions"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:09.803045 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: Close
[0m15:34:09.803931 [info ] [Thread-1 (]: 199 of 262 PASS not_null_fct_sales_transactions_store_id ....................... [[32mPASS[0m in 3.74s]
[0m15:34:09.804508 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m15:34:09.804938 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m15:34:09.805472 [info ] [Thread-1 (]: 202 of 262 START test not_null_fct_sales_transactions_transaction_date ......... [RUN]
[0m15:34:09.805994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb, now test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61)
[0m15:34:09.806399 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m15:34:09.810033 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m15:34:09.810628 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m15:34:09.812581 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m15:34:09.813114 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m15:34:09.813460 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: BEGIN
[0m15:34:09.813817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:09.838226 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.268 seconds
[0m15:34:09.839561 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: ROLLBACK
[0m15:34:09.842731 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.288 seconds
[0m15:34:09.843960 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: ROLLBACK
[0m15:34:10.106196 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: Close
[0m15:34:10.107104 [info ] [Thread-4 (]: 200 of 262 PASS not_null_fct_sales_transactions_store_name ..................... [[32mPASS[0m in 2.94s]
[0m15:34:10.107687 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m15:34:10.108102 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m15:34:10.108553 [info ] [Thread-4 (]: 203 of 262 START test not_null_fct_sales_transactions_transaction_day .......... [RUN]
[0m15:34:10.109017 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b, now test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86)
[0m15:34:10.109348 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m15:34:10.112899 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m15:34:10.113469 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m15:34:10.115536 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m15:34:10.116075 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m15:34:10.116390 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: BEGIN
[0m15:34:10.116732 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:10.126981 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: Close
[0m15:34:10.127875 [info ] [Thread-3 (]: 198 of 262 PASS not_null_fct_sales_transactions_payment_method ................. [[32mPASS[0m in 4.31s]
[0m15:34:10.128589 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m15:34:10.129093 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m15:34:10.129640 [info ] [Thread-3 (]: 204 of 262 START test not_null_fct_sales_transactions_transaction_id ........... [RUN]
[0m15:34:10.130201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5, now test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d)
[0m15:34:10.130610 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m15:34:10.133992 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m15:34:10.134568 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m15:34:10.136417 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m15:34:10.136949 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m15:34:10.137302 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: BEGIN
[0m15:34:10.137634 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:10.491995 [debug] [Thread-2 (]: SQL status: BEGIN in 2.645 seconds
[0m15:34:10.492554 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m15:34:10.492893 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "postgres"."silver_to_golden"."fct_sales_transactions"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m15:34:10.759394 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.266 seconds
[0m15:34:10.761002 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: ROLLBACK
[0m15:34:11.014756 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: Close
[0m15:34:11.015686 [info ] [Thread-2 (]: 201 of 262 PASS not_null_fct_sales_transactions_total_amount ................... [[32mPASS[0m in 3.18s]
[0m15:34:11.016304 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m15:34:11.016720 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m15:34:11.017146 [info ] [Thread-2 (]: 205 of 262 START test not_null_fct_sales_transactions_transaction_month ........ [RUN]
[0m15:34:11.017599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b, now test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6)
[0m15:34:11.017922 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m15:34:11.021448 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m15:34:11.022041 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m15:34:11.024407 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m15:34:11.024976 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m15:34:11.025347 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: BEGIN
[0m15:34:11.025691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:12.020221 [debug] [Thread-1 (]: SQL status: BEGIN in 2.206 seconds
[0m15:34:12.020732 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m15:34:12.021119 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m15:34:12.266667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.245 seconds
[0m15:34:12.268070 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: ROLLBACK
[0m15:34:12.359044 [debug] [Thread-3 (]: SQL status: BEGIN in 2.221 seconds
[0m15:34:12.359635 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m15:34:12.360093 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:12.529181 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: Close
[0m15:34:12.530643 [info ] [Thread-1 (]: 202 of 262 PASS not_null_fct_sales_transactions_transaction_date ............... [[32mPASS[0m in 2.72s]
[0m15:34:12.531548 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m15:34:12.532181 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m15:34:12.532841 [info ] [Thread-1 (]: 206 of 262 START test not_null_fct_sales_transactions_transaction_year ......... [RUN]
[0m15:34:12.533471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61, now test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e)
[0m15:34:12.533857 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m15:34:12.540012 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m15:34:12.540949 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m15:34:12.543533 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m15:34:12.544106 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m15:34:12.544477 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: BEGIN
[0m15:34:12.544783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:12.649222 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.289 seconds
[0m15:34:12.650793 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: ROLLBACK
[0m15:34:12.836825 [debug] [Thread-4 (]: SQL status: BEGIN in 2.720 seconds
[0m15:34:12.837445 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m15:34:12.837941 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_day
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_day is null



  
  
      
    ) dbt_internal_test
[0m15:34:12.894276 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: Close
[0m15:34:12.895303 [info ] [Thread-3 (]: 204 of 262 PASS not_null_fct_sales_transactions_transaction_id ................. [[32mPASS[0m in 2.77s]
[0m15:34:12.896102 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m15:34:12.896608 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m15:34:12.897170 [info ] [Thread-3 (]: 207 of 262 START test not_null_fct_shipments_order_id .......................... [RUN]
[0m15:34:12.897744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d, now test.retail_dbt.not_null_fct_shipments_order_id.31824196fb)
[0m15:34:12.898235 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m15:34:12.902510 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m15:34:12.903069 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m15:34:12.905295 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m15:34:12.905893 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m15:34:12.906246 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: BEGIN
[0m15:34:12.906590 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:13.146335 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.308 seconds
[0m15:34:13.148048 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: ROLLBACK
[0m15:34:13.458841 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: Close
[0m15:34:13.459689 [info ] [Thread-4 (]: 203 of 262 PASS not_null_fct_sales_transactions_transaction_day ................ [[32mPASS[0m in 3.35s]
[0m15:34:13.460258 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m15:34:13.460679 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m15:34:13.461128 [info ] [Thread-4 (]: 208 of 262 START test not_null_fct_shipments_received_date ..................... [RUN]
[0m15:34:13.461590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86, now test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517)
[0m15:34:13.461925 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m15:34:13.465518 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m15:34:13.466115 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m15:34:13.469298 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m15:34:13.469819 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m15:34:13.470191 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: BEGIN
[0m15:34:13.470502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:13.791144 [debug] [Thread-2 (]: SQL status: BEGIN in 2.765 seconds
[0m15:34:13.791632 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m15:34:13.791971 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_month
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_month is null



  
  
      
    ) dbt_internal_test
[0m15:34:14.088937 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.296 seconds
[0m15:34:14.090364 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: ROLLBACK
[0m15:34:14.923594 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: Close
[0m15:34:14.924467 [info ] [Thread-2 (]: 205 of 262 PASS not_null_fct_sales_transactions_transaction_month .............. [[32mPASS[0m in 3.91s]
[0m15:34:14.925030 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m15:34:14.925429 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m15:34:14.925873 [info ] [Thread-2 (]: 209 of 262 START test not_null_fct_shipments_received_day ...................... [RUN]
[0m15:34:14.926352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6, now test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10)
[0m15:34:14.926703 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m15:34:14.930248 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m15:34:14.930806 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m15:34:14.932837 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m15:34:14.933416 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m15:34:14.933739 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: BEGIN
[0m15:34:14.934072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:15.201614 [debug] [Thread-3 (]: SQL status: BEGIN in 2.295 seconds
[0m15:34:15.202149 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m15:34:15.202659 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "postgres"."silver_to_golden"."fct_shipments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:15.546560 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.343 seconds
[0m15:34:15.548402 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: ROLLBACK
[0m15:34:15.820800 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: Close
[0m15:34:15.822223 [info ] [Thread-3 (]: 207 of 262 PASS not_null_fct_shipments_order_id ................................ [[32mPASS[0m in 2.92s]
[0m15:34:15.822977 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m15:34:15.823428 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m15:34:15.823862 [info ] [Thread-3 (]: 210 of 262 START test not_null_fct_shipments_received_month .................... [RUN]
[0m15:34:15.824328 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_order_id.31824196fb, now test.retail_dbt.not_null_fct_shipments_received_month.3a25060656)
[0m15:34:15.824663 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m15:34:15.828239 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m15:34:15.828756 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m15:34:15.830651 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m15:34:15.831339 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m15:34:15.831737 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: BEGIN
[0m15:34:15.832170 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:16.346173 [debug] [Thread-1 (]: SQL status: BEGIN in 3.801 seconds
[0m15:34:16.346745 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m15:34:16.347161 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_year
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_year is null



  
  
      
    ) dbt_internal_test
[0m15:34:16.619160 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.272 seconds
[0m15:34:16.620560 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: ROLLBACK
[0m15:34:16.801611 [debug] [Thread-4 (]: SQL status: BEGIN in 3.331 seconds
[0m15:34:16.802215 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m15:34:16.802704 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_date
from "postgres"."silver_to_golden"."fct_shipments"
where received_date is null



  
  
      
    ) dbt_internal_test
[0m15:34:16.885489 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: Close
[0m15:34:16.886538 [info ] [Thread-1 (]: 206 of 262 PASS not_null_fct_sales_transactions_transaction_year ............... [[32mPASS[0m in 4.35s]
[0m15:34:16.887326 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m15:34:16.887779 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m15:34:16.888199 [info ] [Thread-1 (]: 211 of 262 START test not_null_fct_shipments_received_year ..................... [RUN]
[0m15:34:16.888638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e, now test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f)
[0m15:34:16.888999 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m15:34:16.892741 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m15:34:16.893317 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m15:34:16.895523 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m15:34:16.896098 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m15:34:16.896470 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: BEGIN
[0m15:34:16.896779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:17.083401 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.280 seconds
[0m15:34:17.085145 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: ROLLBACK
[0m15:34:17.322812 [debug] [Thread-2 (]: SQL status: BEGIN in 2.389 seconds
[0m15:34:17.323358 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m15:34:17.323751 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_day
from "postgres"."silver_to_golden"."fct_shipments"
where received_day is null



  
  
      
    ) dbt_internal_test
[0m15:34:17.356468 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: Close
[0m15:34:17.357474 [info ] [Thread-4 (]: 208 of 262 PASS not_null_fct_shipments_received_date ........................... [[32mPASS[0m in 3.90s]
[0m15:34:17.358297 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m15:34:17.358799 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m15:34:17.359338 [info ] [Thread-4 (]: 212 of 262 START test not_null_fct_shipments_shipment_duration_days ............ [RUN]
[0m15:34:17.359877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517, now test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0)
[0m15:34:17.360301 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m15:34:17.365796 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m15:34:17.366396 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m15:34:17.368377 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m15:34:17.368910 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m15:34:17.369232 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: BEGIN
[0m15:34:17.369559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:17.572326 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.248 seconds
[0m15:34:17.574022 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: ROLLBACK
[0m15:34:17.815522 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: Close
[0m15:34:17.816832 [info ] [Thread-2 (]: 209 of 262 PASS not_null_fct_shipments_received_day ............................ [[32mPASS[0m in 2.89s]
[0m15:34:17.817609 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m15:34:17.818169 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m15:34:17.818754 [info ] [Thread-2 (]: 213 of 262 START test not_null_fct_shipments_shipment_id ....................... [RUN]
[0m15:34:17.819299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10, now test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b)
[0m15:34:17.819673 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m15:34:17.824765 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m15:34:17.825545 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m15:34:17.828180 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m15:34:17.828865 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m15:34:17.829320 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: BEGIN
[0m15:34:17.829766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:18.146482 [debug] [Thread-3 (]: SQL status: BEGIN in 2.314 seconds
[0m15:34:18.147025 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m15:34:18.147408 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_month
from "postgres"."silver_to_golden"."fct_shipments"
where received_month is null



  
  
      
    ) dbt_internal_test
[0m15:34:18.401333 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.253 seconds
[0m15:34:18.402799 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: ROLLBACK
[0m15:34:18.653224 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: Close
[0m15:34:18.654198 [info ] [Thread-3 (]: 210 of 262 PASS not_null_fct_shipments_received_month .......................... [[32mPASS[0m in 2.83s]
[0m15:34:18.654785 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m15:34:18.655206 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m15:34:18.655692 [info ] [Thread-3 (]: 214 of 262 START test not_null_fct_shipments_shipped_date ...................... [RUN]
[0m15:34:18.656157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_month.3a25060656, now test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a)
[0m15:34:18.656550 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m15:34:18.660102 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m15:34:18.660733 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m15:34:18.662942 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m15:34:18.663510 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m15:34:18.663826 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: BEGIN
[0m15:34:18.664163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:19.324218 [debug] [Thread-1 (]: SQL status: BEGIN in 2.427 seconds
[0m15:34:19.324718 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m15:34:19.325082 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_year
from "postgres"."silver_to_golden"."fct_shipments"
where received_year is null



  
  
      
    ) dbt_internal_test
[0m15:34:19.631562 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.306 seconds
[0m15:34:19.633019 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: ROLLBACK
[0m15:34:20.167359 [debug] [Thread-2 (]: SQL status: BEGIN in 2.338 seconds
[0m15:34:20.168005 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m15:34:20.168387 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipment_id
from "postgres"."silver_to_golden"."fct_shipments"
where shipment_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:20.299554 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: Close
[0m15:34:20.300422 [info ] [Thread-1 (]: 211 of 262 PASS not_null_fct_shipments_received_year ........................... [[32mPASS[0m in 3.41s]
[0m15:34:20.300988 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m15:34:20.301421 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m15:34:20.301889 [info ] [Thread-1 (]: 215 of 262 START test not_null_fct_shipments_shipped_day ....................... [RUN]
[0m15:34:20.302397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f, now test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843)
[0m15:34:20.302734 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m15:34:20.306223 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m15:34:20.306783 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m15:34:20.309771 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m15:34:20.310318 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m15:34:20.310719 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: BEGIN
[0m15:34:20.311080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:20.412957 [debug] [Thread-4 (]: SQL status: BEGIN in 3.043 seconds
[0m15:34:20.413609 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.245 seconds
[0m15:34:20.414039 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m15:34:20.415470 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: ROLLBACK
[0m15:34:20.415892 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipment_duration_days
from "postgres"."silver_to_golden"."fct_shipments"
where shipment_duration_days is null



  
  
      
    ) dbt_internal_test
[0m15:34:20.664559 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.248 seconds
[0m15:34:20.666219 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: ROLLBACK
[0m15:34:20.900264 [debug] [Thread-3 (]: SQL status: BEGIN in 2.236 seconds
[0m15:34:20.900787 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m15:34:20.901190 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_date
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_date is null



  
  
      
    ) dbt_internal_test
[0m15:34:20.916730 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: Close
[0m15:34:20.917516 [info ] [Thread-4 (]: 212 of 262 PASS not_null_fct_shipments_shipment_duration_days .................. [[32mPASS[0m in 3.56s]
[0m15:34:20.918197 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m15:34:20.918639 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m15:34:20.919139 [info ] [Thread-4 (]: 216 of 262 START test not_null_fct_shipments_shipped_month ..................... [RUN]
[0m15:34:20.919588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0, now test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc)
[0m15:34:20.919974 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m15:34:20.923455 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m15:34:20.924013 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m15:34:20.925977 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m15:34:20.926485 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m15:34:20.926847 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: BEGIN
[0m15:34:20.927157 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:21.168965 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.267 seconds
[0m15:34:21.169457 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: Close
[0m15:34:21.170907 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: ROLLBACK
[0m15:34:21.171691 [info ] [Thread-2 (]: 213 of 262 PASS not_null_fct_shipments_shipment_id ............................. [[32mPASS[0m in 3.35s]
[0m15:34:21.172254 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m15:34:21.172721 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m15:34:21.173379 [info ] [Thread-2 (]: 217 of 262 START test not_null_fct_shipments_shipped_year ...................... [RUN]
[0m15:34:21.173833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b, now test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5)
[0m15:34:21.174217 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m15:34:21.177656 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m15:34:21.178212 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m15:34:21.180064 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m15:34:21.180574 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m15:34:21.180882 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: BEGIN
[0m15:34:21.181224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:21.416726 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: Close
[0m15:34:21.417654 [info ] [Thread-3 (]: 214 of 262 PASS not_null_fct_shipments_shipped_date ............................ [[32mPASS[0m in 2.76s]
[0m15:34:21.418342 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m15:34:21.418789 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m15:34:21.419212 [info ] [Thread-3 (]: 218 of 262 START test not_null_fct_shipments_store_id .......................... [RUN]
[0m15:34:21.419641 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a, now test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1)
[0m15:34:21.420010 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m15:34:21.423860 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m15:34:21.424432 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m15:34:21.426371 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m15:34:21.426892 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m15:34:21.427251 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: BEGIN
[0m15:34:21.427584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:22.555084 [debug] [Thread-1 (]: SQL status: BEGIN in 2.244 seconds
[0m15:34:22.555563 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m15:34:22.555912 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_day
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_day is null



  
  
      
    ) dbt_internal_test
[0m15:34:22.804628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.248 seconds
[0m15:34:22.806070 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: ROLLBACK
[0m15:34:23.053779 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: Close
[0m15:34:23.054751 [info ] [Thread-1 (]: 215 of 262 PASS not_null_fct_shipments_shipped_day ............................. [[32mPASS[0m in 2.75s]
[0m15:34:23.055379 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m15:34:23.055816 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m15:34:23.056294 [info ] [Thread-1 (]: 219 of 262 START test not_null_fct_shipments_store_name ........................ [RUN]
[0m15:34:23.056751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843, now test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d)
[0m15:34:23.057118 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m15:34:23.060672 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m15:34:23.061256 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m15:34:23.064278 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m15:34:23.064802 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m15:34:23.065150 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: BEGIN
[0m15:34:23.065458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:23.493194 [debug] [Thread-4 (]: SQL status: BEGIN in 2.566 seconds
[0m15:34:23.493659 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m15:34:23.493992 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_month
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_month is null



  
  
      
    ) dbt_internal_test
[0m15:34:23.751920 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.257 seconds
[0m15:34:23.753679 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: ROLLBACK
[0m15:34:24.009401 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: Close
[0m15:34:24.010372 [info ] [Thread-4 (]: 216 of 262 PASS not_null_fct_shipments_shipped_month ........................... [[32mPASS[0m in 3.09s]
[0m15:34:24.011018 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m15:34:24.011494 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m15:34:24.011959 [info ] [Thread-4 (]: 220 of 262 START test not_null_fct_shipments_supplier_id ....................... [RUN]
[0m15:34:24.012447 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc, now test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca)
[0m15:34:24.012786 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m15:34:24.016667 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m15:34:24.017228 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m15:34:24.019186 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m15:34:24.019731 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m15:34:24.020075 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: BEGIN
[0m15:34:24.020418 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:24.079351 [debug] [Thread-3 (]: SQL status: BEGIN in 2.652 seconds
[0m15:34:24.079821 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m15:34:24.080153 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_shipments"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:24.253931 [debug] [Thread-2 (]: SQL status: BEGIN in 3.073 seconds
[0m15:34:24.254447 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m15:34:24.254776 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_year
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_year is null



  
  
      
    ) dbt_internal_test
[0m15:34:24.369259 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.289 seconds
[0m15:34:24.370818 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: ROLLBACK
[0m15:34:24.572259 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.317 seconds
[0m15:34:24.573717 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: ROLLBACK
[0m15:34:24.679362 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: Close
[0m15:34:24.680269 [info ] [Thread-3 (]: 218 of 262 PASS not_null_fct_shipments_store_id ................................ [[32mPASS[0m in 3.26s]
[0m15:34:24.680945 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m15:34:24.681587 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m15:34:24.682012 [info ] [Thread-3 (]: 221 of 262 START test not_null_fct_shipments_supplier_name ..................... [RUN]
[0m15:34:24.682769 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1, now test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f)
[0m15:34:24.683105 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m15:34:24.686612 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m15:34:24.687357 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m15:34:24.689248 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m15:34:24.689759 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m15:34:24.690123 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: BEGIN
[0m15:34:24.690430 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:24.918313 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: Close
[0m15:34:24.919359 [info ] [Thread-2 (]: 217 of 262 PASS not_null_fct_shipments_shipped_year ............................ [[32mPASS[0m in 3.75s]
[0m15:34:24.919955 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m15:34:24.920336 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m15:34:24.920800 [info ] [Thread-2 (]: 222 of 262 START test not_null_fct_stock_movements_movement_date ............... [RUN]
[0m15:34:24.921259 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5, now test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f)
[0m15:34:24.921634 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m15:34:24.925082 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m15:34:24.925651 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m15:34:24.927618 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m15:34:24.928149 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m15:34:24.928493 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: BEGIN
[0m15:34:24.928795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:25.727184 [debug] [Thread-1 (]: SQL status: BEGIN in 2.662 seconds
[0m15:34:25.727686 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m15:34:25.728086 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_shipments"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:26.014473 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.286 seconds
[0m15:34:26.015956 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: ROLLBACK
[0m15:34:26.297373 [debug] [Thread-4 (]: SQL status: BEGIN in 2.277 seconds
[0m15:34:26.298026 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: Close
[0m15:34:26.298498 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m15:34:26.299004 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."fct_shipments"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:26.299754 [info ] [Thread-1 (]: 219 of 262 PASS not_null_fct_shipments_store_name .............................. [[32mPASS[0m in 3.24s]
[0m15:34:26.300467 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m15:34:26.300918 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m15:34:26.301400 [info ] [Thread-1 (]: 223 of 262 START test not_null_fct_stock_movements_movement_id ................. [RUN]
[0m15:34:26.301982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d, now test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6)
[0m15:34:26.302450 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m15:34:26.375520 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m15:34:26.376184 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m15:34:26.378035 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m15:34:26.378619 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m15:34:26.378939 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: BEGIN
[0m15:34:26.379268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:26.547463 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.247 seconds
[0m15:34:26.548909 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: ROLLBACK
[0m15:34:26.798489 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: Close
[0m15:34:26.799710 [info ] [Thread-4 (]: 220 of 262 PASS not_null_fct_shipments_supplier_id ............................. [[32mPASS[0m in 2.79s]
[0m15:34:26.800830 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m15:34:26.801471 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m15:34:26.802423 [info ] [Thread-4 (]: 224 of 262 START test not_null_fct_stock_movements_movement_month .............. [RUN]
[0m15:34:26.803086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca, now test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd)
[0m15:34:26.803528 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m15:34:26.807141 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m15:34:26.807778 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m15:34:26.809786 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m15:34:26.810422 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m15:34:26.810784 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: BEGIN
[0m15:34:26.811308 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:27.587320 [debug] [Thread-2 (]: SQL status: BEGIN in 2.728 seconds
[0m15:34:27.587806 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m15:34:27.588147 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_date
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_date is null



  
  
      
    ) dbt_internal_test
[0m15:34:27.891529 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.303 seconds
[0m15:34:27.893153 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: ROLLBACK
[0m15:34:28.182759 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: Close
[0m15:34:28.183800 [info ] [Thread-2 (]: 222 of 262 PASS not_null_fct_stock_movements_movement_date ..................... [[32mPASS[0m in 3.26s]
[0m15:34:28.184381 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m15:34:28.184845 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m15:34:28.185302 [info ] [Thread-2 (]: 225 of 262 START test not_null_fct_stock_movements_movement_type ............... [RUN]
[0m15:34:28.185756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f, now test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096)
[0m15:34:28.186077 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m15:34:28.189875 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m15:34:28.190499 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m15:34:28.192668 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m15:34:28.193238 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m15:34:28.193546 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: BEGIN
[0m15:34:28.193881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:28.276200 [debug] [Thread-3 (]: SQL status: BEGIN in 3.655 seconds
[0m15:34:28.276737 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m15:34:28.277089 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_name
from "postgres"."silver_to_golden"."fct_shipments"
where supplier_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:28.568824 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.291 seconds
[0m15:34:28.570302 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: ROLLBACK
[0m15:34:28.856484 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: Close
[0m15:34:28.857358 [info ] [Thread-3 (]: 221 of 262 PASS not_null_fct_shipments_supplier_name ........................... [[32mPASS[0m in 4.17s]
[0m15:34:28.857907 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m15:34:28.858300 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m15:34:28.858710 [info ] [Thread-3 (]: 226 of 262 START test not_null_fct_stock_movements_movement_year ............... [RUN]
[0m15:34:28.859108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f, now test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13)
[0m15:34:28.859418 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m15:34:28.862967 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m15:34:28.863494 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m15:34:28.865432 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m15:34:28.865973 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m15:34:28.866287 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: BEGIN
[0m15:34:28.866624 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:29.637181 [debug] [Thread-1 (]: SQL status: BEGIN in 3.327 seconds
[0m15:34:29.637675 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m15:34:29.638017 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_id
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:29.881407 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.243 seconds
[0m15:34:29.884167 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: ROLLBACK
[0m15:34:30.075767 [debug] [Thread-4 (]: SQL status: BEGIN in 3.334 seconds
[0m15:34:30.076281 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m15:34:30.076668 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_month
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_month is null



  
  
      
    ) dbt_internal_test
[0m15:34:30.129062 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: Close
[0m15:34:30.129944 [info ] [Thread-1 (]: 223 of 262 PASS not_null_fct_stock_movements_movement_id ....................... [[32mPASS[0m in 3.83s]
[0m15:34:30.130498 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m15:34:30.130911 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m15:34:30.131399 [info ] [Thread-1 (]: 227 of 262 START test not_null_fct_stock_movements_product_id .................. [RUN]
[0m15:34:30.131892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6, now test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a)
[0m15:34:30.132260 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m15:34:30.135864 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m15:34:30.136393 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m15:34:30.138459 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m15:34:30.138991 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m15:34:30.139301 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: BEGIN
[0m15:34:30.139653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:30.339604 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.262 seconds
[0m15:34:30.341938 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: ROLLBACK
[0m15:34:30.666561 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: Close
[0m15:34:30.667238 [debug] [Thread-2 (]: SQL status: BEGIN in 2.473 seconds
[0m15:34:30.667809 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m15:34:30.668965 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_type
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_type is null



  
  
      
    ) dbt_internal_test
[0m15:34:30.668553 [info ] [Thread-4 (]: 224 of 262 PASS not_null_fct_stock_movements_movement_month .................... [[32mPASS[0m in 3.87s]
[0m15:34:30.669902 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m15:34:30.670371 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m15:34:30.670913 [info ] [Thread-4 (]: 228 of 262 START test not_null_fct_stock_movements_product_name ................ [RUN]
[0m15:34:30.671468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd, now test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b)
[0m15:34:30.671934 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m15:34:30.675978 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m15:34:30.676557 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m15:34:30.678764 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m15:34:30.679316 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m15:34:30.679629 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: BEGIN
[0m15:34:30.679991 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:30.939134 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.269 seconds
[0m15:34:30.940946 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: ROLLBACK
[0m15:34:31.188131 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: Close
[0m15:34:31.189258 [info ] [Thread-2 (]: 225 of 262 PASS not_null_fct_stock_movements_movement_type ..................... [[32mPASS[0m in 3.00s]
[0m15:34:31.189978 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m15:34:31.190468 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m15:34:31.190966 [info ] [Thread-2 (]: 229 of 262 START test not_null_fct_stock_movements_quantity .................... [RUN]
[0m15:34:31.191525 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096, now test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a)
[0m15:34:31.191927 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m15:34:31.197668 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m15:34:31.198614 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m15:34:31.202152 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m15:34:31.203119 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m15:34:31.203528 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: BEGIN
[0m15:34:31.203923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:31.246566 [debug] [Thread-3 (]: SQL status: BEGIN in 2.380 seconds
[0m15:34:31.247194 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m15:34:31.247622 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_year
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_year is null



  
  
      
    ) dbt_internal_test
[0m15:34:31.500009 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.252 seconds
[0m15:34:31.501653 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: ROLLBACK
[0m15:34:31.750410 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: Close
[0m15:34:31.751420 [info ] [Thread-3 (]: 226 of 262 PASS not_null_fct_stock_movements_movement_year ..................... [[32mPASS[0m in 2.89s]
[0m15:34:31.752150 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m15:34:31.752669 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m15:34:31.753163 [info ] [Thread-3 (]: 230 of 262 START test not_null_fct_stock_movements_store_id .................... [RUN]
[0m15:34:31.753687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13, now test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385)
[0m15:34:31.754338 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m15:34:31.758024 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m15:34:31.758572 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m15:34:31.762196 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m15:34:31.762875 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m15:34:31.763276 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: BEGIN
[0m15:34:31.763696 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:32.929080 [debug] [Thread-4 (]: SQL status: BEGIN in 2.249 seconds
[0m15:34:32.929603 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m15:34:32.929977 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_stock_movements"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:33.190570 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.260 seconds
[0m15:34:33.191975 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: ROLLBACK
[0m15:34:33.459886 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: Close
[0m15:34:33.460851 [info ] [Thread-4 (]: 228 of 262 PASS not_null_fct_stock_movements_product_name ...................... [[32mPASS[0m in 2.79s]
[0m15:34:33.461462 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m15:34:33.461898 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m15:34:33.462329 [info ] [Thread-4 (]: 231 of 262 START test not_null_fct_stock_movements_store_name .................. [RUN]
[0m15:34:33.462761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b, now test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7)
[0m15:34:33.463082 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m15:34:33.466664 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m15:34:33.467221 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m15:34:33.469281 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m15:34:33.469807 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m15:34:33.470114 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: BEGIN
[0m15:34:33.470468 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:33.497971 [debug] [Thread-2 (]: SQL status: BEGIN in 2.294 seconds
[0m15:34:33.498494 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m15:34:33.498823 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver_to_golden"."fct_stock_movements"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m15:34:33.748354 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.249 seconds
[0m15:34:33.749872 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: ROLLBACK
[0m15:34:33.998869 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: Close
[0m15:34:34.000035 [info ] [Thread-2 (]: 229 of 262 PASS not_null_fct_stock_movements_quantity .......................... [[32mPASS[0m in 2.81s]
[0m15:34:34.000910 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m15:34:34.001450 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m15:34:34.001991 [info ] [Thread-2 (]: 232 of 262 START test not_null_fct_store_visits_customer_id .................... [RUN]
[0m15:34:34.002559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a, now test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0)
[0m15:34:34.002999 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m15:34:34.006993 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m15:34:34.007543 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m15:34:34.009527 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m15:34:34.010051 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m15:34:34.010372 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: BEGIN
[0m15:34:34.010719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:35.022402 [debug] [Thread-3 (]: SQL status: BEGIN in 3.259 seconds
[0m15:34:35.022972 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m15:34:35.023435 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_stock_movements"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:35.332065 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.308 seconds
[0m15:34:35.334464 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: ROLLBACK
[0m15:34:35.636399 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: Close
[0m15:34:35.637448 [info ] [Thread-3 (]: 230 of 262 PASS not_null_fct_stock_movements_store_id .......................... [[32mPASS[0m in 3.88s]
[0m15:34:35.638143 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m15:34:35.638634 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m15:34:35.639178 [info ] [Thread-3 (]: 233 of 262 START test not_null_fct_store_visits_customer_name .................. [RUN]
[0m15:34:35.639838 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385, now test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76)
[0m15:34:35.640263 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m15:34:35.644068 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m15:34:35.644679 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m15:34:35.646765 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m15:34:35.647313 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m15:34:35.647624 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: BEGIN
[0m15:34:35.647955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:36.136513 [debug] [Thread-1 (]: SQL status: BEGIN in 5.997 seconds
[0m15:34:36.137023 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m15:34:36.137357 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_stock_movements"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:36.443843 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.306 seconds
[0m15:34:36.444400 [debug] [Thread-4 (]: SQL status: BEGIN in 2.974 seconds
[0m15:34:36.445838 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: ROLLBACK
[0m15:34:36.446341 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m15:34:36.446840 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_stock_movements"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:36.718029 [debug] [Thread-2 (]: SQL status: BEGIN in 2.707 seconds
[0m15:34:36.718578 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m15:34:36.718948 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_store_visits"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:36.741770 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.294 seconds
[0m15:34:36.743227 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: ROLLBACK
[0m15:34:36.991545 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.272 seconds
[0m15:34:36.993072 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: ROLLBACK
[0m15:34:37.039252 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: Close
[0m15:34:37.040181 [info ] [Thread-4 (]: 231 of 262 PASS not_null_fct_stock_movements_store_name ........................ [[32mPASS[0m in 3.58s]
[0m15:34:37.040810 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m15:34:37.041241 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m15:34:37.041728 [info ] [Thread-4 (]: 234 of 262 START test not_null_fct_store_visits_store_id ....................... [RUN]
[0m15:34:37.042195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7, now test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb)
[0m15:34:37.042523 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m15:34:37.048043 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m15:34:37.048686 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m15:34:37.050677 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m15:34:37.051245 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m15:34:37.051566 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: BEGIN
[0m15:34:37.051871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:37.269111 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: Close
[0m15:34:37.270022 [info ] [Thread-2 (]: 232 of 262 PASS not_null_fct_store_visits_customer_id .......................... [[32mPASS[0m in 3.27s]
[0m15:34:37.270605 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m15:34:37.271023 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m15:34:37.271485 [info ] [Thread-2 (]: 235 of 262 START test not_null_fct_store_visits_store_name ..................... [RUN]
[0m15:34:37.271938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0, now test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31)
[0m15:34:37.272266 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m15:34:37.275912 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m15:34:37.276442 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m15:34:37.278313 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m15:34:37.278841 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m15:34:37.279155 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: BEGIN
[0m15:34:37.279476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:37.510684 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: Close
[0m15:34:37.511562 [info ] [Thread-1 (]: 227 of 262 PASS not_null_fct_stock_movements_product_id ........................ [[32mPASS[0m in 7.38s]
[0m15:34:37.512185 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m15:34:37.512628 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m15:34:37.513050 [info ] [Thread-1 (]: 236 of 262 START test not_null_fct_store_visits_visit_date ..................... [RUN]
[0m15:34:37.513490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a, now test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a)
[0m15:34:37.513812 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m15:34:37.517315 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m15:34:37.517845 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m15:34:37.519727 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m15:34:37.520264 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m15:34:37.520639 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: BEGIN
[0m15:34:37.520965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:37.959831 [debug] [Thread-3 (]: SQL status: BEGIN in 2.312 seconds
[0m15:34:37.960347 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m15:34:37.960751 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "postgres"."silver_to_golden"."fct_store_visits"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:38.214965 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.254 seconds
[0m15:34:38.216495 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: ROLLBACK
[0m15:34:38.473581 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: Close
[0m15:34:38.474458 [error] [Thread-3 (]: 233 of 262 FAIL 902 not_null_fct_store_visits_customer_name .................... [[31mFAIL 902[0m in 2.83s]
[0m15:34:38.475027 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m15:34:38.475427 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m15:34:38.475886 [info ] [Thread-3 (]: 237 of 262 START test not_null_fct_store_visits_visit_day ...................... [RUN]
[0m15:34:38.476328 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76, now test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48)
[0m15:34:38.476702 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m15:34:38.480092 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m15:34:38.480645 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m15:34:38.483654 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m15:34:38.484184 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m15:34:38.484519 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: BEGIN
[0m15:34:38.484861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:39.515762 [debug] [Thread-2 (]: SQL status: BEGIN in 2.236 seconds
[0m15:34:39.516263 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m15:34:39.516636 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_store_visits"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m15:34:39.765880 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.249 seconds
[0m15:34:39.767289 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: ROLLBACK
[0m15:34:40.026277 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: Close
[0m15:34:40.027301 [info ] [Thread-2 (]: 235 of 262 PASS not_null_fct_store_visits_store_name ........................... [[32mPASS[0m in 2.76s]
[0m15:34:40.027882 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m15:34:40.028301 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m15:34:40.028769 [info ] [Thread-2 (]: 238 of 262 START test not_null_fct_store_visits_visit_id ....................... [RUN]
[0m15:34:40.029237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31, now test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54)
[0m15:34:40.029567 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m15:34:40.033069 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m15:34:40.033599 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m15:34:40.035514 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m15:34:40.036053 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m15:34:40.036389 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: BEGIN
[0m15:34:40.036743 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:40.465281 [debug] [Thread-1 (]: SQL status: BEGIN in 2.944 seconds
[0m15:34:40.465821 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m15:34:40.466233 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_date
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_date is null



  
  
      
    ) dbt_internal_test
[0m15:34:40.787261 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.321 seconds
[0m15:34:40.788783 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: ROLLBACK
[0m15:34:40.873268 [debug] [Thread-3 (]: SQL status: BEGIN in 2.388 seconds
[0m15:34:40.873743 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m15:34:40.874081 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_day
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_day is null



  
  
      
    ) dbt_internal_test
[0m15:34:41.126762 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: Close
[0m15:34:41.127288 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.253 seconds
[0m15:34:41.129185 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: ROLLBACK
[0m15:34:41.129748 [info ] [Thread-1 (]: 236 of 262 PASS not_null_fct_store_visits_visit_date ........................... [[32mPASS[0m in 3.62s]
[0m15:34:41.130400 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m15:34:41.130828 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m15:34:41.131279 [info ] [Thread-1 (]: 239 of 262 START test not_null_fct_store_visits_visit_month .................... [RUN]
[0m15:34:41.131723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a, now test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157)
[0m15:34:41.132086 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m15:34:41.136330 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m15:34:41.136950 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m15:34:41.138925 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m15:34:41.139696 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m15:34:41.140037 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: BEGIN
[0m15:34:41.140353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:41.424471 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: Close
[0m15:34:41.425521 [info ] [Thread-3 (]: 237 of 262 PASS not_null_fct_store_visits_visit_day ............................ [[32mPASS[0m in 2.95s]
[0m15:34:41.426142 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m15:34:41.426546 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m15:34:41.426981 [info ] [Thread-3 (]: 240 of 262 START test not_null_fct_store_visits_visit_year ..................... [RUN]
[0m15:34:41.427376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48, now test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227)
[0m15:34:41.427743 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m15:34:41.431775 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m15:34:41.432336 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m15:34:41.434530 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m15:34:41.435066 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m15:34:41.435376 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: BEGIN
[0m15:34:41.435725 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:41.628669 [debug] [Thread-4 (]: SQL status: BEGIN in 4.577 seconds
[0m15:34:41.629264 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m15:34:41.629783 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_store_visits"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:42.065868 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.436 seconds
[0m15:34:42.067441 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: ROLLBACK
[0m15:34:42.435915 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: Close
[0m15:34:42.436875 [info ] [Thread-4 (]: 234 of 262 PASS not_null_fct_store_visits_store_id ............................. [[32mPASS[0m in 5.39s]
[0m15:34:42.437513 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m15:34:42.438201 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m15:34:42.438633 [info ] [Thread-4 (]: 241 of 262 START test unique_dim_brands_scd_brand_id ........................... [RUN]
[0m15:34:42.439091 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb, now test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c)
[0m15:34:42.439419 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m15:34:42.444858 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m15:34:42.445418 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m15:34:42.449406 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m15:34:42.449990 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m15:34:42.450320 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: BEGIN
[0m15:34:42.450677 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:43.027676 [debug] [Thread-2 (]: SQL status: BEGIN in 2.991 seconds
[0m15:34:43.028188 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m15:34:43.028660 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m15:34:43.309056 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.280 seconds
[0m15:34:43.310463 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: ROLLBACK
[0m15:34:43.585616 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: Close
[0m15:34:43.586460 [info ] [Thread-2 (]: 238 of 262 PASS not_null_fct_store_visits_visit_id ............................. [[32mPASS[0m in 3.56s]
[0m15:34:43.587041 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m15:34:43.587508 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m15:34:43.587948 [info ] [Thread-2 (]: 242 of 262 START test unique_dim_campaigns_campaign_id ......................... [RUN]
[0m15:34:43.588382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54, now test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300)
[0m15:34:43.588803 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m15:34:43.592494 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m15:34:43.593062 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m15:34:43.594913 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m15:34:43.595446 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m15:34:43.595796 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: BEGIN
[0m15:34:43.596116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:44.210473 [debug] [Thread-1 (]: SQL status: BEGIN in 3.070 seconds
[0m15:34:44.210986 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m15:34:44.211342 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_month
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_month is null



  
  
      
    ) dbt_internal_test
[0m15:34:44.482634 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.271 seconds
[0m15:34:44.484292 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: ROLLBACK
[0m15:34:44.749319 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: Close
[0m15:34:44.750344 [info ] [Thread-1 (]: 239 of 262 PASS not_null_fct_store_visits_visit_month .......................... [[32mPASS[0m in 3.62s]
[0m15:34:44.751085 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m15:34:44.751590 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m15:34:44.752109 [info ] [Thread-1 (]: 243 of 262 START test unique_dim_categories_scd_category_id .................... [RUN]
[0m15:34:44.752647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157, now test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa)
[0m15:34:44.753104 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m15:34:44.757125 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m15:34:44.757683 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m15:34:44.759793 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m15:34:44.760345 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m15:34:44.760704 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: BEGIN
[0m15:34:44.761007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:45.451673 [debug] [Thread-4 (]: SQL status: BEGIN in 3.001 seconds
[0m15:34:45.452250 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m15:34:45.452697 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    brand_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_brands_scd"
where brand_id is not null
group by brand_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:45.492044 [debug] [Thread-3 (]: SQL status: BEGIN in 4.056 seconds
[0m15:34:45.492734 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m15:34:45.493083 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_year
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_year is null



  
  
      
    ) dbt_internal_test
[0m15:34:45.720769 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.268 seconds
[0m15:34:45.722786 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: ROLLBACK
[0m15:34:45.800831 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.307 seconds
[0m15:34:45.802333 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: ROLLBACK
[0m15:34:45.993024 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: Close
[0m15:34:45.993990 [info ] [Thread-4 (]: 241 of 262 PASS unique_dim_brands_scd_brand_id ................................. [[32mPASS[0m in 3.55s]
[0m15:34:45.994707 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m15:34:45.995393 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m15:34:45.996066 [info ] [Thread-4 (]: 244 of 262 START test unique_dim_customers_scd_customer_id ..................... [RUN]
[0m15:34:45.996938 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c, now test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086)
[0m15:34:45.997526 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m15:34:46.003784 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m15:34:46.004820 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m15:34:46.008109 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m15:34:46.008884 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m15:34:46.009491 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: BEGIN
[0m15:34:46.010083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:46.131142 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: Close
[0m15:34:46.132177 [info ] [Thread-3 (]: 240 of 262 PASS not_null_fct_store_visits_visit_year ........................... [[32mPASS[0m in 4.70s]
[0m15:34:46.132905 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m15:34:46.133360 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m15:34:46.133888 [info ] [Thread-3 (]: 245 of 262 START test unique_dim_discount_rules_rule_id ........................ [RUN]
[0m15:34:46.134336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227, now test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6)
[0m15:34:46.134751 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m15:34:46.140834 [debug] [Thread-2 (]: SQL status: BEGIN in 2.545 seconds
[0m15:34:46.141201 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m15:34:46.141546 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m15:34:46.142111 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    campaign_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_campaigns"
where campaign_id is not null
group by campaign_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:46.142579 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m15:34:46.144858 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m15:34:46.145461 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m15:34:46.145828 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: BEGIN
[0m15:34:46.146139 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:46.414140 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.271 seconds
[0m15:34:46.416258 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: ROLLBACK
[0m15:34:46.690684 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: Close
[0m15:34:46.691634 [info ] [Thread-2 (]: 242 of 262 PASS unique_dim_campaigns_campaign_id ............................... [[32mPASS[0m in 3.10s]
[0m15:34:46.692275 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m15:34:46.692842 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m15:34:46.693427 [info ] [Thread-2 (]: 246 of 262 START test unique_dim_employees_scd_employee_id ..................... [RUN]
[0m15:34:46.694090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300, now test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021)
[0m15:34:46.694426 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m15:34:46.698361 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m15:34:46.699003 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m15:34:46.701272 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m15:34:46.701883 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m15:34:46.702260 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: BEGIN
[0m15:34:46.702611 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:48.015124 [debug] [Thread-1 (]: SQL status: BEGIN in 3.254 seconds
[0m15:34:48.015649 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m15:34:48.016097 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    category_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_categories_scd"
where category_id is not null
group by category_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:48.261275 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.245 seconds
[0m15:34:48.263071 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: ROLLBACK
[0m15:34:48.505639 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: Close
[0m15:34:48.506650 [info ] [Thread-1 (]: 243 of 262 PASS unique_dim_categories_scd_category_id .......................... [[32mPASS[0m in 3.75s]
[0m15:34:48.507474 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m15:34:48.508072 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m15:34:48.508752 [info ] [Thread-1 (]: 247 of 262 START test unique_dim_loyalty_programs_scd_loyalty_program_id ....... [RUN]
[0m15:34:48.509378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa, now test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805)
[0m15:34:48.509874 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m15:34:48.515564 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m15:34:48.516487 [debug] [Thread-4 (]: SQL status: BEGIN in 2.506 seconds
[0m15:34:48.517472 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m15:34:48.518264 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_customers_scd"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:48.519165 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m15:34:48.524225 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m15:34:48.525296 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m15:34:48.525827 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: BEGIN
[0m15:34:48.526295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:48.793568 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.275 seconds
[0m15:34:48.795178 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: ROLLBACK
[0m15:34:49.090886 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: Close
[0m15:34:49.091969 [info ] [Thread-4 (]: 244 of 262 PASS unique_dim_customers_scd_customer_id ........................... [[32mPASS[0m in 3.10s]
[0m15:34:49.093082 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m15:34:49.093667 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m15:34:49.094244 [info ] [Thread-4 (]: 248 of 262 START test unique_dim_products_scd_product_id ....................... [RUN]
[0m15:34:49.094868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086, now test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989)
[0m15:34:49.095309 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m15:34:49.099753 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m15:34:49.100378 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m15:34:49.105759 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m15:34:49.106645 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m15:34:49.107149 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: BEGIN
[0m15:34:49.107639 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:49.531743 [debug] [Thread-2 (]: SQL status: BEGIN in 2.829 seconds
[0m15:34:49.532325 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m15:34:49.532790 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    employee_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_employees_scd"
where employee_id is not null
group by employee_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:49.791293 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.258 seconds
[0m15:34:49.793085 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: ROLLBACK
[0m15:34:50.054062 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: Close
[0m15:34:50.055017 [info ] [Thread-2 (]: 246 of 262 PASS unique_dim_employees_scd_employee_id ........................... [[32mPASS[0m in 3.36s]
[0m15:34:50.055689 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m15:34:50.056189 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m15:34:50.056723 [info ] [Thread-2 (]: 249 of 262 START test unique_dim_promotions_scd_promotion_id ................... [RUN]
[0m15:34:50.057319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021, now test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe)
[0m15:34:50.057783 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m15:34:50.063078 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m15:34:50.063888 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m15:34:50.066358 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m15:34:50.066893 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m15:34:50.067242 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: BEGIN
[0m15:34:50.067546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:50.907662 [debug] [Thread-1 (]: SQL status: BEGIN in 2.381 seconds
[0m15:34:50.908165 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m15:34:50.908510 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    loyalty_program_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where loyalty_program_id is not null
group by loyalty_program_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:51.162288 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.253 seconds
[0m15:34:51.163729 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: ROLLBACK
[0m15:34:51.333011 [debug] [Thread-4 (]: SQL status: BEGIN in 2.225 seconds
[0m15:34:51.333535 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m15:34:51.333863 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_products_scd"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:51.412661 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: Close
[0m15:34:51.413536 [info ] [Thread-1 (]: 247 of 262 PASS unique_dim_loyalty_programs_scd_loyalty_program_id ............. [[32mPASS[0m in 2.90s]
[0m15:34:51.414102 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m15:34:51.414528 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m15:34:51.414992 [info ] [Thread-1 (]: 250 of 262 START test unique_dim_stores_scd_store_id ........................... [RUN]
[0m15:34:51.415438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805, now test.retail_dbt.unique_dim_stores_scd_store_id.6625450729)
[0m15:34:51.415765 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m15:34:51.419265 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m15:34:51.419791 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m15:34:51.421678 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m15:34:51.422234 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m15:34:51.422580 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: BEGIN
[0m15:34:51.422917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:51.577008 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.243 seconds
[0m15:34:51.578575 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: ROLLBACK
[0m15:34:51.802388 [debug] [Thread-3 (]: SQL status: BEGIN in 5.656 seconds
[0m15:34:51.802954 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m15:34:51.803403 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rule_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_discount_rules"
where rule_id is not null
group by rule_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:51.815892 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: Close
[0m15:34:51.816809 [info ] [Thread-4 (]: 248 of 262 PASS unique_dim_products_scd_product_id ............................. [[32mPASS[0m in 2.72s]
[0m15:34:51.817381 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m15:34:51.817803 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m15:34:51.818463 [info ] [Thread-4 (]: 251 of 262 START test unique_dim_suppliers_scd_supplier_id ..................... [RUN]
[0m15:34:51.818899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989, now test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574)
[0m15:34:51.819367 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m15:34:51.822873 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m15:34:51.823420 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m15:34:51.825355 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m15:34:51.825888 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m15:34:51.826241 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: BEGIN
[0m15:34:51.826600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:52.068037 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.264 seconds
[0m15:34:52.070093 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: ROLLBACK
[0m15:34:52.722529 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: Close
[0m15:34:52.723559 [info ] [Thread-3 (]: 245 of 262 PASS unique_dim_discount_rules_rule_id .............................. [[32mPASS[0m in 6.59s]
[0m15:34:52.724352 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m15:34:52.724917 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m15:34:52.725456 [info ] [Thread-3 (]: 252 of 262 START test unique_dim_tax_rules_tax_id .............................. [RUN]
[0m15:34:52.726079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6, now test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360)
[0m15:34:52.726513 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m15:34:52.730336 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m15:34:52.730892 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m15:34:52.734182 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m15:34:52.734735 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m15:34:52.735105 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: BEGIN
[0m15:34:52.735444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:52.801794 [debug] [Thread-2 (]: SQL status: BEGIN in 2.734 seconds
[0m15:34:52.802298 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m15:34:52.802633 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    promotion_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_promotions_scd"
where promotion_id is not null
group by promotion_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:53.094554 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.291 seconds
[0m15:34:53.096058 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: ROLLBACK
[0m15:34:53.384476 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: Close
[0m15:34:53.385444 [info ] [Thread-2 (]: 249 of 262 PASS unique_dim_promotions_scd_promotion_id ......................... [[32mPASS[0m in 3.33s]
[0m15:34:53.386038 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m15:34:53.386436 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m15:34:53.386894 [info ] [Thread-2 (]: 253 of 262 START test unique_fct_customer_feedback_feedback_id ................. [RUN]
[0m15:34:53.387377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe, now test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999)
[0m15:34:53.387940 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m15:34:53.391349 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m15:34:53.391879 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m15:34:53.393917 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m15:34:53.394441 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m15:34:53.394813 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: BEGIN
[0m15:34:53.395114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:53.984362 [debug] [Thread-1 (]: SQL status: BEGIN in 2.561 seconds
[0m15:34:53.984885 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m15:34:53.985228 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_stores_scd"
where store_id is not null
group by store_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:54.201741 [debug] [Thread-4 (]: SQL status: BEGIN in 2.375 seconds
[0m15:34:54.202252 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m15:34:54.202617 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    supplier_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_suppliers_scd"
where supplier_id is not null
group by supplier_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:54.266583 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.281 seconds
[0m15:34:54.268074 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: ROLLBACK
[0m15:34:54.515085 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.312 seconds
[0m15:34:54.516468 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: ROLLBACK
[0m15:34:54.555263 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: Close
[0m15:34:54.556193 [info ] [Thread-1 (]: 250 of 262 PASS unique_dim_stores_scd_store_id ................................. [[32mPASS[0m in 3.14s]
[0m15:34:54.556819 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m15:34:54.557250 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m15:34:54.557713 [info ] [Thread-1 (]: 254 of 262 START test unique_fct_inventory_inventory_id ........................ [RUN]
[0m15:34:54.558182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_stores_scd_store_id.6625450729, now test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e)
[0m15:34:54.558575 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m15:34:54.562173 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m15:34:54.562719 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m15:34:54.564692 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m15:34:54.565213 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m15:34:54.565526 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: BEGIN
[0m15:34:54.565866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:54.768752 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: Close
[0m15:34:54.769598 [info ] [Thread-4 (]: 251 of 262 PASS unique_dim_suppliers_scd_supplier_id ........................... [[32mPASS[0m in 2.95s]
[0m15:34:54.770157 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m15:34:54.770566 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m15:34:54.771001 [info ] [Thread-4 (]: 255 of 262 START test unique_fct_pricing_history_history_id .................... [RUN]
[0m15:34:54.771451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574, now test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe)
[0m15:34:54.771791 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m15:34:54.775342 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m15:34:54.775885 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m15:34:54.778283 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m15:34:54.778927 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m15:34:54.779349 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: BEGIN
[0m15:34:54.779746 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:55.905490 [debug] [Thread-2 (]: SQL status: BEGIN in 2.510 seconds
[0m15:34:55.906000 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m15:34:55.906341 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_id is not null
group by feedback_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:56.160766 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.254 seconds
[0m15:34:56.162159 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: ROLLBACK
[0m15:34:56.472568 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: Close
[0m15:34:56.473518 [info ] [Thread-2 (]: 253 of 262 PASS unique_fct_customer_feedback_feedback_id ....................... [[32mPASS[0m in 3.09s]
[0m15:34:56.474130 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m15:34:56.474603 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m15:34:56.475147 [info ] [Thread-2 (]: 256 of 262 START test unique_fct_purchase_orders_order_id ...................... [RUN]
[0m15:34:56.475689 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999, now test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18)
[0m15:34:56.476068 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m15:34:56.481573 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m15:34:56.482158 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m15:34:56.484233 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m15:34:56.484779 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m15:34:56.485101 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: BEGIN
[0m15:34:56.485437 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:57.031592 [debug] [Thread-3 (]: SQL status: BEGIN in 4.353 seconds
[0m15:34:57.032299 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m15:34:57.032772 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    tax_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_tax_rules"
where tax_id is not null
group by tax_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:57.416016 [debug] [Thread-4 (]: SQL status: BEGIN in 2.694 seconds
[0m15:34:57.416622 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m15:34:57.417024 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    history_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_pricing_history"
where history_id is not null
group by history_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:57.436917 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.404 seconds
[0m15:34:57.437359 [debug] [Thread-1 (]: SQL status: BEGIN in 2.929 seconds
[0m15:34:57.438722 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: ROLLBACK
[0m15:34:57.439188 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m15:34:57.439730 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    inventory_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_inventory"
where inventory_id is not null
group by inventory_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:57.706714 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.289 seconds
[0m15:34:57.708132 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: ROLLBACK
[0m15:34:57.726842 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: Close
[0m15:34:57.727797 [info ] [Thread-3 (]: 252 of 262 PASS unique_dim_tax_rules_tax_id .................................... [[32mPASS[0m in 5.00s]
[0m15:34:57.728361 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m15:34:57.728760 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m15:34:57.729190 [info ] [Thread-3 (]: 257 of 262 START test unique_fct_returns_return_id ............................. [RUN]
[0m15:34:57.729570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360, now test.retail_dbt.unique_fct_returns_return_id.d461048e81)
[0m15:34:57.729948 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m15:34:57.733482 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m15:34:57.733863 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.294 seconds
[0m15:34:57.735470 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: ROLLBACK
[0m15:34:57.736011 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m15:34:57.738150 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m15:34:57.738715 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m15:34:57.739052 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: BEGIN
[0m15:34:57.739426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:57.985949 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: Close
[0m15:34:57.986817 [info ] [Thread-4 (]: 255 of 262 PASS unique_fct_pricing_history_history_id .......................... [[32mPASS[0m in 3.22s]
[0m15:34:57.987419 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m15:34:57.987834 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m15:34:57.988196 [info ] [Thread-4 (]: 258 of 262 START test unique_fct_sales_items_item_id ........................... [RUN]
[0m15:34:57.988709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe, now test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b)
[0m15:34:57.989033 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m15:34:57.992968 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m15:34:57.993559 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m15:34:57.995820 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m15:34:57.996360 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m15:34:57.996707 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: BEGIN
[0m15:34:57.997005 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:34:58.196244 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: Close
[0m15:34:58.197173 [info ] [Thread-1 (]: 254 of 262 PASS unique_fct_inventory_inventory_id .............................. [[32mPASS[0m in 3.64s]
[0m15:34:58.197723 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m15:34:58.198166 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m15:34:58.198638 [info ] [Thread-1 (]: 259 of 262 START test unique_fct_sales_transactions_transaction_id ............. [RUN]
[0m15:34:58.199114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e, now test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1)
[0m15:34:58.199442 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m15:34:58.202858 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m15:34:58.203410 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m15:34:58.206617 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m15:34:58.207217 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m15:34:58.207537 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: BEGIN
[0m15:34:58.207861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:59.555137 [debug] [Thread-2 (]: SQL status: BEGIN in 3.127 seconds
[0m15:34:59.555654 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m15:34:59.555988 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:34:59.828939 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.272 seconds
[0m15:34:59.830493 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: ROLLBACK
[0m15:35:00.083932 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: Close
[0m15:35:00.084802 [info ] [Thread-2 (]: 256 of 262 PASS unique_fct_purchase_orders_order_id ............................ [[32mPASS[0m in 3.61s]
[0m15:35:00.085413 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m15:35:00.085864 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m15:35:00.086295 [info ] [Thread-2 (]: 260 of 262 START test unique_fct_shipments_shipment_id ......................... [RUN]
[0m15:35:00.086735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18, now test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c)
[0m15:35:00.087107 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m15:35:00.090497 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m15:35:00.091045 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m15:35:00.093056 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m15:35:00.093583 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m15:35:00.093898 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: BEGIN
[0m15:35:00.094233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:35:00.879723 [debug] [Thread-3 (]: SQL status: BEGIN in 3.140 seconds
[0m15:35:00.880343 [debug] [Thread-4 (]: SQL status: BEGIN in 2.883 seconds
[0m15:35:00.880735 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m15:35:00.881160 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m15:35:00.881546 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_returns_return_id.d461048e81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    return_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_returns"
where return_id is not null
group by return_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:35:00.881991 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_sales_items"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:35:01.248514 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.366 seconds
[0m15:35:01.250049 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: ROLLBACK
[0m15:35:01.250503 [debug] [Thread-1 (]: SQL status: BEGIN in 3.043 seconds
[0m15:35:01.250929 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.368 seconds
[0m15:35:01.251663 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m15:35:01.252988 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: ROLLBACK
[0m15:35:01.253443 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:35:01.534602 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: Close
[0m15:35:01.536048 [info ] [Thread-3 (]: 257 of 262 PASS unique_fct_returns_return_id ................................... [[32mPASS[0m in 3.81s]
[0m15:35:01.536686 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m15:35:01.537120 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m15:35:01.537640 [info ] [Thread-3 (]: 261 of 262 START test unique_fct_stock_movements_movement_id ................... [RUN]
[0m15:35:01.538244 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_returns_return_id.d461048e81, now test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333)
[0m15:35:01.538662 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m15:35:01.542386 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m15:35:01.542926 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m15:35:01.545209 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m15:35:01.545815 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m15:35:01.546189 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: BEGIN
[0m15:35:01.546513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:35:01.549362 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: Close
[0m15:35:01.550102 [info ] [Thread-4 (]: 258 of 262 PASS unique_fct_sales_items_item_id ................................. [[32mPASS[0m in 3.56s]
[0m15:35:01.550636 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m15:35:01.551038 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m15:35:01.551533 [info ] [Thread-4 (]: 262 of 262 START test unique_fct_store_visits_visit_id ......................... [RUN]
[0m15:35:01.551950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b, now test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28)
[0m15:35:01.552289 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m15:35:01.555576 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m15:35:01.556083 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m15:35:01.557981 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m15:35:01.558527 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m15:35:01.558872 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: BEGIN
[0m15:35:01.559212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:35:01.568267 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.314 seconds
[0m15:35:01.569572 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: ROLLBACK
[0m15:35:01.820425 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: Close
[0m15:35:01.821341 [info ] [Thread-1 (]: 259 of 262 PASS unique_fct_sales_transactions_transaction_id ................... [[32mPASS[0m in 3.62s]
[0m15:35:01.821910 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m15:35:03.087002 [debug] [Thread-2 (]: SQL status: BEGIN in 2.993 seconds
[0m15:35:03.087643 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m15:35:03.088101 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    shipment_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_shipments"
where shipment_id is not null
group by shipment_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:35:03.429838 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.341 seconds
[0m15:35:03.431598 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: ROLLBACK
[0m15:35:04.042511 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: Close
[0m15:35:04.043595 [info ] [Thread-2 (]: 260 of 262 PASS unique_fct_shipments_shipment_id ............................... [[32mPASS[0m in 3.96s]
[0m15:35:04.044364 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m15:35:04.942728 [debug] [Thread-3 (]: SQL status: BEGIN in 3.396 seconds
[0m15:35:04.943290 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m15:35:04.943716 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    movement_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_id is not null
group by movement_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:35:05.346972 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.403 seconds
[0m15:35:05.347525 [debug] [Thread-4 (]: SQL status: BEGIN in 3.788 seconds
[0m15:35:05.348894 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: ROLLBACK
[0m15:35:05.349338 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m15:35:05.349816 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    visit_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_store_visits"
where visit_id is not null
group by visit_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:35:05.637614 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.287 seconds
[0m15:35:05.638311 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: Close
[0m15:35:05.640250 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: ROLLBACK
[0m15:35:05.641306 [info ] [Thread-3 (]: 261 of 262 PASS unique_fct_stock_movements_movement_id ......................... [[32mPASS[0m in 4.10s]
[0m15:35:05.642046 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m15:35:05.934550 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: Close
[0m15:35:05.935507 [info ] [Thread-4 (]: 262 of 262 PASS unique_fct_store_visits_visit_id ............................... [[32mPASS[0m in 4.38s]
[0m15:35:05.936101 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m15:35:05.938211 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:05.938519 [debug] [MainThread]: On master: BEGIN
[0m15:35:05.938841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:08.575364 [debug] [MainThread]: SQL status: BEGIN in 2.636 seconds
[0m15:35:08.575806 [debug] [MainThread]: On master: COMMIT
[0m15:35:08.576168 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:08.576484 [debug] [MainThread]: On master: COMMIT
[0m15:35:08.850772 [debug] [MainThread]: SQL status: COMMIT in 0.274 seconds
[0m15:35:08.851250 [debug] [MainThread]: On master: Close
[0m15:35:08.852007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:08.852319 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c' was properly closed.
[0m15:35:08.852581 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333' was properly closed.
[0m15:35:08.852878 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1' was properly closed.
[0m15:35:08.853130 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28' was properly closed.
[0m15:35:08.853642 [info ] [MainThread]: 
[0m15:35:08.854023 [info ] [MainThread]: Finished running 262 data tests in 0 hours 4 minutes and 2.55 seconds (242.55s).
[0m15:35:08.881345 [debug] [MainThread]: Command end result
[0m15:35:09.060405 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m15:35:09.063293 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m15:35:09.076652 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m15:35:09.077079 [info ] [MainThread]: 
[0m15:35:09.077471 [info ] [MainThread]: [31mCompleted with 19 errors, 0 partial successes, and 0 warnings:[0m
[0m15:35:09.077788 [info ] [MainThread]: 
[0m15:35:09.078214 [error] [MainThread]: [31mFailure in test not_null_dim_brands_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.078610 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m15:35:09.078904 [info ] [MainThread]: 
[0m15:35:09.079259 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_brands_scd_dbt_valid_to.sql
[0m15:35:09.079589 [info ] [MainThread]: 
[0m15:35:09.079933 [error] [MainThread]: [31mFailure in test not_null_dim_brands_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.080270 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m15:35:09.080586 [info ] [MainThread]: 
[0m15:35:09.080922 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_brands_scd_valid_to.sql
[0m15:35:09.081218 [info ] [MainThread]: 
[0m15:35:09.081587 [error] [MainThread]: [31mFailure in test not_null_dim_categories_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.081925 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m15:35:09.082290 [info ] [MainThread]: 
[0m15:35:09.082654 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_categories_scd_dbt_valid_to.sql
[0m15:35:09.082950 [info ] [MainThread]: 
[0m15:35:09.083305 [error] [MainThread]: [31mFailure in test not_null_dim_categories_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.083672 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m15:35:09.083957 [info ] [MainThread]: 
[0m15:35:09.084287 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_categories_scd_valid_to.sql
[0m15:35:09.084607 [info ] [MainThread]: 
[0m15:35:09.084946 [error] [MainThread]: [31mFailure in test not_null_dim_customers_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.085302 [error] [MainThread]:   Got 902 results, configured to fail if != 0
[0m15:35:09.085618 [info ] [MainThread]: 
[0m15:35:09.085950 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_customers_scd_dbt_valid_to.sql
[0m15:35:09.086240 [info ] [MainThread]: 
[0m15:35:09.086602 [error] [MainThread]: [31mFailure in test not_null_dim_customers_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.086933 [error] [MainThread]:   Got 902 results, configured to fail if != 0
[0m15:35:09.087242 [info ] [MainThread]: 
[0m15:35:09.087599 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_customers_scd_valid_to.sql
[0m15:35:09.087901 [info ] [MainThread]: 
[0m15:35:09.088241 [error] [MainThread]: [31mFailure in test not_null_dim_employees_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.088597 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m15:35:09.088881 [info ] [MainThread]: 
[0m15:35:09.089210 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_employees_scd_dbt_valid_to.sql
[0m15:35:09.089513 [info ] [MainThread]: 
[0m15:35:09.089847 [error] [MainThread]: [31mFailure in test not_null_dim_employees_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.090180 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m15:35:09.090544 [info ] [MainThread]: 
[0m15:35:09.090949 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_employees_scd_valid_to.sql
[0m15:35:09.091347 [info ] [MainThread]: 
[0m15:35:09.091723 [error] [MainThread]: [31mFailure in test not_null_dim_loyalty_programs_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.092060 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m15:35:09.092343 [info ] [MainThread]: 
[0m15:35:09.092696 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_loyalty_programs_scd_dbt_valid_to.sql
[0m15:35:09.092991 [info ] [MainThread]: 
[0m15:35:09.093333 [error] [MainThread]: [31mFailure in test not_null_dim_loyalty_programs_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.093700 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m15:35:09.093984 [info ] [MainThread]: 
[0m15:35:09.094315 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_loyalty_programs_scd_valid_to.sql
[0m15:35:09.094629 [info ] [MainThread]: 
[0m15:35:09.094967 [error] [MainThread]: [31mFailure in test not_null_dim_products_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.095344 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m15:35:09.095698 [info ] [MainThread]: 
[0m15:35:09.096033 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_products_scd_dbt_valid_to.sql
[0m15:35:09.096327 [info ] [MainThread]: 
[0m15:35:09.096685 [error] [MainThread]: [31mFailure in test not_null_dim_products_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.097020 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m15:35:09.097303 [info ] [MainThread]: 
[0m15:35:09.097649 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_products_scd_valid_to.sql
[0m15:35:09.097940 [info ] [MainThread]: 
[0m15:35:09.098278 [error] [MainThread]: [31mFailure in test not_null_dim_promotions_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.098616 [error] [MainThread]:   Got 248 results, configured to fail if != 0
[0m15:35:09.098901 [info ] [MainThread]: 
[0m15:35:09.099245 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_promotions_scd_dbt_valid_to.sql
[0m15:35:09.099551 [info ] [MainThread]: 
[0m15:35:09.099899 [error] [MainThread]: [31mFailure in test not_null_dim_promotions_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.100230 [error] [MainThread]:   Got 248 results, configured to fail if != 0
[0m15:35:09.100511 [info ] [MainThread]: 
[0m15:35:09.100870 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_promotions_scd_valid_to.sql
[0m15:35:09.101160 [info ] [MainThread]: 
[0m15:35:09.101495 [error] [MainThread]: [31mFailure in test not_null_dim_stores_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.101852 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m15:35:09.102135 [info ] [MainThread]: 
[0m15:35:09.102471 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_stores_scd_dbt_valid_to.sql
[0m15:35:09.102785 [info ] [MainThread]: 
[0m15:35:09.103131 [error] [MainThread]: [31mFailure in test not_null_dim_stores_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.103474 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m15:35:09.103833 [info ] [MainThread]: 
[0m15:35:09.104222 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_stores_scd_valid_to.sql
[0m15:35:09.104535 [info ] [MainThread]: 
[0m15:35:09.104890 [error] [MainThread]: [31mFailure in test not_null_dim_suppliers_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.105245 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m15:35:09.105556 [info ] [MainThread]: 
[0m15:35:09.105974 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_suppliers_scd_dbt_valid_to.sql
[0m15:35:09.106327 [info ] [MainThread]: 
[0m15:35:09.106703 [error] [MainThread]: [31mFailure in test not_null_dim_suppliers_scd_valid_to (models/golden/schema.yml)[0m
[0m15:35:09.107038 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m15:35:09.107384 [info ] [MainThread]: 
[0m15:35:09.107744 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_suppliers_scd_valid_to.sql
[0m15:35:09.108041 [info ] [MainThread]: 
[0m15:35:09.108411 [error] [MainThread]: [31mFailure in test not_null_fct_store_visits_customer_name (models/golden/schema.yml)[0m
[0m15:35:09.108854 [error] [MainThread]:   Got 902 results, configured to fail if != 0
[0m15:35:09.109184 [info ] [MainThread]: 
[0m15:35:09.109563 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_fct_store_visits_customer_name.sql
[0m15:35:09.110036 [info ] [MainThread]: 
[0m15:35:09.110371 [info ] [MainThread]: Done. PASS=243 WARN=0 ERROR=19 SKIP=0 NO-OP=0 TOTAL=262
[0m15:35:09.111596 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 244.16394, "process_in_blocks": "0", "process_kernel_time": 0.838891, "process_mem_max_rss": "145596", "process_out_blocks": "15792", "process_user_time": 7.541957}
[0m15:35:09.111999 [debug] [MainThread]: Command `dbt test` failed at 15:35:09.111917 after 244.16 seconds
[0m15:35:09.112372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc477d8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc468a45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc409521e0>]}
[0m15:35:09.112696 [debug] [MainThread]: Flushing usage events
[0m15:35:10.503500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:14:49.337005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1bbc9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1c00c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1bbcb0e0>]}


============================== 07:14:49.342954 | eb76a006-1b04-422c-944e-1b9d50bea504 ==============================
[0m07:14:49.342954 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:14:49.343441 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select path:models/staging --full-refresh --profiles-dir /home/airflow/.dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/home/airflow/.dbt', 'warn_error': 'None'}
[0m07:14:49.529095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b1bdc70>]}
[0m07:14:49.579780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b3f9a00>]}
[0m07:14:49.580450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:14:49.674611 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:14:49.829763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:49.830164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:49.889176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1a528620>]}
[0m07:14:50.154715 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:14:50.158915 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:14:50.250391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e19d6ae40>]}
[0m07:14:50.250876 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:14:50.251261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e19d17290>]}
[0m07:14:50.262940 [info ] [MainThread]: 
[0m07:14:50.263366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:14:50.263642 [info ] [MainThread]: 
[0m07:14:50.264129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:14:50.268691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m07:14:50.304025 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:14:50.304533 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:14:50.304904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:52.638275 [debug] [ThreadPool]: SQL status: SELECT 4 in 2.333 seconds
[0m07:14:52.639410 [debug] [ThreadPool]: On list_postgres: Close
[0m07:14:52.640200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_silver_staging)
[0m07:14:52.640612 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "silver_staging"
"
[0m07:14:52.645397 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_staging"
[0m07:14:52.645692 [debug] [ThreadPool]: On create_postgres_silver_staging: BEGIN
[0m07:14:52.645938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:55.030263 [debug] [ThreadPool]: SQL status: BEGIN in 2.384 seconds
[0m07:14:55.030894 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_staging"
[0m07:14:55.031279 [debug] [ThreadPool]: On create_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_postgres_silver_staging"} */
create schema if not exists "silver_staging"
[0m07:14:55.322362 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.291 seconds
[0m07:14:55.323472 [debug] [ThreadPool]: On create_postgres_silver_staging: COMMIT
[0m07:14:55.323886 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_staging"
[0m07:14:55.324270 [debug] [ThreadPool]: On create_postgres_silver_staging: COMMIT
[0m07:14:55.606505 [debug] [ThreadPool]: SQL status: COMMIT in 0.282 seconds
[0m07:14:55.607002 [debug] [ThreadPool]: On create_postgres_silver_staging: Close
[0m07:14:55.613154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_silver_staging, now list_postgres_silver_to_golden)
[0m07:14:55.618276 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:14:55.618753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_staging'
[0m07:14:55.619094 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:14:55.619861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:14:55.621479 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:14:55.622147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m07:14:55.622487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:55.624207 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:14:55.624559 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:14:55.626249 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:14:55.626789 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:14:55.627181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:55.627614 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:14:55.628061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:55.628599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:58.227869 [debug] [ThreadPool]: SQL status: BEGIN in 2.600 seconds
[0m07:14:58.228503 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:14:58.228819 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:14:58.300734 [debug] [ThreadPool]: SQL status: BEGIN in 2.678 seconds
[0m07:14:58.301212 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:14:58.301636 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:14:58.339825 [debug] [ThreadPool]: SQL status: BEGIN in 2.711 seconds
[0m07:14:58.340346 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:14:58.340653 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:14:58.502125 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.273 seconds
[0m07:14:58.503385 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:14:58.577304 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.275 seconds
[0m07:14:58.578458 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:14:58.618490 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.277 seconds
[0m07:14:58.619672 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:14:58.751473 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:14:58.832582 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:14:58.934369 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:14:59.240574 [debug] [ThreadPool]: SQL status: BEGIN in 3.613 seconds
[0m07:14:59.241109 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:14:59.241380 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:14:59.467925 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.226 seconds
[0m07:14:59.468999 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:14:59.875556 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:14:59.884467 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:59.884931 [debug] [MainThread]: On master: BEGIN
[0m07:14:59.885173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:15:03.604147 [debug] [MainThread]: SQL status: BEGIN in 2.434 seconds
[0m07:15:03.604559 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:03.604927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:15:03.893812 [debug] [MainThread]: SQL status: SELECT 0 in 0.288 seconds
[0m07:15:03.895172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1e216060>]}
[0m07:15:03.895708 [debug] [MainThread]: On master: ROLLBACK
[0m07:15:04.179107 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:04.179504 [debug] [MainThread]: On master: BEGIN
[0m07:15:04.746398 [debug] [MainThread]: SQL status: BEGIN in 0.567 seconds
[0m07:15:04.746809 [debug] [MainThread]: On master: COMMIT
[0m07:15:04.747142 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:04.747419 [debug] [MainThread]: On master: COMMIT
[0m07:15:05.037123 [debug] [MainThread]: SQL status: COMMIT in 0.289 seconds
[0m07:15:05.037647 [debug] [MainThread]: On master: Close
[0m07:15:05.043881 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_brands
[0m07:15:05.044342 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_campaigns
[0m07:15:05.045131 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_categories
[0m07:15:05.044815 [info ] [Thread-1 (]: 1 of 23 START sql view model silver_staging.stg_brands ......................... [RUN]
[0m07:15:05.046123 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_customer_feedback
[0m07:15:05.045649 [info ] [Thread-2 (]: 2 of 23 START sql view model silver_staging.stg_campaigns ...................... [RUN]
[0m07:15:05.047170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now model.retail_dbt.stg_brands)
[0m07:15:05.046605 [info ] [Thread-3 (]: 3 of 23 START sql view model silver_staging.stg_categories ..................... [RUN]
[0m07:15:05.047749 [info ] [Thread-4 (]: 4 of 23 START sql view model silver_staging.stg_customer_feedback .............. [RUN]
[0m07:15:05.048287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now model.retail_dbt.stg_campaigns)
[0m07:15:05.048660 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_brands
[0m07:15:05.049100 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now model.retail_dbt.stg_categories)
[0m07:15:05.049568 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now model.retail_dbt.stg_customer_feedback)
[0m07:15:05.050010 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_campaigns
[0m07:15:05.057079 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_brands"
[0m07:15:05.057457 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_categories
[0m07:15:05.057902 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_customer_feedback
[0m07:15:05.061964 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_campaigns"
[0m07:15:05.064994 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_categories"
[0m07:15:05.067787 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_customer_feedback"
[0m07:15:05.068301 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_brands
[0m07:15:05.074932 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_customer_feedback
[0m07:15:05.075309 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_campaigns
[0m07:15:05.080889 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_categories
[0m07:15:05.110753 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_brands"
[0m07:15:05.113789 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_campaigns"
[0m07:15:05.115426 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_customer_feedback"
[0m07:15:05.119090 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_categories"
[0m07:15:05.120584 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m07:15:05.121029 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: BEGIN
[0m07:15:05.121508 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m07:15:05.122067 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m07:15:05.122424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:05.122864 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m07:15:05.123256 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: BEGIN
[0m07:15:05.123650 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: BEGIN
[0m07:15:05.124187 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: BEGIN
[0m07:15:05.124560 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:05.124924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:05.125314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:07.749034 [debug] [Thread-1 (]: SQL status: BEGIN in 2.624 seconds
[0m07:15:07.749454 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m07:15:07.749834 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_brands"} */

  create view "postgres"."silver_staging"."stg_brands__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."raw"."brands"
),

cleaned as (
    select
        case 
            when trim(brand_id) = '' then null
            when lower(trim(brand_id)) in ('null', 'na', 'n/a') then null
            -- loại bỏ ký tự không phải số trước khi cast
            else cast(regexp_replace(trim(brand_id), '[^0-9]', '', 'g') as int)
        end as brand_id,
        
        case 
            when trim(name) = '' then null
            when lower(trim(name)) in ('null', 'na', 'n/a', 'none', 'unknown') then null
            else trim(name)
        end as name,
        
        current_timestamp as staged_at
    from source
)

select * from cleaned
  );
[0m07:15:07.769144 [debug] [Thread-3 (]: SQL status: BEGIN in 2.644 seconds
[0m07:15:07.769694 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m07:15:07.770111 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_categories"} */

  create view "postgres"."silver_staging"."stg_categories__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."raw"."categories"
),

cleaned as (
    select
        case 
            when trim(category_id) = '' then null
            when lower(trim(category_id)) in ('null', 'na', 'n/a') then null
            -- loại bỏ ký tự không phải số trước khi cast
            else cast(regexp_replace(trim(category_id), '[^0-9]', '', 'g') as int)
        end as category_id,
        
        case 
            when trim(name) = '' then null
            when lower(trim(name)) in ('null', 'na', 'n/a', 'none', 'unknown') then null
            else trim(name)
        end as name,
        
        current_timestamp as staged_at
    from source
)

select * from cleaned
  );
[0m07:15:08.043608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.293 seconds
[0m07:15:08.048645 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m07:15:08.048970 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.278 seconds
[0m07:15:08.049421 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_brands"} */
alter table "postgres"."silver_staging"."stg_brands__dbt_tmp" rename to "stg_brands"
[0m07:15:08.051962 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m07:15:08.052434 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_categories"} */
alter table "postgres"."silver_staging"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m07:15:08.141944 [debug] [Thread-2 (]: SQL status: BEGIN in 3.017 seconds
[0m07:15:08.142369 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m07:15:08.142776 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_campaigns"} */

  create view "postgres"."silver_staging"."stg_campaigns__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."raw"."campaigns"
),

cleaned as (
    select
        case 
            when campaign_id is null then null
            when trim(campaign_id) = '' then null
            when lower(trim(campaign_id)) in ('null','na','n/a','none') then null
            -- loại bỏ ký tự không phải số rồi cast sang int
            else cast(regexp_replace(trim(campaign_id), '[^0-9]', '', 'g') as int)
        end as campaign_id,

        case 
            when name is null then null
            when trim(name) = '' then null
            when lower(trim(name)) in ('null','na','n/a','none') then null
            else trim(name)
        end as name,

        case
            when budget is null then null
            when trim(budget::text) = '' then null
            when lower(trim(budget::text)) in ('null','na','n/a','none') then null
            else nullif(regexp_replace(trim(budget::text), '[^0-9.\-]', '', 'g'), '')
        end as budget_str,

        nullif(trim(start_date::text), '') as start_date_raw,
        nullif(trim(end_date::text), '') as end_date_raw,

        current_timestamp as staged_at
    from source
),

typed as (
    select
        campaign_id,
        name,
        case
            when budget_str ~ '^-?\d+(\.\d+)?$' then budget_str::numeric
            else null
        end as budget,

        /* Chuẩn hoá dấu phân cách ngày về '-' để dễ regex */
        case when start_date_raw is null then null
             else regexp_replace(lower(start_date_raw), '[./]', '-', 'g') end as start_norm,
        case when end_date_raw   is null then null
             else regexp_replace(lower(end_date_raw),   '[./]', '-', 'g') end as end_norm,

        staged_at
    from cleaned
),

parsed as (
    select
        campaign_id,
        name,
        budget,

        /* START_DATE */
        case
            /* YYYY-MM-DD [optional time] */
            when start_norm ~ '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'YYYY-MM-DD')
            /* DD-MM-YYYY [optional time] */
            when start_norm ~ '^(0[1-9]|[12]\d|3[01])-(0[1-9]|1[0-2])-\d{4}(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'DD-MM-YYYY')
            /* MM-DD-YYYY [optional time] */
            when start_norm ~ '^(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])-\d{4}(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'MM-DD-YYYY')
            else null
        end as start_date,

        /* END_DATE */
        case
            when end_norm ~ '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'YYYY-MM-DD')
            when end_norm ~ '^(0[1-9]|[12]\d|3[01])-(0[1-9]|1[0-2])-\d{4}(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'DD-MM-YYYY')
            when end_norm ~ '^(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])-\d{4}(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'MM-DD-YYYY')
            else null
        end as end_date,

        staged_at
    from typed
),

filtered as (
    select *
    from parsed
    where start_date is not null
      and end_date is not null
      and start_date < end_date
      and start_date < date '2025-08-22'
      and end_date < date '2025-08-22'
      -- Thêm điều kiện loại bỏ tất cả các hàng có giá trị null ở bất kỳ cột nào
      and campaign_id is not null
      and name is not null
      and budget is not null
      and staged_at is not null
)

select
    campaign_id,
    name,
    budget,
    start_date,
    end_date,
    staged_at
from filtered
  );
[0m07:15:08.305690 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.253 seconds
[0m07:15:08.317097 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: COMMIT
[0m07:15:08.317436 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m07:15:08.317720 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: COMMIT
[0m07:15:08.336635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.284 seconds
[0m07:15:08.337771 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: COMMIT
[0m07:15:08.338087 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m07:15:08.338399 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: COMMIT
[0m07:15:08.377934 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.235 seconds
[0m07:15:08.380892 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m07:15:08.381218 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_campaigns"} */
alter table "postgres"."silver_staging"."stg_campaigns__dbt_tmp" rename to "stg_campaigns"
[0m07:15:08.421431 [debug] [Thread-4 (]: SQL status: BEGIN in 3.299 seconds
[0m07:15:08.421807 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m07:15:08.422255 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customer_feedback"} */

  create view "postgres"."silver_staging"."stg_customer_feedback__dbt_tmp"
    
    
  as (
    

WITH source_data AS (
    SELECT
        -- cast các ID về int
        CASE
            WHEN feedback_id IS NULL OR TRIM(feedback_id::text) = '' 
                 OR LOWER(TRIM(feedback_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(feedback_id::text), '[^0-9]', '', 'g') AS int)
        END AS feedback_id,

        CASE
            WHEN customer_id IS NULL OR TRIM(customer_id::text) = '' 
                 OR LOWER(TRIM(customer_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(customer_id::text), '[^0-9]', '', 'g') AS int)
        END AS customer_id,

        CASE
            WHEN store_id IS NULL OR TRIM(store_id::text) = '' 
                 OR LOWER(TRIM(store_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(store_id::text), '[^0-9]', '', 'g') AS int)
        END AS store_id,

        CASE
            WHEN product_id IS NULL OR TRIM(product_id::text) = '' 
                 OR LOWER(TRIM(product_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(product_id::text), '[^0-9]', '', 'g') AS int)
        END AS product_id,

        CASE
            WHEN rating IS NULL THEN NULL
            WHEN TRIM(LOWER(CAST(rating AS text))) IN ('na', '') THEN NULL
            WHEN TRIM(CAST(rating AS text)) ~ '^[0-9]+$' 
            THEN CAST(TRIM(CAST(rating AS text)) AS integer)
            ELSE NULL
        END AS rating,

        TRIM(CAST(comments AS text)) AS comments,

        CASE
            WHEN feedback_date IS NULL THEN NULL
            WHEN TRIM(LOWER(CAST(feedback_date AS text))) IN ('na', '') THEN NULL
            ELSE TRIM(REPLACE(CAST(feedback_date AS text), E'\r', ''))
        END AS feedback_date_text
    FROM "postgres"."raw"."customer_feedback"
),

dated AS (
    SELECT
        feedback_id,
        customer_id,
        store_id,
        product_id,
        rating,
        comments,
        feedback_date_text,

        (
            feedback_date_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
        ) AS is_valid_date_text,

        CASE
            WHEN feedback_date_text IS NOT NULL
             AND feedback_date_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
            THEN to_timestamp(replace(feedback_date_text, '-', '/'), 'YYYY/FMMM/FMDD')
            ELSE NULL
        END AS feedback_date_ts
    FROM source_data
),

staging_data AS (
    SELECT
        feedback_id::int      AS feedback_id,
        customer_id::int      AS customer_id,
        store_id::int         AS store_id,
        product_id::int       AS product_id,
        rating::integer       AS rating,
        comments::text        AS comments,
        feedback_date_ts      AS feedback_date
    FROM dated
    WHERE
        feedback_id IS NOT NULL
        AND customer_id IS NOT NULL
        AND store_id   IS NOT NULL
        AND product_id IS NOT NULL
        AND rating BETWEEN 1 AND 5
        AND is_valid_date_text
        AND feedback_date_ts IS NOT NULL
        AND feedback_date_ts <= to_timestamp('2025/08/22', 'YYYY/MM/DD')
)

SELECT
    feedback_id,
    customer_id,
    store_id,
    product_id,
    rating,
    comments,
    feedback_date
FROM staging_data
  );
[0m07:15:08.578933 [debug] [Thread-3 (]: SQL status: COMMIT in 0.261 seconds
[0m07:15:08.584632 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_staging"."stg_categories__dbt_backup"
[0m07:15:08.588715 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m07:15:08.589041 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_categories"} */
drop view if exists "postgres"."silver_staging"."stg_categories__dbt_backup" cascade
[0m07:15:08.594324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.256 seconds
[0m07:15:08.596483 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_staging"."stg_brands__dbt_backup"
[0m07:15:08.596976 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m07:15:08.597499 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_brands"} */
drop view if exists "postgres"."silver_staging"."stg_brands__dbt_backup" cascade
[0m07:15:08.617078 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.236 seconds
[0m07:15:08.618151 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: COMMIT
[0m07:15:08.618452 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m07:15:08.618732 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: COMMIT
[0m07:15:08.648187 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.225 seconds
[0m07:15:08.651361 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m07:15:08.651667 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customer_feedback"} */
alter table "postgres"."silver_staging"."stg_customer_feedback__dbt_tmp" rename to "stg_customer_feedback"
[0m07:15:08.849688 [debug] [Thread-2 (]: SQL status: COMMIT in 0.231 seconds
[0m07:15:08.850121 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.261 seconds
[0m07:15:08.898537 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.246 seconds
[0m07:15:08.898972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.301 seconds
[0m07:15:08.900556 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_staging"."stg_campaigns__dbt_backup"
[0m07:15:08.902554 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: Close
[0m07:15:08.903621 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: COMMIT
[0m07:15:08.904656 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: Close
[0m07:15:08.905213 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m07:15:08.905684 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m07:15:08.907507 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_campaigns"} */
drop view if exists "postgres"."silver_staging"."stg_campaigns__dbt_backup" cascade
[0m07:15:08.908053 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: COMMIT
[0m07:15:08.908461 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e187a4f20>]}
[0m07:15:08.908881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1c139370>]}
[0m07:15:08.909755 [info ] [Thread-3 (]: 3 of 23 OK created sql view model silver_staging.stg_categories ................ [[32mCREATE VIEW[0m in 3.86s]
[0m07:15:08.910549 [info ] [Thread-1 (]: 1 of 23 OK created sql view model silver_staging.stg_brands .................... [[32mCREATE VIEW[0m in 3.86s]
[0m07:15:08.911269 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_categories
[0m07:15:08.911927 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_brands
[0m07:15:08.912430 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_customers
[0m07:15:08.912984 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_discount_rules
[0m07:15:08.913585 [info ] [Thread-3 (]: 5 of 23 START sql view model silver_staging.stg_customers ...................... [RUN]
[0m07:15:08.914134 [info ] [Thread-1 (]: 6 of 23 START sql view model silver_staging.stg_discount_rules ................. [RUN]
[0m07:15:08.914602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_categories, now model.retail_dbt.stg_customers)
[0m07:15:08.914999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_brands, now model.retail_dbt.stg_discount_rules)
[0m07:15:08.915389 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_customers
[0m07:15:08.915871 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_discount_rules
[0m07:15:08.918833 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m07:15:08.921574 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_discount_rules"
[0m07:15:08.922286 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_discount_rules
[0m07:15:08.922658 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_customers
[0m07:15:08.925109 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_discount_rules"
[0m07:15:08.927944 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m07:15:08.928719 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m07:15:08.929121 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m07:15:08.929447 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: BEGIN
[0m07:15:08.929845 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: BEGIN
[0m07:15:08.930218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:08.930582 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:09.131477 [debug] [Thread-4 (]: SQL status: COMMIT in 0.222 seconds
[0m07:15:09.134066 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_staging"."stg_customer_feedback__dbt_backup"
[0m07:15:09.134707 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m07:15:09.135099 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customer_feedback"} */
drop view if exists "postgres"."silver_staging"."stg_customer_feedback__dbt_backup" cascade
[0m07:15:09.138351 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.229 seconds
[0m07:15:09.139702 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: Close
[0m07:15:09.140286 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e18760dd0>]}
[0m07:15:09.140763 [info ] [Thread-2 (]: 2 of 23 OK created sql view model silver_staging.stg_campaigns ................. [[32mCREATE VIEW[0m in 4.09s]
[0m07:15:09.141224 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_campaigns
[0m07:15:09.141558 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_employees
[0m07:15:09.142066 [info ] [Thread-2 (]: 7 of 23 START sql view model silver_staging.stg_employees ...................... [RUN]
[0m07:15:09.142587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_campaigns, now model.retail_dbt.stg_employees)
[0m07:15:09.142948 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_employees
[0m07:15:09.145956 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_employees"
[0m07:15:09.147147 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_employees
[0m07:15:09.150512 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_employees"
[0m07:15:09.150998 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m07:15:09.151282 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: BEGIN
[0m07:15:09.151584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:09.357451 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.222 seconds
[0m07:15:09.358890 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: Close
[0m07:15:09.359602 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e18760590>]}
[0m07:15:09.360240 [info ] [Thread-4 (]: 4 of 23 OK created sql view model silver_staging.stg_customer_feedback ......... [[32mCREATE VIEW[0m in 4.31s]
[0m07:15:09.360839 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_customer_feedback
[0m07:15:09.361218 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_inventory
[0m07:15:09.361714 [info ] [Thread-4 (]: 8 of 23 START sql view model silver_staging.stg_inventory ...................... [RUN]
[0m07:15:09.362193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customer_feedback, now model.retail_dbt.stg_inventory)
[0m07:15:09.362588 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_inventory
[0m07:15:09.365830 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory"
[0m07:15:09.366421 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_inventory
[0m07:15:09.369069 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory"
[0m07:15:09.369599 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m07:15:09.369896 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: BEGIN
[0m07:15:09.370167 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:11.286009 [debug] [Thread-1 (]: SQL status: BEGIN in 2.356 seconds
[0m07:15:11.286522 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m07:15:11.286991 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_discount_rules"} */

  create view "postgres"."silver_staging"."stg_discount_rules__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(rule_id AS text))          AS rule_id_txt,
        TRIM(CAST(product_id AS text))       AS product_id_txt,
        TRIM(CAST(discount_type AS text))    AS discount_type_txt,
        TRIM(CAST(value AS text))            AS value_txt,
        TRIM(REPLACE(CAST(valid_from AS text), E'\r','')) AS valid_from_txt,
        TRIM(REPLACE(CAST(valid_to   AS text), E'\r','')) AS valid_to_txt
    FROM "postgres"."raw"."discount_rules"
),
norm AS (
    SELECT
        NULLIF(rule_id_txt, '')          AS rule_id_clean,
        NULLIF(product_id_txt, '')       AS product_id_clean,
        NULLIF(discount_type_txt, '')    AS discount_type_clean,
        NULLIF(value_txt, '')            AS value_clean,
        NULLIF(valid_from_txt, '')       AS valid_from_clean,
        NULLIF(valid_to_txt, '')         AS valid_to_clean
    FROM src
),
typed AS (
    SELECT
        CASE WHEN rule_id_clean    ~ '^[0-9]+$'               THEN rule_id_clean::integer END          AS rule_id,
        CASE WHEN product_id_clean ~ '^[0-9]+$'               THEN product_id_clean::integer END       AS product_id,

        -- bỏ (?i) -> dùng ~* để so khớp không phân biệt hoa thường
        CASE WHEN discount_type_clean ~* '^(na|n/a)$' THEN NULL
             ELSE lower(discount_type_clean) END                                                            AS discount_type,

        CASE WHEN value_clean ~* '^(na|n/a)$' THEN NULL
             WHEN value_clean ~ '^[0-9]+(\.[0-9]+)?$' THEN value_clean::numeric
             ELSE NULL END                                                                                  AS value,

        CASE WHEN valid_from_clean ~* '^(na|n/a)$' THEN NULL
             WHEN valid_from_clean ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
                  THEN to_timestamp(replace(valid_from_clean,'-','/'),'YYYY/FMMM/FMDD')
             ELSE NULL END                                                                                  AS valid_from,

        CASE WHEN valid_to_clean ~* '^(na|n/a)$' THEN NULL
             WHEN valid_to_clean ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
                  THEN to_timestamp(replace(valid_to_clean,'-','/'),'YYYY/FMMM/FMDD')
             ELSE NULL END                                                                                  AS valid_to
    FROM norm
),
staging_data AS (
    SELECT rule_id, product_id, discount_type, value, valid_from, valid_to
    FROM typed
    WHERE rule_id IS NOT NULL
      AND product_id IS NOT NULL
      AND discount_type IS NOT NULL
      AND value IS NOT NULL
      AND valid_from IS NOT NULL
      AND valid_to   IS NOT NULL
      AND valid_from < valid_to
)
SELECT * FROM staging_data
  );
[0m07:15:11.340223 [debug] [Thread-2 (]: SQL status: BEGIN in 2.189 seconds
[0m07:15:11.340718 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m07:15:11.341165 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_employees"} */

  create view "postgres"."silver_staging"."stg_employees__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(employee_id AS text)) AS employee_id_txt,
        TRIM(CAST(name        AS text)) AS name_txt,
        TRIM(CAST(role        AS text)) AS role_txt,
        TRIM(CAST(store_id    AS text)) AS store_id_txt
    FROM "postgres"."raw"."employees"
),

filtered AS (
    SELECT *
    FROM src
    WHERE employee_id_txt IS NOT NULL AND employee_id_txt <> '' AND lower(employee_id_txt) NOT IN ('na','n/a')
      AND name_txt        IS NOT NULL AND name_txt <> ''        AND lower(name_txt)        NOT IN ('na','n/a')
      AND role_txt        IS NOT NULL AND role_txt <> ''        AND lower(role_txt)        NOT IN ('na','n/a')
      AND store_id_txt    IS NOT NULL AND store_id_txt <> ''    AND lower(store_id_txt)    NOT IN ('na','n/a')
),

typed AS (
    SELECT
        CAST(employee_id_txt AS integer) AS employee_id,
        name_txt  AS name,
        role_txt  AS role,
        CAST(store_id_txt AS integer)    AS store_id
    FROM filtered
)

SELECT *
FROM typed
  );
[0m07:15:11.399136 [debug] [Thread-4 (]: SQL status: BEGIN in 2.029 seconds
[0m07:15:11.399637 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m07:15:11.400128 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory"} */

  create view "postgres"."silver_staging"."stg_inventory__dbt_tmp"
    
    
  as (
    

with source as (
    select * 
    from "postgres"."raw"."inventory"
),

cleaned as (
    select
        case 
            when inventory_id is null or trim(lower(inventory_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(inventory_id as integer) 
        end as inventory_id,

        case 
            when store_id is null or trim(lower(store_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(store_id as integer) 
        end as store_id,

        case 
            when product_id is null or trim(lower(product_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(product_id as integer) 
        end as product_id,

        case 
            when quantity is null or trim(lower(quantity)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(quantity as integer) 
        end as quantity,

        case 
            when last_updated is null or trim(lower(last_updated)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(last_updated as timestamp) 
        end as last_updated
    from source
),

filtered as (
    select *
    from cleaned
    where 
        inventory_id is not null
        and store_id is not null
        and product_id is not null
        and quantity is not null
        and last_updated is not null
        and quantity <> 0
        and cast(last_updated as date) <= date('2025-08-22')
)

select * from filtered
  );
[0m07:15:11.433173 [debug] [Thread-3 (]: SQL status: BEGIN in 2.502 seconds
[0m07:15:11.433597 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m07:15:11.433967 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */

  create view "postgres"."silver_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(customer_id AS text))                        AS customer_id_text,
        TRIM(CAST(name        AS text))                        AS name,
        LOWER(TRIM(CAST(email AS text)))                       AS email,
        TRIM(CAST(phone       AS text))                        AS phone_text,
        TRIM(CAST(loyalty_program_id AS text))                 AS loyalty_program_id_text,
        TRIM(REPLACE(CAST(created_at AS text), E'\r',''))      AS created_at_text
    FROM "postgres"."raw"."customers"
),
typed AS (
    SELECT
        CASE WHEN customer_id_text ~ '^[0-9]+$'
             THEN customer_id_text::integer END                AS customer_id,
        name,
        email,
        phone_text                                             AS phone,
        CASE WHEN loyalty_program_id_text ~ '^[0-9]+$'
             THEN loyalty_program_id_text::integer END         AS loyalty_program_id,

        CASE
            WHEN created_at_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
            THEN to_timestamp(replace(created_at_text,'-','/'),'YYYY/FMMM/FMDD')
            ELSE NULL
        END                                                    AS created_at
    FROM src
)
SELECT
    customer_id, name, email, phone, loyalty_program_id, created_at
FROM typed
WHERE created_at IS NOT NULL
  AND created_at <= to_timestamp('2025/08/22','YYYY/MM/DD')
  );
[0m07:15:11.542012 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.254 seconds
[0m07:15:11.545255 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m07:15:11.545655 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_discount_rules"} */
alter table "postgres"."silver_staging"."stg_discount_rules__dbt_tmp" rename to "stg_discount_rules"
[0m07:15:11.812087 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.411 seconds
[0m07:15:11.812622 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.378 seconds
[0m07:15:11.815826 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m07:15:11.818564 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m07:15:11.818992 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory"} */
alter table "postgres"."silver_staging"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m07:15:11.819390 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
alter table "postgres"."silver_staging"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m07:15:12.040279 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.699 seconds
[0m07:15:12.043523 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m07:15:12.043890 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_employees"} */
alter table "postgres"."silver_staging"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m07:15:12.046088 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m07:15:12.047183 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: COMMIT
[0m07:15:12.047540 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m07:15:12.047823 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: COMMIT
[0m07:15:12.082092 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.262 seconds
[0m07:15:12.083303 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: COMMIT
[0m07:15:12.083799 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m07:15:12.084164 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: COMMIT
[0m07:15:12.267494 [debug] [Thread-4 (]: SQL status: COMMIT in 0.219 seconds
[0m07:15:12.270738 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_staging"."stg_inventory__dbt_backup"
[0m07:15:12.271216 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m07:15:12.271510 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory"} */
drop view if exists "postgres"."silver_staging"."stg_inventory__dbt_backup" cascade
[0m07:15:12.275940 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.232 seconds
[0m07:15:12.276992 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: COMMIT
[0m07:15:12.277297 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m07:15:12.277617 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: COMMIT
[0m07:15:12.296155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.750 seconds
[0m07:15:12.297474 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: COMMIT
[0m07:15:12.297911 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m07:15:12.298358 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: COMMIT
[0m07:15:12.364341 [debug] [Thread-3 (]: SQL status: COMMIT in 0.280 seconds
[0m07:15:12.366759 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_staging"."stg_customers__dbt_backup"
[0m07:15:12.367242 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m07:15:12.367529 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */
drop view if exists "postgres"."silver_staging"."stg_customers__dbt_backup" cascade
[0m07:15:12.801103 [debug] [Thread-2 (]: SQL status: COMMIT in 0.523 seconds
[0m07:15:12.801643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.503 seconds
[0m07:15:12.801965 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.434 seconds
[0m07:15:12.804075 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_staging"."stg_employees__dbt_backup"
[0m07:15:12.805967 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_staging"."stg_discount_rules__dbt_backup"
[0m07:15:12.807341 [debug] [Thread-3 (]: On model.retail_dbt.stg_customers: Close
[0m07:15:12.807996 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m07:15:12.808544 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m07:15:12.808959 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_employees"} */
drop view if exists "postgres"."silver_staging"."stg_employees__dbt_backup" cascade
[0m07:15:12.809499 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1898e180>]}
[0m07:15:12.809884 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_discount_rules"} */
drop view if exists "postgres"."silver_staging"."stg_discount_rules__dbt_backup" cascade
[0m07:15:12.810670 [info ] [Thread-3 (]: 5 of 23 OK created sql view model silver_staging.stg_customers ................. [[32mCREATE VIEW[0m in 3.89s]
[0m07:15:12.811381 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_customers
[0m07:15:12.812059 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_loyalty_programs
[0m07:15:12.812792 [info ] [Thread-3 (]: 9 of 23 START sql view model silver_staging.stg_loyalty_programs ............... [RUN]
[0m07:15:12.813148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_loyalty_programs)
[0m07:15:12.813473 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_loyalty_programs
[0m07:15:12.816070 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_loyalty_programs"
[0m07:15:12.816559 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_loyalty_programs
[0m07:15:12.819152 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_loyalty_programs"
[0m07:15:12.819618 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m07:15:12.819908 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: BEGIN
[0m07:15:12.820212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:13.058752 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.248 seconds
[0m07:15:13.060226 [debug] [Thread-2 (]: On model.retail_dbt.stg_employees: Close
[0m07:15:13.060927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14eb1d60>]}
[0m07:15:13.061515 [info ] [Thread-2 (]: 7 of 23 OK created sql view model silver_staging.stg_employees ................. [[32mCREATE VIEW[0m in 3.92s]
[0m07:15:13.062344 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_employees
[0m07:15:13.062786 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_payments
[0m07:15:13.063289 [info ] [Thread-2 (]: 10 of 23 START sql view model silver_staging.stg_payments ...................... [RUN]
[0m07:15:13.063704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_employees, now model.retail_dbt.stg_payments)
[0m07:15:13.064059 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_payments
[0m07:15:13.066780 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_payments"
[0m07:15:13.067281 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_payments
[0m07:15:13.071008 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_payments"
[0m07:15:13.071487 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m07:15:13.071793 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: BEGIN
[0m07:15:13.072085 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:13.082387 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.271 seconds
[0m07:15:13.083590 [debug] [Thread-1 (]: On model.retail_dbt.stg_discount_rules: Close
[0m07:15:13.084164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e187f4770>]}
[0m07:15:13.084658 [info ] [Thread-1 (]: 6 of 23 OK created sql view model silver_staging.stg_discount_rules ............ [[32mCREATE VIEW[0m in 4.17s]
[0m07:15:13.085153 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_discount_rules
[0m07:15:13.085485 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_pricing_history
[0m07:15:13.085933 [info ] [Thread-1 (]: 11 of 23 START sql view model silver_staging.stg_pricing_history ............... [RUN]
[0m07:15:13.086317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_discount_rules, now model.retail_dbt.stg_pricing_history)
[0m07:15:13.086638 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_pricing_history
[0m07:15:13.089268 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_pricing_history"
[0m07:15:13.089742 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_pricing_history
[0m07:15:13.092198 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_pricing_history"
[0m07:15:13.092657 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m07:15:13.092960 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: BEGIN
[0m07:15:13.093287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:13.468699 [debug] [Thread-4 (]: SQL status: DROP VIEW in 1.197 seconds
[0m07:15:13.470173 [debug] [Thread-4 (]: On model.retail_dbt.stg_inventory: Close
[0m07:15:13.470953 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14e8fe00>]}
[0m07:15:13.471578 [info ] [Thread-4 (]: 8 of 23 OK created sql view model silver_staging.stg_inventory ................. [[32mCREATE VIEW[0m in 4.11s]
[0m07:15:13.472569 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_inventory
[0m07:15:13.473125 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_products
[0m07:15:13.473628 [info ] [Thread-4 (]: 12 of 23 START sql view model silver_staging.stg_products ...................... [RUN]
[0m07:15:13.474114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory, now model.retail_dbt.stg_products)
[0m07:15:13.474454 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_products
[0m07:15:13.477376 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m07:15:13.477868 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_products
[0m07:15:13.480418 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m07:15:13.480916 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m07:15:13.481210 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: BEGIN
[0m07:15:13.481507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:15.029074 [debug] [Thread-3 (]: SQL status: BEGIN in 2.209 seconds
[0m07:15:15.029743 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m07:15:15.030323 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_loyalty_programs"} */

  create view "postgres"."silver_staging"."stg_loyalty_programs__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(loyalty_program_id AS text)) AS loyalty_program_id_txt,
        TRIM(CAST(name               AS text)) AS name_txt,
        TRIM(CAST(points_per_dollar  AS text)) AS points_per_dollar_txt
    FROM "postgres"."raw"."loyalty_programs"
),


filtered AS (
    SELECT *
    FROM src
    WHERE loyalty_program_id_txt IS NOT NULL AND loyalty_program_id_txt <> '' AND lower(loyalty_program_id_txt) NOT IN ('na','n/a')
      AND name_txt               IS NOT NULL AND name_txt               <> '' AND lower(name_txt)               NOT IN ('na','n/a')
      AND points_per_dollar_txt  IS NOT NULL AND points_per_dollar_txt  <> '' AND lower(points_per_dollar_txt)  NOT IN ('na','n/a')
),

typed AS (
    SELECT
        
        CASE
          WHEN loyalty_program_id_txt ~ '^\s*\d+\s*$' THEN loyalty_program_id_txt::integer
        END AS loyalty_program_id,

        name_txt AS name,

        CASE
          WHEN points_per_dollar_txt ~ '^\s*\d+\s*$' THEN points_per_dollar_txt::integer
        END AS points_per_dollar
    FROM filtered
)

SELECT loyalty_program_id, name, points_per_dollar
FROM typed
WHERE loyalty_program_id IS NOT NULL
  AND name IS NOT NULL
  AND points_per_dollar IS NOT NULL
  );
[0m07:15:15.180027 [debug] [Thread-2 (]: SQL status: BEGIN in 2.108 seconds
[0m07:15:15.180628 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m07:15:15.181126 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_payments"} */

  create view "postgres"."silver_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(payment_id AS text))                 AS payment_id_txt,
        TRIM(CAST(method     AS text))                 AS method,
        TRIM(CAST(status     AS text))                 AS status,
        TRIM(REPLACE(CAST(paid_at AS text), E'\r','')) AS paid_at_txt
    FROM "postgres"."raw"."payments"
),

typed AS (
    SELECT
        
        CASE WHEN payment_id_txt ~ '^\s*\d+\s*$' THEN payment_id_txt::integer END AS payment_id,
        method,
        status,

        
        CASE
          WHEN paid_at_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(paid_at_txt,'-','/'),'YYYY/FMMM/FMDD')
          ELSE NULL
        END AS paid_at
    FROM src
)

SELECT
    payment_id,
    method,
    status,
    paid_at
FROM typed
WHERE paid_at IS NOT NULL
  AND paid_at <= to_timestamp('2025/08/22','YYYY/MM/DD')
  );
[0m07:15:15.288033 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.257 seconds
[0m07:15:15.292037 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m07:15:15.292613 [debug] [Thread-1 (]: SQL status: BEGIN in 2.199 seconds
[0m07:15:15.293124 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_loyalty_programs"} */
alter table "postgres"."silver_staging"."stg_loyalty_programs__dbt_tmp" rename to "stg_loyalty_programs"
[0m07:15:15.293628 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m07:15:15.294241 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_pricing_history"} */

  create view "postgres"."silver_staging"."stg_pricing_history__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(history_id     AS text)) AS history_id_txt,
        TRIM(CAST(product_id     AS text)) AS product_id_txt,
        TRIM(CAST(price          AS text)) AS price_txt,
        TRIM(REPLACE(CAST(effective_date AS text), E'\r','')) AS effective_date_txt
    FROM "postgres"."raw"."pricing_history"
),

typed AS (
    SELECT
        
        CASE WHEN history_id_txt ~ '^\d+$'  THEN history_id_txt::integer  END AS history_id,
        CASE WHEN product_id_txt ~ '^\d+$'  THEN product_id_txt::integer  END AS product_id,

        
        CASE WHEN price_txt ~ '^-?\d+(\.\d+)?$' THEN price_txt::numeric END AS price,

        
        CASE
          WHEN effective_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(effective_date_txt, '-', '/'),'YYYY/FMMM/FMDD')::date
          ELSE NULL
        END AS effective_date
    FROM src
)

SELECT
    history_id,
    product_id,
    price,
    effective_date
FROM typed
WHERE price IS NOT NULL
  AND price > 0
  AND effective_date IS NOT NULL
  AND effective_date <= CURRENT_DATE
  );
[0m07:15:15.427910 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.246 seconds
[0m07:15:15.431772 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m07:15:15.432439 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_payments"} */
alter table "postgres"."silver_staging"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m07:15:15.551477 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.257 seconds
[0m07:15:15.553896 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: COMMIT
[0m07:15:15.554445 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.260 seconds
[0m07:15:15.554858 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m07:15:15.559019 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m07:15:15.559807 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: COMMIT
[0m07:15:15.560607 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_pricing_history"} */
alter table "postgres"."silver_staging"."stg_pricing_history__dbt_tmp" rename to "stg_pricing_history"
[0m07:15:15.653722 [debug] [Thread-4 (]: SQL status: BEGIN in 2.172 seconds
[0m07:15:15.654260 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m07:15:15.654771 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */

  create view "postgres"."silver_staging"."stg_products__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    TRIM(CAST(product_id  AS text)) AS product_id_txt,
    TRIM(CAST(name        AS text)) AS name_txt,
    TRIM(CAST(category_id AS text)) AS category_id_txt,
    TRIM(CAST(brand_id    AS text)) AS brand_id_txt,
    TRIM(CAST(supplier_id AS text)) AS supplier_id_txt,
    TRIM(CAST(price       AS text)) AS price_txt,
    TRIM(REPLACE(CAST(created_at AS text), E'\r','')) AS created_at_txt,
    -- 👇 loại \r,\n,\t và collapse space cho season
    TRIM(REGEXP_REPLACE(REPLACE(CAST(season AS text), E'\r',''), '\s+', ' ', 'g')) AS season_txt
  FROM "postgres"."raw"."products"
),

typed AS (
  SELECT
    CASE WHEN product_id_txt  ~ '^\d+$'          THEN product_id_txt::integer  END AS product_id,
    NULLIF(name_txt,'')                                 AS name,
    CASE WHEN category_id_txt ~ '^\d+$'          THEN category_id_txt::integer END AS category_id,
    CASE WHEN brand_id_txt    ~ '^\d+$'          THEN brand_id_txt::integer    END AS brand_id,
    CASE WHEN supplier_id_txt ~ '^\d+$'          THEN supplier_id_txt::integer END AS supplier_id,
    CASE WHEN price_txt       ~ '^\d+(\.\d+)?$'  THEN price_txt::numeric       END AS price,
    CASE
      WHEN created_at_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
      THEN to_timestamp(replace(created_at_txt,'-','/'),'YYYY/FMMM/FMDD')::date
    END AS created_at,

    
    CASE
      WHEN lower(season_txt) ~ '^spring$'                    THEN 'Spring'
      WHEN lower(season_txt) ~ '^summer$'                    THEN 'Summer'
      WHEN lower(season_txt) ~ '^(fall|autumn)$'             THEN 'Fall'
      WHEN lower(season_txt) ~ '^winter$'                    THEN 'Winter'
      WHEN lower(season_txt) ~ '^all[ _-]?year$'             THEN 'All Year'
      ELSE NULL
    END AS season
  FROM src
)

SELECT product_id, name, category_id, brand_id, supplier_id, price, created_at, season
FROM typed
WHERE price IS NOT NULL
  AND created_at IS NOT NULL
  AND created_at < '2025-08-22'
  );
[0m07:15:15.797097 [debug] [Thread-3 (]: SQL status: COMMIT in 0.236 seconds
[0m07:15:15.800124 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_staging"."stg_loyalty_programs__dbt_backup"
[0m07:15:15.800633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.239 seconds
[0m07:15:15.801248 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m07:15:15.802584 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: COMMIT
[0m07:15:15.803108 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_loyalty_programs"} */
drop view if exists "postgres"."silver_staging"."stg_loyalty_programs__dbt_backup" cascade
[0m07:15:15.803617 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m07:15:15.804165 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: COMMIT
[0m07:15:15.910158 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.255 seconds
[0m07:15:15.913505 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m07:15:15.913866 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
alter table "postgres"."silver_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m07:15:16.049606 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.245 seconds
[0m07:15:16.051114 [debug] [Thread-3 (]: On model.retail_dbt.stg_loyalty_programs: Close
[0m07:15:16.051922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14d93440>]}
[0m07:15:16.053541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.249 seconds
[0m07:15:16.056067 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_staging"."stg_pricing_history__dbt_backup"
[0m07:15:16.053005 [info ] [Thread-3 (]: 9 of 23 OK created sql view model silver_staging.stg_loyalty_programs .......... [[32mCREATE VIEW[0m in 3.24s]
[0m07:15:16.056844 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m07:15:16.057455 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_loyalty_programs
[0m07:15:16.057903 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_pricing_history"} */
drop view if exists "postgres"."silver_staging"."stg_pricing_history__dbt_backup" cascade
[0m07:15:16.058409 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_promotions
[0m07:15:16.059039 [info ] [Thread-3 (]: 13 of 23 START sql view model silver_staging.stg_promotions .................... [RUN]
[0m07:15:16.059552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_loyalty_programs, now model.retail_dbt.stg_promotions)
[0m07:15:16.059955 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_promotions
[0m07:15:16.062544 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_promotions"
[0m07:15:16.063002 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_promotions
[0m07:15:16.065654 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_promotions"
[0m07:15:16.066241 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m07:15:16.066603 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: BEGIN
[0m07:15:16.067013 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:16.157830 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.244 seconds
[0m07:15:16.158300 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.725 seconds
[0m07:15:16.159616 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: COMMIT
[0m07:15:16.160660 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: COMMIT
[0m07:15:16.161099 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m07:15:16.161511 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m07:15:16.161885 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: COMMIT
[0m07:15:16.162291 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: COMMIT
[0m07:15:16.306182 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.247 seconds
[0m07:15:16.307700 [debug] [Thread-1 (]: On model.retail_dbt.stg_pricing_history: Close
[0m07:15:16.308537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14d6d1c0>]}
[0m07:15:16.309299 [info ] [Thread-1 (]: 11 of 23 OK created sql view model silver_staging.stg_pricing_history .......... [[32mCREATE VIEW[0m in 3.22s]
[0m07:15:16.310023 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_pricing_history
[0m07:15:16.310462 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_purchase_orders
[0m07:15:16.310923 [info ] [Thread-1 (]: 14 of 23 START sql view model silver_staging.stg_purchase_orders ............... [RUN]
[0m07:15:16.311358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_pricing_history, now model.retail_dbt.stg_purchase_orders)
[0m07:15:16.311694 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_purchase_orders
[0m07:15:16.314550 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_purchase_orders"
[0m07:15:16.315030 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_purchase_orders
[0m07:15:16.319182 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_purchase_orders"
[0m07:15:16.319984 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m07:15:16.320398 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: BEGIN
[0m07:15:16.320803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:16.402871 [debug] [Thread-2 (]: SQL status: COMMIT in 0.240 seconds
[0m07:15:16.403354 [debug] [Thread-4 (]: SQL status: COMMIT in 0.241 seconds
[0m07:15:16.405606 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_staging"."stg_payments__dbt_backup"
[0m07:15:16.408148 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_staging"."stg_products__dbt_backup"
[0m07:15:16.408761 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m07:15:16.409294 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m07:15:16.409672 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_payments"} */
drop view if exists "postgres"."silver_staging"."stg_payments__dbt_backup" cascade
[0m07:15:16.410046 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */
drop view if exists "postgres"."silver_staging"."stg_products__dbt_backup" cascade
[0m07:15:16.635509 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.225 seconds
[0m07:15:16.637160 [debug] [Thread-2 (]: On model.retail_dbt.stg_payments: Close
[0m07:15:16.637841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14ec96d0>]}
[0m07:15:16.638715 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.228 seconds
[0m07:15:16.638404 [info ] [Thread-2 (]: 10 of 23 OK created sql view model silver_staging.stg_payments ................. [[32mCREATE VIEW[0m in 3.57s]
[0m07:15:16.640252 [debug] [Thread-4 (]: On model.retail_dbt.stg_products: Close
[0m07:15:16.640785 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_payments
[0m07:15:16.641236 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_returns
[0m07:15:16.641730 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14d6c200>]}
[0m07:15:16.642213 [info ] [Thread-2 (]: 15 of 23 START sql view model silver_staging.stg_returns ....................... [RUN]
[0m07:15:16.642986 [info ] [Thread-4 (]: 12 of 23 OK created sql view model silver_staging.stg_products ................. [[32mCREATE VIEW[0m in 3.17s]
[0m07:15:16.643453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_payments, now model.retail_dbt.stg_returns)
[0m07:15:16.644058 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_products
[0m07:15:16.644426 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_returns
[0m07:15:16.644842 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_sales_items
[0m07:15:16.648352 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_returns"
[0m07:15:16.648823 [info ] [Thread-4 (]: 16 of 23 START sql view model silver_staging.stg_sales_items ................... [RUN]
[0m07:15:16.649450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.stg_sales_items)
[0m07:15:16.649870 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_sales_items
[0m07:15:16.652748 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_sales_items"
[0m07:15:16.653243 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_returns
[0m07:15:16.656252 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_returns"
[0m07:15:16.656712 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_sales_items
[0m07:15:16.659345 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_sales_items"
[0m07:15:16.659990 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m07:15:16.660400 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: BEGIN
[0m07:15:16.660787 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m07:15:16.661096 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:16.661480 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: BEGIN
[0m07:15:16.661975 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:18.701710 [debug] [Thread-3 (]: SQL status: BEGIN in 2.635 seconds
[0m07:15:18.702149 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m07:15:18.702481 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_promotions"} */

  create view "postgres"."silver_staging"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(promotion_id AS text))                       AS promotion_id_txt,
        TRIM(CAST(name AS text))                               AS name_txt,
        TRIM(REPLACE(CAST(start_date AS text), E'\r',''))      AS start_date_txt,
        TRIM(REPLACE(CAST(end_date   AS text), E'\r',''))      AS end_date_txt
    FROM "postgres"."raw"."promotions"
),

typed AS (
    SELECT
        
        CASE WHEN promotion_id_txt ~ '^\d+$' THEN promotion_id_txt::int END AS promotion_id,

        
        NULLIF(NULLIF(lower(name_txt),'na'),'') AS name_clean,

        
        CASE
          WHEN start_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(start_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS start_date,

        CASE
          WHEN end_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(end_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS end_date
    FROM src
)

SELECT
    promotion_id,
    initcap(name_clean) AS name,
    start_date,
    end_date
FROM typed
WHERE promotion_id IS NOT NULL
  AND name_clean  IS NOT NULL
  AND start_date  IS NOT NULL
  AND end_date    IS NOT NULL
  AND start_date  < end_date
  );
[0m07:15:18.791230 [debug] [Thread-1 (]: SQL status: BEGIN in 2.470 seconds
[0m07:15:18.791692 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m07:15:18.792061 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_purchase_orders"} */

  create view "postgres"."silver_staging"."stg_purchase_orders__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(order_id AS text))       AS order_id_txt,
        TRIM(CAST(supplier_id AS text))    AS supplier_id_txt,
        TRIM(CAST(order_date AS text))     AS order_date_txt,
        TRIM(CAST(status AS text))         AS status_txt
    FROM "postgres"."raw"."purchase_orders"
),

typed AS (
    SELECT
        CASE WHEN order_id_txt ~ '^\d+$' THEN order_id_txt::int END        AS order_id,
        CASE WHEN supplier_id_txt ~ '^\d+$' THEN supplier_id_txt::int END  AS supplier_id,

        CASE
          WHEN order_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(order_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS order_date,

        NULLIF(NULLIF(lower(status_txt),'na'),'') AS status_clean
    FROM src
)

SELECT
    order_id,
    supplier_id,
    order_date,
    initcap(status_clean) AS status
FROM typed
WHERE order_id IS NOT NULL
  AND supplier_id IS NOT NULL
  AND order_date IS NOT NULL
  AND status_clean IS NOT NULL
  AND order_date <= DATE '2025-08-22'
  );
[0m07:15:19.058365 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.355 seconds
[0m07:15:19.062072 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m07:15:19.062435 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_promotions"} */
alter table "postgres"."silver_staging"."stg_promotions__dbt_tmp" rename to "stg_promotions"
[0m07:15:19.105869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.313 seconds
[0m07:15:19.108731 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m07:15:19.109089 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_purchase_orders"} */
alter table "postgres"."silver_staging"."stg_purchase_orders__dbt_tmp" rename to "stg_purchase_orders"
[0m07:15:19.408014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.298 seconds
[0m07:15:19.408494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.346 seconds
[0m07:15:19.409572 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: COMMIT
[0m07:15:19.410504 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: COMMIT
[0m07:15:19.410863 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m07:15:19.411235 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m07:15:19.411589 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: COMMIT
[0m07:15:19.411996 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: COMMIT
[0m07:15:19.706531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.294 seconds
[0m07:15:19.707026 [debug] [Thread-4 (]: SQL status: BEGIN in 3.045 seconds
[0m07:15:19.709197 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_staging"."stg_purchase_orders__dbt_backup"
[0m07:15:19.709591 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m07:15:19.710138 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m07:15:19.710613 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_items"} */

  create view "postgres"."silver_staging"."stg_sales_items__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."sales_items"
),

final as (
    select
        
        cast(item_id as int) as item_id,
        cast(transaction_id as int) as transaction_id,
        cast(product_id as int) as product_id,
        

        cast(quantity as int) as quantity,
        
        cast(unit_price as decimal(10,2)) as unit_price,
        cast(discount as decimal(10,2)) as discount,
        cast(tax as decimal(10,2)) as tax,
        
        cast(unit_price as decimal(10,2)) * cast(quantity as int) as gross_amount,
        (cast(unit_price as decimal(10,2)) * cast(quantity as int)) - 
         cast(discount as decimal(10,2)) + 
         cast(tax as decimal(10,2)) as net_amount,
        
        case 
            when cast(quantity as int) > 0 and cast(unit_price as decimal(10,2)) < 0 then 'invalid_positive_qty_negative_price'
            when cast(discount as decimal(10,2)) > cast(unit_price as decimal(10,2)) * cast(quantity as int) then 'discount_exceeds_gross'
            when cast(discount as decimal(10,2)) < 0 then 'negative_discount'
            when cast(tax as decimal(10,2)) < 0 then 'negative_tax'
            when cast(quantity as int) < 0 then 'negative_quantity'
            else 'valid'
        end as business_validation_flag
        
    from source_data
    
    -- Basic validation + Business logic validation
    where item_id is not null
        and transaction_id is not null  
        and product_id is not null
        and quantity is not null
        and unit_price is not null
        and discount is not null
        and tax is not null
        -- Business rules
        and cast(quantity as int) >= 0  -- No negative quantities
        and cast(discount as decimal(10,2)) >= 0  -- No negative discounts
        and cast(tax as decimal(10,2)) >= 0  -- No negative tax
        and cast(discount as decimal(10,2)) <= cast(unit_price as decimal(10,2)) * cast(quantity as int)  -- Discount can't exceed gross amount
        -- Allow unit_price = 0 for free items/samples
        and not (cast(quantity as int) > 0 and cast(unit_price as decimal(10,2)) < 0)  -- If quantity > 0, price can't be negative
)

select * from final
  );
[0m07:15:19.711050 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_purchase_orders"} */
drop view if exists "postgres"."silver_staging"."stg_purchase_orders__dbt_backup" cascade
[0m07:15:19.750322 [debug] [Thread-3 (]: SQL status: COMMIT in 0.338 seconds
[0m07:15:19.752361 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_staging"."stg_promotions__dbt_backup"
[0m07:15:19.753038 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m07:15:19.753329 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_promotions"} */
drop view if exists "postgres"."silver_staging"."stg_promotions__dbt_backup" cascade
[0m07:15:19.987977 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.276 seconds
[0m07:15:19.989167 [debug] [Thread-1 (]: On model.retail_dbt.stg_purchase_orders: Close
[0m07:15:19.989784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14dd2e10>]}
[0m07:15:19.990296 [info ] [Thread-1 (]: 14 of 23 OK created sql view model silver_staging.stg_purchase_orders .......... [[32mCREATE VIEW[0m in 3.68s]
[0m07:15:19.990806 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_purchase_orders
[0m07:15:19.991144 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_sales_transactions
[0m07:15:19.991782 [info ] [Thread-1 (]: 17 of 23 START sql view model silver_staging.stg_sales_transactions ............ [RUN]
[0m07:15:19.992310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_purchase_orders, now model.retail_dbt.stg_sales_transactions)
[0m07:15:19.992629 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_sales_transactions
[0m07:15:19.995268 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_sales_transactions"
[0m07:15:19.995760 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_sales_transactions
[0m07:15:19.998363 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_sales_transactions"
[0m07:15:19.998847 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m07:15:19.999233 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: BEGIN
[0m07:15:19.999535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:20.042222 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.331 seconds
[0m07:15:20.044928 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m07:15:20.045247 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_items"} */
alter table "postgres"."silver_staging"."stg_sales_items__dbt_tmp" rename to "stg_sales_items"
[0m07:15:20.083898 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.330 seconds
[0m07:15:20.085498 [debug] [Thread-3 (]: On model.retail_dbt.stg_promotions: Close
[0m07:15:20.086244 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14de4380>]}
[0m07:15:20.086904 [info ] [Thread-3 (]: 13 of 23 OK created sql view model silver_staging.stg_promotions ............... [[32mCREATE VIEW[0m in 4.03s]
[0m07:15:20.087515 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_promotions
[0m07:15:20.087941 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_shipments
[0m07:15:20.088376 [info ] [Thread-3 (]: 18 of 23 START sql view model silver_staging.stg_shipments ..................... [RUN]
[0m07:15:20.088752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_promotions, now model.retail_dbt.stg_shipments)
[0m07:15:20.089260 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_shipments
[0m07:15:20.093506 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_shipments"
[0m07:15:20.094050 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_shipments
[0m07:15:20.097172 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_shipments"
[0m07:15:20.097682 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m07:15:20.097988 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: BEGIN
[0m07:15:20.098268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:20.390998 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.345 seconds
[0m07:15:20.392238 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: COMMIT
[0m07:15:20.392570 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m07:15:20.392863 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: COMMIT
[0m07:15:20.668804 [debug] [Thread-4 (]: SQL status: COMMIT in 0.276 seconds
[0m07:15:20.671288 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_staging"."stg_sales_items__dbt_backup"
[0m07:15:20.671738 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m07:15:20.672089 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_items"} */
drop view if exists "postgres"."silver_staging"."stg_sales_items__dbt_backup" cascade
[0m07:15:20.768617 [debug] [Thread-2 (]: SQL status: BEGIN in 4.107 seconds
[0m07:15:20.769086 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m07:15:20.769411 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_returns"} */

  create view "postgres"."silver_staging"."stg_returns__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(return_id   AS text))                               AS return_id_txt,
        TRIM(CAST(item_id     AS text))                               AS item_id_txt,
    
        TRIM(REGEXP_REPLACE(REPLACE(CAST(reason AS text), E'\r',''), '\s+', ' ', 'g')) AS reason_txt,
        
        TRIM(REPLACE(CAST(return_date AS text), E'\r',''))            AS return_date_txt
    FROM "postgres"."raw"."returns"
),

typed AS (
    SELECT
        CASE WHEN return_id_txt ~ '^\d+$' THEN return_id_txt::int END AS return_id,
        CASE WHEN item_id_txt   ~ '^\d+$' THEN item_id_txt::int   END AS item_id,

        CASE
          WHEN reason_txt IS NULL OR reason_txt = '' THEN NULL
          WHEN lower(reason_txt) IN ('na','n/a') THEN NULL
          ELSE reason_txt
        END AS reason,

        CASE
          WHEN return_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(return_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS return_date
    FROM src
)

SELECT
    return_id,
    item_id,
    reason,
    return_date
FROM typed
WHERE return_id   IS NOT NULL
  AND item_id     IS NOT NULL
  AND reason      IS NOT NULL
  AND return_date IS NOT NULL
  AND return_date <= DATE '2025-08-22'
  );
[0m07:15:21.033336 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.263 seconds
[0m07:15:21.036596 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m07:15:21.037000 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_returns"} */
alter table "postgres"."silver_staging"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m07:15:21.289973 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.617 seconds
[0m07:15:21.291263 [debug] [Thread-4 (]: On model.retail_dbt.stg_sales_items: Close
[0m07:15:21.291978 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14c58e00>]}
[0m07:15:21.292527 [info ] [Thread-4 (]: 16 of 23 OK created sql view model silver_staging.stg_sales_items .............. [[32mCREATE VIEW[0m in 4.64s]
[0m07:15:21.293086 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_sales_items
[0m07:15:21.293480 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_stock_movements
[0m07:15:21.294065 [info ] [Thread-4 (]: 19 of 23 START sql view model silver_staging.stg_stock_movements ............... [RUN]
[0m07:15:21.294633 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_sales_items, now model.retail_dbt.stg_stock_movements)
[0m07:15:21.295033 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_stock_movements
[0m07:15:21.298972 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_stock_movements"
[0m07:15:21.299826 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_stock_movements
[0m07:15:21.302925 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_stock_movements"
[0m07:15:21.303425 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m07:15:21.303755 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: BEGIN
[0m07:15:21.304063 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:21.325220 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.288 seconds
[0m07:15:21.326529 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: COMMIT
[0m07:15:21.326891 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m07:15:21.327198 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: COMMIT
[0m07:15:21.609479 [debug] [Thread-2 (]: SQL status: COMMIT in 0.282 seconds
[0m07:15:21.611942 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_staging"."stg_returns__dbt_backup"
[0m07:15:21.612447 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m07:15:21.612792 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_returns"} */
drop view if exists "postgres"."silver_staging"."stg_returns__dbt_backup" cascade
[0m07:15:21.930249 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.317 seconds
[0m07:15:21.931622 [debug] [Thread-2 (]: On model.retail_dbt.stg_returns: Close
[0m07:15:21.932432 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14cdb800>]}
[0m07:15:21.933004 [info ] [Thread-2 (]: 15 of 23 OK created sql view model silver_staging.stg_returns .................. [[32mCREATE VIEW[0m in 5.29s]
[0m07:15:21.933551 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_returns
[0m07:15:21.933934 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_store_visits
[0m07:15:21.934463 [info ] [Thread-2 (]: 20 of 23 START sql view model silver_staging.stg_store_visits .................. [RUN]
[0m07:15:21.934878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_returns, now model.retail_dbt.stg_store_visits)
[0m07:15:21.935247 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_store_visits
[0m07:15:21.939222 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_store_visits"
[0m07:15:21.939780 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_store_visits
[0m07:15:21.942848 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_store_visits"
[0m07:15:21.943386 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m07:15:21.943724 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: BEGIN
[0m07:15:21.944073 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:22.671578 [debug] [Thread-3 (]: SQL status: BEGIN in 2.573 seconds
[0m07:15:22.672089 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m07:15:22.672464 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_shipments"} */

  create view "postgres"."silver_staging"."stg_shipments__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."shipments"
),

final as (
    select
        cast(shipment_id as int) as shipment_id,
        cast(order_id as int) as order_id,
        cast(store_id as int) as store_id,
        cast(shipped_date as timestamp) as shipped_date,
        cast(received_date as timestamp) as received_date
    from source_data
    where shipment_id is not null
        and order_id is not null
        and store_id is not null
        and shipped_date is not null
        and received_date is not null
        and shipped_date < received_date
        and shipped_date <= '2025-08-22 00:00:00'
        and received_date <= '2025-08-22 00:00:00'
        and shipment_id != 'N/A'
        and order_id != 'N/A'
        and store_id != 'N/A'
        and shipped_date != 'N/A'
        and received_date != 'N/A'
)

select * from final
  );
[0m07:15:22.944044 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.271 seconds
[0m07:15:22.947125 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m07:15:22.947484 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_shipments"} */
alter table "postgres"."silver_staging"."stg_shipments__dbt_tmp" rename to "stg_shipments"
[0m07:15:23.238906 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.291 seconds
[0m07:15:23.240278 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: COMMIT
[0m07:15:23.240619 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m07:15:23.241107 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: COMMIT
[0m07:15:23.458163 [debug] [Thread-4 (]: SQL status: BEGIN in 2.154 seconds
[0m07:15:23.458711 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m07:15:23.459107 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stock_movements"} */

  create view "postgres"."silver_staging"."stg_stock_movements__dbt_tmp"
    
    
  as (
    


WITH src AS (
  SELECT
    TRIM(CAST(movement_id   AS text)) AS movement_id_txt,
    TRIM(CAST(product_id    AS text)) AS product_id_txt,
    TRIM(CAST(store_id      AS text)) AS store_id_txt,
    TRIM(CAST(movement_type AS text)) AS movement_type_txt,
    TRIM(CAST(quantity      AS text)) AS quantity_txt,
    TRIM(REPLACE(CAST(movement_date AS text), E'\r','')) AS movement_date_txt
  FROM "postgres"."raw"."stock_movements"
),


typed AS (
  SELECT
    CASE WHEN movement_id_txt  ~ '^\d+$' THEN movement_id_txt::int  END AS movement_id,
    CASE WHEN product_id_txt   ~ '^\d+$' THEN product_id_txt::int   END AS product_id,
    CASE WHEN store_id_txt     ~ '^\d+$' THEN store_id_txt::int     END AS store_id,

    CASE
      WHEN upper(TRIM(movement_type_txt)) IN ('IN','OUT','TRANSFER')
      THEN upper(TRIM(movement_type_txt))
      ELSE NULL
    END AS movement_type,

    CASE
      WHEN quantity_txt IS NULL OR quantity_txt = '' THEN NULL
      WHEN lower(quantity_txt) IN ('unknown','na','n/a') THEN NULL
      WHEN quantity_txt ~ '^-?\d+$' THEN quantity_txt::int
      ELSE NULL
    END AS quantity,

  
    CASE
      WHEN movement_date_txt ~ '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
      THEN to_date(movement_date_txt,'YYYY-MM-DD')
    END AS movement_date_raw,

    movement_date_txt
  FROM src
),


dated AS (
  SELECT
    movement_id, product_id, store_id, movement_type, quantity,
    CASE
      WHEN movement_date_raw IS NOT NULL
       AND to_char(movement_date_raw,'YYYY-MM-DD') = movement_date_txt
      THEN movement_date_raw
    END AS movement_date
  FROM typed
)

SELECT
  movement_id,
  product_id,
  store_id,
  movement_type,
  quantity,
  movement_date
FROM dated
WHERE movement_id   IS NOT NULL AND movement_id   > 0
  AND product_id    IS NOT NULL AND product_id    > 0
  AND store_id      IS NOT NULL AND store_id      > 0
  AND movement_type IS NOT NULL
  AND quantity      IS NOT NULL AND quantity      > 0
  AND movement_date IS NOT NULL
  AND movement_date <= DATE '2025-08-22'
  );
[0m07:15:23.502496 [debug] [Thread-1 (]: SQL status: BEGIN in 3.503 seconds
[0m07:15:23.502908 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m07:15:23.503305 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_transactions"} */

  create view "postgres"."silver_staging"."stg_sales_transactions__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."sales_transactions"
),

final as (
    select
        cast(transaction_id as int) as transaction_id,
        cast(customer_id as int) as customer_id,
        cast(store_id as int) as store_id,
        cast(employee_id as int) as employee_id,
        cast(transaction_date as timestamp) as transaction_date,
        case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end as total_amount,
        cast(payment_id as int) as payment_id
    from source_data
    where transaction_id is not null
        and customer_id is not null
        and store_id is not null
        and employee_id is not null
        and transaction_date is not null
        and case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end is not null
        and payment_id is not null
        and case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end != 0
        and transaction_id != 'N/A'
        and customer_id != 'N/A'
        and store_id != 'N/A'
        and employee_id != 'N/A'
        and payment_id != 'N/A'
)

select * from final
  );
[0m07:15:23.538575 [debug] [Thread-3 (]: SQL status: COMMIT in 0.297 seconds
[0m07:15:23.540885 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_staging"."stg_shipments__dbt_backup"
[0m07:15:23.541380 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m07:15:23.541752 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_shipments"} */
drop view if exists "postgres"."silver_staging"."stg_shipments__dbt_backup" cascade
[0m07:15:23.701223 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.242 seconds
[0m07:15:23.704331 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m07:15:23.704684 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stock_movements"} */
alter table "postgres"."silver_staging"."stg_stock_movements__dbt_tmp" rename to "stg_stock_movements"
[0m07:15:23.797708 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.294 seconds
[0m07:15:23.800538 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m07:15:23.800892 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_transactions"} */
alter table "postgres"."silver_staging"."stg_sales_transactions__dbt_tmp" rename to "stg_sales_transactions"
[0m07:15:23.824066 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.282 seconds
[0m07:15:23.825528 [debug] [Thread-3 (]: On model.retail_dbt.stg_shipments: Close
[0m07:15:23.826259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14d5aba0>]}
[0m07:15:23.826899 [info ] [Thread-3 (]: 18 of 23 OK created sql view model silver_staging.stg_shipments ................ [[32mCREATE VIEW[0m in 3.74s]
[0m07:15:23.827651 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_shipments
[0m07:15:23.828215 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m07:15:23.828784 [info ] [Thread-3 (]: 21 of 23 START sql view model silver_staging.stg_stores ........................ [RUN]
[0m07:15:23.829283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_shipments, now model.retail_dbt.stg_stores)
[0m07:15:23.829729 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m07:15:23.832515 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m07:15:23.833039 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m07:15:23.836865 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m07:15:23.837435 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m07:15:23.837788 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: BEGIN
[0m07:15:23.838087 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:23.943286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.238 seconds
[0m07:15:23.944608 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: COMMIT
[0m07:15:23.944976 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m07:15:23.945327 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: COMMIT
[0m07:15:24.073440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.272 seconds
[0m07:15:24.074930 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: COMMIT
[0m07:15:24.075373 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m07:15:24.075883 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: COMMIT
[0m07:15:24.134156 [debug] [Thread-2 (]: SQL status: BEGIN in 2.190 seconds
[0m07:15:24.134693 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m07:15:24.135066 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_store_visits"} */

  create view "postgres"."silver_staging"."stg_store_visits__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    TRIM(CAST(visit_id    AS text)) AS visit_id_txt,
    TRIM(CAST(customer_id AS text)) AS customer_id_txt,
    TRIM(CAST(store_id    AS text)) AS store_id_txt,
    TRIM(REPLACE(CAST(visit_date AS text), E'\r','')) AS visit_date_txt
  FROM "postgres"."raw"."store_visits"
),

typed AS (
  SELECT
    
    CASE WHEN visit_id_txt    ~ '^\d+$' THEN visit_id_txt::int    END AS visit_id,
    CASE WHEN customer_id_txt ~ '^\d+$' THEN customer_id_txt::int END AS customer_id,
    CASE WHEN store_id_txt    ~ '^\d+$' THEN store_id_txt::int    END AS store_id,

    
    CASE
      WHEN visit_date_txt ~ '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
      THEN to_date(visit_date_txt,'YYYY-MM-DD')
    END AS visit_date_raw,

    visit_date_txt
  FROM src
),


validated AS (
  SELECT
    visit_id, customer_id, store_id,
    CASE
      WHEN visit_date_raw IS NOT NULL
       AND to_char(visit_date_raw,'YYYY-MM-DD') = visit_date_txt
      THEN visit_date_raw
    END AS visit_date
  FROM typed
)

SELECT
  visit_id,
  customer_id,
  store_id,
  visit_date
FROM validated
WHERE visit_id    IS NOT NULL
  AND customer_id IS NOT NULL
  AND store_id    IS NOT NULL
  AND visit_date  IS NOT NULL
  AND visit_date <= DATE '2025-08-22'
  );
[0m07:15:24.170571 [debug] [Thread-4 (]: SQL status: COMMIT in 0.225 seconds
[0m07:15:24.173250 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_staging"."stg_stock_movements__dbt_backup"
[0m07:15:24.173844 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m07:15:24.174245 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stock_movements"} */
drop view if exists "postgres"."silver_staging"."stg_stock_movements__dbt_backup" cascade
[0m07:15:24.333510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.257 seconds
[0m07:15:24.335945 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_staging"."stg_sales_transactions__dbt_backup"
[0m07:15:24.336512 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m07:15:24.336867 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_transactions"} */
drop view if exists "postgres"."silver_staging"."stg_sales_transactions__dbt_backup" cascade
[0m07:15:24.377338 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.242 seconds
[0m07:15:24.380448 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m07:15:24.380853 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_store_visits"} */
alter table "postgres"."silver_staging"."stg_store_visits__dbt_tmp" rename to "stg_store_visits"
[0m07:15:24.397032 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.222 seconds
[0m07:15:24.398475 [debug] [Thread-4 (]: On model.retail_dbt.stg_stock_movements: Close
[0m07:15:24.399180 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14b46480>]}
[0m07:15:24.399794 [info ] [Thread-4 (]: 19 of 23 OK created sql view model silver_staging.stg_stock_movements .......... [[32mCREATE VIEW[0m in 3.10s]
[0m07:15:24.400572 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_stock_movements
[0m07:15:24.401177 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_suppliers
[0m07:15:24.401759 [info ] [Thread-4 (]: 22 of 23 START sql view model silver_staging.stg_suppliers ..................... [RUN]
[0m07:15:24.402285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stock_movements, now model.retail_dbt.stg_suppliers)
[0m07:15:24.402695 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_suppliers
[0m07:15:24.405739 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_suppliers"
[0m07:15:24.406245 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_suppliers
[0m07:15:24.409099 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_suppliers"
[0m07:15:24.409595 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m07:15:24.409907 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: BEGIN
[0m07:15:24.410208 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:24.594971 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.258 seconds
[0m07:15:24.596453 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_transactions: Close
[0m07:15:24.597194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14c87f20>]}
[0m07:15:24.597786 [info ] [Thread-1 (]: 17 of 23 OK created sql view model silver_staging.stg_sales_transactions ....... [[32mCREATE VIEW[0m in 4.60s]
[0m07:15:24.598389 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_sales_transactions
[0m07:15:24.598796 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_tax_rules
[0m07:15:24.599302 [info ] [Thread-1 (]: 23 of 23 START sql view model silver_staging.stg_tax_rules ..................... [RUN]
[0m07:15:24.599750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_sales_transactions, now model.retail_dbt.stg_tax_rules)
[0m07:15:24.600175 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_tax_rules
[0m07:15:24.602532 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_tax_rules"
[0m07:15:24.603006 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_tax_rules
[0m07:15:24.606358 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_tax_rules"
[0m07:15:24.606831 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m07:15:24.607114 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: BEGIN
[0m07:15:24.607491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:24.642051 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.261 seconds
[0m07:15:24.643690 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: COMMIT
[0m07:15:24.644162 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m07:15:24.644585 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: COMMIT
[0m07:15:24.870107 [debug] [Thread-2 (]: SQL status: COMMIT in 0.225 seconds
[0m07:15:24.872801 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_staging"."stg_store_visits__dbt_backup"
[0m07:15:24.873398 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m07:15:24.873852 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_store_visits"} */
drop view if exists "postgres"."silver_staging"."stg_store_visits__dbt_backup" cascade
[0m07:15:25.108510 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.234 seconds
[0m07:15:25.110011 [debug] [Thread-2 (]: On model.retail_dbt.stg_store_visits: Close
[0m07:15:25.110848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e18997fe0>]}
[0m07:15:25.111467 [info ] [Thread-2 (]: 20 of 23 OK created sql view model silver_staging.stg_store_visits ............. [[32mCREATE VIEW[0m in 3.18s]
[0m07:15:25.112093 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_store_visits
[0m07:15:26.203367 [debug] [Thread-3 (]: SQL status: BEGIN in 2.365 seconds
[0m07:15:26.204025 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m07:15:26.204591 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */

  create view "postgres"."silver_staging"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    store_id::int      AS store_id,
    NULLIF(TRIM(name), '')     AS name,
    NULLIF(TRIM(location), '') AS location,
    manager_id::int    AS manager_id
  FROM raw.stores
)

SELECT
  store_id,
  name,
  location,
  manager_id
FROM src
  );
[0m07:15:26.437033 [debug] [Thread-4 (]: SQL status: BEGIN in 2.027 seconds
[0m07:15:26.437744 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m07:15:26.438424 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_suppliers"} */

  create view "postgres"."silver_staging"."stg_suppliers__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        supplier_id::int                               AS supplier_id,
        NULLIF(TRIM(name), '')                         AS name,
        NULLIF(TRIM(contact_info), '')                 AS contact_info
    FROM raw.suppliers
)

SELECT
    supplier_id,
    name,
    contact_info
FROM src
  );
[0m07:15:26.461219 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.256 seconds
[0m07:15:26.464492 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m07:15:26.464922 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
alter table "postgres"."silver_staging"."stg_stores__dbt_tmp" rename to "stg_stores"
[0m07:15:26.664160 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.225 seconds
[0m07:15:26.667278 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m07:15:26.667607 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_suppliers"} */
alter table "postgres"."silver_staging"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m07:15:26.727988 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.263 seconds
[0m07:15:26.729559 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: COMMIT
[0m07:15:26.730010 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m07:15:26.730407 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: COMMIT
[0m07:15:26.891035 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.223 seconds
[0m07:15:26.892231 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: COMMIT
[0m07:15:26.892546 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m07:15:26.892836 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: COMMIT
[0m07:15:26.986357 [debug] [Thread-3 (]: SQL status: COMMIT in 0.256 seconds
[0m07:15:26.988751 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_staging"."stg_stores__dbt_backup"
[0m07:15:26.989235 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m07:15:26.989525 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */
drop view if exists "postgres"."silver_staging"."stg_stores__dbt_backup" cascade
[0m07:15:27.117309 [debug] [Thread-4 (]: SQL status: COMMIT in 0.224 seconds
[0m07:15:27.119578 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_staging"."stg_suppliers__dbt_backup"
[0m07:15:27.120093 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m07:15:27.120416 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_suppliers"} */
drop view if exists "postgres"."silver_staging"."stg_suppliers__dbt_backup" cascade
[0m07:15:27.120783 [debug] [Thread-1 (]: SQL status: BEGIN in 2.513 seconds
[0m07:15:27.121129 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m07:15:27.121462 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_tax_rules"} */

  create view "postgres"."silver_staging"."stg_tax_rules__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        tax_id::int                                    AS tax_id,
        product_id::int                                AS product_id,
        NULLIF(NULLIF(NULLIF(LOWER(TRIM(tax_rate)), 'none'), 'n/a'), '') AS tax_rate_clean,
        TRIM(region)                                   AS region
    FROM raw.tax_rules
),

typed AS (
    SELECT
        tax_id,
        product_id,
        CASE
            WHEN tax_rate_clean ~ '^[0-9]+(\.[0-9]+)?$'
                 AND tax_rate_clean::numeric > 0
            THEN tax_rate_clean::numeric
        END AS tax_rate,
        region
    FROM src
)

SELECT *
FROM typed
WHERE tax_rate IS NOT NULL
  );
[0m07:15:27.260540 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.271 seconds
[0m07:15:27.261821 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m07:15:27.262488 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14b66d80>]}
[0m07:15:27.263160 [info ] [Thread-3 (]: 21 of 23 OK created sql view model silver_staging.stg_stores ................... [[32mCREATE VIEW[0m in 3.43s]
[0m07:15:27.263952 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m07:15:27.344810 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.224 seconds
[0m07:15:27.346004 [debug] [Thread-4 (]: On model.retail_dbt.stg_suppliers: Close
[0m07:15:27.346587 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14b78d10>]}
[0m07:15:27.347122 [info ] [Thread-4 (]: 22 of 23 OK created sql view model silver_staging.stg_suppliers ................ [[32mCREATE VIEW[0m in 2.94s]
[0m07:15:27.347682 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_suppliers
[0m07:15:27.350841 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.229 seconds
[0m07:15:27.353498 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m07:15:27.353802 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_tax_rules"} */
alter table "postgres"."silver_staging"."stg_tax_rules__dbt_tmp" rename to "stg_tax_rules"
[0m07:15:27.579207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.225 seconds
[0m07:15:27.580565 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: COMMIT
[0m07:15:27.580967 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m07:15:27.581263 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: COMMIT
[0m07:15:27.809129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.227 seconds
[0m07:15:27.811252 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_staging"."stg_tax_rules__dbt_backup"
[0m07:15:27.811719 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m07:15:27.812030 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_tax_rules"} */
drop view if exists "postgres"."silver_staging"."stg_tax_rules__dbt_backup" cascade
[0m07:15:28.046850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.234 seconds
[0m07:15:28.048119 [debug] [Thread-1 (]: On model.retail_dbt.stg_tax_rules: Close
[0m07:15:28.048775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb76a006-1b04-422c-944e-1b9d50bea504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e14bd1520>]}
[0m07:15:33.534491 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m07:15:33.535320 [info ] [Thread-1 (]: 23 of 23 OK created sql view model silver_staging.stg_tax_rules ................ [[32mCREATE VIEW[0m in 3.45s]
[0m07:15:33.535885 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_tax_rules
[0m07:15:33.537714 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:33.538037 [debug] [MainThread]: On master: BEGIN
[0m07:15:33.538349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:15:37.581033 [debug] [MainThread]: SQL status: BEGIN in 4.043 seconds
[0m07:15:37.581524 [debug] [MainThread]: On master: COMMIT
[0m07:15:37.581821 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:37.582112 [debug] [MainThread]: On master: COMMIT
[0m07:15:37.803912 [debug] [MainThread]: SQL status: COMMIT in 0.221 seconds
[0m07:15:37.804521 [debug] [MainThread]: On master: Close
[0m07:15:37.805071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:37.805324 [debug] [MainThread]: Connection 'model.retail_dbt.stg_stores' was properly closed.
[0m07:15:37.805596 [debug] [MainThread]: Connection 'model.retail_dbt.stg_tax_rules' was properly closed.
[0m07:15:37.805862 [debug] [MainThread]: Connection 'model.retail_dbt.stg_suppliers' was properly closed.
[0m07:15:37.806120 [debug] [MainThread]: Connection 'model.retail_dbt.stg_store_visits' was properly closed.
[0m07:15:37.806547 [info ] [MainThread]: 
[0m07:15:37.806879 [info ] [MainThread]: Finished running 23 view models in 0 hours 0 minutes and 47.54 seconds (47.54s).
[0m07:15:37.809698 [debug] [MainThread]: Command end result
[0m07:15:37.958515 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:15:37.961119 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:15:37.965882 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:15:37.966185 [info ] [MainThread]: 
[0m07:15:37.966531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:15:37.966800 [info ] [MainThread]: 
[0m07:15:37.967110 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m07:15:37.967815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 45.602123, "process_in_blocks": "8784", "process_kernel_time": 0.431146, "process_mem_max_rss": "143336", "process_out_blocks": "12504", "process_user_time": 3.441037}
[0m07:15:37.968202 [debug] [MainThread]: Command `dbt run` succeeded at 07:15:37.968132 after 45.60 seconds
[0m07:15:37.968482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1c139a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1bfce390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e1b3e7200>]}
[0m07:15:37.968761 [debug] [MainThread]: Flushing usage events
[0m07:15:39.170756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:15:41.868552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f5681250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f362d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f32e5760>]}


============================== 07:15:41.874830 | 7f6baf91-6edb-4142-82d2-d7ee6bd0a9df ==============================
[0m07:15:41.874830 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:15:41.875307 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/invalid --full-refresh --profiles-dir /home/airflow/.dbt', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'empty': 'False', 'quiet': 'False'}
[0m07:15:42.012864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f2df2f60>]}
[0m07:15:42.060871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f38420f0>]}
[0m07:15:42.061499 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:15:42.160009 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:15:42.311528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:15:42.311888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:15:42.368752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f1bc96d0>]}
[0m07:15:42.567961 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:15:42.571848 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:15:42.619382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f03c39b0>]}
[0m07:15:42.619899 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:15:42.620358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f2e4f470>]}
[0m07:15:42.631801 [info ] [MainThread]: 
[0m07:15:42.632355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:15:42.632816 [info ] [MainThread]: 
[0m07:15:42.633448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:15:42.638084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m07:15:42.668304 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:15:42.668687 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:15:42.669093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:46.027513 [debug] [ThreadPool]: SQL status: SELECT 5 in 3.358 seconds
[0m07:15:46.028666 [debug] [ThreadPool]: On list_postgres: Close
[0m07:15:46.029428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_silver_invalid)
[0m07:15:46.029841 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "silver_invalid"
"
[0m07:15:46.034197 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_invalid"
[0m07:15:46.034516 [debug] [ThreadPool]: On create_postgres_silver_invalid: BEGIN
[0m07:15:46.034763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:15:48.851983 [debug] [ThreadPool]: SQL status: BEGIN in 2.817 seconds
[0m07:15:48.852445 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_invalid"
[0m07:15:48.852877 [debug] [ThreadPool]: On create_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_postgres_silver_invalid"} */
create schema if not exists "silver_invalid"
[0m07:15:49.149268 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.296 seconds
[0m07:15:49.150367 [debug] [ThreadPool]: On create_postgres_silver_invalid: COMMIT
[0m07:15:49.150761 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_invalid"
[0m07:15:49.151098 [debug] [ThreadPool]: On create_postgres_silver_invalid: COMMIT
[0m07:15:49.431453 [debug] [ThreadPool]: SQL status: COMMIT in 0.280 seconds
[0m07:15:49.431906 [debug] [ThreadPool]: On create_postgres_silver_invalid: Close
[0m07:15:49.439203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_silver_invalid, now list_postgres_silver_staging)
[0m07:15:49.444316 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:15:49.444765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m07:15:49.445103 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:15:49.445687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m07:15:49.447766 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:15:49.448248 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:15:49.448730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:15:49.450728 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:15:49.451133 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:15:49.453058 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:15:49.453627 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:15:49.454008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:49.454519 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:15:49.454934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:49.455495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:51.627410 [debug] [ThreadPool]: SQL status: BEGIN in 2.172 seconds
[0m07:15:51.627813 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:15:51.628093 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:15:51.683267 [debug] [ThreadPool]: SQL status: BEGIN in 2.229 seconds
[0m07:15:51.683615 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:15:51.683928 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:15:51.849836 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.221 seconds
[0m07:15:51.851057 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:15:51.876266 [debug] [ThreadPool]: SQL status: BEGIN in 2.421 seconds
[0m07:15:51.876577 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:15:51.876848 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:15:51.926385 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.242 seconds
[0m07:15:51.927309 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:15:51.957359 [debug] [ThreadPool]: SQL status: BEGIN in 2.509 seconds
[0m07:15:51.957799 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:15:51.958078 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:15:52.069047 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:15:52.131646 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.254 seconds
[0m07:15:52.132832 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:15:52.167122 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:15:52.224837 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.266 seconds
[0m07:15:52.226179 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:15:52.390397 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:15:52.616560 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:15:52.628291 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:52.628584 [debug] [MainThread]: On master: BEGIN
[0m07:15:52.628879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:15:54.805394 [debug] [MainThread]: SQL status: BEGIN in 2.176 seconds
[0m07:15:54.805830 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:54.806194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:15:55.063038 [debug] [MainThread]: SQL status: SELECT 23 in 0.256 seconds
[0m07:15:55.065465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f2b06ea0>]}
[0m07:15:55.066223 [debug] [MainThread]: On master: ROLLBACK
[0m07:15:55.330550 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:55.331034 [debug] [MainThread]: On master: BEGIN
[0m07:15:55.833850 [debug] [MainThread]: SQL status: BEGIN in 0.502 seconds
[0m07:15:55.834291 [debug] [MainThread]: On master: COMMIT
[0m07:15:55.834625 [debug] [MainThread]: Using postgres connection "master"
[0m07:15:55.834930 [debug] [MainThread]: On master: COMMIT
[0m07:15:56.088972 [debug] [MainThread]: SQL status: COMMIT in 0.254 seconds
[0m07:15:56.089488 [debug] [MainThread]: On master: Close
[0m07:15:56.094210 [debug] [Thread-1 (]: Began running node model.retail_dbt.campaign_invalid
[0m07:15:56.094730 [debug] [Thread-2 (]: Began running node model.retail_dbt.customer_feedback_invalid
[0m07:15:56.095613 [debug] [Thread-3 (]: Began running node model.retail_dbt.customer_invalid
[0m07:15:56.096136 [debug] [Thread-4 (]: Began running node model.retail_dbt.discount_rules_invalid
[0m07:15:56.095270 [info ] [Thread-1 (]: 1 of 19 START sql view model silver_invalid.campaign_invalid ................... [RUN]
[0m07:15:56.096764 [info ] [Thread-2 (]: 2 of 19 START sql view model silver_invalid.customer_feedback_invalid .......... [RUN]
[0m07:15:56.097429 [info ] [Thread-3 (]: 3 of 19 START sql view model silver_invalid.customer_invalid ................... [RUN]
[0m07:15:56.098503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now model.retail_dbt.campaign_invalid)
[0m07:15:56.098047 [info ] [Thread-4 (]: 4 of 19 START sql view model silver_invalid.discount_rules_invalid ............. [RUN]
[0m07:15:56.099040 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now model.retail_dbt.customer_feedback_invalid)
[0m07:15:56.099498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now model.retail_dbt.customer_invalid)
[0m07:15:56.099904 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.campaign_invalid
[0m07:15:56.100342 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now model.retail_dbt.discount_rules_invalid)
[0m07:15:56.100776 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.customer_feedback_invalid
[0m07:15:56.101177 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.customer_invalid
[0m07:15:56.108051 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.campaign_invalid"
[0m07:15:56.108420 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.discount_rules_invalid
[0m07:15:56.111268 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.customer_feedback_invalid"
[0m07:15:56.114134 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.customer_invalid"
[0m07:15:56.116960 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.discount_rules_invalid"
[0m07:15:56.117513 [debug] [Thread-1 (]: Began executing node model.retail_dbt.campaign_invalid
[0m07:15:56.118514 [debug] [Thread-2 (]: Began executing node model.retail_dbt.customer_feedback_invalid
[0m07:15:56.144909 [debug] [Thread-3 (]: Began executing node model.retail_dbt.customer_invalid
[0m07:15:56.155781 [debug] [Thread-4 (]: Began executing node model.retail_dbt.discount_rules_invalid
[0m07:15:56.158843 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.customer_feedback_invalid"
[0m07:15:56.159329 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.customer_invalid"
[0m07:15:56.161083 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.campaign_invalid"
[0m07:15:56.163480 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.discount_rules_invalid"
[0m07:15:56.164437 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.customer_feedback_invalid"
[0m07:15:56.165202 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: BEGIN
[0m07:15:56.165574 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customer_invalid"
[0m07:15:56.165972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:15:56.166505 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.discount_rules_invalid"
[0m07:15:56.166861 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: BEGIN
[0m07:15:56.167239 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.campaign_invalid"
[0m07:15:56.167756 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: BEGIN
[0m07:15:56.168193 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:15:56.168666 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: BEGIN
[0m07:15:56.169066 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:15:56.169624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:15:58.788500 [debug] [Thread-4 (]: SQL status: BEGIN in 2.619 seconds
[0m07:15:58.789078 [debug] [Thread-2 (]: SQL status: BEGIN in 2.623 seconds
[0m07:15:58.789541 [debug] [Thread-3 (]: SQL status: BEGIN in 2.621 seconds
[0m07:15:58.789987 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.discount_rules_invalid"
[0m07:15:58.790501 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.customer_feedback_invalid"
[0m07:15:58.790982 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customer_invalid"
[0m07:15:58.791546 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.discount_rules_invalid"} */

  create view "postgres"."silver_invalid"."discount_rules_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(rule_id AS text))          AS rule_id_txt,
        TRIM(CAST(product_id AS text))       AS product_id_txt,
        TRIM(CAST(discount_type AS text))    AS discount_type_txt,
        TRIM(CAST(value AS text))            AS value_txt,
        TRIM(REPLACE(CAST(valid_from AS text), E'\r','')) AS valid_from_txt,
        TRIM(REPLACE(CAST(valid_to   AS text), E'\r','')) AS valid_to_txt
    FROM "postgres"."raw"."discount_rules"
),
norm AS (
    SELECT
        NULLIF(rule_id_txt, '')        AS rule_id_clean,
        NULLIF(product_id_txt, '')     AS product_id_clean,
        NULLIF(discount_type_txt, '')  AS discount_type_clean,
        NULLIF(value_txt, '')          AS value_clean,
        NULLIF(valid_from_txt, '')     AS valid_from_clean,
        NULLIF(valid_to_txt, '')       AS valid_to_clean
    FROM src
),
typed AS (
    SELECT
        *,
        CASE WHEN rule_id_clean    ~ '^[0-9]+$' THEN rule_id_clean::integer END        AS rule_id_val,
        CASE WHEN product_id_clean ~ '^[0-9]+$' THEN product_id_clean::integer END     AS product_id_val,
        CASE WHEN value_clean ~* '^(na|n/a)$' THEN NULL
             WHEN value_clean ~ '^[0-9]+(\.[0-9]+)?$' THEN value_clean::numeric END    AS value_val,
        CASE WHEN valid_from_clean ~* '^(na|n/a)$' THEN NULL
             WHEN valid_from_clean ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
                  THEN to_timestamp(replace(valid_from_clean,'-','/'),'YYYY/FMMM/FMDD') END AS valid_from_ts,
        CASE WHEN valid_to_clean ~* '^(na|n/a)$' THEN NULL
             WHEN valid_to_clean ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
                  THEN to_timestamp(replace(valid_to_clean,'-','/'),'YYYY/FMMM/FMDD') END   AS valid_to_ts
    FROM norm
),
flags AS (
    SELECT
        *,
        (rule_id_val IS NULL
         OR product_id_val IS NULL
         OR discount_type_clean IS NULL OR discount_type_clean ~* '^(na|n/a)$'
         OR value_val IS NULL
         OR valid_from_ts IS NULL
         OR valid_to_ts IS NULL) AS f_missing_or_na,
        (valid_from_ts IS NOT NULL AND valid_to_ts IS NOT NULL AND valid_from_ts >= valid_to_ts) AS f_bad_range
    FROM typed
)
SELECT
    rule_id_clean AS rule_id,
    product_id_clean AS product_id,
    discount_type_clean AS discount_type,
    value_clean AS value,
    valid_from_clean AS valid_from,
    valid_to_clean AS valid_to,
    CASE
      WHEN f_missing_or_na AND f_bad_range THEN 'missing_or_NA; valid_from >= valid_to'
      WHEN f_missing_or_na THEN 'missing_or_NA'
      WHEN f_bad_range THEN 'valid_from >= valid_to'
    END AS invalid_reason
FROM flags
WHERE f_missing_or_na OR f_bad_range
  );
[0m07:15:58.792221 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_feedback_invalid"} */

  create view "postgres"."silver_invalid"."customer_feedback_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(feedback_id AS text))  AS feedback_id,
        TRIM(CAST(customer_id AS text))  AS customer_id,
        TRIM(CAST(store_id    AS text))  AS store_id,
        TRIM(CAST(product_id  AS text))  AS product_id,
        /* giữ nguyên rating dạng text để kiểm tra 'bad' */
        CASE
            WHEN rating IS NULL THEN NULL
            ELSE TRIM(CAST(rating AS text))
        END AS rating_text,
        TRIM(CAST(comments AS text)) AS comments,
        /* chuẩn hoá ngày thô */
        CASE
            WHEN feedback_date IS NULL THEN NULL
            ELSE TRIM(REPLACE(CAST(feedback_date AS text), E'\r',''))
        END AS feedback_date_text
    FROM "postgres"."raw"."customer_feedback"
),
dated AS (
    SELECT
        *,
        /* nhận YYYY[-/]M[M]?[-/]D[D]?; parse linh hoạt */
        CASE
            WHEN feedback_date_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
            THEN to_timestamp(replace(feedback_date_text, '-', '/'), 'YYYY/FMMM/FMDD')
            ELSE NULL
        END AS feedback_date_ts
    FROM src
),
flagged AS (
    SELECT
        *,
        /* 2 điều kiện invalid duy nhất */
        (rating_text IS NOT NULL AND lower(rating_text) = 'bad') AS f_rating_bad,
        (feedback_date_ts IS NOT NULL
          AND feedback_date_ts > to_timestamp('2025/08/22','YYYY/MM/DD')) AS f_date_after_cutoff
    FROM dated
)
SELECT
    feedback_id,
    customer_id,
    store_id,
    product_id,
    rating_text    AS rating,
    comments,
    feedback_date_text,
    feedback_date_ts AS feedback_date_parsed,
    CASE
        WHEN f_rating_bad AND f_date_after_cutoff THEN 'rating=bad; date>2025/08/22'
        WHEN f_rating_bad THEN 'rating=bad'
        WHEN f_date_after_cutoff THEN 'date>2025/08/22'
    END AS invalid_reason
FROM flagged
WHERE
    /* chỉ lấy đúng 2 loại lỗi này */
    f_rating_bad OR f_date_after_cutoff
  );
[0m07:15:58.792979 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_invalid"} */

  create view "postgres"."silver_invalid"."customer_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(customer_id AS text))            AS customer_id_text,
        TRIM(CAST(name AS text))                   AS name,
        LOWER(TRIM(CAST(email AS text)))           AS email,
        TRIM(CAST(phone AS text))                  AS phone,
        TRIM(CAST(loyalty_program_id AS text))     AS loyalty_program_id_text,
        TRIM(REPLACE(CAST(created_at AS text), E'\r','')) AS created_at_text
    FROM "postgres"."raw"."customers"
),
typed AS (
    SELECT
        *,
        CASE WHEN customer_id_text ~ '^[0-9]+$' THEN customer_id_text::integer END        AS customer_id_val,
        CASE WHEN loyalty_program_id_text ~ '^[0-9]+$' THEN loyalty_program_id_text::int  END AS loyalty_program_id_val,
        CASE
            WHEN created_at_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
            THEN to_timestamp(replace(created_at_text,'-','/'),'YYYY/FMMM/FMDD')
        END AS created_at_ts
    FROM src
),
flag AS (
    SELECT
        *,
        (customer_id_val IS NULL)                                              AS f_bad_customer_id,
        (email IS NULL OR email !~ '^[^@]+@[^@]+\.[^@]+$')                     AS f_bad_email,
        (phone IS NULL OR phone !~ '^[0-9]{9,15}$')                            AS f_bad_phone,   -- bạn chỉnh dài số nếu muốn
        (loyalty_program_id_val IS NULL)                                       AS f_bad_loyalty,
        (created_at_ts IS NULL)                                                AS f_bad_date,
        (created_at_ts IS NOT NULL AND created_at_ts > to_timestamp('2025/08/22','YYYY/MM/DD')) AS f_date_after_cutoff
    FROM typed
),
reasons AS (
    SELECT
        *,
        array_remove(ARRAY[
            CASE WHEN f_bad_customer_id   THEN 'Invalid customer_id' END,
            CASE WHEN f_bad_email         THEN 'Invalid email' END,
            CASE WHEN f_bad_phone         THEN 'Invalid phone' END,
            CASE WHEN f_bad_loyalty       THEN 'Invalid loyalty_program_id' END,
            CASE WHEN f_bad_date          THEN 'Invalid created_at format' END,
            CASE WHEN f_date_after_cutoff THEN 'created_at > 2025-08-22' END
        ], NULL) AS reason_arr
    FROM flag
)
SELECT
    customer_id_text   AS customer_id,
    name,
    email,
    phone,
    loyalty_program_id_text AS loyalty_program_id,
    created_at_text    AS created_at_raw,
    created_at_ts      AS created_at_parsed,
    array_to_string(reason_arr,'; ') AS invalid_reason
FROM reasons
WHERE cardinality(reason_arr) > 0
  );
[0m07:15:59.062580 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.269 seconds
[0m07:15:59.063053 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.269 seconds
[0m07:15:59.063456 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.270 seconds
[0m07:15:59.069336 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.discount_rules_invalid"
[0m07:15:59.071496 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.customer_feedback_invalid"
[0m07:15:59.074203 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customer_invalid"
[0m07:15:59.074686 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.discount_rules_invalid"} */
alter table "postgres"."silver_invalid"."discount_rules_invalid__dbt_tmp" rename to "discount_rules_invalid"
[0m07:15:59.075068 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_feedback_invalid"} */
alter table "postgres"."silver_invalid"."customer_feedback_invalid__dbt_tmp" rename to "customer_feedback_invalid"
[0m07:15:59.075468 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_invalid"} */
alter table "postgres"."silver_invalid"."customer_invalid__dbt_tmp" rename to "customer_invalid"
[0m07:15:59.286803 [debug] [Thread-1 (]: SQL status: BEGIN in 3.117 seconds
[0m07:15:59.287305 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.campaign_invalid"
[0m07:15:59.287847 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.campaign_invalid"} */

  create view "postgres"."silver_invalid"."campaign_invalid__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."raw"."campaigns"
),

cleaned as (
    select
        campaign_id::text        as campaign_id_raw,
        name::text               as name_raw,
        budget::text             as budget_raw,
        start_date::text         as start_date_raw,
        end_date::text           as end_date_raw,

        
        case 
            when campaign_id is null or trim(campaign_id::text) = '' then null
            when lower(trim(campaign_id::text)) in ('null','na','n/a','none') then null
            else trim(campaign_id::text)
        end as campaign_id,

        case 
            when name is null or trim(name::text) = '' then null
            when lower(trim(name::text)) in ('null','na','n/a','none') then null
            else trim(name::text)
        end as name,

        case
            when budget is null then null
            when trim(budget::text) = '' then null
            when lower(trim(budget::text)) in ('null','na','n/a','none') then null
            else nullif(regexp_replace(trim(budget::text), '[^0-9.\-]', '', 'g'), '')
        end as budget_str,

        case when start_date is null then null else regexp_replace(trim(start_date::text), '[./]', '-', 'g') end as start_norm,
        case when end_date   is null then null else regexp_replace(trim(end_date::text),   '[./]', '-', 'g') end   as end_norm
    from source
),


parsed as (
    select
        *,
        case
            when start_norm ~ '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'YYYY-MM-DD')
            when start_norm ~ '^(0[1-9]|[12]\d|3[01])-(0[1-9]|1[0-2])-\d{4}(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'DD-MM-YYYY')
            when start_norm ~ '^(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])-\d{4}(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'MM-DD-YYYY')
            else null
        end as start_date_parsed,

        case
            when end_norm ~ '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'YYYY-MM-DD')
            when end_norm ~ '^(0[1-9]|[12]\d|3[01])-(0[1-9]|1[0-2])-\d{4}(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'DD-MM-YYYY')
            when end_norm ~ '^(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])-\d{4}(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'MM-DD-YYYY')
            else null
        end as end_date_parsed,

        case when budget_str ~ '^-?\d+(\.\d+)?$' then budget_str::numeric else null end as budget_num
    from cleaned
),


flagged as (
    select
        *,
        
        (budget_str is null or not (budget_str ~ '^-?\d+(\.\d+)?$'))                as f_budget_invalid,

        
        (start_norm is not null and start_date_parsed is null)                      as f_start_bad_format,
        (end_norm   is not null and end_date_parsed   is null)                      as f_end_bad_format,
        (start_norm is null)                                                        as f_start_missing,
        (end_norm   is null)                                                        as f_end_missing,

        
        (start_date_parsed is not null and end_date_parsed is not null 
            and start_date_parsed >= end_date_parsed)                               as f_order_invalid,

        (start_date_parsed is not null and start_date_parsed >= date '2025-08-22') as f_start_ge_cutoff,
        (end_date_parsed   is not null and end_date_parsed   >= date '2025-08-22') as f_end_ge_cutoff
    from parsed
),


reasons as (
    select
        *,
        array_remove(
            array[
                case when f_budget_invalid  then 'budget_invalid_or_not_numeric' end,
                case when f_start_missing   then 'start_date_missing' end,
                case when f_end_missing     then 'end_date_missing' end,
                case when f_start_bad_format then 'start_date_unparseable' end,
                case when f_end_bad_format   then 'end_date_unparseable' end,
                case when f_order_invalid    then 'start_date_not_less_than_end_date' end,
                case when f_start_ge_cutoff  then 'start_date_on_or_after_2025-08-22' end,
                case when f_end_ge_cutoff    then 'end_date_on_or_after_2025-08-22' end
            ],
            null
        ) as invalid_reasons_array
    from flagged
),


invalid_rows as (
    select *
    from reasons
    where cardinality(invalid_reasons_array) > 0
)

select
    
    campaign_id_raw,
    name_raw,
    budget_raw,
    start_date_raw,
    end_date_raw,
    campaign_id,
    name,
    budget_str,
    budget_num,
    start_norm,
    end_norm,
    start_date_parsed as start_date,
    end_date_parsed   as end_date, 
    invalid_reasons_array                                  as invalid_reasons,
    array_to_string(invalid_reasons_array, '; ')           as invalid_reason_text
from invalid_rows
  );
[0m07:15:59.361765 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.286 seconds
[0m07:15:59.362386 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.286 seconds
[0m07:15:59.362795 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.287 seconds
[0m07:15:59.376480 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: COMMIT
[0m07:15:59.377780 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: COMMIT
[0m07:15:59.378914 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: COMMIT
[0m07:15:59.379339 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.discount_rules_invalid"
[0m07:15:59.379792 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.customer_feedback_invalid"
[0m07:15:59.380164 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customer_invalid"
[0m07:15:59.380545 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: COMMIT
[0m07:15:59.380940 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: COMMIT
[0m07:15:59.381287 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: COMMIT
[0m07:15:59.544790 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.256 seconds
[0m07:15:59.548855 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.campaign_invalid"
[0m07:15:59.549263 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.campaign_invalid"} */
alter table "postgres"."silver_invalid"."campaign_invalid__dbt_tmp" rename to "campaign_invalid"
[0m07:15:59.665514 [debug] [Thread-2 (]: SQL status: COMMIT in 0.284 seconds
[0m07:15:59.721454 [debug] [Thread-3 (]: SQL status: COMMIT in 0.340 seconds
[0m07:15:59.725847 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_invalid"."customer_feedback_invalid__dbt_backup"
[0m07:15:59.726327 [debug] [Thread-4 (]: SQL status: COMMIT in 0.345 seconds
[0m07:15:59.728175 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_invalid"."customer_invalid__dbt_backup"
[0m07:15:59.732403 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.customer_feedback_invalid"
[0m07:15:59.734551 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_invalid"."discount_rules_invalid__dbt_backup"
[0m07:15:59.735072 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customer_invalid"
[0m07:15:59.735496 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_feedback_invalid"} */
drop view if exists "postgres"."silver_invalid"."customer_feedback_invalid__dbt_backup" cascade
[0m07:15:59.736019 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.discount_rules_invalid"
[0m07:15:59.736415 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_invalid"} */
drop view if exists "postgres"."silver_invalid"."customer_invalid__dbt_backup" cascade
[0m07:15:59.736853 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.discount_rules_invalid"} */
drop view if exists "postgres"."silver_invalid"."discount_rules_invalid__dbt_backup" cascade
[0m07:15:59.828192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.279 seconds
[0m07:15:59.829503 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: COMMIT
[0m07:15:59.829812 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.campaign_invalid"
[0m07:15:59.830125 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: COMMIT
[0m07:15:59.981415 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.245 seconds
[0m07:15:59.981941 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.245 seconds
[0m07:15:59.984261 [debug] [Thread-2 (]: On model.retail_dbt.customer_feedback_invalid: Close
[0m07:15:59.984703 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.247 seconds
[0m07:15:59.985997 [debug] [Thread-3 (]: On model.retail_dbt.customer_invalid: Close
[0m07:15:59.987351 [debug] [Thread-4 (]: On model.retail_dbt.discount_rules_invalid: Close
[0m07:15:59.989689 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f1f9f320>]}
[0m07:15:59.990083 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ee0ca8a0>]}
[0m07:15:59.991115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ee02e8d0>]}
[0m07:15:59.990773 [info ] [Thread-2 (]: 2 of 19 OK created sql view model silver_invalid.customer_feedback_invalid ..... [[32mCREATE VIEW[0m in 3.89s]
[0m07:15:59.991930 [info ] [Thread-3 (]: 3 of 19 OK created sql view model silver_invalid.customer_invalid .............. [[32mCREATE VIEW[0m in 3.89s]
[0m07:15:59.992586 [info ] [Thread-4 (]: 4 of 19 OK created sql view model silver_invalid.discount_rules_invalid ........ [[32mCREATE VIEW[0m in 3.89s]
[0m07:15:59.993315 [debug] [Thread-2 (]: Finished running node model.retail_dbt.customer_feedback_invalid
[0m07:15:59.993914 [debug] [Thread-3 (]: Finished running node model.retail_dbt.customer_invalid
[0m07:15:59.994517 [debug] [Thread-4 (]: Finished running node model.retail_dbt.discount_rules_invalid
[0m07:15:59.995004 [debug] [Thread-2 (]: Began running node model.retail_dbt.employees_invalid
[0m07:15:59.995568 [debug] [Thread-3 (]: Began running node model.retail_dbt.inventory_invalid
[0m07:15:59.996126 [debug] [Thread-4 (]: Began running node model.retail_dbt.loyalty_programs_invalid
[0m07:15:59.996707 [info ] [Thread-2 (]: 5 of 19 START sql view model silver_invalid.employees_invalid .................. [RUN]
[0m07:15:59.997249 [info ] [Thread-3 (]: 6 of 19 START sql view model silver_invalid.inventory_invalid .................. [RUN]
[0m07:15:59.997797 [info ] [Thread-4 (]: 7 of 19 START sql table model silver_invalid.loyalty_programs_invalid .......... [RUN]
[0m07:15:59.998384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.customer_feedback_invalid, now model.retail_dbt.employees_invalid)
[0m07:15:59.998831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.customer_invalid, now model.retail_dbt.inventory_invalid)
[0m07:15:59.999271 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.discount_rules_invalid, now model.retail_dbt.loyalty_programs_invalid)
[0m07:15:59.999686 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.employees_invalid
[0m07:16:00.000071 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.inventory_invalid
[0m07:16:00.000403 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.loyalty_programs_invalid
[0m07:16:00.003218 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.employees_invalid"
[0m07:16:00.006077 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.inventory_invalid"
[0m07:16:00.009052 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:00.010039 [debug] [Thread-2 (]: Began executing node model.retail_dbt.employees_invalid
[0m07:16:00.014317 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.employees_invalid"
[0m07:16:00.014730 [debug] [Thread-4 (]: Began executing node model.retail_dbt.loyalty_programs_invalid
[0m07:16:00.015095 [debug] [Thread-3 (]: Began executing node model.retail_dbt.inventory_invalid
[0m07:16:00.033641 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.inventory_invalid"
[0m07:16:00.035835 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:00.036651 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_invalid"
[0m07:16:00.037169 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: BEGIN
[0m07:16:00.037595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:00.038078 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.inventory_invalid"
[0m07:16:00.038649 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:00.039051 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: BEGIN
[0m07:16:00.039415 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: BEGIN
[0m07:16:00.039838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:00.040293 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:00.115651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.285 seconds
[0m07:16:00.118249 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_invalid"."campaign_invalid__dbt_backup"
[0m07:16:00.118867 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.campaign_invalid"
[0m07:16:00.119228 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.campaign_invalid"} */
drop view if exists "postgres"."silver_invalid"."campaign_invalid__dbt_backup" cascade
[0m07:16:00.388423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.269 seconds
[0m07:16:00.389998 [debug] [Thread-1 (]: On model.retail_dbt.campaign_invalid: Close
[0m07:16:00.390787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ee0c7320>]}
[0m07:16:00.391477 [info ] [Thread-1 (]: 1 of 19 OK created sql view model silver_invalid.campaign_invalid .............. [[32mCREATE VIEW[0m in 4.29s]
[0m07:16:00.392075 [debug] [Thread-1 (]: Finished running node model.retail_dbt.campaign_invalid
[0m07:16:00.392540 [debug] [Thread-1 (]: Began running node model.retail_dbt.payments_invalid
[0m07:16:00.393079 [info ] [Thread-1 (]: 8 of 19 START sql view model silver_invalid.payments_invalid ................... [RUN]
[0m07:16:00.393476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.campaign_invalid, now model.retail_dbt.payments_invalid)
[0m07:16:00.393796 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.payments_invalid
[0m07:16:00.397149 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.payments_invalid"
[0m07:16:00.397668 [debug] [Thread-1 (]: Began executing node model.retail_dbt.payments_invalid
[0m07:16:00.400320 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.payments_invalid"
[0m07:16:00.400825 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_invalid"
[0m07:16:00.401117 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: BEGIN
[0m07:16:00.401410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:03.239725 [debug] [Thread-3 (]: SQL status: BEGIN in 2.640 seconds
[0m07:16:03.240203 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.inventory_invalid"
[0m07:16:03.240574 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.inventory_invalid"} */

  create view "postgres"."silver_invalid"."inventory_invalid__dbt_tmp"
    
    
  as (
    

with source as (
    select * 
    from "postgres"."raw"."inventory"
),

evaluated as (
    select
        inventory_id,
        store_id,
        product_id,
        quantity,
        last_updated,

        -- rule checks
        case 
            when inventory_id is null or trim(lower(inventory_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then 'invalid_inventory_id'
        end as invalid_inventory_id,

        case 
            when store_id is null or trim(lower(store_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then 'invalid_store_id'
        end as invalid_store_id,

        case 
            when product_id is null or trim(lower(product_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then 'invalid_product_id'
        end as invalid_product_id,

        case 
            when quantity is null or trim(lower(quantity)) in ('', 'null', 'na', 'n/a', 'none') 
                 or cast(quantity as integer) = 0
            then 'invalid_quantity'
        end as invalid_quantity,

        case 
            when last_updated is null or trim(lower(last_updated)) in ('', 'null', 'na', 'n/a', 'none') 
            then 'invalid_last_updated_null'
            when cast(last_updated as date) > date('2025-08-22') 
            then 'invalid_last_updated_future'
        end as invalid_last_updated
    from source
),

invalids as (
    select *
    from evaluated
    where invalid_inventory_id is not null
       or invalid_store_id is not null
       or invalid_product_id is not null
       or invalid_quantity is not null
       or invalid_last_updated is not null
)

select * from invalids
  );
[0m07:16:03.259794 [debug] [Thread-4 (]: SQL status: BEGIN in 2.660 seconds
[0m07:16:03.260138 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:03.260526 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.loyalty_programs_invalid"} */

  
    

  create  table "postgres"."silver_invalid"."loyalty_programs_invalid__dbt_tmp"
  
  
    as
  
  (
    

with source as (
    select * from "postgres"."silver_staging"."stg_loyalty_programs"
),
invalid as (
    select
        loyalty_program_id,
        name,
        points_per_dollar,
        case 
            when loyalty_program_id is null then 'loyalty_program_id_null'
            when points_per_dollar is null then 'points_per_dollar_null'
            when points_per_dollar::text !~ '^[0-9]+$' then 'points_per_dollar_not_numeric'
        end as invalid_reason
    from source
    where 
        loyalty_program_id is null
        or points_per_dollar is null
        or points_per_dollar::text !~ '^[0-9]+$'
)

select * from invalid
  );
  
[0m07:16:04.785659 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.283 seconds
[0m07:16:04.788575 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.inventory_invalid"
[0m07:16:04.788936 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.inventory_invalid"} */
alter table "postgres"."silver_invalid"."inventory_invalid__dbt_tmp" rename to "inventory_invalid"
[0m07:16:04.813926 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.292 seconds
[0m07:16:04.820201 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:04.820541 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.loyalty_programs_invalid"} */
alter table "postgres"."silver_invalid"."loyalty_programs_invalid__dbt_tmp" rename to "loyalty_programs_invalid"
[0m07:16:05.074607 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.285 seconds
[0m07:16:05.075872 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: COMMIT
[0m07:16:05.076215 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.inventory_invalid"
[0m07:16:05.076544 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: COMMIT
[0m07:16:05.112798 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.292 seconds
[0m07:16:05.113917 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: COMMIT
[0m07:16:05.114279 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:05.114593 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: COMMIT
[0m07:16:05.345952 [debug] [Thread-3 (]: SQL status: COMMIT in 0.269 seconds
[0m07:16:05.348423 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_invalid"."inventory_invalid__dbt_backup"
[0m07:16:05.348954 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.inventory_invalid"
[0m07:16:05.349290 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.inventory_invalid"} */
drop view if exists "postgres"."silver_invalid"."inventory_invalid__dbt_backup" cascade
[0m07:16:05.401911 [debug] [Thread-4 (]: SQL status: COMMIT in 0.287 seconds
[0m07:16:05.404324 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_invalid"."loyalty_programs_invalid__dbt_backup"
[0m07:16:05.406950 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.loyalty_programs_invalid"
[0m07:16:05.407276 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.loyalty_programs_invalid"} */
drop table if exists "postgres"."silver_invalid"."loyalty_programs_invalid__dbt_backup" cascade
[0m07:16:05.625452 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.276 seconds
[0m07:16:05.626786 [debug] [Thread-3 (]: On model.retail_dbt.inventory_invalid: Close
[0m07:16:05.627527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f01a2570>]}
[0m07:16:05.628273 [info ] [Thread-3 (]: 6 of 19 OK created sql view model silver_invalid.inventory_invalid ............. [[32mCREATE VIEW[0m in 5.63s]
[0m07:16:05.628909 [debug] [Thread-3 (]: Finished running node model.retail_dbt.inventory_invalid
[0m07:16:05.629326 [debug] [Thread-3 (]: Began running node model.retail_dbt.pricing_history_invalid
[0m07:16:05.629815 [info ] [Thread-3 (]: 9 of 19 START sql view model silver_invalid.pricing_history_invalid ............ [RUN]
[0m07:16:05.630250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.inventory_invalid, now model.retail_dbt.pricing_history_invalid)
[0m07:16:05.630569 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.pricing_history_invalid
[0m07:16:05.633757 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.pricing_history_invalid"
[0m07:16:05.634288 [debug] [Thread-3 (]: Began executing node model.retail_dbt.pricing_history_invalid
[0m07:16:05.636942 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.pricing_history_invalid"
[0m07:16:05.637491 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.pricing_history_invalid"
[0m07:16:05.637846 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: BEGIN
[0m07:16:05.638212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:05.797236 [debug] [Thread-1 (]: SQL status: BEGIN in 3.574 seconds
[0m07:16:05.797777 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.390 seconds
[0m07:16:05.798193 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_invalid"
[0m07:16:05.799491 [debug] [Thread-4 (]: On model.retail_dbt.loyalty_programs_invalid: Close
[0m07:16:05.799995 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.payments_invalid"} */

  create view "postgres"."silver_invalid"."payments_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(payment_id AS text))                 AS payment_id_txt,
        TRIM(CAST(method     AS text))                 AS method,
        TRIM(CAST(status     AS text))                 AS status,
        TRIM(REPLACE(CAST(paid_at AS text), E'\r','')) AS paid_at_txt
    FROM "postgres"."raw"."payments"
),

typed AS (
    SELECT
        *,
        CASE WHEN paid_at_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
             THEN to_timestamp(replace(paid_at_txt,'-','/'),'YYYY/FMMM/FMDD')
        END AS paid_at_ts
    FROM src
),

flags AS (
    SELECT
        *,
        /* thiếu/NA */
        (paid_at_txt IS NULL OR paid_at_txt = '' OR lower(paid_at_txt) IN ('na','n/a')) AS f_date_missing,
        /* có giá trị nhưng không khớp pattern */
        (paid_at_txt IS NOT NULL AND paid_at_txt <> '' AND lower(paid_at_txt) NOT IN ('na','n/a')
         AND paid_at_ts IS NULL) AS f_bad_format,
        /* qua cutoff */
        (paid_at_ts IS NOT NULL AND paid_at_ts > to_timestamp('2025/08/22','YYYY/MM/DD')) AS f_after_cutoff
    FROM typed
)

SELECT
    payment_id_txt AS payment_id,
    method,
    status,
    paid_at_txt    AS paid_at_raw,
    paid_at_ts     AS paid_at_parsed,
    CASE
        WHEN f_date_missing THEN 'paid_at missing/NA'
        WHEN f_bad_format   THEN 'paid_at invalid format'
        WHEN f_after_cutoff THEN 'paid_at > 2025-08-22'
    END AS invalid_reason
FROM flags
WHERE f_date_missing OR f_bad_format OR f_after_cutoff
  );
[0m07:16:05.800714 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ee025a00>]}
[0m07:16:05.801342 [info ] [Thread-4 (]: 7 of 19 OK created sql table model silver_invalid.loyalty_programs_invalid ..... [[32mSELECT 0[0m in 5.80s]
[0m07:16:05.801911 [debug] [Thread-4 (]: Finished running node model.retail_dbt.loyalty_programs_invalid
[0m07:16:05.802288 [debug] [Thread-4 (]: Began running node model.retail_dbt.products_invalid
[0m07:16:05.802757 [info ] [Thread-4 (]: 10 of 19 START sql view model silver_invalid.products_invalid .................. [RUN]
[0m07:16:05.803182 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.loyalty_programs_invalid, now model.retail_dbt.products_invalid)
[0m07:16:05.803516 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.products_invalid
[0m07:16:05.806878 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.products_invalid"
[0m07:16:05.807438 [debug] [Thread-4 (]: Began executing node model.retail_dbt.products_invalid
[0m07:16:05.810965 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.products_invalid"
[0m07:16:05.811486 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_invalid"
[0m07:16:05.811840 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: BEGIN
[0m07:16:05.812152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:06.119193 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.319 seconds
[0m07:16:06.119772 [debug] [Thread-2 (]: SQL status: BEGIN in 4.261 seconds
[0m07:16:06.122831 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_invalid"
[0m07:16:06.123283 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_invalid"
[0m07:16:06.123741 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.payments_invalid"} */
alter table "postgres"."silver_invalid"."payments_invalid__dbt_tmp" rename to "payments_invalid"
[0m07:16:06.124216 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.employees_invalid"} */

  create view "postgres"."silver_invalid"."employees_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(employee_id AS text)) AS employee_id_txt,
        TRIM(CAST(name        AS text)) AS name_txt,
        TRIM(CAST(role        AS text)) AS role_txt,
        TRIM(CAST(store_id    AS text)) AS store_id_txt
    FROM "postgres"."raw"."employees"
),

flags AS (
    SELECT
        *,
        (employee_id_txt IS NULL OR employee_id_txt = '' OR lower(employee_id_txt) IN ('na','n/a')) AS f_bad_employee_id,
        (name_txt        IS NULL OR name_txt        = '' OR lower(name_txt)        IN ('na','n/a')) AS f_bad_name,
        (role_txt        IS NULL OR role_txt        = '' OR lower(role_txt)        IN ('na','n/a')) AS f_bad_role,
        (store_id_txt    IS NULL OR store_id_txt    = '' OR lower(store_id_txt)    IN ('na','n/a')) AS f_bad_store_id
    FROM src
),

reasons AS (
    SELECT
        *,
        array_remove(ARRAY[
            CASE WHEN f_bad_employee_id THEN 'NULL/empty/NA in employee_id' END,
            CASE WHEN f_bad_name        THEN 'NULL/empty/NA in name' END,
            CASE WHEN f_bad_role        THEN 'NULL/empty/NA in role' END,
            CASE WHEN f_bad_store_id    THEN 'NULL/empty/NA in store_id' END
        ], NULL) AS reason_arr
    FROM flags
)

SELECT
    employee_id_txt AS employee_id,
    name_txt        AS name,
    role_txt        AS role,
    store_id_txt    AS store_id,
    array_to_string(reason_arr, '; ') AS invalid_reason
FROM reasons
WHERE cardinality(reason_arr) > 0
  );
[0m07:16:06.378615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.254 seconds
[0m07:16:06.379962 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: COMMIT
[0m07:16:06.380372 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_invalid"
[0m07:16:06.380721 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: COMMIT
[0m07:16:06.447859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.323 seconds
[0m07:16:06.450821 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_invalid"
[0m07:16:06.451207 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.employees_invalid"} */
alter table "postgres"."silver_invalid"."employees_invalid__dbt_tmp" rename to "employees_invalid"
[0m07:16:06.665374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.284 seconds
[0m07:16:06.668068 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_invalid"."payments_invalid__dbt_backup"
[0m07:16:06.668728 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_invalid"
[0m07:16:06.669087 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.payments_invalid"} */
drop view if exists "postgres"."silver_invalid"."payments_invalid__dbt_backup" cascade
[0m07:16:06.766806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.315 seconds
[0m07:16:06.768250 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: COMMIT
[0m07:16:06.768705 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_invalid"
[0m07:16:06.769096 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: COMMIT
[0m07:16:06.916871 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.247 seconds
[0m07:16:06.918255 [debug] [Thread-1 (]: On model.retail_dbt.payments_invalid: Close
[0m07:16:06.918913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec754d70>]}
[0m07:16:06.919450 [info ] [Thread-1 (]: 8 of 19 OK created sql view model silver_invalid.payments_invalid .............. [[32mCREATE VIEW[0m in 6.53s]
[0m07:16:06.920041 [debug] [Thread-1 (]: Finished running node model.retail_dbt.payments_invalid
[0m07:16:06.920435 [debug] [Thread-1 (]: Began running node model.retail_dbt.promotions_invalid
[0m07:16:06.920954 [info ] [Thread-1 (]: 11 of 19 START sql view model silver_invalid.promotions_invalid ................ [RUN]
[0m07:16:06.921388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.payments_invalid, now model.retail_dbt.promotions_invalid)
[0m07:16:06.921739 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.promotions_invalid
[0m07:16:06.925518 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.promotions_invalid"
[0m07:16:06.926102 [debug] [Thread-1 (]: Began executing node model.retail_dbt.promotions_invalid
[0m07:16:06.928821 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.promotions_invalid"
[0m07:16:06.929361 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.promotions_invalid"
[0m07:16:06.929709 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: BEGIN
[0m07:16:06.930030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:07.095617 [debug] [Thread-2 (]: SQL status: COMMIT in 0.326 seconds
[0m07:16:07.098046 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_invalid"."employees_invalid__dbt_backup"
[0m07:16:07.098606 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_invalid"
[0m07:16:07.098961 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.employees_invalid"} */
drop view if exists "postgres"."silver_invalid"."employees_invalid__dbt_backup" cascade
[0m07:16:07.415442 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.316 seconds
[0m07:16:07.416819 [debug] [Thread-2 (]: On model.retail_dbt.employees_invalid: Close
[0m07:16:07.417555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ee0ac3b0>]}
[0m07:16:07.418133 [info ] [Thread-2 (]: 5 of 19 OK created sql view model silver_invalid.employees_invalid ............. [[32mCREATE VIEW[0m in 7.42s]
[0m07:16:07.418694 [debug] [Thread-2 (]: Finished running node model.retail_dbt.employees_invalid
[0m07:16:07.419122 [debug] [Thread-2 (]: Began running node model.retail_dbt.purchase_orders_invalid
[0m07:16:07.419680 [info ] [Thread-2 (]: 12 of 19 START sql view model silver_invalid.purchase_orders_invalid ........... [RUN]
[0m07:16:07.420114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.employees_invalid, now model.retail_dbt.purchase_orders_invalid)
[0m07:16:07.420449 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.purchase_orders_invalid
[0m07:16:07.423415 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.purchase_orders_invalid"
[0m07:16:07.423946 [debug] [Thread-2 (]: Began executing node model.retail_dbt.purchase_orders_invalid
[0m07:16:07.427880 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.purchase_orders_invalid"
[0m07:16:07.428414 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.purchase_orders_invalid"
[0m07:16:07.428725 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: BEGIN
[0m07:16:07.429112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:08.043272 [debug] [Thread-4 (]: SQL status: BEGIN in 2.231 seconds
[0m07:16:08.043838 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_invalid"
[0m07:16:08.044309 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.products_invalid"} */

  create view "postgres"."silver_invalid"."products_invalid__dbt_tmp"
    
    
  as (
    

-- 1) Raw -> text sạch
WITH src AS (
    SELECT
        TRIM(CAST(product_id  AS text)) AS product_id_txt,
        TRIM(CAST(name        AS text)) AS name_txt,
        TRIM(CAST(category_id AS text)) AS category_id_txt,
        TRIM(CAST(brand_id    AS text)) AS brand_id_txt,
        TRIM(CAST(supplier_id AS text)) AS supplier_id_txt,
        TRIM(CAST(price       AS text)) AS price_txt,
        TRIM(REPLACE(CAST(created_at AS text), E'\r','')) AS created_at_txt,
        -- làm sạch season: bỏ \r, gom space
        TRIM(REGEXP_REPLACE(REPLACE(CAST(season AS text), E'\r',''), '\s+', ' ', 'g')) AS season_txt
    FROM "postgres"."raw"."products"
),

-- 2) Parse/cast để kiểm tra
typed AS (
    SELECT
        src.*,
        CASE WHEN product_id_txt  ~ '^\d+$'         THEN product_id_txt::integer  END AS product_id_val,
        CASE WHEN category_id_txt ~ '^\d+$'         THEN category_id_txt::integer END AS category_id_val,
        CASE WHEN brand_id_txt    ~ '^\d+$'         THEN brand_id_txt::integer    END AS brand_id_val,
        CASE WHEN supplier_id_txt ~ '^\d+$'         THEN supplier_id_txt::integer END AS supplier_id_val,
        CASE WHEN price_txt       ~ '^\d+(\.\d+)?$' THEN price_txt::numeric       END AS price_val,
        CASE
          WHEN created_at_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(created_at_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS created_at_val,

        -- chuẩn hoá & map season linh hoạt
        lower(season_txt) AS season_low,
        CASE
          WHEN lower(season_txt) ~ '^spring$'                    THEN 'Spring'
          WHEN lower(season_txt) ~ '^summer$'                    THEN 'Summer'
          WHEN lower(season_txt) ~ '^(fall|autumn)$'             THEN 'Fall'
          WHEN lower(season_txt) ~ '^winter$'                    THEN 'Winter'
          WHEN lower(season_txt) ~ '^all[ _-]?year$'             THEN 'All Year'
          ELSE NULL
        END AS season_norm
    FROM src
),

-- 3) Cờ NA/rỗng
na_flags AS (
    SELECT
        *,
        (product_id_txt  IS NULL OR product_id_txt  = '' OR lower(product_id_txt)  IN ('na','n/a')) AS na_product_id,
        (name_txt        IS NULL OR name_txt        = '' OR lower(name_txt)        IN ('na','n/a')) AS na_name,
        (category_id_txt IS NULL OR category_id_txt = '' OR lower(category_id_txt) IN ('na','n/a')) AS na_category_id,
        (brand_id_txt    IS NULL OR brand_id_txt    = '' OR lower(brand_id_txt)    IN ('na','n/a')) AS na_brand_id,
        (supplier_id_txt IS NULL OR supplier_id_txt = '' OR lower(supplier_id_txt) IN ('na','n/a')) AS na_supplier_id,
        (price_txt       IS NULL OR price_txt       = '' OR lower(price_txt)       IN ('na','n/a')) AS na_price,
        (created_at_txt  IS NULL OR created_at_txt  = '' OR lower(created_at_txt)  IN ('na','n/a')) AS na_created_at,
        (season_txt      IS NULL OR season_txt      = '' OR lower(season_txt)      IN ('na','n/a')) AS na_season
    FROM typed
),

-- 4) Cờ invalid theo rule staging (price NOT NULL; created_at < 2025-08-22; season hợp lệ)
flags AS (
    SELECT
        *,
        (product_id_val  IS NULL OR product_id_val  <= 0) AS f_product_id_bad,
        (name_txt IS NULL OR name_txt='')                 AS f_name_bad,
        (category_id_val IS NULL OR category_id_val <= 0) AS f_category_id_bad,
        (brand_id_val    IS NULL OR brand_id_val    <= 0) AS f_brand_id_bad,
        (supplier_id_val IS NULL OR supplier_id_val <= 0) AS f_supplier_id_bad,

        (price_val IS NULL)                                AS f_price_null,
        (price_val IS NOT NULL AND price_val <= 0)         AS f_price_nonpositive,

        (created_at_val IS NULL)                           AS f_created_at_null_or_badfmt,
        (created_at_val IS NOT NULL AND created_at_val >= DATE '2025-08-22') AS f_created_at_on_or_after_cutoff,

        -- season: dùng season_norm đã chuẩn hoá; chỉ bad khi có giá trị nhưng không map được
        (season_norm IS NULL AND NOT na_season)            AS f_season_bad
    FROM na_flags
),

-- 5) Gộp lý do
reasons AS (
    SELECT
        *,
        array_remove(ARRAY[
            CASE WHEN na_product_id  THEN 'product_id missing/NA' END,
            CASE WHEN na_name        THEN 'name missing/NA' END,
            CASE WHEN na_category_id THEN 'category_id missing/NA' END,
            CASE WHEN na_brand_id    THEN 'brand_id missing/NA' END,
            CASE WHEN na_supplier_id THEN 'supplier_id missing/NA' END,
            CASE WHEN na_price       THEN 'price missing/NA' END,
            CASE WHEN na_created_at  THEN 'created_at missing/NA' END,
            CASE WHEN na_season      THEN 'season missing/NA' END,

            CASE WHEN NOT na_product_id  AND f_product_id_bad        THEN 'product_id not positive integer' END,
            CASE WHEN NOT na_name        AND f_name_bad              THEN 'name empty' END,
            CASE WHEN NOT na_category_id AND f_category_id_bad       THEN 'category_id not positive integer' END,
            CASE WHEN NOT na_brand_id    AND f_brand_id_bad          THEN 'brand_id not positive integer' END,
            CASE WHEN NOT na_supplier_id AND f_supplier_id_bad       THEN 'supplier_id not positive integer' END,
            CASE WHEN NOT na_price       AND f_price_null            THEN 'price is NULL' END,
            CASE WHEN NOT na_price       AND f_price_nonpositive     THEN 'price <= 0' END,
            CASE WHEN NOT na_created_at  AND f_created_at_null_or_badfmt THEN 'created_at invalid format' END,
            CASE WHEN f_created_at_on_or_after_cutoff               THEN 'created_at >= 2025-08-22' END,
            CASE WHEN f_season_bad                                   THEN 'season not in {Spring,Summer,Fall,Winter,All Year}' END
        ], NULL) AS reason_arr
    FROM flags
)

-- 6) Kết quả invalid
SELECT
    product_id_txt  AS product_id,
    name_txt        AS name,
    category_id_txt AS category_id,
    brand_id_txt    AS brand_id,
    supplier_id_txt AS supplier_id,
    price_txt       AS price,
    created_at_txt  AS created_at,
    season_txt      AS season,
    array_to_string(reason_arr, '; ') AS invalid_reason
FROM reasons
WHERE cardinality(reason_arr) > 0
  );
[0m07:16:08.274414 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.230 seconds
[0m07:16:08.277209 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_invalid"
[0m07:16:08.277571 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.products_invalid"} */
alter table "postgres"."silver_invalid"."products_invalid__dbt_tmp" rename to "products_invalid"
[0m07:16:08.311350 [debug] [Thread-3 (]: SQL status: BEGIN in 2.673 seconds
[0m07:16:08.311835 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.pricing_history_invalid"
[0m07:16:08.312273 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.pricing_history_invalid"} */

  create view "postgres"."silver_invalid"."pricing_history_invalid__dbt_tmp"
    
    
  as (
    

-- 1) Lấy dữ liệu thô và chuẩn hoá text
WITH src AS (
    SELECT
        TRIM(CAST(history_id     AS text))                         AS history_id_raw,
        TRIM(CAST(product_id     AS text))                         AS product_id_raw,
        TRIM(CAST(price          AS text))                         AS price_raw,
        TRIM(REPLACE(CAST(effective_date AS text), E'\r',''))      AS effective_date_raw
    FROM "postgres"."raw"."pricing_history"
),

-- 2) Parse/cast về kiểu dùng để kiểm tra
typed AS (
    SELECT
        history_id_raw,
        product_id_raw,
        price_raw,
        effective_date_raw,

        CASE WHEN price_raw ~ '^-?\d+(\.\d+)?$' THEN price_raw::numeric END AS price_num,
        CASE
          WHEN effective_date_raw ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(effective_date_raw, '-', '/'),'YYYY/FMMM/FMDD')::date
        END AS effective_date_cast
    FROM src
),

-- 3) Cờ thiếu/NA
na_flags AS (
    SELECT
        history_id_raw,
        product_id_raw,
        price_raw,
        effective_date_raw,
        price_num,
        effective_date_cast,

        (price_raw IS NULL OR price_raw = '' OR lower(price_raw) IN ('na','n/a')) AS f_price_missing,
        (effective_date_raw IS NULL OR effective_date_raw = ''
            OR lower(effective_date_raw) IN ('na','n/a'))                         AS f_date_missing
    FROM typed
),

-- 4) Các cờ còn lại
flags AS (
    SELECT
        history_id_raw,
        product_id_raw,
        price_raw,
        effective_date_raw,
        price_num,
        effective_date_cast,
        f_price_missing,
        f_date_missing,

        (price_num IS NULL AND NOT f_price_missing)        AS f_price_not_numeric,
        (price_num IS NOT NULL AND price_num <= 0)         AS f_price_nonpositive,
        (effective_date_cast IS NULL AND NOT f_date_missing) AS f_date_bad_format,
        (effective_date_cast IS NOT NULL
         AND effective_date_cast > CURRENT_DATE)           AS f_date_future
    FROM na_flags
),

-- 5) Gộp lý do
reasons AS (
    SELECT
        history_id_raw,
        product_id_raw,
        price_raw,
        effective_date_raw,
        price_num,
        effective_date_cast,
        array_remove(ARRAY[
            CASE WHEN f_price_missing      THEN 'price missing/NA' END,
            CASE WHEN f_price_not_numeric  THEN 'price not numeric' END,
            CASE WHEN f_price_nonpositive  THEN 'price <= 0' END,
            CASE WHEN f_date_missing       THEN 'effective_date missing/NA' END,
            CASE WHEN f_date_bad_format    THEN 'effective_date invalid format' END,
            CASE WHEN f_date_future        THEN 'effective_date in the future' END
        ], NULL) AS reason_arr
    FROM flags
)

-- 6) Kết quả invalid
SELECT
    history_id_raw      AS history_id,
    product_id_raw      AS product_id,
    price_raw           AS price_raw,
    price_num           AS price_parsed,
    effective_date_raw  AS effective_date_raw,
    effective_date_cast AS effective_date_parsed,
    array_to_string(reason_arr, '; ') AS invalid_reason
FROM reasons
WHERE cardinality(reason_arr) > 0
  );
[0m07:16:08.499146 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.221 seconds
[0m07:16:08.500282 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: COMMIT
[0m07:16:08.500594 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_invalid"
[0m07:16:08.500880 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: COMMIT
[0m07:16:08.567423 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.255 seconds
[0m07:16:08.570017 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.pricing_history_invalid"
[0m07:16:08.570348 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.pricing_history_invalid"} */
alter table "postgres"."silver_invalid"."pricing_history_invalid__dbt_tmp" rename to "pricing_history_invalid"
[0m07:16:08.724166 [debug] [Thread-4 (]: SQL status: COMMIT in 0.223 seconds
[0m07:16:08.726701 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_invalid"."products_invalid__dbt_backup"
[0m07:16:08.727264 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_invalid"
[0m07:16:08.727685 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.products_invalid"} */
drop view if exists "postgres"."silver_invalid"."products_invalid__dbt_backup" cascade
[0m07:16:08.843937 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.273 seconds
[0m07:16:08.845184 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: COMMIT
[0m07:16:08.845509 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.pricing_history_invalid"
[0m07:16:08.845796 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: COMMIT
[0m07:16:08.951540 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.223 seconds
[0m07:16:08.952922 [debug] [Thread-4 (]: On model.retail_dbt.products_invalid: Close
[0m07:16:08.953512 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec5ff7a0>]}
[0m07:16:08.954017 [info ] [Thread-4 (]: 10 of 19 OK created sql view model silver_invalid.products_invalid ............. [[32mCREATE VIEW[0m in 3.15s]
[0m07:16:08.954513 [debug] [Thread-4 (]: Finished running node model.retail_dbt.products_invalid
[0m07:16:08.954878 [debug] [Thread-4 (]: Began running node model.retail_dbt.returns_invalid
[0m07:16:08.955351 [info ] [Thread-4 (]: 13 of 19 START sql table model silver_invalid.returns_invalid .................. [RUN]
[0m07:16:08.955736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.products_invalid, now model.retail_dbt.returns_invalid)
[0m07:16:08.956060 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.returns_invalid
[0m07:16:08.958787 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.returns_invalid"
[0m07:16:08.959269 [debug] [Thread-4 (]: Began executing node model.retail_dbt.returns_invalid
[0m07:16:08.961641 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.returns_invalid"
[0m07:16:08.962138 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.returns_invalid"
[0m07:16:08.962443 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: BEGIN
[0m07:16:08.962760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:09.103851 [debug] [Thread-3 (]: SQL status: COMMIT in 0.258 seconds
[0m07:16:09.106060 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_invalid"."pricing_history_invalid__dbt_backup"
[0m07:16:09.106489 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.pricing_history_invalid"
[0m07:16:09.106793 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.pricing_history_invalid"} */
drop view if exists "postgres"."silver_invalid"."pricing_history_invalid__dbt_backup" cascade
[0m07:16:09.328328 [debug] [Thread-1 (]: SQL status: BEGIN in 2.398 seconds
[0m07:16:09.328754 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.promotions_invalid"
[0m07:16:09.329085 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.promotions_invalid"} */

  create view "postgres"."silver_invalid"."promotions_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(promotion_id AS text))                       AS promotion_id_txt,
        TRIM(CAST(name AS text))                               AS name_txt,
        TRIM(REPLACE(CAST(start_date AS text), E'\r',''))      AS start_date_txt,
        TRIM(REPLACE(CAST(end_date   AS text), E'\r',''))      AS end_date_txt
    FROM "postgres"."raw"."promotions"
),

typed AS (
    SELECT
        src.*,
        CASE WHEN promotion_id_txt ~ '^\d+$' THEN promotion_id_txt::int END AS promotion_id,
        NULLIF(NULLIF(lower(name_txt),'na'),'') AS name_clean,
        CASE
          WHEN start_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(start_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS start_date,
        CASE
          WHEN end_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(end_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS end_date
    FROM src
),

flags AS (
    SELECT
        *,
        (promotion_id IS NULL) AS f_bad_id,
        (name_clean IS NULL)   AS f_bad_name,
        (start_date IS NULL)   AS f_bad_start,
        (end_date   IS NULL)   AS f_bad_end,
        (start_date IS NOT NULL AND end_date IS NOT NULL AND start_date >= end_date) AS f_bad_order
    FROM typed
),

reasons AS (
    SELECT
        *,
        array_remove(ARRAY[
            CASE WHEN f_bad_id    THEN 'invalid promotion_id' END,
            CASE WHEN f_bad_name  THEN 'name missing/NA' END,
            CASE WHEN f_bad_start THEN 'invalid start_date' END,
            CASE WHEN f_bad_end   THEN 'invalid end_date' END,
            CASE WHEN f_bad_order THEN 'start_date >= end_date' END
        ], NULL) AS reason_arr
    FROM flags
)

SELECT
    promotion_id_txt AS promotion_id,
    name_txt         AS name,
    start_date_txt   AS start_date,
    end_date_txt     AS end_date,
    array_to_string(reason_arr,'; ') AS invalid_reason
FROM reasons
WHERE cardinality(reason_arr) > 0
  );
[0m07:16:09.363100 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.256 seconds
[0m07:16:09.364391 [debug] [Thread-3 (]: On model.retail_dbt.pricing_history_invalid: Close
[0m07:16:09.365033 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec779640>]}
[0m07:16:09.365518 [info ] [Thread-3 (]: 9 of 19 OK created sql view model silver_invalid.pricing_history_invalid ....... [[32mCREATE VIEW[0m in 3.73s]
[0m07:16:09.366207 [debug] [Thread-3 (]: Finished running node model.retail_dbt.pricing_history_invalid
[0m07:16:09.366588 [debug] [Thread-3 (]: Began running node model.retail_dbt.sales_items_invalid
[0m07:16:09.367031 [info ] [Thread-3 (]: 14 of 19 START sql view model silver_invalid.sales_items_invalid ............... [RUN]
[0m07:16:09.367503 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.pricing_history_invalid, now model.retail_dbt.sales_items_invalid)
[0m07:16:09.367944 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.sales_items_invalid
[0m07:16:09.371632 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.sales_items_invalid"
[0m07:16:09.372122 [debug] [Thread-3 (]: Began executing node model.retail_dbt.sales_items_invalid
[0m07:16:09.374506 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.sales_items_invalid"
[0m07:16:09.374990 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_items_invalid"
[0m07:16:09.375279 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: BEGIN
[0m07:16:09.375596 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:09.440494 [debug] [Thread-2 (]: SQL status: BEGIN in 2.011 seconds
[0m07:16:09.440921 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.purchase_orders_invalid"
[0m07:16:09.441295 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.purchase_orders_invalid"} */

  create view "postgres"."silver_invalid"."purchase_orders_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(order_id AS text))       AS order_id_txt,
        TRIM(CAST(supplier_id AS text))    AS supplier_id_txt,
        TRIM(CAST(order_date AS text))     AS order_date_txt,
        TRIM(CAST(status AS text))         AS status_txt
    FROM "postgres"."raw"."purchase_orders"
),

typed AS (
    SELECT
        src.*,
        CASE WHEN order_id_txt ~ '^\d+$' THEN order_id_txt::int END        AS order_id,
        CASE WHEN supplier_id_txt ~ '^\d+$' THEN supplier_id_txt::int END  AS supplier_id,
        CASE
          WHEN order_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(order_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS order_date,
        NULLIF(NULLIF(lower(status_txt),'na'),'') AS status_clean
    FROM src
),

flags AS (
    SELECT *,
        (order_id IS NULL)                         AS f_bad_id,
        (supplier_id IS NULL)                      AS f_bad_supplier,
        (order_date IS NULL)                       AS f_bad_date,
        (order_date IS NOT NULL AND order_date > DATE '2025-08-22') AS f_future_date,
        (status_clean IS NULL)                     AS f_bad_status
    FROM typed
),

reasons AS (
    SELECT *,
        array_remove(ARRAY[
            CASE WHEN f_bad_id       THEN 'invalid order_id' END,
            CASE WHEN f_bad_supplier THEN 'invalid supplier_id' END,
            CASE WHEN f_bad_date     THEN 'invalid order_date' END,
            CASE WHEN f_future_date  THEN 'order_date > 2025-08-22' END,
            CASE WHEN f_bad_status   THEN 'status missing/NA' END
        ], NULL) AS reason_arr
    FROM flags
)

SELECT
    order_id_txt   AS order_id,
    supplier_id_txt AS supplier_id,
    order_date_txt AS order_date,
    status_txt     AS status,
    array_to_string(reason_arr,'; ') AS invalid_reason
FROM reasons
WHERE cardinality(reason_arr) > 0
  );
[0m07:16:09.579237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.250 seconds
[0m07:16:09.581862 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.promotions_invalid"
[0m07:16:09.582177 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.promotions_invalid"} */
alter table "postgres"."silver_invalid"."promotions_invalid__dbt_tmp" rename to "promotions_invalid"
[0m07:16:09.660040 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.218 seconds
[0m07:16:09.662694 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.purchase_orders_invalid"
[0m07:16:09.663030 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.purchase_orders_invalid"} */
alter table "postgres"."silver_invalid"."purchase_orders_invalid__dbt_tmp" rename to "purchase_orders_invalid"
[0m07:16:09.833129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.251 seconds
[0m07:16:09.834252 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: COMMIT
[0m07:16:09.834563 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.promotions_invalid"
[0m07:16:09.834958 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: COMMIT
[0m07:16:09.883009 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.220 seconds
[0m07:16:09.884080 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: COMMIT
[0m07:16:09.884418 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.purchase_orders_invalid"
[0m07:16:09.884706 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: COMMIT
[0m07:16:10.085430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.250 seconds
[0m07:16:10.087659 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_invalid"."promotions_invalid__dbt_backup"
[0m07:16:10.088245 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.promotions_invalid"
[0m07:16:10.088551 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.promotions_invalid"} */
drop view if exists "postgres"."silver_invalid"."promotions_invalid__dbt_backup" cascade
[0m07:16:10.101455 [debug] [Thread-2 (]: SQL status: COMMIT in 0.216 seconds
[0m07:16:10.103325 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_invalid"."purchase_orders_invalid__dbt_backup"
[0m07:16:10.103905 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.purchase_orders_invalid"
[0m07:16:10.104201 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.purchase_orders_invalid"} */
drop view if exists "postgres"."silver_invalid"."purchase_orders_invalid__dbt_backup" cascade
[0m07:16:10.323417 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.219 seconds
[0m07:16:10.324667 [debug] [Thread-2 (]: On model.retail_dbt.purchase_orders_invalid: Close
[0m07:16:10.325294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec7a27e0>]}
[0m07:16:10.325836 [info ] [Thread-2 (]: 12 of 19 OK created sql view model silver_invalid.purchase_orders_invalid ...... [[32mCREATE VIEW[0m in 2.91s]
[0m07:16:10.326355 [debug] [Thread-2 (]: Finished running node model.retail_dbt.purchase_orders_invalid
[0m07:16:10.326697 [debug] [Thread-2 (]: Began running node model.retail_dbt.sales_transactions_invalid
[0m07:16:10.327177 [info ] [Thread-2 (]: 15 of 19 START sql view model silver_invalid.sales_transactions_invalid ........ [RUN]
[0m07:16:10.327610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.purchase_orders_invalid, now model.retail_dbt.sales_transactions_invalid)
[0m07:16:10.327949 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.sales_transactions_invalid
[0m07:16:10.330565 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.sales_transactions_invalid"
[0m07:16:10.331053 [debug] [Thread-2 (]: Began executing node model.retail_dbt.sales_transactions_invalid
[0m07:16:10.334459 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.sales_transactions_invalid"
[0m07:16:10.334956 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.sales_transactions_invalid"
[0m07:16:10.335277 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: BEGIN
[0m07:16:10.335556 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:10.341831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.253 seconds
[0m07:16:10.342857 [debug] [Thread-1 (]: On model.retail_dbt.promotions_invalid: Close
[0m07:16:10.343405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec754f50>]}
[0m07:16:10.343916 [info ] [Thread-1 (]: 11 of 19 OK created sql view model silver_invalid.promotions_invalid ........... [[32mCREATE VIEW[0m in 3.42s]
[0m07:16:10.344415 [debug] [Thread-1 (]: Finished running node model.retail_dbt.promotions_invalid
[0m07:16:10.344792 [debug] [Thread-1 (]: Began running node model.retail_dbt.shipments_invalid
[0m07:16:10.345298 [info ] [Thread-1 (]: 16 of 19 START sql view model silver_invalid.shipments_invalid ................. [RUN]
[0m07:16:10.345668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.promotions_invalid, now model.retail_dbt.shipments_invalid)
[0m07:16:10.345995 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.shipments_invalid
[0m07:16:10.348429 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.shipments_invalid"
[0m07:16:10.348911 [debug] [Thread-1 (]: Began executing node model.retail_dbt.shipments_invalid
[0m07:16:10.351317 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.shipments_invalid"
[0m07:16:10.351795 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.shipments_invalid"
[0m07:16:10.352100 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: BEGIN
[0m07:16:10.352398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:11.247608 [debug] [Thread-4 (]: SQL status: BEGIN in 2.285 seconds
[0m07:16:11.248003 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.returns_invalid"
[0m07:16:11.248345 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.returns_invalid"} */

  
    

  create  table "postgres"."silver_invalid"."returns_invalid__dbt_tmp"
  
  
    as
  
  (
    

WITH src AS (
    SELECT
        TRIM(CAST(return_id   AS text))                               AS return_id_txt,
        TRIM(CAST(item_id     AS text))                               AS item_id_txt,
        TRIM(REGEXP_REPLACE(REPLACE(CAST(reason AS text), E'\r',''), '\s+', ' ', 'g')) AS reason_txt,
        TRIM(REPLACE(CAST(return_date AS text), E'\r',''))            AS return_date_txt
    FROM "postgres"."raw"."returns"
),

typed AS (
    SELECT
        return_id_txt,
        item_id_txt,
        reason_txt,
        return_date_txt,

        CASE WHEN return_id_txt ~ '^\d+$' THEN return_id_txt::int END AS return_id,
        CASE WHEN item_id_txt   ~ '^\d+$' THEN item_id_txt::int   END AS item_id,

        CASE
          WHEN reason_txt IS NULL OR reason_txt = '' THEN NULL
          WHEN lower(reason_txt) IN ('na','n/a') THEN NULL
          ELSE reason_txt
        END AS reason_clean,

        CASE
          WHEN return_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(return_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS return_date_clean
    FROM src
)

SELECT
    return_id_txt        AS return_id_raw,
    item_id_txt          AS item_id_raw,
    reason_txt           AS reason_raw,
    return_date_txt      AS return_date_raw,
    return_id,
    item_id,
    reason_clean,
    return_date_clean,

    -- lý do bị loại
    CASE
        WHEN return_id IS NULL OR item_id IS NULL
            THEN 'invalid_id'
        WHEN reason_clean IS NULL
            THEN 'invalid_reason'
        WHEN return_date_clean IS NULL
            THEN 'invalid_date_format'
        WHEN return_date_clean > DATE '2025-08-22'
            THEN 'future_date'
    END AS invalid_reason
FROM typed
WHERE
      return_id IS NULL
   OR item_id IS NULL
   OR reason_clean IS NULL
   OR return_date_clean IS NULL
   OR return_date_clean > DATE '2025-08-22'
  );
  
[0m07:16:11.565290 [debug] [Thread-4 (]: SQL status: SELECT 500 in 0.316 seconds
[0m07:16:11.568157 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.returns_invalid"
[0m07:16:11.568512 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.returns_invalid"} */
alter table "postgres"."silver_invalid"."returns_invalid__dbt_tmp" rename to "returns_invalid"
[0m07:16:11.629744 [debug] [Thread-3 (]: SQL status: BEGIN in 2.254 seconds
[0m07:16:11.630211 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_items_invalid"
[0m07:16:11.630552 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_items_invalid"} */

  create view "postgres"."silver_invalid"."sales_items_invalid__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."sales_items"
),

final as (
    select
        -- Primary key casting
        cast(item_id as int) as item_id,
        cast(transaction_id as int) as transaction_id,
        cast(product_id as int) as product_id,
        
        -- Quantity casting
        cast(quantity as int) as quantity,
        
        -- Price and monetary fields casting
        cast(unit_price as decimal(10,2)) as unit_price,
        cast(discount as decimal(10,2)) as discount,
        cast(tax as decimal(10,2)) as tax,
        
        -- Calculated fields
        cast(unit_price as decimal(10,2)) * cast(quantity as int) as gross_amount,
        (cast(unit_price as decimal(10,2)) * cast(quantity as int)) - 
         cast(discount as decimal(10,2)) + 
         cast(tax as decimal(10,2)) as net_amount,
        
        -- Business logic validation flags
        case 
            when cast(quantity as int) > 0 and cast(unit_price as decimal(10,2)) < 0 then 'invalid_positive_qty_negative_price'
            when cast(discount as decimal(10,2)) > cast(unit_price as decimal(10,2)) * cast(quantity as int) then 'discount_exceeds_gross'
            when cast(discount as decimal(10,2)) < 0 then 'negative_discount'
            when cast(tax as decimal(10,2)) < 0 then 'negative_tax'
            when cast(quantity as int) < 0 then 'negative_quantity'
            else 'valid'
        end as business_validation_flag
        
    from source_data
    
    -- Keep only invalid records
    where not (
        item_id is not null
        and transaction_id is not null  
        and product_id is not null
        and quantity is not null
        and unit_price is not null
        and discount is not null
        and tax is not null
        -- Business rules
        and cast(quantity as int) >= 0
        and cast(discount as decimal(10,2)) >= 0
        and cast(tax as decimal(10,2)) >= 0
        and cast(discount as decimal(10,2)) <= cast(unit_price as decimal(10,2)) * cast(quantity as int)
        and not (cast(quantity as int) > 0 and cast(unit_price as decimal(10,2)) < 0)
    )
)

select * from final
  );
[0m07:16:11.819609 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.251 seconds
[0m07:16:11.820832 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: COMMIT
[0m07:16:11.821138 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.returns_invalid"
[0m07:16:11.821431 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: COMMIT
[0m07:16:11.884040 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.253 seconds
[0m07:16:11.886608 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_items_invalid"
[0m07:16:11.886927 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_items_invalid"} */
alter table "postgres"."silver_invalid"."sales_items_invalid__dbt_tmp" rename to "sales_items_invalid"
[0m07:16:12.134533 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.247 seconds
[0m07:16:12.135747 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: COMMIT
[0m07:16:12.136085 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_items_invalid"
[0m07:16:12.136400 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: COMMIT
[0m07:16:12.382433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.246 seconds
[0m07:16:12.384618 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_invalid"."sales_items_invalid__dbt_backup"
[0m07:16:12.385057 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_items_invalid"
[0m07:16:12.385377 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_items_invalid"} */
drop view if exists "postgres"."silver_invalid"."sales_items_invalid__dbt_backup" cascade
[0m07:16:12.491298 [debug] [Thread-1 (]: SQL status: BEGIN in 2.139 seconds
[0m07:16:12.491817 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.shipments_invalid"
[0m07:16:12.492273 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.shipments_invalid"} */

  create view "postgres"."silver_invalid"."shipments_invalid__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."shipments"
),

final as (
    select
        cast(shipment_id as int) as shipment_id,
        cast(order_id as int) as order_id,
        cast(store_id as int) as store_id,
        case
            when shipped_date is null or shipped_date = 'N/A' or shipped_date > '2025-08-22 00:00:00' then null
            else cast(shipped_date as timestamp)
        end as shipped_date,
        case
            when received_date is null or received_date = 'N/A' or received_date > '2025-08-22 00:00:00' then null
            else cast(received_date as timestamp)
        end as received_date,
        case
            when shipment_id is null or shipment_id = 'N/A' then 'invalid_shipment_id'
            when order_id is null or order_id = 'N/A' then 'invalid_order_id'
            when store_id is null or store_id = 'N/A' then 'invalid_store_id'
            when case
                when shipped_date is null or shipped_date = 'N/A' or shipped_date > '2025-08-22 00:00:00' then null
                else cast(shipped_date as timestamp)
            end is null then 'invalid_shipped_date'
            when case
                when received_date is null or received_date = 'N/A' or received_date > '2025-08-22 00:00:00' then null
                else cast(received_date as timestamp)
            end is null then 'invalid_received_date'
            when shipped_date >= received_date then 'shipped_date_not_before_received_date'
            else 'valid'
        end as invalid_reason
    from source_data
    where not (
        shipment_id is not null
        and order_id is not null
        and store_id is not null
        and case
            when shipped_date is null or shipped_date = 'N/A' or shipped_date > '2025-08-22 00:00:00' then null
            else cast(shipped_date as timestamp)
        end is not null
        and case
            when received_date is null or received_date = 'N/A' or received_date > '2025-08-22 00:00:00' then null
            else cast(received_date as timestamp)
        end is not null
        and case
            when shipped_date is null or shipped_date = 'N/A' or shipped_date > '2025-08-22 00:00:00' then null
            else cast(shipped_date as timestamp)
        end < case
            when received_date is null or received_date = 'N/A' or received_date > '2025-08-22 00:00:00' then null
            else cast(received_date as timestamp)
        end
        and shipment_id != 'N/A'
        and order_id != 'N/A'
        and store_id != 'N/A'
        and shipped_date != 'N/A'
        and received_date != 'N/A'
    )
)

select * from final
  );
[0m07:16:12.553675 [debug] [Thread-4 (]: SQL status: COMMIT in 0.732 seconds
[0m07:16:12.556292 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_invalid"."returns_invalid__dbt_backup"
[0m07:16:12.556832 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.returns_invalid"
[0m07:16:12.557141 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.returns_invalid"} */
drop table if exists "postgres"."silver_invalid"."returns_invalid__dbt_backup" cascade
[0m07:16:12.564092 [debug] [Thread-2 (]: SQL status: BEGIN in 2.228 seconds
[0m07:16:12.564586 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.sales_transactions_invalid"
[0m07:16:12.564998 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_transactions_invalid"} */

  create view "postgres"."silver_invalid"."sales_transactions_invalid__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."sales_transactions"
),

final as (
    select
        cast(transaction_id as int) as transaction_id,
        cast(customer_id as int) as customer_id,
        cast(store_id as int) as store_id,
        cast(employee_id as int) as employee_id,
        cast(transaction_date as timestamp) as transaction_date,
        case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end as total_amount,
        cast(payment_id as int) as payment_id,
        case
            when transaction_id is null or transaction_id = 'N/A' then 'invalid_transaction_id'
            when customer_id is null or customer_id = 'N/A' then 'invalid_customer_id'
            when store_id is null or store_id = 'N/A' then 'invalid_store_id'
            when employee_id is null or employee_id = 'N/A' then 'invalid_employee_id'
            when transaction_date is null then 'invalid_transaction_date'
            when case
                when trim(upper(total_amount)) = 'N/A' then null
                else cast(total_amount as decimal(15,2))
            end is null or case
                when trim(upper(total_amount)) = 'N/A' then null
                else cast(total_amount as decimal(15,2))
            end = 0 then 'invalid_total_amount'
            when payment_id is null or payment_id = 'N/A' then 'invalid_payment_id'
            else 'valid'
        end as invalid_reason
    from source_data
    where not (
        transaction_id is not null
        and customer_id is not null
        and store_id is not null
        and employee_id is not null
        and transaction_date is not null
        and case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end is not null
        and payment_id is not null
        and case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end != 0
        and transaction_id != 'N/A'
        and customer_id != 'N/A'
        and store_id != 'N/A'
        and employee_id != 'N/A'
        and payment_id != 'N/A'
    )
)

select * from final
  );
[0m07:16:12.631707 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.246 seconds
[0m07:16:12.633179 [debug] [Thread-3 (]: On model.retail_dbt.sales_items_invalid: Close
[0m07:16:12.633831 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f0182570>]}
[0m07:16:12.634340 [info ] [Thread-3 (]: 14 of 19 OK created sql view model silver_invalid.sales_items_invalid .......... [[32mCREATE VIEW[0m in 3.27s]
[0m07:16:12.634835 [debug] [Thread-3 (]: Finished running node model.retail_dbt.sales_items_invalid
[0m07:16:12.635189 [debug] [Thread-3 (]: Began running node model.retail_dbt.stock_movements_invalid
[0m07:16:12.635720 [info ] [Thread-3 (]: 17 of 19 START sql view model silver_invalid.stock_movements_invalid ........... [RUN]
[0m07:16:12.636235 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.sales_items_invalid, now model.retail_dbt.stock_movements_invalid)
[0m07:16:12.636705 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stock_movements_invalid
[0m07:16:12.641195 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stock_movements_invalid"
[0m07:16:12.641683 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stock_movements_invalid
[0m07:16:12.644219 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stock_movements_invalid"
[0m07:16:12.644982 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stock_movements_invalid"
[0m07:16:12.645429 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: BEGIN
[0m07:16:12.645830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:12.735884 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.243 seconds
[0m07:16:12.739072 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.shipments_invalid"
[0m07:16:12.739451 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.shipments_invalid"} */
alter table "postgres"."silver_invalid"."shipments_invalid__dbt_tmp" rename to "shipments_invalid"
[0m07:16:12.809077 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.243 seconds
[0m07:16:12.812403 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.sales_transactions_invalid"
[0m07:16:12.812794 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_transactions_invalid"} */
alter table "postgres"."silver_invalid"."sales_transactions_invalid__dbt_tmp" rename to "sales_transactions_invalid"
[0m07:16:12.824190 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.267 seconds
[0m07:16:12.825339 [debug] [Thread-4 (]: On model.retail_dbt.returns_invalid: Close
[0m07:16:12.825937 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec7d3650>]}
[0m07:16:12.826482 [info ] [Thread-4 (]: 13 of 19 OK created sql table model silver_invalid.returns_invalid ............. [[32mSELECT 500[0m in 3.87s]
[0m07:16:12.827062 [debug] [Thread-4 (]: Finished running node model.retail_dbt.returns_invalid
[0m07:16:12.827448 [debug] [Thread-4 (]: Began running node model.retail_dbt.store_visits_invalid
[0m07:16:12.827999 [info ] [Thread-4 (]: 18 of 19 START sql view model silver_invalid.store_visits_invalid .............. [RUN]
[0m07:16:12.828399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.returns_invalid, now model.retail_dbt.store_visits_invalid)
[0m07:16:12.828795 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.store_visits_invalid
[0m07:16:12.831897 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.store_visits_invalid"
[0m07:16:12.832439 [debug] [Thread-4 (]: Began executing node model.retail_dbt.store_visits_invalid
[0m07:16:12.835353 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.store_visits_invalid"
[0m07:16:12.835888 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.store_visits_invalid"
[0m07:16:12.836239 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: BEGIN
[0m07:16:12.836564 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:12.986793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.247 seconds
[0m07:16:12.988397 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: COMMIT
[0m07:16:12.988918 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.shipments_invalid"
[0m07:16:12.989323 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: COMMIT
[0m07:16:13.064039 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.251 seconds
[0m07:16:13.065472 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: COMMIT
[0m07:16:13.065842 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.sales_transactions_invalid"
[0m07:16:13.066183 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: COMMIT
[0m07:16:13.232095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.242 seconds
[0m07:16:13.234886 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_invalid"."shipments_invalid__dbt_backup"
[0m07:16:13.235628 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.shipments_invalid"
[0m07:16:13.236053 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.shipments_invalid"} */
drop view if exists "postgres"."silver_invalid"."shipments_invalid__dbt_backup" cascade
[0m07:16:13.317451 [debug] [Thread-2 (]: SQL status: COMMIT in 0.251 seconds
[0m07:16:13.321240 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_invalid"."sales_transactions_invalid__dbt_backup"
[0m07:16:13.321921 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.sales_transactions_invalid"
[0m07:16:13.322321 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_transactions_invalid"} */
drop view if exists "postgres"."silver_invalid"."sales_transactions_invalid__dbt_backup" cascade
[0m07:16:13.475722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.239 seconds
[0m07:16:13.477091 [debug] [Thread-1 (]: On model.retail_dbt.shipments_invalid: Close
[0m07:16:13.477809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec6220f0>]}
[0m07:16:13.478357 [info ] [Thread-1 (]: 16 of 19 OK created sql view model silver_invalid.shipments_invalid ............ [[32mCREATE VIEW[0m in 3.13s]
[0m07:16:13.478884 [debug] [Thread-1 (]: Finished running node model.retail_dbt.shipments_invalid
[0m07:16:13.479263 [debug] [Thread-1 (]: Began running node model.retail_dbt.tax_rules_invalid
[0m07:16:13.479810 [info ] [Thread-1 (]: 19 of 19 START sql view model silver_invalid.tax_rules_invalid ................. [RUN]
[0m07:16:13.480377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.shipments_invalid, now model.retail_dbt.tax_rules_invalid)
[0m07:16:13.480774 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.tax_rules_invalid
[0m07:16:13.484034 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.tax_rules_invalid"
[0m07:16:13.484656 [debug] [Thread-1 (]: Began executing node model.retail_dbt.tax_rules_invalid
[0m07:16:13.487674 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.tax_rules_invalid"
[0m07:16:13.488218 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_invalid"
[0m07:16:13.488529 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: BEGIN
[0m07:16:13.488822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:13.570516 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.248 seconds
[0m07:16:13.571908 [debug] [Thread-2 (]: On model.retail_dbt.sales_transactions_invalid: Close
[0m07:16:13.572663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec63cce0>]}
[0m07:16:13.573245 [info ] [Thread-2 (]: 15 of 19 OK created sql view model silver_invalid.sales_transactions_invalid ... [[32mCREATE VIEW[0m in 3.24s]
[0m07:16:13.573831 [debug] [Thread-2 (]: Finished running node model.retail_dbt.sales_transactions_invalid
[0m07:16:15.275950 [debug] [Thread-3 (]: SQL status: BEGIN in 2.630 seconds
[0m07:16:15.276446 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stock_movements_invalid"
[0m07:16:15.276861 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stock_movements_invalid"} */

  create view "postgres"."silver_invalid"."stock_movements_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    TRIM(CAST(movement_id   AS text)) AS movement_id_txt,
    TRIM(CAST(product_id    AS text)) AS product_id_txt,
    TRIM(CAST(store_id      AS text)) AS store_id_txt,
    TRIM(CAST(movement_type AS text)) AS movement_type_txt,
    TRIM(CAST(quantity      AS text)) AS quantity_txt,
    TRIM(REPLACE(CAST(movement_date AS text), E'\r','')) AS movement_date_txt
  FROM "postgres"."raw"."stock_movements"
),

checked AS (
  SELECT
    *,
    -- validate từng cột
    CASE 
      WHEN movement_id_txt !~ '^\d+$' OR movement_id_txt::int <= 0
        THEN 'invalid_movement_id'
    END AS r_id,

    CASE 
      WHEN product_id_txt !~ '^\d+$' OR product_id_txt::int <= 0
        THEN 'invalid_product_id'
    END AS r_product,

    CASE 
      WHEN store_id_txt !~ '^\d+$' OR store_id_txt::int <= 0
        THEN 'invalid_store_id'
    END AS r_store,

    CASE 
      WHEN upper(TRIM(movement_type_txt)) NOT IN ('IN','OUT','TRANSFER')
        THEN 'invalid_movement_type'
    END AS r_type,

    CASE 
      WHEN quantity_txt IS NULL OR quantity_txt = '' 
        OR lower(quantity_txt) IN ('unknown','na','n/a')
        OR quantity_txt !~ '^-?\d+$'
        OR quantity_txt::int <= 0
        THEN 'invalid_quantity'
    END AS r_qty,

    CASE 
      WHEN movement_date_txt IS NULL OR movement_date_txt = '' THEN 'date_null'
      WHEN movement_date_txt !~ '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
        THEN 'invalid_format_date'
      WHEN to_char(to_date(movement_date_txt,'YYYY-MM-DD'),'YYYY-MM-DD') <> movement_date_txt
        THEN 'nonexistent_date'
      WHEN to_date(movement_date_txt,'YYYY-MM-DD') > DATE '2025-08-22'
        THEN 'future_date'
    END AS r_date
  FROM src
)

SELECT
  movement_id_txt,
  product_id_txt,
  store_id_txt,
  movement_type_txt,
  quantity_txt,
  movement_date_txt,

  array_to_string(
    array_remove(ARRAY[r_id, r_product, r_store, r_type, r_qty, r_date], NULL),
    '; '
  ) AS invalid_reason
FROM checked
WHERE r_id IS NOT NULL
   OR r_product IS NOT NULL
   OR r_store IS NOT NULL
   OR r_type IS NOT NULL
   OR r_qty IS NOT NULL
   OR r_date IS NOT NULL
  );
[0m07:16:15.456206 [debug] [Thread-4 (]: SQL status: BEGIN in 2.620 seconds
[0m07:16:15.456724 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.store_visits_invalid"
[0m07:16:15.457143 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.store_visits_invalid"} */

  create view "postgres"."silver_invalid"."store_visits_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    TRIM(CAST(visit_id    AS text)) AS visit_id_txt,
    TRIM(CAST(customer_id AS text)) AS customer_id_txt,
    TRIM(CAST(store_id    AS text)) AS store_id_txt,
    TRIM(REPLACE(CAST(visit_date AS text), E'\r','')) AS visit_date_txt
  FROM "postgres"."raw"."store_visits"
),

checked AS (
  SELECT
    *,
    -- id checks
    CASE WHEN visit_id_txt    !~ '^\d+$'                  THEN 'invalid visit_id' END AS r_visit_id,
    CASE WHEN customer_id_txt !~ '^\d+$'                  THEN 'invalid customer_id' END AS r_customer_id,
    CASE WHEN store_id_txt    !~ '^\d+$'                  THEN 'invalid store_id' END AS r_store_id,

    -- date checks
    CASE 
      WHEN visit_date_txt IS NULL OR visit_date_txt = '' THEN 'visit_date is null/empty'
      WHEN visit_date_txt !~ '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
           THEN 'invalid date format'
      WHEN to_char(to_date(visit_date_txt,'YYYY-MM-DD'),'YYYY-MM-DD') <> visit_date_txt
           THEN 'nonexistent calendar date'
      WHEN to_date(visit_date_txt,'YYYY-MM-DD') > DATE '2025-08-22'
           THEN 'visit_date > 2025-08-22'
    END AS r_visit_date
  FROM src
)

SELECT
  visit_id_txt    AS visit_id,
  customer_id_txt AS customer_id,
  store_id_txt    AS store_id,
  visit_date_txt  AS visit_date,
  array_to_string(
    array_remove(ARRAY[r_visit_id, r_customer_id, r_store_id, r_visit_date], NULL),
    '; '
  ) AS invalid_reason
FROM checked
WHERE r_visit_id    IS NOT NULL
   OR r_customer_id IS NOT NULL
   OR r_store_id    IS NOT NULL
   OR r_visit_date  IS NOT NULL
  );
[0m07:16:15.563107 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.286 seconds
[0m07:16:15.565943 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stock_movements_invalid"
[0m07:16:15.566251 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stock_movements_invalid"} */
alter table "postgres"."silver_invalid"."stock_movements_invalid__dbt_tmp" rename to "stock_movements_invalid"
[0m07:16:15.719257 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.262 seconds
[0m07:16:15.722338 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.store_visits_invalid"
[0m07:16:15.722750 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.store_visits_invalid"} */
alter table "postgres"."silver_invalid"."store_visits_invalid__dbt_tmp" rename to "store_visits_invalid"
[0m07:16:15.823515 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.257 seconds
[0m07:16:15.824716 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: COMMIT
[0m07:16:15.825045 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stock_movements_invalid"
[0m07:16:15.825356 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: COMMIT
[0m07:16:15.920510 [debug] [Thread-1 (]: SQL status: BEGIN in 2.432 seconds
[0m07:16:15.921014 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_invalid"
[0m07:16:15.921385 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.tax_rules_invalid"} */

  create view "postgres"."silver_invalid"."tax_rules_invalid__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        tax_id::int                                    AS tax_id,
        product_id::int                                AS product_id,
        TRIM(LOWER(tax_rate))                          AS tax_rate_raw,
        TRIM(region)                                   AS region
    FROM raw.tax_rules
),

invalid AS (
    SELECT
        tax_id,
        product_id,
        tax_rate_raw,
        region,
        CASE
            WHEN tax_rate_raw IS NULL OR tax_rate_raw = '' THEN 'tax_rate_null_or_blank'
            WHEN tax_rate_raw IN ('none','n/a') THEN 'tax_rate_invalid_string'
            WHEN tax_rate_raw ~ '^[0-9]+(\.[0-9]+)?$' AND tax_rate_raw::numeric = 0 THEN 'tax_rate_zero'
            ELSE 'tax_rate_unknown_format'
        END AS invalid_reason
    FROM src
    WHERE 
        tax_rate_raw IS NULL
        OR tax_rate_raw = ''
        OR tax_rate_raw IN ('none','n/a')
        OR (tax_rate_raw ~ '^[0-9]+(\.[0-9]+)?$' AND tax_rate_raw::numeric = 0)
        OR tax_rate_raw !~ '^[0-9]+(\.[0-9]+)?$'
)

SELECT *
FROM invalid
  );
[0m07:16:15.983117 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.260 seconds
[0m07:16:15.984327 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: COMMIT
[0m07:16:15.984682 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.store_visits_invalid"
[0m07:16:15.985019 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: COMMIT
[0m07:16:16.081670 [debug] [Thread-3 (]: SQL status: COMMIT in 0.256 seconds
[0m07:16:16.084065 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_invalid"."stock_movements_invalid__dbt_backup"
[0m07:16:16.084608 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stock_movements_invalid"
[0m07:16:16.084935 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stock_movements_invalid"} */
drop view if exists "postgres"."silver_invalid"."stock_movements_invalid__dbt_backup" cascade
[0m07:16:16.175431 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.254 seconds
[0m07:16:16.178076 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_invalid"
[0m07:16:16.178409 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.tax_rules_invalid"} */
alter table "postgres"."silver_invalid"."tax_rules_invalid__dbt_tmp" rename to "tax_rules_invalid"
[0m07:16:16.251522 [debug] [Thread-4 (]: SQL status: COMMIT in 0.266 seconds
[0m07:16:16.254347 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_invalid"."store_visits_invalid__dbt_backup"
[0m07:16:16.254798 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.store_visits_invalid"
[0m07:16:16.255091 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.store_visits_invalid"} */
drop view if exists "postgres"."silver_invalid"."store_visits_invalid__dbt_backup" cascade
[0m07:16:16.348408 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.263 seconds
[0m07:16:16.349623 [debug] [Thread-3 (]: On model.retail_dbt.stock_movements_invalid: Close
[0m07:16:16.350196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec542840>]}
[0m07:16:16.350677 [info ] [Thread-3 (]: 17 of 19 OK created sql view model silver_invalid.stock_movements_invalid ...... [[32mCREATE VIEW[0m in 3.71s]
[0m07:16:16.351166 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stock_movements_invalid
[0m07:16:16.543143 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.288 seconds
[0m07:16:16.544620 [debug] [Thread-4 (]: On model.retail_dbt.store_visits_invalid: Close
[0m07:16:16.545220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec5275f0>]}
[0m07:16:16.545711 [info ] [Thread-4 (]: 18 of 19 OK created sql view model silver_invalid.store_visits_invalid ......... [[32mCREATE VIEW[0m in 3.72s]
[0m07:16:16.546211 [debug] [Thread-4 (]: Finished running node model.retail_dbt.store_visits_invalid
[0m07:16:16.951461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.773 seconds
[0m07:16:16.952886 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: COMMIT
[0m07:16:16.953271 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_invalid"
[0m07:16:16.953675 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: COMMIT
[0m07:16:17.201953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.248 seconds
[0m07:16:17.204954 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_invalid"."tax_rules_invalid__dbt_backup"
[0m07:16:17.205592 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_invalid"
[0m07:16:17.206012 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.tax_rules_invalid"} */
drop view if exists "postgres"."silver_invalid"."tax_rules_invalid__dbt_backup" cascade
[0m07:16:17.478396 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.272 seconds
[0m07:16:17.479938 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_invalid: Close
[0m07:16:17.480716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6baf91-6edb-4142-82d2-d7ee6bd0a9df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71ec7cff20>]}
[0m07:16:17.481370 [info ] [Thread-1 (]: 19 of 19 OK created sql view model silver_invalid.tax_rules_invalid ............ [[32mCREATE VIEW[0m in 4.00s]
[0m07:16:17.482028 [debug] [Thread-1 (]: Finished running node model.retail_dbt.tax_rules_invalid
[0m07:16:17.483934 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:17.484310 [debug] [MainThread]: On master: BEGIN
[0m07:16:17.484569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:16:20.585939 [debug] [MainThread]: SQL status: BEGIN in 3.101 seconds
[0m07:16:20.586405 [debug] [MainThread]: On master: COMMIT
[0m07:16:20.586747 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:20.587052 [debug] [MainThread]: On master: COMMIT
[0m07:16:20.810612 [debug] [MainThread]: SQL status: COMMIT in 0.223 seconds
[0m07:16:20.811003 [debug] [MainThread]: On master: Close
[0m07:16:20.811619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:16:20.811915 [debug] [MainThread]: Connection 'model.retail_dbt.tax_rules_invalid' was properly closed.
[0m07:16:20.812149 [debug] [MainThread]: Connection 'model.retail_dbt.stock_movements_invalid' was properly closed.
[0m07:16:20.812401 [debug] [MainThread]: Connection 'model.retail_dbt.store_visits_invalid' was properly closed.
[0m07:16:20.812682 [debug] [MainThread]: Connection 'model.retail_dbt.sales_transactions_invalid' was properly closed.
[0m07:16:20.813050 [info ] [MainThread]: 
[0m07:16:20.813389 [info ] [MainThread]: Finished running 2 table models, 17 view models in 0 hours 0 minutes and 38.18 seconds (38.18s).
[0m07:16:20.815726 [debug] [MainThread]: Command end result
[0m07:16:20.975175 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:16:20.977303 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:16:20.982003 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:16:20.982260 [info ] [MainThread]: 
[0m07:16:20.982580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:16:20.982875 [info ] [MainThread]: 
[0m07:16:20.983169 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=19
[0m07:16:20.983929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.349907, "process_in_blocks": "0", "process_kernel_time": 0.393661, "process_mem_max_rss": "142228", "process_out_blocks": "10184", "process_user_time": 3.241425}
[0m07:16:20.984298 [debug] [MainThread]: Command `dbt run` succeeded at 07:16:20.984227 after 37.35 seconds
[0m07:16:20.984577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f2e4f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f13dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b71f13dc0b0>]}
[0m07:16:20.984855 [debug] [MainThread]: Flushing usage events
[0m07:16:22.571305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:16:25.727303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78576906a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78576bbea9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785769659220>]}


============================== 07:16:25.733494 | 499d7c00-ab70-4dec-8330-65bf575394b6 ==============================
[0m07:16:25.733494 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:16:25.733925 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/airflow/.dbt', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select path:models/silver --full-refresh --profiles-dir /home/airflow/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'empty': 'False', 'log_format': 'default'}
[0m07:16:25.867720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785769b15b80>]}
[0m07:16:25.913861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785769777740>]}
[0m07:16:25.914442 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:16:26.002567 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:16:26.141534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:16:26.141875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:16:26.192395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785767fdc9b0>]}
[0m07:16:26.385625 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:16:26.388318 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:16:26.424603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785766f37680>]}
[0m07:16:26.425046 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:16:26.425386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78576906b440>]}
[0m07:16:26.435533 [info ] [MainThread]: 
[0m07:16:26.435887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:16:26.436141 [info ] [MainThread]: 
[0m07:16:26.436579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:26.440250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m07:16:26.467832 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:16:26.468185 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:16:26.468435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:30.160645 [debug] [ThreadPool]: SQL status: SELECT 6 in 3.692 seconds
[0m07:16:30.161818 [debug] [ThreadPool]: On list_postgres: Close
[0m07:16:30.162675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_silver)
[0m07:16:30.163123 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "silver"
"
[0m07:16:30.167707 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver"
[0m07:16:30.168001 [debug] [ThreadPool]: On create_postgres_silver: BEGIN
[0m07:16:30.168301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:32.951662 [debug] [ThreadPool]: SQL status: BEGIN in 2.783 seconds
[0m07:16:32.952115 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver"
[0m07:16:32.952445 [debug] [ThreadPool]: On create_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_postgres_silver"} */
create schema if not exists "silver"
[0m07:16:33.178144 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.225 seconds
[0m07:16:33.179190 [debug] [ThreadPool]: On create_postgres_silver: COMMIT
[0m07:16:33.179608 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver"
[0m07:16:33.179956 [debug] [ThreadPool]: On create_postgres_silver: COMMIT
[0m07:16:33.402019 [debug] [ThreadPool]: SQL status: COMMIT in 0.222 seconds
[0m07:16:33.402482 [debug] [ThreadPool]: On create_postgres_silver: Close
[0m07:16:33.409673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_silver, now list_postgres_silver)
[0m07:16:33.414422 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:16:33.414854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:16:33.415136 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:16:33.415783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m07:16:33.417331 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:16:33.417878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_staging'
[0m07:16:33.418227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:33.420304 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:16:33.420634 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:16:33.422202 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:16:33.422647 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:16:33.422978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:33.423380 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:16:33.423830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:33.424320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:37.495903 [debug] [ThreadPool]: SQL status: BEGIN in 2.435 seconds
[0m07:16:37.496322 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:16:37.496691 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:16:37.764275 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.267 seconds
[0m07:16:37.765619 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:16:37.929096 [debug] [ThreadPool]: SQL status: BEGIN in 2.869 seconds
[0m07:16:37.929530 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:16:37.929829 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:16:37.968033 [debug] [ThreadPool]: SQL status: BEGIN in 2.907 seconds
[0m07:16:37.968479 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:16:37.968869 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:16:38.001164 [debug] [ThreadPool]: SQL status: BEGIN in 2.946 seconds
[0m07:16:38.001554 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:16:38.001852 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:16:38.026984 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:16:38.249205 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.280 seconds
[0m07:16:38.249674 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.320 seconds
[0m07:16:38.251130 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:16:38.252424 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:16:38.281259 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.279 seconds
[0m07:16:38.282335 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:16:38.524036 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:16:38.561286 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:16:38.575664 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:16:38.587803 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.588143 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.588436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:41.123496 [debug] [MainThread]: SQL status: BEGIN in 2.535 seconds
[0m07:16:41.123917 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:41.124261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:41.384418 [debug] [MainThread]: SQL status: SELECT 40 in 0.260 seconds
[0m07:16:41.386169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785768eac680>]}
[0m07:16:41.386646 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:41.646549 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:41.646904 [debug] [MainThread]: On master: BEGIN
[0m07:16:42.178707 [debug] [MainThread]: SQL status: BEGIN in 0.531 seconds
[0m07:16:42.179116 [debug] [MainThread]: On master: COMMIT
[0m07:16:42.179493 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:42.179796 [debug] [MainThread]: On master: COMMIT
[0m07:16:42.438666 [debug] [MainThread]: SQL status: COMMIT in 0.259 seconds
[0m07:16:42.439048 [debug] [MainThread]: On master: Close
[0m07:16:42.442905 [debug] [Thread-1 (]: Began running node model.retail_dbt.brands_silver
[0m07:16:42.443350 [debug] [Thread-2 (]: Began running node model.retail_dbt.campaigns_silver
[0m07:16:42.444142 [debug] [Thread-3 (]: Began running node model.retail_dbt.categories_silver
[0m07:16:42.444682 [debug] [Thread-4 (]: Began running node model.retail_dbt.customer_feedback_silver
[0m07:16:42.443825 [info ] [Thread-1 (]: 1 of 23 START sql table model silver.brands_silver ............................. [RUN]
[0m07:16:42.445308 [info ] [Thread-2 (]: 2 of 23 START sql table model silver.campaigns_silver .......................... [RUN]
[0m07:16:42.445840 [info ] [Thread-3 (]: 3 of 23 START sql table model silver.categories_silver ......................... [RUN]
[0m07:16:42.446404 [info ] [Thread-4 (]: 4 of 23 START sql table model silver.customer_feedback_silver .................. [RUN]
[0m07:16:42.446963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now model.retail_dbt.brands_silver)
[0m07:16:42.447451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now model.retail_dbt.campaigns_silver)
[0m07:16:42.447845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now model.retail_dbt.categories_silver)
[0m07:16:42.448302 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now model.retail_dbt.customer_feedback_silver)
[0m07:16:42.448716 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.brands_silver
[0m07:16:42.449074 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.campaigns_silver
[0m07:16:42.449468 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.categories_silver
[0m07:16:42.449861 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.customer_feedback_silver
[0m07:16:42.455887 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.brands_silver"
[0m07:16:42.458411 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.campaigns_silver"
[0m07:16:42.460744 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.categories_silver"
[0m07:16:42.463033 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.customer_feedback_silver"
[0m07:16:42.463959 [debug] [Thread-2 (]: Began executing node model.retail_dbt.campaigns_silver
[0m07:16:42.474874 [debug] [Thread-4 (]: Began executing node model.retail_dbt.customer_feedback_silver
[0m07:16:42.480381 [debug] [Thread-3 (]: Began executing node model.retail_dbt.categories_silver
[0m07:16:42.505013 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.campaigns_silver"
[0m07:16:42.505399 [debug] [Thread-1 (]: Began executing node model.retail_dbt.brands_silver
[0m07:16:42.509255 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.categories_silver"
[0m07:16:42.512581 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.customer_feedback_silver"
[0m07:16:42.515398 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.brands_silver"
[0m07:16:42.516562 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.campaigns_silver"
[0m07:16:42.516971 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: BEGIN
[0m07:16:42.517442 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.customer_feedback_silver"
[0m07:16:42.517832 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.categories_silver"
[0m07:16:42.518215 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:42.518563 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: BEGIN
[0m07:16:42.518908 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.brands_silver"
[0m07:16:42.519300 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: BEGIN
[0m07:16:42.519819 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:42.520216 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: BEGIN
[0m07:16:42.520716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:42.521311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:44.625997 [debug] [Thread-3 (]: SQL status: BEGIN in 2.105 seconds
[0m07:16:44.626400 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.categories_silver"
[0m07:16:44.626737 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.categories_silver"} */

  
    

  create  table "postgres"."silver"."categories_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_categories" as s
  );
  
[0m07:16:44.628030 [debug] [Thread-1 (]: SQL status: BEGIN in 2.107 seconds
[0m07:16:44.628392 [debug] [Thread-4 (]: SQL status: BEGIN in 2.109 seconds
[0m07:16:44.628757 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.brands_silver"
[0m07:16:44.629149 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.customer_feedback_silver"
[0m07:16:44.629547 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.brands_silver"} */

  
    

  create  table "postgres"."silver"."brands_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_brands" as s
  );
  
[0m07:16:44.629937 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_feedback_silver"} */

  
    

  create  table "postgres"."silver"."customer_feedback_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_customer_feedback" as s
  );
  
[0m07:16:44.695713 [debug] [Thread-2 (]: SQL status: BEGIN in 2.177 seconds
[0m07:16:44.696140 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.campaigns_silver"
[0m07:16:44.696547 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.campaigns_silver"} */

  
    

  create  table "postgres"."silver"."campaigns_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_campaigns" as s
  );
  
[0m07:16:44.869831 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.243 seconds
[0m07:16:44.876990 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.categories_silver"
[0m07:16:44.877322 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.categories_silver"} */
alter table "postgres"."silver"."categories_silver__dbt_tmp" rename to "categories_silver"
[0m07:16:44.881874 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.252 seconds
[0m07:16:44.884098 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.brands_silver"
[0m07:16:44.884444 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.brands_silver"} */
alter table "postgres"."silver"."brands_silver__dbt_tmp" rename to "brands_silver"
[0m07:16:44.984566 [debug] [Thread-2 (]: SQL status: SELECT 177 in 0.288 seconds
[0m07:16:44.987102 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.campaigns_silver"
[0m07:16:44.987477 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.campaigns_silver"} */
alter table "postgres"."silver"."campaigns_silver__dbt_tmp" rename to "campaigns_silver"
[0m07:16:45.009263 [debug] [Thread-4 (]: SQL status: SELECT 3786 in 0.379 seconds
[0m07:16:45.012276 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.customer_feedback_silver"
[0m07:16:45.012646 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_feedback_silver"} */
alter table "postgres"."silver"."customer_feedback_silver__dbt_tmp" rename to "customer_feedback_silver"
[0m07:16:45.145683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.261 seconds
[0m07:16:45.146123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m07:16:45.159632 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: COMMIT
[0m07:16:45.161800 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: COMMIT
[0m07:16:45.162203 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.categories_silver"
[0m07:16:45.162584 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.brands_silver"
[0m07:16:45.163010 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: COMMIT
[0m07:16:45.163420 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: COMMIT
[0m07:16:45.220249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.232 seconds
[0m07:16:45.221437 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: COMMIT
[0m07:16:45.221759 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.campaigns_silver"
[0m07:16:45.222059 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: COMMIT
[0m07:16:45.235147 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.222 seconds
[0m07:16:45.236081 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: COMMIT
[0m07:16:45.236408 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.customer_feedback_silver"
[0m07:16:45.236742 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: COMMIT
[0m07:16:45.384261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.220 seconds
[0m07:16:45.384868 [debug] [Thread-3 (]: SQL status: COMMIT in 0.221 seconds
[0m07:16:45.392337 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver"."brands_silver__dbt_backup"
[0m07:16:45.394952 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver"."categories_silver__dbt_backup"
[0m07:16:45.399885 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.brands_silver"
[0m07:16:45.400487 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.categories_silver"
[0m07:16:45.400902 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.brands_silver"} */
drop table if exists "postgres"."silver"."brands_silver__dbt_backup" cascade
[0m07:16:45.401279 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.categories_silver"} */
drop table if exists "postgres"."silver"."categories_silver__dbt_backup" cascade
[0m07:16:45.445892 [debug] [Thread-2 (]: SQL status: COMMIT in 0.223 seconds
[0m07:16:45.448552 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver"."campaigns_silver__dbt_backup"
[0m07:16:45.449158 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.campaigns_silver"
[0m07:16:45.449532 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.campaigns_silver"} */
drop table if exists "postgres"."silver"."campaigns_silver__dbt_backup" cascade
[0m07:16:45.458716 [debug] [Thread-4 (]: SQL status: COMMIT in 0.222 seconds
[0m07:16:45.460969 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver"."customer_feedback_silver__dbt_backup"
[0m07:16:45.461434 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.customer_feedback_silver"
[0m07:16:45.461754 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customer_feedback_silver"} */
drop table if exists "postgres"."silver"."customer_feedback_silver__dbt_backup" cascade
[0m07:16:45.622875 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.221 seconds
[0m07:16:45.625069 [debug] [Thread-3 (]: On model.retail_dbt.categories_silver: Close
[0m07:16:45.626422 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78576b885670>]}
[0m07:16:45.626950 [info ] [Thread-3 (]: 3 of 23 OK created sql table model silver.categories_silver .................... [[32mSELECT 10[0m in 3.18s]
[0m07:16:45.627461 [debug] [Thread-3 (]: Finished running node model.retail_dbt.categories_silver
[0m07:16:45.627839 [debug] [Thread-3 (]: Began running node model.retail_dbt.customers_silver
[0m07:16:45.628799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.227 seconds
[0m07:16:45.628382 [info ] [Thread-3 (]: 5 of 23 START sql table model silver.customers_silver .......................... [RUN]
[0m07:16:45.630206 [debug] [Thread-1 (]: On model.retail_dbt.brands_silver: Close
[0m07:16:45.630674 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.categories_silver, now model.retail_dbt.customers_silver)
[0m07:16:45.631176 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.customers_silver
[0m07:16:45.631706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785764ba80b0>]}
[0m07:16:45.634358 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.customers_silver"
[0m07:16:45.635009 [info ] [Thread-1 (]: 1 of 23 OK created sql table model silver.brands_silver ........................ [[32mSELECT 10[0m in 3.18s]
[0m07:16:45.635738 [debug] [Thread-1 (]: Finished running node model.retail_dbt.brands_silver
[0m07:16:45.636163 [debug] [Thread-1 (]: Began running node model.retail_dbt.discount_rules_silver
[0m07:16:45.636713 [info ] [Thread-1 (]: 6 of 23 START sql table model silver.discount_rules_silver ..................... [RUN]
[0m07:16:45.637178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.brands_silver, now model.retail_dbt.discount_rules_silver)
[0m07:16:45.637560 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.discount_rules_silver
[0m07:16:45.637867 [debug] [Thread-3 (]: Began executing node model.retail_dbt.customers_silver
[0m07:16:45.640429 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.discount_rules_silver"
[0m07:16:45.644607 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.customers_silver"
[0m07:16:45.645263 [debug] [Thread-1 (]: Began executing node model.retail_dbt.discount_rules_silver
[0m07:16:45.648203 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.discount_rules_silver"
[0m07:16:45.648680 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customers_silver"
[0m07:16:45.649211 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: BEGIN
[0m07:16:45.649552 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:45.650086 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.discount_rules_silver"
[0m07:16:45.650453 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: BEGIN
[0m07:16:45.650862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:45.682785 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.233 seconds
[0m07:16:45.684246 [debug] [Thread-2 (]: On model.retail_dbt.campaigns_silver: Close
[0m07:16:45.684717 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.223 seconds
[0m07:16:45.685348 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785764b6f410>]}
[0m07:16:45.686609 [debug] [Thread-4 (]: On model.retail_dbt.customer_feedback_silver: Close
[0m07:16:45.687298 [info ] [Thread-2 (]: 2 of 23 OK created sql table model silver.campaigns_silver ..................... [[32mSELECT 177[0m in 3.24s]
[0m07:16:45.688015 [debug] [Thread-2 (]: Finished running node model.retail_dbt.campaigns_silver
[0m07:16:45.688576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785764b59f10>]}
[0m07:16:45.688998 [debug] [Thread-2 (]: Began running node model.retail_dbt.employees_silver
[0m07:16:45.689645 [info ] [Thread-4 (]: 4 of 23 OK created sql table model silver.customer_feedback_silver ............. [[32mSELECT 3786[0m in 3.24s]
[0m07:16:45.690192 [info ] [Thread-2 (]: 7 of 23 START sql table model silver.employees_silver .......................... [RUN]
[0m07:16:45.690805 [debug] [Thread-4 (]: Finished running node model.retail_dbt.customer_feedback_silver
[0m07:16:45.691272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.campaigns_silver, now model.retail_dbt.employees_silver)
[0m07:16:45.691753 [debug] [Thread-4 (]: Began running node model.retail_dbt.inventory_silver
[0m07:16:45.692200 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.employees_silver
[0m07:16:45.692703 [info ] [Thread-4 (]: 8 of 23 START sql table model silver.inventory_silver .......................... [RUN]
[0m07:16:45.695407 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.employees_silver"
[0m07:16:45.695865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.customer_feedback_silver, now model.retail_dbt.inventory_silver)
[0m07:16:45.696391 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.inventory_silver
[0m07:16:45.698818 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.inventory_silver"
[0m07:16:45.699192 [debug] [Thread-2 (]: Began executing node model.retail_dbt.employees_silver
[0m07:16:45.702327 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.employees_silver"
[0m07:16:45.702827 [debug] [Thread-4 (]: Began executing node model.retail_dbt.inventory_silver
[0m07:16:45.705737 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.inventory_silver"
[0m07:16:45.706144 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_silver"
[0m07:16:45.706653 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: BEGIN
[0m07:16:45.707109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:45.707734 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.inventory_silver"
[0m07:16:45.708201 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: BEGIN
[0m07:16:45.708681 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:47.706369 [debug] [Thread-1 (]: SQL status: BEGIN in 2.055 seconds
[0m07:16:47.706893 [debug] [Thread-3 (]: SQL status: BEGIN in 2.057 seconds
[0m07:16:47.707254 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.discount_rules_silver"
[0m07:16:47.707658 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customers_silver"
[0m07:16:47.708091 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.discount_rules_silver"} */

  
    

  create  table "postgres"."silver"."discount_rules_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_discount_rules" as s
  );
  
[0m07:16:47.708491 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customers_silver"} */

  
    

  create  table "postgres"."silver"."customers_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_customers" as s
  );
  
[0m07:16:47.856703 [debug] [Thread-2 (]: SQL status: BEGIN in 2.149 seconds
[0m07:16:47.857274 [debug] [Thread-4 (]: SQL status: BEGIN in 2.149 seconds
[0m07:16:47.857764 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_silver"
[0m07:16:47.858179 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.inventory_silver"
[0m07:16:47.858631 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.employees_silver"} */

  
    

  create  table "postgres"."silver"."employees_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_employees" as s
  );
  
[0m07:16:47.859126 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.inventory_silver"} */

  
    

  create  table "postgres"."silver"."inventory_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_inventory" as s
  );
  
[0m07:16:47.963845 [debug] [Thread-3 (]: SQL status: SELECT 902 in 0.255 seconds
[0m07:16:47.967935 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customers_silver"
[0m07:16:47.968301 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customers_silver"} */
alter table "postgres"."silver"."customers_silver__dbt_tmp" rename to "customers_silver"
[0m07:16:47.975436 [debug] [Thread-1 (]: SQL status: SELECT 454 in 0.267 seconds
[0m07:16:47.978132 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.discount_rules_silver"
[0m07:16:47.978497 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.discount_rules_silver"} */
alter table "postgres"."silver"."discount_rules_silver__dbt_tmp" rename to "discount_rules_silver"
[0m07:16:48.187723 [debug] [Thread-2 (]: SQL status: SELECT 200 in 0.328 seconds
[0m07:16:48.188170 [debug] [Thread-4 (]: SQL status: SELECT 1649 in 0.328 seconds
[0m07:16:48.191093 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_silver"
[0m07:16:48.193710 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.inventory_silver"
[0m07:16:48.194085 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.employees_silver"} */
alter table "postgres"."silver"."employees_silver__dbt_tmp" rename to "employees_silver"
[0m07:16:48.194488 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.inventory_silver"} */
alter table "postgres"."silver"."inventory_silver__dbt_tmp" rename to "inventory_silver"
[0m07:16:48.212545 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.244 seconds
[0m07:16:48.213573 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: COMMIT
[0m07:16:48.213932 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customers_silver"
[0m07:16:48.214242 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: COMMIT
[0m07:16:48.215961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.237 seconds
[0m07:16:48.217020 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: COMMIT
[0m07:16:48.217342 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.discount_rules_silver"
[0m07:16:48.217742 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: COMMIT
[0m07:16:48.444750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.250 seconds
[0m07:16:48.445345 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.250 seconds
[0m07:16:48.446638 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: COMMIT
[0m07:16:48.447701 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: COMMIT
[0m07:16:48.448127 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_silver"
[0m07:16:48.448614 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.inventory_silver"
[0m07:16:48.448989 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: COMMIT
[0m07:16:48.449350 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: COMMIT
[0m07:16:48.456744 [debug] [Thread-3 (]: SQL status: COMMIT in 0.242 seconds
[0m07:16:48.459136 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver"."customers_silver__dbt_backup"
[0m07:16:48.459673 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.customers_silver"
[0m07:16:48.459996 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.customers_silver"} */
drop table if exists "postgres"."silver"."customers_silver__dbt_backup" cascade
[0m07:16:48.465627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.248 seconds
[0m07:16:48.467662 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver"."discount_rules_silver__dbt_backup"
[0m07:16:48.468132 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.discount_rules_silver"
[0m07:16:48.468457 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.discount_rules_silver"} */
drop table if exists "postgres"."silver"."discount_rules_silver__dbt_backup" cascade
[0m07:16:48.695489 [debug] [Thread-2 (]: SQL status: COMMIT in 0.246 seconds
[0m07:16:48.697861 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver"."employees_silver__dbt_backup"
[0m07:16:48.698375 [debug] [Thread-4 (]: SQL status: COMMIT in 0.249 seconds
[0m07:16:48.698904 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.employees_silver"
[0m07:16:48.701736 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver"."inventory_silver__dbt_backup"
[0m07:16:48.702150 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.employees_silver"} */
drop table if exists "postgres"."silver"."employees_silver__dbt_backup" cascade
[0m07:16:48.702722 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.inventory_silver"
[0m07:16:48.703191 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.243 seconds
[0m07:16:48.703665 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.inventory_silver"} */
drop table if exists "postgres"."silver"."inventory_silver__dbt_backup" cascade
[0m07:16:48.705003 [debug] [Thread-3 (]: On model.retail_dbt.customers_silver: Close
[0m07:16:48.705849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857642ec980>]}
[0m07:16:48.706463 [info ] [Thread-3 (]: 5 of 23 OK created sql table model silver.customers_silver ..................... [[32mSELECT 902[0m in 3.08s]
[0m07:16:48.706899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.238 seconds
[0m07:16:48.707423 [debug] [Thread-3 (]: Finished running node model.retail_dbt.customers_silver
[0m07:16:48.708669 [debug] [Thread-1 (]: On model.retail_dbt.discount_rules_silver: Close
[0m07:16:48.709154 [debug] [Thread-3 (]: Began running node model.retail_dbt.loyalty_programs_silver
[0m07:16:48.710174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857642cb380>]}
[0m07:16:48.709769 [info ] [Thread-3 (]: 9 of 23 START sql table model silver.loyalty_programs_silver ................... [RUN]
[0m07:16:48.710818 [info ] [Thread-1 (]: 6 of 23 OK created sql table model silver.discount_rules_silver ................ [[32mSELECT 454[0m in 3.07s]
[0m07:16:48.711318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.customers_silver, now model.retail_dbt.loyalty_programs_silver)
[0m07:16:48.711924 [debug] [Thread-1 (]: Finished running node model.retail_dbt.discount_rules_silver
[0m07:16:48.712358 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.loyalty_programs_silver
[0m07:16:48.712803 [debug] [Thread-1 (]: Began running node model.retail_dbt.payments_silver
[0m07:16:48.715274 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.loyalty_programs_silver"
[0m07:16:48.715797 [info ] [Thread-1 (]: 10 of 23 START sql table model silver.payments_silver .......................... [RUN]
[0m07:16:48.716452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.discount_rules_silver, now model.retail_dbt.payments_silver)
[0m07:16:48.716939 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.payments_silver
[0m07:16:48.719448 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.payments_silver"
[0m07:16:48.719880 [debug] [Thread-3 (]: Began executing node model.retail_dbt.loyalty_programs_silver
[0m07:16:48.722935 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.loyalty_programs_silver"
[0m07:16:48.723362 [debug] [Thread-1 (]: Began executing node model.retail_dbt.payments_silver
[0m07:16:48.726650 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.payments_silver"
[0m07:16:48.727108 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.loyalty_programs_silver"
[0m07:16:48.727522 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: BEGIN
[0m07:16:48.727909 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:48.728263 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_silver"
[0m07:16:48.728796 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: BEGIN
[0m07:16:48.729155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:48.951449 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.248 seconds
[0m07:16:48.952933 [debug] [Thread-2 (]: On model.retail_dbt.employees_silver: Close
[0m07:16:48.953626 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78576411e360>]}
[0m07:16:48.954186 [info ] [Thread-2 (]: 7 of 23 OK created sql table model silver.employees_silver ..................... [[32mSELECT 200[0m in 3.26s]
[0m07:16:48.954730 [debug] [Thread-2 (]: Finished running node model.retail_dbt.employees_silver
[0m07:16:48.955137 [debug] [Thread-2 (]: Began running node model.retail_dbt.pricing_history_silver
[0m07:16:48.955631 [info ] [Thread-2 (]: 11 of 23 START sql table model silver.pricing_history_silver ................... [RUN]
[0m07:16:48.956023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.employees_silver, now model.retail_dbt.pricing_history_silver)
[0m07:16:48.956399 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.pricing_history_silver
[0m07:16:48.959089 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.pricing_history_silver"
[0m07:16:48.959610 [debug] [Thread-2 (]: Began executing node model.retail_dbt.pricing_history_silver
[0m07:16:48.962424 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.pricing_history_silver"
[0m07:16:48.962943 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.pricing_history_silver"
[0m07:16:48.963248 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: BEGIN
[0m07:16:48.963566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:48.972252 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.267 seconds
[0m07:16:48.973600 [debug] [Thread-4 (]: On model.retail_dbt.inventory_silver: Close
[0m07:16:48.974189 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857642a0650>]}
[0m07:16:48.974709 [info ] [Thread-4 (]: 8 of 23 OK created sql table model silver.inventory_silver ..................... [[32mSELECT 1649[0m in 3.28s]
[0m07:16:48.975251 [debug] [Thread-4 (]: Finished running node model.retail_dbt.inventory_silver
[0m07:16:48.975654 [debug] [Thread-4 (]: Began running node model.retail_dbt.products_silver
[0m07:16:48.976095 [info ] [Thread-4 (]: 12 of 23 START sql table model silver.products_silver .......................... [RUN]
[0m07:16:48.976538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.inventory_silver, now model.retail_dbt.products_silver)
[0m07:16:48.976908 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.products_silver
[0m07:16:48.980202 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.products_silver"
[0m07:16:48.980743 [debug] [Thread-4 (]: Began executing node model.retail_dbt.products_silver
[0m07:16:48.983297 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.products_silver"
[0m07:16:48.983829 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_silver"
[0m07:16:48.984140 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: BEGIN
[0m07:16:48.984439 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:50.850868 [debug] [Thread-1 (]: SQL status: BEGIN in 2.122 seconds
[0m07:16:50.851369 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_silver"
[0m07:16:50.851718 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.payments_silver"} */

  
    

  create  table "postgres"."silver"."payments_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_payments" as s
  );
  
[0m07:16:50.903893 [debug] [Thread-3 (]: SQL status: BEGIN in 2.176 seconds
[0m07:16:50.904323 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.loyalty_programs_silver"
[0m07:16:50.904692 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.loyalty_programs_silver"} */

  
    

  create  table "postgres"."silver"."loyalty_programs_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_loyalty_programs" as s
  );
  
[0m07:16:51.000162 [debug] [Thread-4 (]: SQL status: BEGIN in 2.016 seconds
[0m07:16:51.000638 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_silver"
[0m07:16:51.000942 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.products_silver"} */

  
    

  create  table "postgres"."silver"."products_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_products" as s
  );
  
[0m07:16:51.002892 [debug] [Thread-2 (]: SQL status: BEGIN in 2.039 seconds
[0m07:16:51.003213 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.pricing_history_silver"
[0m07:16:51.003530 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.pricing_history_silver"} */

  
    

  create  table "postgres"."silver"."pricing_history_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_pricing_history" as s
  );
  
[0m07:16:51.129117 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.224 seconds
[0m07:16:51.131980 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.loyalty_programs_silver"
[0m07:16:51.132316 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.loyalty_programs_silver"} */
alter table "postgres"."silver"."loyalty_programs_silver__dbt_tmp" rename to "loyalty_programs_silver"
[0m07:16:51.247431 [debug] [Thread-4 (]: SQL status: SELECT 400 in 0.246 seconds
[0m07:16:51.251940 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_silver"
[0m07:16:51.252545 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.products_silver"} */
alter table "postgres"."silver"."products_silver__dbt_tmp" rename to "products_silver"
[0m07:16:51.345422 [debug] [Thread-2 (]: SQL status: SELECT 8160 in 0.341 seconds
[0m07:16:51.348121 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.pricing_history_silver"
[0m07:16:51.348531 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.pricing_history_silver"} */
alter table "postgres"."silver"."pricing_history_silver__dbt_tmp" rename to "pricing_history_silver"
[0m07:16:51.354295 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.222 seconds
[0m07:16:51.355396 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: COMMIT
[0m07:16:51.355753 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.loyalty_programs_silver"
[0m07:16:51.356045 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: COMMIT
[0m07:16:51.475710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.223 seconds
[0m07:16:51.476934 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: COMMIT
[0m07:16:51.477300 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_silver"
[0m07:16:51.477617 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: COMMIT
[0m07:16:51.483249 [debug] [Thread-1 (]: SQL status: SELECT 50000 in 0.631 seconds
[0m07:16:51.486067 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_silver"
[0m07:16:51.486429 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.payments_silver"} */
alter table "postgres"."silver"."payments_silver__dbt_tmp" rename to "payments_silver"
[0m07:16:51.569122 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.220 seconds
[0m07:16:51.570478 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: COMMIT
[0m07:16:51.570823 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.pricing_history_silver"
[0m07:16:51.571135 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: COMMIT
[0m07:16:51.577290 [debug] [Thread-3 (]: SQL status: COMMIT in 0.221 seconds
[0m07:16:51.579363 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver"."loyalty_programs_silver__dbt_backup"
[0m07:16:51.579841 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.loyalty_programs_silver"
[0m07:16:51.580194 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.loyalty_programs_silver"} */
drop table if exists "postgres"."silver"."loyalty_programs_silver__dbt_backup" cascade
[0m07:16:51.700586 [debug] [Thread-4 (]: SQL status: COMMIT in 0.223 seconds
[0m07:16:51.703400 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver"."products_silver__dbt_backup"
[0m07:16:51.703840 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.products_silver"
[0m07:16:51.704146 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.products_silver"} */
drop table if exists "postgres"."silver"."products_silver__dbt_backup" cascade
[0m07:16:51.709254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.222 seconds
[0m07:16:51.710293 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: COMMIT
[0m07:16:51.710626 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_silver"
[0m07:16:51.710948 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: COMMIT
[0m07:16:51.806888 [debug] [Thread-2 (]: SQL status: COMMIT in 0.235 seconds
[0m07:16:51.807333 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.227 seconds
[0m07:16:51.809567 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver"."pricing_history_silver__dbt_backup"
[0m07:16:51.810631 [debug] [Thread-3 (]: On model.retail_dbt.loyalty_programs_silver: Close
[0m07:16:51.811129 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.pricing_history_silver"
[0m07:16:51.811569 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.pricing_history_silver"} */
drop table if exists "postgres"."silver"."pricing_history_silver__dbt_backup" cascade
[0m07:16:51.812091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857642bd730>]}
[0m07:16:51.812696 [info ] [Thread-3 (]: 9 of 23 OK created sql table model silver.loyalty_programs_silver .............. [[32mSELECT 5[0m in 3.10s]
[0m07:16:51.813190 [debug] [Thread-3 (]: Finished running node model.retail_dbt.loyalty_programs_silver
[0m07:16:51.813561 [debug] [Thread-3 (]: Began running node model.retail_dbt.promotions_silver
[0m07:16:51.814054 [info ] [Thread-3 (]: 13 of 23 START sql table model silver.promotions_silver ........................ [RUN]
[0m07:16:51.814505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.loyalty_programs_silver, now model.retail_dbt.promotions_silver)
[0m07:16:51.814866 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.promotions_silver
[0m07:16:51.817415 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.promotions_silver"
[0m07:16:51.817903 [debug] [Thread-3 (]: Began executing node model.retail_dbt.promotions_silver
[0m07:16:51.820419 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.promotions_silver"
[0m07:16:51.820940 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.promotions_silver"
[0m07:16:51.821252 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: BEGIN
[0m07:16:51.821522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:51.925923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.215 seconds
[0m07:16:51.926350 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.222 seconds
[0m07:16:51.929042 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver"."payments_silver__dbt_backup"
[0m07:16:51.930377 [debug] [Thread-4 (]: On model.retail_dbt.products_silver: Close
[0m07:16:51.930895 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.payments_silver"
[0m07:16:51.931285 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.payments_silver"} */
drop table if exists "postgres"."silver"."payments_silver__dbt_backup" cascade
[0m07:16:51.931814 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785764b56b40>]}
[0m07:16:51.932488 [info ] [Thread-4 (]: 12 of 23 OK created sql table model silver.products_silver ..................... [[32mSELECT 400[0m in 2.96s]
[0m07:16:51.933117 [debug] [Thread-4 (]: Finished running node model.retail_dbt.products_silver
[0m07:16:51.933577 [debug] [Thread-4 (]: Began running node model.retail_dbt.purchase_orders_silver
[0m07:16:51.934101 [info ] [Thread-4 (]: 14 of 23 START sql table model silver.purchase_orders_silver ................... [RUN]
[0m07:16:51.934573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.products_silver, now model.retail_dbt.purchase_orders_silver)
[0m07:16:51.934940 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.purchase_orders_silver
[0m07:16:51.937311 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.purchase_orders_silver"
[0m07:16:51.937808 [debug] [Thread-4 (]: Began executing node model.retail_dbt.purchase_orders_silver
[0m07:16:51.940310 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.purchase_orders_silver"
[0m07:16:51.940829 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.purchase_orders_silver"
[0m07:16:51.941176 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: BEGIN
[0m07:16:51.941457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:52.254433 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.442 seconds
[0m07:16:52.254903 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.323 seconds
[0m07:16:52.256042 [debug] [Thread-2 (]: On model.retail_dbt.pricing_history_silver: Close
[0m07:16:52.257137 [debug] [Thread-1 (]: On model.retail_dbt.payments_silver: Close
[0m07:16:52.257800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857641c2d80>]}
[0m07:16:52.258232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785764158140>]}
[0m07:16:52.258801 [info ] [Thread-2 (]: 11 of 23 OK created sql table model silver.pricing_history_silver .............. [[32mSELECT 8160[0m in 3.30s]
[0m07:16:52.259444 [info ] [Thread-1 (]: 10 of 23 OK created sql table model silver.payments_silver ..................... [[32mSELECT 50000[0m in 3.54s]
[0m07:16:52.260050 [debug] [Thread-2 (]: Finished running node model.retail_dbt.pricing_history_silver
[0m07:16:52.260741 [debug] [Thread-1 (]: Finished running node model.retail_dbt.payments_silver
[0m07:16:52.261192 [debug] [Thread-2 (]: Began running node model.retail_dbt.returns_silver
[0m07:16:52.261676 [debug] [Thread-1 (]: Began running node model.retail_dbt.sales_items_silver
[0m07:16:52.262212 [info ] [Thread-2 (]: 15 of 23 START sql table model silver.returns_silver ........................... [RUN]
[0m07:16:52.262705 [info ] [Thread-1 (]: 16 of 23 START sql table model silver.sales_items_silver ....................... [RUN]
[0m07:16:52.263214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.pricing_history_silver, now model.retail_dbt.returns_silver)
[0m07:16:52.263617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.payments_silver, now model.retail_dbt.sales_items_silver)
[0m07:16:52.263969 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.returns_silver
[0m07:16:52.264302 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.sales_items_silver
[0m07:16:52.267483 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.returns_silver"
[0m07:16:52.269798 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.sales_items_silver"
[0m07:16:52.270427 [debug] [Thread-2 (]: Began executing node model.retail_dbt.returns_silver
[0m07:16:52.273089 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.returns_silver"
[0m07:16:52.273437 [debug] [Thread-1 (]: Began executing node model.retail_dbt.sales_items_silver
[0m07:16:52.275977 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.sales_items_silver"
[0m07:16:52.276472 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.returns_silver"
[0m07:16:52.276875 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: BEGIN
[0m07:16:52.277250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:52.277625 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.sales_items_silver"
[0m07:16:52.278042 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: BEGIN
[0m07:16:52.278339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:54.102226 [debug] [Thread-3 (]: SQL status: BEGIN in 2.281 seconds
[0m07:16:54.102678 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.promotions_silver"
[0m07:16:54.103009 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.promotions_silver"} */

  
    

  create  table "postgres"."silver"."promotions_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_promotions" as s
  );
  
[0m07:16:54.314658 [debug] [Thread-2 (]: SQL status: BEGIN in 2.037 seconds
[0m07:16:54.315166 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.returns_silver"
[0m07:16:54.315493 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.returns_silver"} */

  
    

  create  table "postgres"."silver"."returns_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_returns" as s
  );
  
[0m07:16:54.360351 [debug] [Thread-3 (]: SQL status: SELECT 248 in 0.257 seconds
[0m07:16:54.363225 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.promotions_silver"
[0m07:16:54.363589 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.promotions_silver"} */
alter table "postgres"."silver"."promotions_silver__dbt_tmp" rename to "promotions_silver"
[0m07:16:54.624128 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.260 seconds
[0m07:16:54.624796 [debug] [Thread-4 (]: SQL status: BEGIN in 2.683 seconds
[0m07:16:54.626213 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: COMMIT
[0m07:16:54.626712 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.purchase_orders_silver"
[0m07:16:54.627231 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.promotions_silver"
[0m07:16:54.627717 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.purchase_orders_silver"} */

  
    

  create  table "postgres"."silver"."purchase_orders_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_purchase_orders" as s
  );
  
[0m07:16:54.628208 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: COMMIT
[0m07:16:54.662850 [debug] [Thread-2 (]: SQL status: SELECT 4500 in 0.347 seconds
[0m07:16:54.666130 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.returns_silver"
[0m07:16:54.666607 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.returns_silver"} */
alter table "postgres"."silver"."returns_silver__dbt_tmp" rename to "returns_silver"
[0m07:16:54.872732 [debug] [Thread-1 (]: SQL status: BEGIN in 2.594 seconds
[0m07:16:54.873303 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.sales_items_silver"
[0m07:16:54.873636 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_items_silver"} */

  
    

  create  table "postgres"."silver"."sales_items_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_sales_items" as s
  );
  
[0m07:16:54.877045 [debug] [Thread-3 (]: SQL status: COMMIT in 0.248 seconds
[0m07:16:54.879398 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver"."promotions_silver__dbt_backup"
[0m07:16:54.879904 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.promotions_silver"
[0m07:16:54.880244 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.promotions_silver"} */
drop table if exists "postgres"."silver"."promotions_silver__dbt_backup" cascade
[0m07:16:54.915708 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.249 seconds
[0m07:16:54.916876 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: COMMIT
[0m07:16:54.917228 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.returns_silver"
[0m07:16:54.917534 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: COMMIT
[0m07:16:54.956492 [debug] [Thread-4 (]: SQL status: SELECT 895 in 0.328 seconds
[0m07:16:54.960030 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.purchase_orders_silver"
[0m07:16:54.960415 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.purchase_orders_silver"} */
alter table "postgres"."silver"."purchase_orders_silver__dbt_tmp" rename to "purchase_orders_silver"
[0m07:16:55.129801 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.249 seconds
[0m07:16:55.131113 [debug] [Thread-3 (]: On model.retail_dbt.promotions_silver: Close
[0m07:16:55.131754 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785756772690>]}
[0m07:16:55.132319 [info ] [Thread-3 (]: 13 of 23 OK created sql table model silver.promotions_silver ................... [[32mSELECT 248[0m in 3.32s]
[0m07:16:55.132980 [debug] [Thread-3 (]: Finished running node model.retail_dbt.promotions_silver
[0m07:16:55.133363 [debug] [Thread-3 (]: Began running node model.retail_dbt.sales_transactions_silver
[0m07:16:55.133842 [info ] [Thread-3 (]: 17 of 23 START sql table model silver.sales_transactions_silver ................ [RUN]
[0m07:16:55.134277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.promotions_silver, now model.retail_dbt.sales_transactions_silver)
[0m07:16:55.134639 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.sales_transactions_silver
[0m07:16:55.137286 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.sales_transactions_silver"
[0m07:16:55.137775 [debug] [Thread-3 (]: Began executing node model.retail_dbt.sales_transactions_silver
[0m07:16:55.140554 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.sales_transactions_silver"
[0m07:16:55.141155 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_transactions_silver"
[0m07:16:55.141521 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: BEGIN
[0m07:16:55.141822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:55.175707 [debug] [Thread-2 (]: SQL status: COMMIT in 0.258 seconds
[0m07:16:55.178002 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver"."returns_silver__dbt_backup"
[0m07:16:55.178512 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.returns_silver"
[0m07:16:55.178846 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.returns_silver"} */
drop table if exists "postgres"."silver"."returns_silver__dbt_backup" cascade
[0m07:16:55.278472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.318 seconds
[0m07:16:55.279866 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: COMMIT
[0m07:16:55.280227 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.purchase_orders_silver"
[0m07:16:55.280614 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: COMMIT
[0m07:16:55.606714 [debug] [Thread-4 (]: SQL status: COMMIT in 0.326 seconds
[0m07:16:55.607244 [debug] [Thread-1 (]: SQL status: SELECT 91190 in 0.733 seconds
[0m07:16:55.609910 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver"."purchase_orders_silver__dbt_backup"
[0m07:16:55.612645 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.sales_items_silver"
[0m07:16:55.613284 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.purchase_orders_silver"
[0m07:16:55.613721 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_items_silver"} */
alter table "postgres"."silver"."sales_items_silver__dbt_tmp" rename to "sales_items_silver"
[0m07:16:55.614149 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.purchase_orders_silver"} */
drop table if exists "postgres"."silver"."purchase_orders_silver__dbt_backup" cascade
[0m07:16:55.748314 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.569 seconds
[0m07:16:55.749834 [debug] [Thread-2 (]: On model.retail_dbt.returns_silver: Close
[0m07:16:55.750527 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785764b07320>]}
[0m07:16:55.751067 [info ] [Thread-2 (]: 15 of 23 OK created sql table model silver.returns_silver ...................... [[32mSELECT 4500[0m in 3.49s]
[0m07:16:55.751604 [debug] [Thread-2 (]: Finished running node model.retail_dbt.returns_silver
[0m07:16:55.751989 [debug] [Thread-2 (]: Began running node model.retail_dbt.shipments_silver
[0m07:16:55.752492 [info ] [Thread-2 (]: 18 of 23 START sql table model silver.shipments_silver ......................... [RUN]
[0m07:16:55.752926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.returns_silver, now model.retail_dbt.shipments_silver)
[0m07:16:55.753282 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.shipments_silver
[0m07:16:55.755941 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.shipments_silver"
[0m07:16:55.756448 [debug] [Thread-2 (]: Began executing node model.retail_dbt.shipments_silver
[0m07:16:55.759971 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.shipments_silver"
[0m07:16:55.760483 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.shipments_silver"
[0m07:16:55.760814 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: BEGIN
[0m07:16:55.761151 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:55.853362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.239 seconds
[0m07:16:55.854589 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: COMMIT
[0m07:16:55.854926 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.sales_items_silver"
[0m07:16:55.855239 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: COMMIT
[0m07:16:55.930213 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.316 seconds
[0m07:16:55.931608 [debug] [Thread-4 (]: On model.retail_dbt.purchase_orders_silver: Close
[0m07:16:55.932234 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785756763500>]}
[0m07:16:55.932820 [info ] [Thread-4 (]: 14 of 23 OK created sql table model silver.purchase_orders_silver .............. [[32mSELECT 895[0m in 4.00s]
[0m07:16:55.933399 [debug] [Thread-4 (]: Finished running node model.retail_dbt.purchase_orders_silver
[0m07:16:55.933772 [debug] [Thread-4 (]: Began running node model.retail_dbt.stock_movements_silver
[0m07:16:55.934263 [info ] [Thread-4 (]: 19 of 23 START sql table model silver.stock_movements_silver ................... [RUN]
[0m07:16:55.934678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.purchase_orders_silver, now model.retail_dbt.stock_movements_silver)
[0m07:16:55.935031 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stock_movements_silver
[0m07:16:55.937763 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stock_movements_silver"
[0m07:16:55.938289 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stock_movements_silver
[0m07:16:55.941064 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stock_movements_silver"
[0m07:16:55.941586 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stock_movements_silver"
[0m07:16:55.941933 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: BEGIN
[0m07:16:55.942229 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:16:56.096781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.241 seconds
[0m07:16:56.099168 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver"."sales_items_silver__dbt_backup"
[0m07:16:56.099691 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.sales_items_silver"
[0m07:16:56.100034 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_items_silver"} */
drop table if exists "postgres"."silver"."sales_items_silver__dbt_backup" cascade
[0m07:16:56.345616 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.245 seconds
[0m07:16:56.347030 [debug] [Thread-1 (]: On model.retail_dbt.sales_items_silver: Close
[0m07:16:56.347647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78575674bec0>]}
[0m07:16:56.348192 [info ] [Thread-1 (]: 16 of 23 OK created sql table model silver.sales_items_silver .................. [[32mSELECT 91190[0m in 4.08s]
[0m07:16:56.348749 [debug] [Thread-1 (]: Finished running node model.retail_dbt.sales_items_silver
[0m07:16:56.349173 [debug] [Thread-1 (]: Began running node model.retail_dbt.store_visits_silver
[0m07:16:56.349655 [info ] [Thread-1 (]: 20 of 23 START sql table model silver.store_visits_silver ...................... [RUN]
[0m07:16:56.350092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.sales_items_silver, now model.retail_dbt.store_visits_silver)
[0m07:16:56.350420 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.store_visits_silver
[0m07:16:56.353174 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.store_visits_silver"
[0m07:16:56.353697 [debug] [Thread-1 (]: Began executing node model.retail_dbt.store_visits_silver
[0m07:16:56.356911 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.store_visits_silver"
[0m07:16:56.357495 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.store_visits_silver"
[0m07:16:56.357798 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: BEGIN
[0m07:16:56.358140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:57.836483 [debug] [Thread-3 (]: SQL status: BEGIN in 2.694 seconds
[0m07:16:57.837011 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_transactions_silver"
[0m07:16:57.837410 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_transactions_silver"} */

  
    

  create  table "postgres"."silver"."sales_transactions_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_sales_transactions" as s
  );
  
[0m07:16:57.928772 [debug] [Thread-2 (]: SQL status: BEGIN in 2.168 seconds
[0m07:16:57.929261 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.shipments_silver"
[0m07:16:57.929689 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.shipments_silver"} */

  
    

  create  table "postgres"."silver"."shipments_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_shipments" as s
  );
  
[0m07:16:58.160231 [debug] [Thread-2 (]: SQL status: SELECT 400 in 0.230 seconds
[0m07:16:58.163445 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.shipments_silver"
[0m07:16:58.163867 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.shipments_silver"} */
alter table "postgres"."silver"."shipments_silver__dbt_tmp" rename to "shipments_silver"
[0m07:16:58.250216 [debug] [Thread-3 (]: SQL status: SELECT 39986 in 0.412 seconds
[0m07:16:58.254408 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_transactions_silver"
[0m07:16:58.254795 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_transactions_silver"} */
alter table "postgres"."silver"."sales_transactions_silver__dbt_tmp" rename to "sales_transactions_silver"
[0m07:16:58.389889 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m07:16:58.391219 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: COMMIT
[0m07:16:58.391637 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.shipments_silver"
[0m07:16:58.392114 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: COMMIT
[0m07:16:58.468585 [debug] [Thread-1 (]: SQL status: BEGIN in 2.110 seconds
[0m07:16:58.469081 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.store_visits_silver"
[0m07:16:58.469482 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.store_visits_silver"} */

  
    

  create  table "postgres"."silver"."store_visits_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_store_visits" as s
  );
  
[0m07:16:58.515161 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.260 seconds
[0m07:16:58.516615 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: COMMIT
[0m07:16:58.517008 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_transactions_silver"
[0m07:16:58.517356 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: COMMIT
[0m07:16:58.621098 [debug] [Thread-2 (]: SQL status: COMMIT in 0.229 seconds
[0m07:16:58.623556 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver"."shipments_silver__dbt_backup"
[0m07:16:58.624207 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.shipments_silver"
[0m07:16:58.624681 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.shipments_silver"} */
drop table if exists "postgres"."silver"."shipments_silver__dbt_backup" cascade
[0m07:16:58.778786 [debug] [Thread-3 (]: SQL status: COMMIT in 0.261 seconds
[0m07:16:58.781198 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver"."sales_transactions_silver__dbt_backup"
[0m07:16:58.781774 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.sales_transactions_silver"
[0m07:16:58.782135 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.sales_transactions_silver"} */
drop table if exists "postgres"."silver"."sales_transactions_silver__dbt_backup" cascade
[0m07:16:58.873086 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.248 seconds
[0m07:16:58.874603 [debug] [Thread-2 (]: On model.retail_dbt.shipments_silver: Close
[0m07:16:58.875310 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78575660fda0>]}
[0m07:16:58.875844 [info ] [Thread-2 (]: 18 of 23 OK created sql table model silver.shipments_silver .................... [[32mSELECT 400[0m in 3.12s]
[0m07:16:58.876440 [debug] [Thread-2 (]: Finished running node model.retail_dbt.shipments_silver
[0m07:16:58.876847 [debug] [Thread-2 (]: Began running node model.retail_dbt.stores_silver
[0m07:16:58.877414 [info ] [Thread-2 (]: 21 of 23 START sql table model silver.stores_silver ............................ [RUN]
[0m07:16:58.877939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.shipments_silver, now model.retail_dbt.stores_silver)
[0m07:16:58.878305 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stores_silver
[0m07:16:58.881020 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stores_silver"
[0m07:16:58.881515 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stores_silver
[0m07:16:58.884343 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stores_silver"
[0m07:16:58.884865 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stores_silver"
[0m07:16:58.885170 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: BEGIN
[0m07:16:58.885448 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:16:58.903867 [debug] [Thread-1 (]: SQL status: SELECT 8999 in 0.434 seconds
[0m07:16:58.907140 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.store_visits_silver"
[0m07:16:58.907553 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.store_visits_silver"} */
alter table "postgres"."silver"."store_visits_silver__dbt_tmp" rename to "store_visits_silver"
[0m07:16:59.056016 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.273 seconds
[0m07:16:59.057453 [debug] [Thread-3 (]: On model.retail_dbt.sales_transactions_silver: Close
[0m07:16:59.058184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785756798170>]}
[0m07:16:59.058774 [info ] [Thread-3 (]: 17 of 23 OK created sql table model silver.sales_transactions_silver ........... [[32mSELECT 39986[0m in 3.92s]
[0m07:16:59.059410 [debug] [Thread-3 (]: Finished running node model.retail_dbt.sales_transactions_silver
[0m07:16:59.059821 [debug] [Thread-3 (]: Began running node model.retail_dbt.suppliers_silver
[0m07:16:59.060364 [info ] [Thread-3 (]: 22 of 23 START sql table model silver.suppliers_silver ......................... [RUN]
[0m07:16:59.060857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.sales_transactions_silver, now model.retail_dbt.suppliers_silver)
[0m07:16:59.061290 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.suppliers_silver
[0m07:16:59.063853 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.suppliers_silver"
[0m07:16:59.064465 [debug] [Thread-3 (]: Began executing node model.retail_dbt.suppliers_silver
[0m07:16:59.068699 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.suppliers_silver"
[0m07:16:59.069186 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.suppliers_silver"
[0m07:16:59.069478 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: BEGIN
[0m07:16:59.069757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:16:59.132319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.224 seconds
[0m07:16:59.133481 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: COMMIT
[0m07:16:59.133813 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.store_visits_silver"
[0m07:16:59.134135 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: COMMIT
[0m07:16:59.360546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.226 seconds
[0m07:16:59.363114 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver"."store_visits_silver__dbt_backup"
[0m07:16:59.363767 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.store_visits_silver"
[0m07:16:59.364141 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.store_visits_silver"} */
drop table if exists "postgres"."silver"."store_visits_silver__dbt_backup" cascade
[0m07:16:59.511878 [debug] [Thread-4 (]: SQL status: BEGIN in 3.570 seconds
[0m07:16:59.512380 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stock_movements_silver"
[0m07:16:59.512850 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stock_movements_silver"} */

  
    

  create  table "postgres"."silver"."stock_movements_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_stock_movements" as s
  );
  
[0m07:16:59.584364 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.220 seconds
[0m07:16:59.585556 [debug] [Thread-1 (]: On model.retail_dbt.store_visits_silver: Close
[0m07:16:59.586113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857566256a0>]}
[0m07:16:59.586593 [info ] [Thread-1 (]: 20 of 23 OK created sql table model silver.store_visits_silver ................. [[32mSELECT 8999[0m in 3.24s]
[0m07:16:59.587118 [debug] [Thread-1 (]: Finished running node model.retail_dbt.store_visits_silver
[0m07:16:59.587488 [debug] [Thread-1 (]: Began running node model.retail_dbt.tax_rules_silver
[0m07:16:59.588015 [info ] [Thread-1 (]: 23 of 23 START sql table model silver.tax_rules_silver ......................... [RUN]
[0m07:16:59.588385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.store_visits_silver, now model.retail_dbt.tax_rules_silver)
[0m07:16:59.588796 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.tax_rules_silver
[0m07:16:59.591247 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.tax_rules_silver"
[0m07:16:59.591772 [debug] [Thread-1 (]: Began executing node model.retail_dbt.tax_rules_silver
[0m07:16:59.594472 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.tax_rules_silver"
[0m07:16:59.594964 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_silver"
[0m07:16:59.595240 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: BEGIN
[0m07:16:59.595553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:00.097141 [debug] [Thread-4 (]: SQL status: SELECT 8067 in 0.584 seconds
[0m07:17:00.099760 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stock_movements_silver"
[0m07:17:00.100087 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stock_movements_silver"} */
alter table "postgres"."silver"."stock_movements_silver__dbt_tmp" rename to "stock_movements_silver"
[0m07:17:00.410669 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.310 seconds
[0m07:17:00.411790 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: COMMIT
[0m07:17:00.412118 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stock_movements_silver"
[0m07:17:00.412470 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: COMMIT
[0m07:17:00.702542 [debug] [Thread-4 (]: SQL status: COMMIT in 0.290 seconds
[0m07:17:00.704774 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver"."stock_movements_silver__dbt_backup"
[0m07:17:00.705265 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stock_movements_silver"
[0m07:17:00.705586 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stock_movements_silver"} */
drop table if exists "postgres"."silver"."stock_movements_silver__dbt_backup" cascade
[0m07:17:00.997162 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.291 seconds
[0m07:17:00.998445 [debug] [Thread-4 (]: On model.retail_dbt.stock_movements_silver: Close
[0m07:17:00.999079 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785756737890>]}
[0m07:17:00.999567 [info ] [Thread-4 (]: 19 of 23 OK created sql table model silver.stock_movements_silver .............. [[32mSELECT 8067[0m in 5.06s]
[0m07:17:01.000069 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stock_movements_silver
[0m07:17:01.081647 [debug] [Thread-3 (]: SQL status: BEGIN in 2.012 seconds
[0m07:17:01.082208 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.suppliers_silver"
[0m07:17:01.082547 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.suppliers_silver"} */

  
    

  create  table "postgres"."silver"."suppliers_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_suppliers" as s
  );
  
[0m07:17:01.202923 [debug] [Thread-2 (]: SQL status: BEGIN in 2.317 seconds
[0m07:17:01.203395 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stores_silver"
[0m07:17:01.203697 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stores_silver"} */

  
    

  create  table "postgres"."silver"."stores_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_stores" as s
  );
  
[0m07:17:01.307953 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.225 seconds
[0m07:17:01.310697 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.suppliers_silver"
[0m07:17:01.311002 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.suppliers_silver"} */
alter table "postgres"."silver"."suppliers_silver__dbt_tmp" rename to "suppliers_silver"
[0m07:17:01.471716 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.268 seconds
[0m07:17:01.475326 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stores_silver"
[0m07:17:01.475685 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stores_silver"} */
alter table "postgres"."silver"."stores_silver__dbt_tmp" rename to "stores_silver"
[0m07:17:01.532637 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.221 seconds
[0m07:17:01.533773 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: COMMIT
[0m07:17:01.534086 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.suppliers_silver"
[0m07:17:01.534382 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: COMMIT
[0m07:17:01.735721 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.260 seconds
[0m07:17:01.736905 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: COMMIT
[0m07:17:01.737213 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stores_silver"
[0m07:17:01.737494 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: COMMIT
[0m07:17:01.753147 [debug] [Thread-3 (]: SQL status: COMMIT in 0.218 seconds
[0m07:17:01.755097 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver"."suppliers_silver__dbt_backup"
[0m07:17:01.755544 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.suppliers_silver"
[0m07:17:01.755837 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.suppliers_silver"} */
drop table if exists "postgres"."silver"."suppliers_silver__dbt_backup" cascade
[0m07:17:01.902344 [debug] [Thread-1 (]: SQL status: BEGIN in 2.307 seconds
[0m07:17:01.902817 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_silver"
[0m07:17:01.903176 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.tax_rules_silver"} */

  
    

  create  table "postgres"."silver"."tax_rules_silver__dbt_tmp"
  
  
    as
  
  (
    

select
  s.*
from "postgres"."silver_staging"."stg_tax_rules" as s
  );
  
[0m07:17:01.990716 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.234 seconds
[0m07:17:01.992357 [debug] [Thread-3 (]: On model.retail_dbt.suppliers_silver: Close
[0m07:17:01.993118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78575661d760>]}
[0m07:17:01.993669 [info ] [Thread-3 (]: 22 of 23 OK created sql table model silver.suppliers_silver .................... [[32mSELECT 10[0m in 2.93s]
[0m07:17:01.994235 [debug] [Thread-3 (]: Finished running node model.retail_dbt.suppliers_silver
[0m07:17:02.026600 [debug] [Thread-2 (]: SQL status: COMMIT in 0.289 seconds
[0m07:17:02.028734 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver"."stores_silver__dbt_backup"
[0m07:17:02.029235 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stores_silver"
[0m07:17:02.029554 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stores_silver"} */
drop table if exists "postgres"."silver"."stores_silver__dbt_backup" cascade
[0m07:17:02.150710 [debug] [Thread-1 (]: SQL status: SELECT 387 in 0.247 seconds
[0m07:17:02.153607 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_silver"
[0m07:17:02.153948 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.tax_rules_silver"} */
alter table "postgres"."silver"."tax_rules_silver__dbt_tmp" rename to "tax_rules_silver"
[0m07:17:02.312189 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.282 seconds
[0m07:17:02.313628 [debug] [Thread-2 (]: On model.retail_dbt.stores_silver: Close
[0m07:17:02.314328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785756538e90>]}
[0m07:17:02.314850 [info ] [Thread-2 (]: 21 of 23 OK created sql table model silver.stores_silver ....................... [[32mSELECT 20[0m in 3.44s]
[0m07:17:02.315401 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stores_silver
[0m07:17:02.402641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.248 seconds
[0m07:17:02.403882 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: COMMIT
[0m07:17:02.404217 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_silver"
[0m07:17:02.404535 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: COMMIT
[0m07:17:02.653727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.249 seconds
[0m07:17:02.656449 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver"."tax_rules_silver__dbt_backup"
[0m07:17:02.657148 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.tax_rules_silver"
[0m07:17:02.657487 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.tax_rules_silver"} */
drop table if exists "postgres"."silver"."tax_rules_silver__dbt_backup" cascade
[0m07:17:02.903967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.246 seconds
[0m07:17:02.905364 [debug] [Thread-1 (]: On model.retail_dbt.tax_rules_silver: Close
[0m07:17:02.906048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499d7c00-ab70-4dec-8330-65bf575394b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857566f61e0>]}
[0m07:17:04.324697 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m07:17:04.325559 [info ] [Thread-1 (]: 23 of 23 OK created sql table model silver.tax_rules_silver .................... [[32mSELECT 387[0m in 3.32s]
[0m07:17:04.326166 [debug] [Thread-1 (]: Finished running node model.retail_dbt.tax_rules_silver
[0m07:17:04.328256 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:04.328657 [debug] [MainThread]: On master: BEGIN
[0m07:17:04.328958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:17:08.603576 [debug] [MainThread]: SQL status: BEGIN in 2.716 seconds
[0m07:17:08.603960 [debug] [MainThread]: On master: COMMIT
[0m07:17:08.604278 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:08.604564 [debug] [MainThread]: On master: COMMIT
[0m07:17:08.825811 [debug] [MainThread]: SQL status: COMMIT in 0.221 seconds
[0m07:17:08.826249 [debug] [MainThread]: On master: Close
[0m07:17:08.826906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:08.827252 [debug] [MainThread]: Connection 'model.retail_dbt.stores_silver' was properly closed.
[0m07:17:08.827564 [debug] [MainThread]: Connection 'model.retail_dbt.tax_rules_silver' was properly closed.
[0m07:17:08.827842 [debug] [MainThread]: Connection 'model.retail_dbt.stock_movements_silver' was properly closed.
[0m07:17:08.828119 [debug] [MainThread]: Connection 'model.retail_dbt.suppliers_silver' was properly closed.
[0m07:17:08.828542 [info ] [MainThread]: 
[0m07:17:08.828913 [info ] [MainThread]: Finished running 23 table models in 0 hours 0 minutes and 42.39 seconds (42.39s).
[0m07:17:08.831831 [debug] [MainThread]: Command end result
[0m07:17:08.990340 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:17:08.993135 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:17:08.998087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:17:08.998465 [info ] [MainThread]: 
[0m07:17:08.998919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:17:08.999318 [info ] [MainThread]: 
[0m07:17:08.999718 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m07:17:09.000645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 40.119354, "process_in_blocks": "0", "process_kernel_time": 0.443354, "process_mem_max_rss": "143544", "process_out_blocks": "10000", "process_user_time": 3.211091}
[0m07:17:09.001088 [debug] [MainThread]: Command `dbt run` succeeded at 07:17:09.000996 after 40.12 seconds
[0m07:17:09.001446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78576b158560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857666f2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7857641acd10>]}
[0m07:17:09.001828 [debug] [MainThread]: Flushing usage events
[0m07:17:11.044837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:17:13.756802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798594575700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798592acfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798592448b30>]}


============================== 07:17:13.762633 | 4571f900-cd6c-4ca7-8d8a-bad2e2094804 ==============================
[0m07:17:13.762633 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:17:13.763133 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt test --select path:models/silver --profiles-dir /home/airflow/.dbt', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'empty': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True'}
[0m07:17:13.917423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4571f900-cd6c-4ca7-8d8a-bad2e2094804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798591b13e90>]}
[0m07:17:13.974733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4571f900-cd6c-4ca7-8d8a-bad2e2094804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798590f86d80>]}
[0m07:17:13.975696 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:17:14.077720 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:17:14.242411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:14.242946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:14.316014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4571f900-cd6c-4ca7-8d8a-bad2e2094804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798590b9a900>]}
[0m07:17:14.543143 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:17:14.546142 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:17:14.596464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4571f900-cd6c-4ca7-8d8a-bad2e2094804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798591aeedb0>]}
[0m07:17:14.597007 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:17:14.597440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4571f900-cd6c-4ca7-8d8a-bad2e2094804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798590b6fc50>]}
[0m07:17:14.611538 [info ] [MainThread]: 
[0m07:17:14.611992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:17:14.612326 [info ] [MainThread]: 
[0m07:17:14.612797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:14.620665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_staging'
[0m07:17:14.628337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:17:14.633844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m07:17:14.636028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m07:17:14.660622 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:17:14.661047 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:17:14.661439 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:17:14.661831 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:17:14.662222 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:17:14.662545 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:17:14.662904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:14.663304 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:17:14.663719 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:17:14.664079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:14.664668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:14.665069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:16.791365 [debug] [ThreadPool]: SQL status: BEGIN in 2.128 seconds
[0m07:17:16.791744 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:17:16.792061 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:17:16.828277 [debug] [ThreadPool]: SQL status: BEGIN in 2.164 seconds
[0m07:17:16.828685 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:17:16.829075 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:17:17.024477 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.232 seconds
[0m07:17:17.025997 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:17:17.057201 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.228 seconds
[0m07:17:17.058432 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:17:17.143011 [debug] [ThreadPool]: SQL status: BEGIN in 2.478 seconds
[0m07:17:17.143533 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:17:17.143816 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:17:17.249625 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:17:17.280548 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:17:17.383108 [debug] [ThreadPool]: SQL status: BEGIN in 2.718 seconds
[0m07:17:17.383546 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:17:17.383867 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:17:17.401303 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.257 seconds
[0m07:17:17.402494 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:17:17.612806 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.229 seconds
[0m07:17:17.614496 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:17:17.662967 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:17:17.846491 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:17:17.858450 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:17.858821 [debug] [MainThread]: On master: BEGIN
[0m07:17:17.859081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:17:20.144258 [debug] [MainThread]: SQL status: BEGIN in 2.285 seconds
[0m07:17:20.144636 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:20.144969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:17:20.403630 [debug] [MainThread]: SQL status: SELECT 40 in 0.258 seconds
[0m07:17:20.405232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4571f900-cd6c-4ca7-8d8a-bad2e2094804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79858fb44200>]}
[0m07:17:20.405629 [debug] [MainThread]: On master: ROLLBACK
[0m07:17:20.653001 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:20.653470 [debug] [MainThread]: On master: BEGIN
[0m07:17:21.144154 [debug] [MainThread]: SQL status: BEGIN in 0.490 seconds
[0m07:17:21.144538 [debug] [MainThread]: On master: COMMIT
[0m07:17:21.144867 [debug] [MainThread]: Using postgres connection "master"
[0m07:17:21.145226 [debug] [MainThread]: On master: COMMIT
[0m07:17:21.393401 [debug] [MainThread]: SQL status: COMMIT in 0.248 seconds
[0m07:17:21.393844 [debug] [MainThread]: On master: Close
[0m07:17:21.398567 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859
[0m07:17:21.399019 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4
[0m07:17:21.399689 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1
[0m07:17:21.399397 [info ] [Thread-1 (]: 1 of 114 START test not_null_brands_silver_brand_id ............................ [RUN]
[0m07:17:21.400516 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e
[0m07:17:21.400093 [info ] [Thread-2 (]: 2 of 114 START test not_null_brands_silver_name ................................ [RUN]
[0m07:17:21.401405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859)
[0m07:17:21.400931 [info ] [Thread-3 (]: 3 of 114 START test not_null_brands_silver_staged_at ........................... [RUN]
[0m07:17:21.402044 [info ] [Thread-4 (]: 4 of 114 START test not_null_campaigns_silver_budget ........................... [RUN]
[0m07:17:21.402538 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4)
[0m07:17:21.402921 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859
[0m07:17:21.403369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1)
[0m07:17:21.403769 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e)
[0m07:17:21.404175 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4
[0m07:17:21.414709 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1
[0m07:17:21.416319 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859"
[0m07:17:21.416684 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e
[0m07:17:21.419371 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4"
[0m07:17:21.422830 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1"
[0m07:17:21.425646 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e"
[0m07:17:21.426462 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859
[0m07:17:21.426902 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4
[0m07:17:21.440361 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859"
[0m07:17:21.440689 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e
[0m07:17:21.442555 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4"
[0m07:17:21.442963 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1
[0m07:17:21.444800 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e"
[0m07:17:21.446627 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1"
[0m07:17:21.447298 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859"
[0m07:17:21.447705 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4"
[0m07:17:21.448286 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e"
[0m07:17:21.448647 [debug] [Thread-1 (]: On test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859: BEGIN
[0m07:17:21.449119 [debug] [Thread-2 (]: On test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4: BEGIN
[0m07:17:21.449556 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1"
[0m07:17:21.449922 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e: BEGIN
[0m07:17:21.450272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:21.450656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:21.451039 [debug] [Thread-3 (]: On test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1: BEGIN
[0m07:17:21.451402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:21.452026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:23.986381 [debug] [Thread-3 (]: SQL status: BEGIN in 2.534 seconds
[0m07:17:23.986831 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1"
[0m07:17:23.987193 [debug] [Thread-3 (]: On test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select staged_at
from "postgres"."silver"."brands_silver"
where staged_at is null



  
  
      
    ) dbt_internal_test
[0m07:17:23.987565 [debug] [Thread-2 (]: SQL status: BEGIN in 2.537 seconds
[0m07:17:23.987954 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4"
[0m07:17:23.988285 [debug] [Thread-2 (]: On test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."brands_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:17:24.016398 [debug] [Thread-1 (]: SQL status: BEGIN in 2.566 seconds
[0m07:17:24.016767 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859"
[0m07:17:24.017077 [debug] [Thread-1 (]: On test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select brand_id
from "postgres"."silver"."brands_silver"
where brand_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:24.244245 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:17:24.247503 [debug] [Thread-1 (]: On test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859: ROLLBACK
[0m07:17:24.247930 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.259 seconds
[0m07:17:24.248268 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.260 seconds
[0m07:17:24.249529 [debug] [Thread-2 (]: On test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4: ROLLBACK
[0m07:17:24.250815 [debug] [Thread-3 (]: On test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1: ROLLBACK
[0m07:17:24.344541 [debug] [Thread-4 (]: SQL status: BEGIN in 2.893 seconds
[0m07:17:24.345036 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e"
[0m07:17:24.345405 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select budget
from "postgres"."silver"."campaigns_silver"
where budget is null



  
  
      
    ) dbt_internal_test
[0m07:17:24.472070 [debug] [Thread-1 (]: On test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859: Close
[0m07:17:24.472947 [info ] [Thread-1 (]: 1 of 114 PASS not_null_brands_silver_brand_id .................................. [[32mPASS[0m in 3.07s]
[0m07:17:24.473725 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859
[0m07:17:24.474157 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142
[0m07:17:24.474566 [info ] [Thread-1 (]: 5 of 114 START test not_null_campaigns_silver_campaign_id ...................... [RUN]
[0m07:17:24.475013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_brands_silver_brand_id.e37c5b2859, now test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142)
[0m07:17:24.475404 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142
[0m07:17:24.478680 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142"
[0m07:17:24.479206 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142
[0m07:17:24.481963 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142"
[0m07:17:24.482485 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142"
[0m07:17:24.482770 [debug] [Thread-1 (]: On test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142: BEGIN
[0m07:17:24.483071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:24.508006 [debug] [Thread-3 (]: On test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1: Close
[0m07:17:24.508389 [debug] [Thread-2 (]: On test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4: Close
[0m07:17:24.509050 [info ] [Thread-3 (]: 3 of 114 PASS not_null_brands_silver_staged_at ................................. [[32mPASS[0m in 3.11s]
[0m07:17:24.509998 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1
[0m07:17:24.509456 [info ] [Thread-2 (]: 2 of 114 PASS not_null_brands_silver_name ...................................... [[32mPASS[0m in 3.11s]
[0m07:17:24.510582 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0
[0m07:17:24.511226 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4
[0m07:17:24.511607 [info ] [Thread-3 (]: 6 of 114 START test not_null_campaigns_silver_end_date ......................... [RUN]
[0m07:17:24.512090 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_campaigns_silver_name.599034b8a0
[0m07:17:24.512511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_brands_silver_staged_at.0c3bcd18b1, now test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0)
[0m07:17:24.512860 [info ] [Thread-2 (]: 7 of 114 START test not_null_campaigns_silver_name ............................. [RUN]
[0m07:17:24.513298 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0
[0m07:17:24.513665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_brands_silver_name.cfe1fe35d4, now test.retail_dbt.not_null_campaigns_silver_name.599034b8a0)
[0m07:17:24.563869 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0"
[0m07:17:24.564331 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_campaigns_silver_name.599034b8a0
[0m07:17:24.567424 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_campaigns_silver_name.599034b8a0"
[0m07:17:24.567937 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0
[0m07:17:24.570015 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0"
[0m07:17:24.570346 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_campaigns_silver_name.599034b8a0
[0m07:17:24.572442 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_campaigns_silver_name.599034b8a0"
[0m07:17:24.573097 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0"
[0m07:17:24.573535 [debug] [Thread-3 (]: On test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0: BEGIN
[0m07:17:24.573945 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:24.574347 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_name.599034b8a0"
[0m07:17:24.574773 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_name.599034b8a0: BEGIN
[0m07:17:24.575067 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:24.581804 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:17:24.583312 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e: ROLLBACK
[0m07:17:24.808534 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e: Close
[0m07:17:24.809288 [info ] [Thread-4 (]: 4 of 114 PASS not_null_campaigns_silver_budget ................................. [[32mPASS[0m in 3.41s]
[0m07:17:24.809820 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e
[0m07:17:24.810200 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff
[0m07:17:24.810668 [info ] [Thread-4 (]: 8 of 114 START test not_null_campaigns_silver_staged_at ........................ [RUN]
[0m07:17:24.811175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_campaigns_silver_budget.69bfe9da3e, now test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff)
[0m07:17:24.811509 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff
[0m07:17:24.814807 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff"
[0m07:17:24.815460 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff
[0m07:17:24.817179 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff"
[0m07:17:24.817653 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff"
[0m07:17:24.817972 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff: BEGIN
[0m07:17:24.818245 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:26.820115 [debug] [Thread-2 (]: SQL status: BEGIN in 2.245 seconds
[0m07:17:26.820547 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_name.599034b8a0"
[0m07:17:26.820854 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_name.599034b8a0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_campaigns_silver_name.599034b8a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."campaigns_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:17:27.044559 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.223 seconds
[0m07:17:27.045785 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_name.599034b8a0: ROLLBACK
[0m07:17:27.057269 [debug] [Thread-1 (]: SQL status: BEGIN in 2.574 seconds
[0m07:17:27.057589 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142"
[0m07:17:27.057955 [debug] [Thread-1 (]: On test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select campaign_id
from "postgres"."silver"."campaigns_silver"
where campaign_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:27.273283 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_name.599034b8a0: Close
[0m07:17:27.274084 [info ] [Thread-2 (]: 7 of 114 PASS not_null_campaigns_silver_name ................................... [[32mPASS[0m in 2.76s]
[0m07:17:27.274594 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_campaigns_silver_name.599034b8a0
[0m07:17:27.274959 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c
[0m07:17:27.275369 [info ] [Thread-2 (]: 9 of 114 START test not_null_campaigns_silver_start_date ....................... [RUN]
[0m07:17:27.275856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_campaigns_silver_name.599034b8a0, now test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c)
[0m07:17:27.276158 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c
[0m07:17:27.280194 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c"
[0m07:17:27.280696 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c
[0m07:17:27.282337 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c"
[0m07:17:27.282840 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c"
[0m07:17:27.283180 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c: BEGIN
[0m07:17:27.283457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:27.305657 [debug] [Thread-4 (]: SQL status: BEGIN in 2.487 seconds
[0m07:17:27.306257 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff"
[0m07:17:27.306706 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select staged_at
from "postgres"."silver"."campaigns_silver"
where staged_at is null



  
  
      
    ) dbt_internal_test
[0m07:17:27.316681 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.258 seconds
[0m07:17:27.317792 [debug] [Thread-1 (]: On test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142: ROLLBACK
[0m07:17:27.580149 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:17:27.580558 [debug] [Thread-1 (]: On test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142: Close
[0m07:17:27.581700 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff: ROLLBACK
[0m07:17:27.582363 [info ] [Thread-1 (]: 5 of 114 PASS not_null_campaigns_silver_campaign_id ............................ [[32mPASS[0m in 3.11s]
[0m07:17:27.582875 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142
[0m07:17:27.583277 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5
[0m07:17:27.583673 [info ] [Thread-1 (]: 10 of 114 START test not_null_categories_silver_category_id .................... [RUN]
[0m07:17:27.584042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_campaigns_silver_campaign_id.4bdea18142, now test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5)
[0m07:17:27.584373 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5
[0m07:17:27.587631 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5"
[0m07:17:27.588139 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5
[0m07:17:27.589845 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5"
[0m07:17:27.590329 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5"
[0m07:17:27.590650 [debug] [Thread-1 (]: On test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5: BEGIN
[0m07:17:27.590930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:27.848683 [debug] [Thread-4 (]: On test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff: Close
[0m07:17:27.849515 [info ] [Thread-4 (]: 8 of 114 PASS not_null_campaigns_silver_staged_at .............................. [[32mPASS[0m in 3.04s]
[0m07:17:27.850085 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff
[0m07:17:27.850482 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_categories_silver_name.9b8db46a0d
[0m07:17:27.850893 [info ] [Thread-4 (]: 11 of 114 START test not_null_categories_silver_name ........................... [RUN]
[0m07:17:27.851321 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_campaigns_silver_staged_at.782d626fff, now test.retail_dbt.not_null_categories_silver_name.9b8db46a0d)
[0m07:17:27.851688 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_categories_silver_name.9b8db46a0d
[0m07:17:27.855077 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_categories_silver_name.9b8db46a0d"
[0m07:17:27.855651 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_categories_silver_name.9b8db46a0d
[0m07:17:27.857624 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_categories_silver_name.9b8db46a0d"
[0m07:17:27.858167 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_categories_silver_name.9b8db46a0d"
[0m07:17:27.858517 [debug] [Thread-4 (]: On test.retail_dbt.not_null_categories_silver_name.9b8db46a0d: BEGIN
[0m07:17:27.858864 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:28.138639 [debug] [Thread-3 (]: SQL status: BEGIN in 3.565 seconds
[0m07:17:28.139185 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0"
[0m07:17:28.139558 [debug] [Thread-3 (]: On test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "postgres"."silver"."campaigns_silver"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m07:17:28.452272 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.312 seconds
[0m07:17:28.453664 [debug] [Thread-3 (]: On test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0: ROLLBACK
[0m07:17:28.766227 [debug] [Thread-3 (]: On test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0: Close
[0m07:17:28.767193 [info ] [Thread-3 (]: 6 of 114 PASS not_null_campaigns_silver_end_date ............................... [[32mPASS[0m in 4.25s]
[0m07:17:28.767814 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0
[0m07:17:28.768259 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605
[0m07:17:28.768663 [info ] [Thread-3 (]: 12 of 114 START test not_null_categories_silver_staged_at ...................... [RUN]
[0m07:17:28.769114 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_campaigns_silver_end_date.36ec8a11c0, now test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605)
[0m07:17:28.769486 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605
[0m07:17:28.772955 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605"
[0m07:17:28.773483 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605
[0m07:17:28.775418 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605"
[0m07:17:28.775949 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605"
[0m07:17:28.776303 [debug] [Thread-3 (]: On test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605: BEGIN
[0m07:17:28.776690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:30.120453 [debug] [Thread-4 (]: SQL status: BEGIN in 2.262 seconds
[0m07:17:30.121009 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_categories_silver_name.9b8db46a0d"
[0m07:17:30.121480 [debug] [Thread-4 (]: On test.retail_dbt.not_null_categories_silver_name.9b8db46a0d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_categories_silver_name.9b8db46a0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."categories_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:17:30.185226 [debug] [Thread-2 (]: SQL status: BEGIN in 2.902 seconds
[0m07:17:30.185651 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c"
[0m07:17:30.186041 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "postgres"."silver"."campaigns_silver"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m07:17:30.366738 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:17:30.368198 [debug] [Thread-4 (]: On test.retail_dbt.not_null_categories_silver_name.9b8db46a0d: ROLLBACK
[0m07:17:30.496521 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.310 seconds
[0m07:17:30.498094 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c: ROLLBACK
[0m07:17:30.628586 [debug] [Thread-4 (]: On test.retail_dbt.not_null_categories_silver_name.9b8db46a0d: Close
[0m07:17:30.629411 [info ] [Thread-4 (]: 11 of 114 PASS not_null_categories_silver_name ................................. [[32mPASS[0m in 2.78s]
[0m07:17:30.630043 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_categories_silver_name.9b8db46a0d
[0m07:17:30.630476 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae
[0m07:17:30.630933 [info ] [Thread-4 (]: 13 of 114 START test not_null_customer_feedback_silver_comments ................ [RUN]
[0m07:17:30.631451 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_categories_silver_name.9b8db46a0d, now test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae)
[0m07:17:30.631882 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae
[0m07:17:30.637179 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae"
[0m07:17:30.637780 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae
[0m07:17:30.639850 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae"
[0m07:17:30.640387 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae"
[0m07:17:30.640700 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae: BEGIN
[0m07:17:30.641042 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:30.810310 [debug] [Thread-2 (]: On test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c: Close
[0m07:17:30.811224 [info ] [Thread-2 (]: 9 of 114 PASS not_null_campaigns_silver_start_date ............................. [[32mPASS[0m in 3.54s]
[0m07:17:30.811885 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c
[0m07:17:30.812322 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35
[0m07:17:30.812846 [info ] [Thread-2 (]: 14 of 114 START test not_null_customer_feedback_silver_customer_id ............. [RUN]
[0m07:17:30.813384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_campaigns_silver_start_date.efe0421e5c, now test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35)
[0m07:17:30.813828 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35
[0m07:17:30.817512 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35"
[0m07:17:30.818001 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35
[0m07:17:30.819752 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35"
[0m07:17:30.820261 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35"
[0m07:17:30.820613 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35: BEGIN
[0m07:17:30.820904 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:30.951298 [debug] [Thread-1 (]: SQL status: BEGIN in 3.360 seconds
[0m07:17:30.951751 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5"
[0m07:17:30.952138 [debug] [Thread-1 (]: On test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from "postgres"."silver"."categories_silver"
where category_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:31.208572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.256 seconds
[0m07:17:31.210114 [debug] [Thread-1 (]: On test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5: ROLLBACK
[0m07:17:31.479804 [debug] [Thread-1 (]: On test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5: Close
[0m07:17:31.480731 [info ] [Thread-1 (]: 10 of 114 PASS not_null_categories_silver_category_id .......................... [[32mPASS[0m in 3.90s]
[0m07:17:31.481397 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5
[0m07:17:31.481801 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699
[0m07:17:31.482271 [info ] [Thread-1 (]: 15 of 114 START test not_null_customer_feedback_silver_feedback_date ........... [RUN]
[0m07:17:31.482778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_categories_silver_category_id.28d2833aa5, now test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699)
[0m07:17:31.483205 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699
[0m07:17:31.486735 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699"
[0m07:17:31.487363 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699
[0m07:17:31.489167 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699"
[0m07:17:31.489651 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699"
[0m07:17:31.489934 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699: BEGIN
[0m07:17:31.490205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:31.492524 [debug] [Thread-3 (]: SQL status: BEGIN in 2.716 seconds
[0m07:17:31.492895 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605"
[0m07:17:31.493291 [debug] [Thread-3 (]: On test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select staged_at
from "postgres"."silver"."categories_silver"
where staged_at is null



  
  
      
    ) dbt_internal_test
[0m07:17:31.720044 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:17:31.721663 [debug] [Thread-3 (]: On test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605: ROLLBACK
[0m07:17:31.955599 [debug] [Thread-3 (]: On test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605: Close
[0m07:17:31.956462 [info ] [Thread-3 (]: 12 of 114 PASS not_null_categories_silver_staged_at ............................ [[32mPASS[0m in 3.19s]
[0m07:17:31.957141 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605
[0m07:17:31.957599 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e
[0m07:17:31.958070 [info ] [Thread-3 (]: 16 of 114 START test not_null_customer_feedback_silver_feedback_id ............. [RUN]
[0m07:17:31.958560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_categories_silver_staged_at.580eaf4605, now test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e)
[0m07:17:31.958933 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e
[0m07:17:31.962699 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e"
[0m07:17:31.963310 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e
[0m07:17:31.966519 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e"
[0m07:17:31.966989 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e"
[0m07:17:31.967334 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e: BEGIN
[0m07:17:31.967615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:32.849160 [debug] [Thread-4 (]: SQL status: BEGIN in 2.208 seconds
[0m07:17:32.849652 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae"
[0m07:17:32.849951 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select comments
from "postgres"."silver"."customer_feedback_silver"
where comments is null



  
  
      
    ) dbt_internal_test
[0m07:17:32.992727 [debug] [Thread-2 (]: SQL status: BEGIN in 2.172 seconds
[0m07:17:32.993191 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35"
[0m07:17:32.993526 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver"."customer_feedback_silver"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:33.087959 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.238 seconds
[0m07:17:33.089254 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae: ROLLBACK
[0m07:17:33.212617 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.219 seconds
[0m07:17:33.213950 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35: ROLLBACK
[0m07:17:33.319648 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae: Close
[0m07:17:33.320514 [info ] [Thread-4 (]: 13 of 114 PASS not_null_customer_feedback_silver_comments ...................... [[32mPASS[0m in 2.69s]
[0m07:17:33.321062 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae
[0m07:17:33.321410 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315
[0m07:17:33.321806 [info ] [Thread-4 (]: 17 of 114 START test not_null_customer_feedback_silver_product_id .............. [RUN]
[0m07:17:33.322220 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_comments.25e81fd4ae, now test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315)
[0m07:17:33.322539 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315
[0m07:17:33.325740 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315"
[0m07:17:33.326238 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315
[0m07:17:33.327937 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315"
[0m07:17:33.328421 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315"
[0m07:17:33.328743 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315: BEGIN
[0m07:17:33.329018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:33.437224 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35: Close
[0m07:17:33.438002 [info ] [Thread-2 (]: 14 of 114 PASS not_null_customer_feedback_silver_customer_id ................... [[32mPASS[0m in 2.62s]
[0m07:17:33.438536 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35
[0m07:17:33.438871 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5
[0m07:17:33.439387 [info ] [Thread-2 (]: 18 of 114 START test not_null_customer_feedback_silver_rating .................. [RUN]
[0m07:17:33.439779 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_customer_id.bed22c5c35, now test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5)
[0m07:17:33.440122 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5
[0m07:17:33.443501 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5"
[0m07:17:33.443995 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5
[0m07:17:33.445766 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5"
[0m07:17:33.446249 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5"
[0m07:17:33.446529 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5: BEGIN
[0m07:17:33.446838 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:33.765835 [debug] [Thread-1 (]: SQL status: BEGIN in 2.276 seconds
[0m07:17:33.766295 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699"
[0m07:17:33.766604 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_date
from "postgres"."silver"."customer_feedback_silver"
where feedback_date is null



  
  
      
    ) dbt_internal_test
[0m07:17:33.989290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.222 seconds
[0m07:17:33.990555 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699: ROLLBACK
[0m07:17:34.212231 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699: Close
[0m07:17:34.213020 [info ] [Thread-1 (]: 15 of 114 PASS not_null_customer_feedback_silver_feedback_date ................. [[32mPASS[0m in 2.73s]
[0m07:17:34.213621 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699
[0m07:17:34.214002 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2
[0m07:17:34.214418 [info ] [Thread-1 (]: 19 of 114 START test not_null_customer_feedback_silver_store_id ................ [RUN]
[0m07:17:34.214834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_feedback_date.7c4177c699, now test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2)
[0m07:17:34.215186 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2
[0m07:17:34.218339 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2"
[0m07:17:34.218838 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2
[0m07:17:34.220612 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2"
[0m07:17:34.221092 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2"
[0m07:17:34.221371 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2: BEGIN
[0m07:17:34.221704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:34.229496 [debug] [Thread-3 (]: SQL status: BEGIN in 2.262 seconds
[0m07:17:34.229958 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e"
[0m07:17:34.230309 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_id
from "postgres"."silver"."customer_feedback_silver"
where feedback_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:34.487320 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.257 seconds
[0m07:17:34.488566 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e: ROLLBACK
[0m07:17:34.735890 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e: Close
[0m07:17:34.736662 [info ] [Thread-3 (]: 16 of 114 PASS not_null_customer_feedback_silver_feedback_id ................... [[32mPASS[0m in 2.78s]
[0m07:17:34.737179 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e
[0m07:17:34.737549 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4
[0m07:17:34.737936 [info ] [Thread-3 (]: 20 of 114 START test not_null_customers_silver_created_at ...................... [RUN]
[0m07:17:34.738351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_feedback_id.3946bdc56e, now test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4)
[0m07:17:34.738661 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4
[0m07:17:34.742776 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4"
[0m07:17:34.743298 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4
[0m07:17:34.744936 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4"
[0m07:17:34.745440 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4"
[0m07:17:34.745750 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4: BEGIN
[0m07:17:34.746019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:35.675994 [debug] [Thread-4 (]: SQL status: BEGIN in 2.347 seconds
[0m07:17:35.676558 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315"
[0m07:17:35.676905 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."customer_feedback_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:35.955467 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.278 seconds
[0m07:17:35.956912 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315: ROLLBACK
[0m07:17:36.248991 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315: Close
[0m07:17:36.249908 [info ] [Thread-4 (]: 17 of 114 PASS not_null_customer_feedback_silver_product_id .................... [[32mPASS[0m in 2.93s]
[0m07:17:36.250583 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315
[0m07:17:36.251067 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_customers_silver_customer_id.754b05a681
[0m07:17:36.251627 [info ] [Thread-4 (]: 21 of 114 START test not_null_customers_silver_customer_id ..................... [RUN]
[0m07:17:36.252170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_product_id.8fb9eeb315, now test.retail_dbt.not_null_customers_silver_customer_id.754b05a681)
[0m07:17:36.252570 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_customers_silver_customer_id.754b05a681
[0m07:17:36.256197 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_customers_silver_customer_id.754b05a681"
[0m07:17:36.256815 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_customers_silver_customer_id.754b05a681
[0m07:17:36.258818 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_customers_silver_customer_id.754b05a681"
[0m07:17:36.259381 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_customer_id.754b05a681"
[0m07:17:36.259795 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_customer_id.754b05a681: BEGIN
[0m07:17:36.260141 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:36.389515 [debug] [Thread-1 (]: SQL status: BEGIN in 2.168 seconds
[0m07:17:36.390002 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2"
[0m07:17:36.390392 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."customer_feedback_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:36.609676 [debug] [Thread-2 (]: SQL status: BEGIN in 3.163 seconds
[0m07:17:36.610199 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5"
[0m07:17:36.610556 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from "postgres"."silver"."customer_feedback_silver"
where rating is null



  
  
      
    ) dbt_internal_test
[0m07:17:36.641689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.251 seconds
[0m07:17:36.643175 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2: ROLLBACK
[0m07:17:36.882702 [debug] [Thread-3 (]: SQL status: BEGIN in 2.137 seconds
[0m07:17:36.883209 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4"
[0m07:17:36.883556 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from "postgres"."silver"."customers_silver"
where created_at is null



  
  
      
    ) dbt_internal_test
[0m07:17:36.887681 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.277 seconds
[0m07:17:36.888931 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5: ROLLBACK
[0m07:17:36.889688 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2: Close
[0m07:17:36.890361 [info ] [Thread-1 (]: 19 of 114 PASS not_null_customer_feedback_silver_store_id ...................... [[32mPASS[0m in 2.68s]
[0m07:17:36.890907 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2
[0m07:17:36.891356 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_customers_silver_email.6856528552
[0m07:17:36.891773 [info ] [Thread-1 (]: 22 of 114 START test not_null_customers_silver_email ........................... [RUN]
[0m07:17:36.892188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_store_id.2d5e8f99b2, now test.retail_dbt.not_null_customers_silver_email.6856528552)
[0m07:17:36.892506 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_customers_silver_email.6856528552
[0m07:17:36.895759 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_customers_silver_email.6856528552"
[0m07:17:36.896290 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_customers_silver_email.6856528552
[0m07:17:36.898220 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_customers_silver_email.6856528552"
[0m07:17:36.898717 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_email.6856528552"
[0m07:17:36.899062 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customers_silver_email.6856528552: BEGIN
[0m07:17:36.899380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:37.121023 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.237 seconds
[0m07:17:37.122372 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4: ROLLBACK
[0m07:17:37.164463 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5: Close
[0m07:17:37.165288 [info ] [Thread-2 (]: 18 of 114 PASS not_null_customer_feedback_silver_rating ........................ [[32mPASS[0m in 3.73s]
[0m07:17:37.165856 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5
[0m07:17:37.166264 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8
[0m07:17:37.166693 [info ] [Thread-2 (]: 23 of 114 START test not_null_customers_silver_loyalty_program_id .............. [RUN]
[0m07:17:37.167200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customer_feedback_silver_rating.ab5a9630b5, now test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8)
[0m07:17:37.167534 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8
[0m07:17:37.171039 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8"
[0m07:17:37.171601 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8
[0m07:17:37.173451 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8"
[0m07:17:37.173982 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8"
[0m07:17:37.174330 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8: BEGIN
[0m07:17:37.174664 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:37.369385 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4: Close
[0m07:17:37.370208 [info ] [Thread-3 (]: 20 of 114 PASS not_null_customers_silver_created_at ............................ [[32mPASS[0m in 2.63s]
[0m07:17:37.370749 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4
[0m07:17:37.371203 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_customers_silver_name.864d7a97ce
[0m07:17:37.371630 [info ] [Thread-3 (]: 24 of 114 START test not_null_customers_silver_name ............................ [RUN]
[0m07:17:37.372014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customers_silver_created_at.f6eb18d9e4, now test.retail_dbt.not_null_customers_silver_name.864d7a97ce)
[0m07:17:37.372365 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_customers_silver_name.864d7a97ce
[0m07:17:37.376607 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_customers_silver_name.864d7a97ce"
[0m07:17:37.377125 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_customers_silver_name.864d7a97ce
[0m07:17:37.378891 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_customers_silver_name.864d7a97ce"
[0m07:17:37.379445 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_name.864d7a97ce"
[0m07:17:37.379790 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_name.864d7a97ce: BEGIN
[0m07:17:37.380133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:40.535401 [debug] [Thread-4 (]: SQL status: BEGIN in 2.639 seconds
[0m07:17:40.535829 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_customer_id.754b05a681"
[0m07:17:40.536195 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_customer_id.754b05a681: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customers_silver_customer_id.754b05a681"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver"."customers_silver"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:40.748027 [debug] [Thread-1 (]: SQL status: BEGIN in 2.213 seconds
[0m07:17:40.748499 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_email.6856528552"
[0m07:17:40.748811 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customers_silver_email.6856528552: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customers_silver_email.6856528552"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "postgres"."silver"."customers_silver"
where email is null



  
  
      
    ) dbt_internal_test
[0m07:17:40.800855 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:17:40.801989 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_customer_id.754b05a681: ROLLBACK
[0m07:17:40.980466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.231 seconds
[0m07:17:40.981693 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customers_silver_email.6856528552: ROLLBACK
[0m07:17:41.034139 [debug] [Thread-2 (]: SQL status: BEGIN in 2.223 seconds
[0m07:17:41.034490 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8"
[0m07:17:41.034840 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_id
from "postgres"."silver"."customers_silver"
where loyalty_program_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:41.074929 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_customer_id.754b05a681: Close
[0m07:17:41.075687 [info ] [Thread-4 (]: 21 of 114 PASS not_null_customers_silver_customer_id ........................... [[32mPASS[0m in 4.82s]
[0m07:17:41.076346 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_customers_silver_customer_id.754b05a681
[0m07:17:41.076685 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_customers_silver_phone.ca7dddc621
[0m07:17:41.077081 [info ] [Thread-4 (]: 25 of 114 START test not_null_customers_silver_phone ........................... [RUN]
[0m07:17:41.077472 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customers_silver_customer_id.754b05a681, now test.retail_dbt.not_null_customers_silver_phone.ca7dddc621)
[0m07:17:41.077796 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_customers_silver_phone.ca7dddc621
[0m07:17:41.080954 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_customers_silver_phone.ca7dddc621"
[0m07:17:41.081430 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_customers_silver_phone.ca7dddc621
[0m07:17:41.083184 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_customers_silver_phone.ca7dddc621"
[0m07:17:41.083703 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_phone.ca7dddc621"
[0m07:17:41.084026 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_phone.ca7dddc621: BEGIN
[0m07:17:41.084328 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:41.266111 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.231 seconds
[0m07:17:41.267428 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8: ROLLBACK
[0m07:17:41.496846 [debug] [Thread-2 (]: On test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8: Close
[0m07:17:41.497604 [info ] [Thread-2 (]: 23 of 114 PASS not_null_customers_silver_loyalty_program_id .................... [[32mPASS[0m in 4.33s]
[0m07:17:41.498155 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8
[0m07:17:41.498559 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d
[0m07:17:41.498988 [info ] [Thread-2 (]: 26 of 114 START test not_null_discount_rules_silver_discount_type .............. [RUN]
[0m07:17:41.499413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customers_silver_loyalty_program_id.c42d2a00d8, now test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d)
[0m07:17:41.499750 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d
[0m07:17:41.502855 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d"
[0m07:17:41.503344 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d
[0m07:17:41.505158 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d"
[0m07:17:41.505706 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d"
[0m07:17:41.505998 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d: BEGIN
[0m07:17:41.506309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:41.532482 [debug] [Thread-3 (]: SQL status: BEGIN in 2.516 seconds
[0m07:17:41.532851 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_name.864d7a97ce"
[0m07:17:41.533204 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_name.864d7a97ce: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customers_silver_name.864d7a97ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."customers_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:17:41.660715 [debug] [Thread-1 (]: On test.retail_dbt.not_null_customers_silver_email.6856528552: Close
[0m07:17:41.661689 [info ] [Thread-1 (]: 22 of 114 PASS not_null_customers_silver_email ................................. [[32mPASS[0m in 4.77s]
[0m07:17:41.662247 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_customers_silver_email.6856528552
[0m07:17:41.662634 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4
[0m07:17:41.663045 [info ] [Thread-1 (]: 27 of 114 START test not_null_discount_rules_silver_product_id ................. [RUN]
[0m07:17:41.663586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customers_silver_email.6856528552, now test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4)
[0m07:17:41.663941 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4
[0m07:17:41.667514 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4"
[0m07:17:41.668020 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4
[0m07:17:41.670539 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4"
[0m07:17:41.671048 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4"
[0m07:17:41.671436 [debug] [Thread-1 (]: On test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4: BEGIN
[0m07:17:41.671734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:41.789676 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.256 seconds
[0m07:17:41.791249 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_name.864d7a97ce: ROLLBACK
[0m07:17:42.048763 [debug] [Thread-3 (]: On test.retail_dbt.not_null_customers_silver_name.864d7a97ce: Close
[0m07:17:42.049578 [info ] [Thread-3 (]: 24 of 114 PASS not_null_customers_silver_name .................................. [[32mPASS[0m in 4.68s]
[0m07:17:42.050109 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_customers_silver_name.864d7a97ce
[0m07:17:42.050502 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec
[0m07:17:42.050939 [info ] [Thread-3 (]: 28 of 114 START test not_null_discount_rules_silver_rule_id .................... [RUN]
[0m07:17:42.051435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customers_silver_name.864d7a97ce, now test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec)
[0m07:17:42.051756 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec
[0m07:17:42.054901 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec"
[0m07:17:42.055436 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec
[0m07:17:42.057306 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec"
[0m07:17:42.057817 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec"
[0m07:17:42.058133 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec: BEGIN
[0m07:17:42.058409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:43.130134 [debug] [Thread-4 (]: SQL status: BEGIN in 2.046 seconds
[0m07:17:43.130936 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_customers_silver_phone.ca7dddc621"
[0m07:17:43.131637 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_phone.ca7dddc621: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_customers_silver_phone.ca7dddc621"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "postgres"."silver"."customers_silver"
where phone is null



  
  
      
    ) dbt_internal_test
[0m07:17:43.350242 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.218 seconds
[0m07:17:43.351774 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_phone.ca7dddc621: ROLLBACK
[0m07:17:43.494155 [debug] [Thread-2 (]: SQL status: BEGIN in 1.988 seconds
[0m07:17:43.494663 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d"
[0m07:17:43.495140 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select discount_type
from "postgres"."silver"."discount_rules_silver"
where discount_type is null



  
  
      
    ) dbt_internal_test
[0m07:17:43.572570 [debug] [Thread-4 (]: On test.retail_dbt.not_null_customers_silver_phone.ca7dddc621: Close
[0m07:17:43.573461 [info ] [Thread-4 (]: 25 of 114 PASS not_null_customers_silver_phone ................................. [[32mPASS[0m in 2.50s]
[0m07:17:43.574212 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_customers_silver_phone.ca7dddc621
[0m07:17:43.574641 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6
[0m07:17:43.575100 [info ] [Thread-4 (]: 29 of 114 START test not_null_discount_rules_silver_valid_from ................. [RUN]
[0m07:17:43.575731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_customers_silver_phone.ca7dddc621, now test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6)
[0m07:17:43.576106 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6
[0m07:17:43.579432 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6"
[0m07:17:43.579994 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6
[0m07:17:43.581955 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6"
[0m07:17:43.582453 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6"
[0m07:17:43.582797 [debug] [Thread-4 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6: BEGIN
[0m07:17:43.583145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:43.713828 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.218 seconds
[0m07:17:43.715535 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d: ROLLBACK
[0m07:17:44.086338 [debug] [Thread-3 (]: SQL status: BEGIN in 2.028 seconds
[0m07:17:44.086859 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec"
[0m07:17:44.087291 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rule_id
from "postgres"."silver"."discount_rules_silver"
where rule_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:44.311453 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.224 seconds
[0m07:17:44.313418 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec: ROLLBACK
[0m07:17:44.374584 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d: Close
[0m07:17:44.375391 [info ] [Thread-2 (]: 26 of 114 PASS not_null_discount_rules_silver_discount_type .................... [[32mPASS[0m in 2.88s]
[0m07:17:44.375888 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d
[0m07:17:44.376280 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a
[0m07:17:44.376694 [info ] [Thread-2 (]: 30 of 114 START test not_null_discount_rules_silver_valid_to ................... [RUN]
[0m07:17:44.377129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_discount_rules_silver_discount_type.508466577d, now test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a)
[0m07:17:44.377587 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a
[0m07:17:44.381124 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a"
[0m07:17:44.381638 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a
[0m07:17:44.384473 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a"
[0m07:17:44.385211 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a"
[0m07:17:44.385693 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a: BEGIN
[0m07:17:44.385987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:44.538544 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec: Close
[0m07:17:44.539731 [info ] [Thread-3 (]: 28 of 114 PASS not_null_discount_rules_silver_rule_id .......................... [[32mPASS[0m in 2.49s]
[0m07:17:44.540872 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec
[0m07:17:44.541648 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_discount_rules_silver_value.c62b860389
[0m07:17:44.542317 [info ] [Thread-3 (]: 31 of 114 START test not_null_discount_rules_silver_value ...................... [RUN]
[0m07:17:44.542844 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_discount_rules_silver_rule_id.3bd4495dec, now test.retail_dbt.not_null_discount_rules_silver_value.c62b860389)
[0m07:17:44.543216 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_discount_rules_silver_value.c62b860389
[0m07:17:44.547517 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_discount_rules_silver_value.c62b860389"
[0m07:17:44.548016 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_discount_rules_silver_value.c62b860389
[0m07:17:44.549868 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_discount_rules_silver_value.c62b860389"
[0m07:17:44.550363 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_value.c62b860389"
[0m07:17:44.550701 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_value.c62b860389: BEGIN
[0m07:17:44.550986 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:44.682254 [debug] [Thread-1 (]: SQL status: BEGIN in 3.010 seconds
[0m07:17:44.682707 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4"
[0m07:17:44.683130 [debug] [Thread-1 (]: On test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."discount_rules_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:44.996287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.313 seconds
[0m07:17:44.997793 [debug] [Thread-1 (]: On test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4: ROLLBACK
[0m07:17:45.248399 [debug] [Thread-1 (]: On test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4: Close
[0m07:17:45.249272 [info ] [Thread-1 (]: 27 of 114 PASS not_null_discount_rules_silver_product_id ....................... [[32mPASS[0m in 3.59s]
[0m07:17:45.249849 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4
[0m07:17:45.250244 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3
[0m07:17:45.250689 [info ] [Thread-1 (]: 32 of 114 START test not_null_employees_silver_employee_id ..................... [RUN]
[0m07:17:45.251283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_discount_rules_silver_product_id.81bef753f4, now test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3)
[0m07:17:45.251776 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3
[0m07:17:45.256654 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3"
[0m07:17:45.257317 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3
[0m07:17:45.260526 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3"
[0m07:17:45.261252 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3"
[0m07:17:45.261704 [debug] [Thread-1 (]: On test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3: BEGIN
[0m07:17:45.262163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:45.891509 [debug] [Thread-4 (]: SQL status: BEGIN in 2.308 seconds
[0m07:17:45.892113 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6"
[0m07:17:45.892590 [debug] [Thread-4 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver"."discount_rules_silver"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:17:46.131476 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.238 seconds
[0m07:17:46.132887 [debug] [Thread-4 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6: ROLLBACK
[0m07:17:46.369191 [debug] [Thread-4 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6: Close
[0m07:17:46.370160 [info ] [Thread-4 (]: 29 of 114 PASS not_null_discount_rules_silver_valid_from ....................... [[32mPASS[0m in 2.79s]
[0m07:17:46.370764 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6
[0m07:17:46.371205 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_employees_silver_name.3812e26daf
[0m07:17:46.371603 [info ] [Thread-4 (]: 33 of 114 START test not_null_employees_silver_name ............................ [RUN]
[0m07:17:46.372039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_discount_rules_silver_valid_from.8c61636ef6, now test.retail_dbt.not_null_employees_silver_name.3812e26daf)
[0m07:17:46.372390 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_employees_silver_name.3812e26daf
[0m07:17:46.375727 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_employees_silver_name.3812e26daf"
[0m07:17:46.376252 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_employees_silver_name.3812e26daf
[0m07:17:46.378085 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_employees_silver_name.3812e26daf"
[0m07:17:46.378612 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_name.3812e26daf"
[0m07:17:46.378916 [debug] [Thread-4 (]: On test.retail_dbt.not_null_employees_silver_name.3812e26daf: BEGIN
[0m07:17:46.379245 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:46.901976 [debug] [Thread-3 (]: SQL status: BEGIN in 2.351 seconds
[0m07:17:46.902484 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_value.c62b860389"
[0m07:17:46.902854 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_value.c62b860389: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_discount_rules_silver_value.c62b860389"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select value
from "postgres"."silver"."discount_rules_silver"
where value is null



  
  
      
    ) dbt_internal_test
[0m07:17:46.908655 [debug] [Thread-2 (]: SQL status: BEGIN in 2.523 seconds
[0m07:17:46.909112 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a"
[0m07:17:46.909518 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver"."discount_rules_silver"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:17:47.145270 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.242 seconds
[0m07:17:47.146904 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_value.c62b860389: ROLLBACK
[0m07:17:47.185870 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.276 seconds
[0m07:17:47.187353 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a: ROLLBACK
[0m07:17:47.393290 [debug] [Thread-3 (]: On test.retail_dbt.not_null_discount_rules_silver_value.c62b860389: Close
[0m07:17:47.394137 [info ] [Thread-3 (]: 31 of 114 PASS not_null_discount_rules_silver_value ............................ [[32mPASS[0m in 2.85s]
[0m07:17:47.394810 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_discount_rules_silver_value.c62b860389
[0m07:17:47.395274 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_employees_silver_role.958be5c671
[0m07:17:47.395767 [info ] [Thread-3 (]: 34 of 114 START test not_null_employees_silver_role ............................ [RUN]
[0m07:17:47.396222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_discount_rules_silver_value.c62b860389, now test.retail_dbt.not_null_employees_silver_role.958be5c671)
[0m07:17:47.396595 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_employees_silver_role.958be5c671
[0m07:17:47.400110 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_employees_silver_role.958be5c671"
[0m07:17:47.400663 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_employees_silver_role.958be5c671
[0m07:17:47.402509 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_employees_silver_role.958be5c671"
[0m07:17:47.403004 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_role.958be5c671"
[0m07:17:47.403375 [debug] [Thread-3 (]: On test.retail_dbt.not_null_employees_silver_role.958be5c671: BEGIN
[0m07:17:47.403667 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:47.464149 [debug] [Thread-2 (]: On test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a: Close
[0m07:17:47.466182 [info ] [Thread-2 (]: 30 of 114 PASS not_null_discount_rules_silver_valid_to ......................... [[32mPASS[0m in 3.09s]
[0m07:17:47.466815 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a
[0m07:17:47.467262 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_employees_silver_store_id.0e962c8015
[0m07:17:47.467701 [info ] [Thread-2 (]: 35 of 114 START test not_null_employees_silver_store_id ........................ [RUN]
[0m07:17:47.468140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_discount_rules_silver_valid_to.b846afb85a, now test.retail_dbt.not_null_employees_silver_store_id.0e962c8015)
[0m07:17:47.468502 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_employees_silver_store_id.0e962c8015
[0m07:17:47.471752 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_employees_silver_store_id.0e962c8015"
[0m07:17:47.472434 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_employees_silver_store_id.0e962c8015
[0m07:17:47.474349 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_employees_silver_store_id.0e962c8015"
[0m07:17:47.474869 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_store_id.0e962c8015"
[0m07:17:47.475206 [debug] [Thread-2 (]: On test.retail_dbt.not_null_employees_silver_store_id.0e962c8015: BEGIN
[0m07:17:47.475503 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:47.760224 [debug] [Thread-1 (]: SQL status: BEGIN in 2.498 seconds
[0m07:17:47.760765 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3"
[0m07:17:47.761130 [debug] [Thread-1 (]: On test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from "postgres"."silver"."employees_silver"
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:48.040408 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:17:48.041893 [debug] [Thread-1 (]: On test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3: ROLLBACK
[0m07:17:48.319978 [debug] [Thread-1 (]: On test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3: Close
[0m07:17:48.320865 [info ] [Thread-1 (]: 32 of 114 PASS not_null_employees_silver_employee_id ........................... [[32mPASS[0m in 3.07s]
[0m07:17:48.321405 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3
[0m07:17:48.321796 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251
[0m07:17:48.322258 [info ] [Thread-1 (]: 36 of 114 START test not_null_inventory_silver_inventory_id .................... [RUN]
[0m07:17:48.322656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_employees_silver_employee_id.c69a236ad3, now test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251)
[0m07:17:48.323005 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251
[0m07:17:48.326383 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251"
[0m07:17:48.326931 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251
[0m07:17:48.328845 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251"
[0m07:17:48.329351 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251"
[0m07:17:48.329695 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251: BEGIN
[0m07:17:48.329990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:49.415635 [debug] [Thread-4 (]: SQL status: BEGIN in 3.036 seconds
[0m07:17:49.416140 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_name.3812e26daf"
[0m07:17:49.416468 [debug] [Thread-4 (]: On test.retail_dbt.not_null_employees_silver_name.3812e26daf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_employees_silver_name.3812e26daf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."employees_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:17:49.662101 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:17:49.663528 [debug] [Thread-4 (]: On test.retail_dbt.not_null_employees_silver_name.3812e26daf: ROLLBACK
[0m07:17:49.885252 [debug] [Thread-3 (]: SQL status: BEGIN in 2.481 seconds
[0m07:17:49.885705 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_role.958be5c671"
[0m07:17:49.886041 [debug] [Thread-3 (]: On test.retail_dbt.not_null_employees_silver_role.958be5c671: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_employees_silver_role.958be5c671"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select role
from "postgres"."silver"."employees_silver"
where role is null



  
  
      
    ) dbt_internal_test
[0m07:17:49.895333 [debug] [Thread-2 (]: SQL status: BEGIN in 2.420 seconds
[0m07:17:49.895715 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_employees_silver_store_id.0e962c8015"
[0m07:17:49.896037 [debug] [Thread-2 (]: On test.retail_dbt.not_null_employees_silver_store_id.0e962c8015: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_employees_silver_store_id.0e962c8015"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."employees_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:49.912948 [debug] [Thread-4 (]: On test.retail_dbt.not_null_employees_silver_name.3812e26daf: Close
[0m07:17:49.913751 [info ] [Thread-4 (]: 33 of 114 PASS not_null_employees_silver_name .................................. [[32mPASS[0m in 3.54s]
[0m07:17:49.914303 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_employees_silver_name.3812e26daf
[0m07:17:49.914714 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9
[0m07:17:49.915150 [info ] [Thread-4 (]: 37 of 114 START test not_null_inventory_silver_last_updated .................... [RUN]
[0m07:17:49.915561 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_employees_silver_name.3812e26daf, now test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9)
[0m07:17:49.915855 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9
[0m07:17:49.919149 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9"
[0m07:17:49.919647 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9
[0m07:17:49.921381 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9"
[0m07:17:49.921807 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9"
[0m07:17:49.922083 [debug] [Thread-4 (]: On test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9: BEGIN
[0m07:17:49.922526 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:50.106143 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.220 seconds
[0m07:17:50.107428 [debug] [Thread-3 (]: On test.retail_dbt.not_null_employees_silver_role.958be5c671: ROLLBACK
[0m07:17:50.165255 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.269 seconds
[0m07:17:50.166488 [debug] [Thread-2 (]: On test.retail_dbt.not_null_employees_silver_store_id.0e962c8015: ROLLBACK
[0m07:17:50.330759 [debug] [Thread-3 (]: On test.retail_dbt.not_null_employees_silver_role.958be5c671: Close
[0m07:17:50.331747 [info ] [Thread-3 (]: 34 of 114 PASS not_null_employees_silver_role .................................. [[32mPASS[0m in 2.94s]
[0m07:17:50.332411 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_employees_silver_role.958be5c671
[0m07:17:50.332764 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f
[0m07:17:50.333279 [info ] [Thread-3 (]: 38 of 114 START test not_null_inventory_silver_product_id ...................... [RUN]
[0m07:17:50.333800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_employees_silver_role.958be5c671, now test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f)
[0m07:17:50.334239 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f
[0m07:17:50.340146 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f"
[0m07:17:50.341123 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f
[0m07:17:50.345461 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f"
[0m07:17:50.346028 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f"
[0m07:17:50.346391 [debug] [Thread-3 (]: On test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f: BEGIN
[0m07:17:50.346670 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:50.423524 [debug] [Thread-2 (]: On test.retail_dbt.not_null_employees_silver_store_id.0e962c8015: Close
[0m07:17:50.424321 [info ] [Thread-2 (]: 35 of 114 PASS not_null_employees_silver_store_id .............................. [[32mPASS[0m in 2.96s]
[0m07:17:50.424897 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_employees_silver_store_id.0e962c8015
[0m07:17:50.425279 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b
[0m07:17:50.425625 [info ] [Thread-2 (]: 39 of 114 START test not_null_inventory_silver_quantity ........................ [RUN]
[0m07:17:50.426140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_employees_silver_store_id.0e962c8015, now test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b)
[0m07:17:50.426448 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b
[0m07:17:50.429643 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b"
[0m07:17:50.430143 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b
[0m07:17:50.431945 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b"
[0m07:17:50.432423 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b"
[0m07:17:50.432700 [debug] [Thread-2 (]: On test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b: BEGIN
[0m07:17:50.433012 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:51.581071 [debug] [Thread-1 (]: SQL status: BEGIN in 3.251 seconds
[0m07:17:51.581550 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251"
[0m07:17:51.581858 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select inventory_id
from "postgres"."silver"."inventory_silver"
where inventory_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:51.803493 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.221 seconds
[0m07:17:51.804820 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251: ROLLBACK
[0m07:17:52.032759 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251: Close
[0m07:17:52.033616 [info ] [Thread-1 (]: 36 of 114 PASS not_null_inventory_silver_inventory_id .......................... [[32mPASS[0m in 3.71s]
[0m07:17:52.034176 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251
[0m07:17:52.034564 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd
[0m07:17:52.034982 [info ] [Thread-1 (]: 40 of 114 START test not_null_inventory_silver_store_id ........................ [RUN]
[0m07:17:52.035444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_inventory_silver_inventory_id.b8e25e2251, now test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd)
[0m07:17:52.035739 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd
[0m07:17:52.038974 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd"
[0m07:17:52.039545 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd
[0m07:17:52.041536 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd"
[0m07:17:52.042015 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd"
[0m07:17:52.042330 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd: BEGIN
[0m07:17:52.042599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:52.278652 [debug] [Thread-4 (]: SQL status: BEGIN in 2.356 seconds
[0m07:17:52.279312 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9"
[0m07:17:52.279628 [debug] [Thread-4 (]: On test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated
from "postgres"."silver"."inventory_silver"
where last_updated is null



  
  
      
    ) dbt_internal_test
[0m07:17:52.393301 [debug] [Thread-3 (]: SQL status: BEGIN in 2.046 seconds
[0m07:17:52.393691 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f"
[0m07:17:52.394026 [debug] [Thread-3 (]: On test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."inventory_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:52.502266 [debug] [Thread-2 (]: SQL status: BEGIN in 2.069 seconds
[0m07:17:52.502679 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b"
[0m07:17:52.503006 [debug] [Thread-2 (]: On test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver"."inventory_silver"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m07:17:52.534419 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.254 seconds
[0m07:17:52.535718 [debug] [Thread-4 (]: On test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9: ROLLBACK
[0m07:17:52.617377 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.223 seconds
[0m07:17:52.618625 [debug] [Thread-3 (]: On test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f: ROLLBACK
[0m07:17:52.729516 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:17:52.730845 [debug] [Thread-2 (]: On test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b: ROLLBACK
[0m07:17:52.790786 [debug] [Thread-4 (]: On test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9: Close
[0m07:17:52.791716 [info ] [Thread-4 (]: 37 of 114 PASS not_null_inventory_silver_last_updated .......................... [[32mPASS[0m in 2.88s]
[0m07:17:52.792329 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9
[0m07:17:52.792717 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162
[0m07:17:52.793150 [info ] [Thread-4 (]: 41 of 114 START test not_null_loyalty_programs_silver_loyalty_program_id ....... [RUN]
[0m07:17:52.793552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_inventory_silver_last_updated.0342be2bb9, now test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162)
[0m07:17:52.793892 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162
[0m07:17:52.797171 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162"
[0m07:17:52.797700 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162
[0m07:17:52.799498 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162"
[0m07:17:52.800070 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162"
[0m07:17:52.800387 [debug] [Thread-4 (]: On test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162: BEGIN
[0m07:17:52.800700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:52.843653 [debug] [Thread-3 (]: On test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f: Close
[0m07:17:52.844409 [info ] [Thread-3 (]: 38 of 114 PASS not_null_inventory_silver_product_id ............................ [[32mPASS[0m in 2.51s]
[0m07:17:52.844910 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f
[0m07:17:52.845279 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2
[0m07:17:52.845664 [info ] [Thread-3 (]: 42 of 114 START test not_null_loyalty_programs_silver_name ..................... [RUN]
[0m07:17:52.846030 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_inventory_silver_product_id.d0a7b9584f, now test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2)
[0m07:17:52.846392 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2
[0m07:17:52.850534 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2"
[0m07:17:52.851027 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2
[0m07:17:52.852792 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2"
[0m07:17:52.853266 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2"
[0m07:17:52.853566 [debug] [Thread-3 (]: On test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2: BEGIN
[0m07:17:52.853840 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:52.984889 [debug] [Thread-2 (]: On test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b: Close
[0m07:17:52.985783 [info ] [Thread-2 (]: 39 of 114 PASS not_null_inventory_silver_quantity .............................. [[32mPASS[0m in 2.56s]
[0m07:17:52.986428 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b
[0m07:17:52.986923 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71
[0m07:17:52.987422 [info ] [Thread-2 (]: 43 of 114 START test not_null_loyalty_programs_silver_points_per_dollar ........ [RUN]
[0m07:17:52.987839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_inventory_silver_quantity.ea309d107b, now test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71)
[0m07:17:52.988182 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71
[0m07:17:52.991198 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71"
[0m07:17:52.991712 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71
[0m07:17:52.993596 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71"
[0m07:17:52.994085 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71"
[0m07:17:52.994403 [debug] [Thread-2 (]: On test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71: BEGIN
[0m07:17:52.994672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:54.141893 [debug] [Thread-1 (]: SQL status: BEGIN in 2.099 seconds
[0m07:17:54.142392 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd"
[0m07:17:54.142799 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."inventory_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:54.904442 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.761 seconds
[0m07:17:54.905735 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd: ROLLBACK
[0m07:17:55.127214 [debug] [Thread-3 (]: SQL status: BEGIN in 2.273 seconds
[0m07:17:55.127770 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2"
[0m07:17:55.128194 [debug] [Thread-3 (]: On test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."loyalty_programs_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:17:55.176288 [debug] [Thread-1 (]: On test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd: Close
[0m07:17:55.177195 [info ] [Thread-1 (]: 40 of 114 PASS not_null_inventory_silver_store_id .............................. [[32mPASS[0m in 3.14s]
[0m07:17:55.177745 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd
[0m07:17:55.178157 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_payments_silver_method.de459907f5
[0m07:17:55.178617 [info ] [Thread-1 (]: 44 of 114 START test not_null_payments_silver_method ........................... [RUN]
[0m07:17:55.179118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_inventory_silver_store_id.b0a34febbd, now test.retail_dbt.not_null_payments_silver_method.de459907f5)
[0m07:17:55.179492 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_payments_silver_method.de459907f5
[0m07:17:55.183005 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_payments_silver_method.de459907f5"
[0m07:17:55.183550 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_payments_silver_method.de459907f5
[0m07:17:55.185334 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_payments_silver_method.de459907f5"
[0m07:17:55.185855 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_method.de459907f5"
[0m07:17:55.186205 [debug] [Thread-1 (]: On test.retail_dbt.not_null_payments_silver_method.de459907f5: BEGIN
[0m07:17:55.186545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:55.376855 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.248 seconds
[0m07:17:55.378223 [debug] [Thread-3 (]: On test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2: ROLLBACK
[0m07:17:55.404008 [debug] [Thread-4 (]: SQL status: BEGIN in 2.603 seconds
[0m07:17:55.404397 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162"
[0m07:17:55.404767 [debug] [Thread-4 (]: On test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_id
from "postgres"."silver"."loyalty_programs_silver"
where loyalty_program_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:55.409174 [debug] [Thread-2 (]: SQL status: BEGIN in 2.414 seconds
[0m07:17:55.409638 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71"
[0m07:17:55.410062 [debug] [Thread-2 (]: On test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select points_per_dollar
from "postgres"."silver"."loyalty_programs_silver"
where points_per_dollar is null



  
  
      
    ) dbt_internal_test
[0m07:17:55.638542 [debug] [Thread-3 (]: On test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2: Close
[0m07:17:55.639453 [info ] [Thread-3 (]: 42 of 114 PASS not_null_loyalty_programs_silver_name ........................... [[32mPASS[0m in 2.79s]
[0m07:17:55.640001 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2
[0m07:17:55.640416 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2
[0m07:17:55.640864 [info ] [Thread-3 (]: 45 of 114 START test not_null_payments_silver_paid_at .......................... [RUN]
[0m07:17:55.641318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_loyalty_programs_silver_name.89b9e901e2, now test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2)
[0m07:17:55.641646 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2
[0m07:17:55.645145 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2"
[0m07:17:55.645739 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2
[0m07:17:55.648910 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2"
[0m07:17:55.649440 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2"
[0m07:17:55.649775 [debug] [Thread-3 (]: On test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2: BEGIN
[0m07:17:55.650071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:55.677223 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.272 seconds
[0m07:17:55.678613 [debug] [Thread-4 (]: On test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162: ROLLBACK
[0m07:17:55.701219 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.291 seconds
[0m07:17:55.702280 [debug] [Thread-2 (]: On test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71: ROLLBACK
[0m07:17:55.950505 [debug] [Thread-4 (]: On test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162: Close
[0m07:17:55.951436 [info ] [Thread-4 (]: 41 of 114 PASS not_null_loyalty_programs_silver_loyalty_program_id ............. [[32mPASS[0m in 3.16s]
[0m07:17:55.952001 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162
[0m07:17:55.952397 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b
[0m07:17:55.952873 [info ] [Thread-4 (]: 46 of 114 START test not_null_payments_silver_payment_id ....................... [RUN]
[0m07:17:55.953276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_loyalty_programs_silver_loyalty_program_id.b5828a7162, now test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b)
[0m07:17:55.953630 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b
[0m07:17:55.956974 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b"
[0m07:17:55.957507 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b
[0m07:17:55.959441 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b"
[0m07:17:55.959940 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b"
[0m07:17:55.960285 [debug] [Thread-4 (]: On test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b: BEGIN
[0m07:17:55.960582 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:55.981181 [debug] [Thread-2 (]: On test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71: Close
[0m07:17:55.981908 [info ] [Thread-2 (]: 43 of 114 PASS not_null_loyalty_programs_silver_points_per_dollar .............. [[32mPASS[0m in 2.99s]
[0m07:17:55.982496 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71
[0m07:17:55.982892 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_payments_silver_status.c2c4b77279
[0m07:17:55.983391 [info ] [Thread-2 (]: 47 of 114 START test not_null_payments_silver_status ........................... [RUN]
[0m07:17:55.983823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_loyalty_programs_silver_points_per_dollar.b30f4d0a71, now test.retail_dbt.not_null_payments_silver_status.c2c4b77279)
[0m07:17:55.984148 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_payments_silver_status.c2c4b77279
[0m07:17:55.987462 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_payments_silver_status.c2c4b77279"
[0m07:17:55.988004 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_payments_silver_status.c2c4b77279
[0m07:17:55.989807 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_payments_silver_status.c2c4b77279"
[0m07:17:55.990328 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_status.c2c4b77279"
[0m07:17:55.990652 [debug] [Thread-2 (]: On test.retail_dbt.not_null_payments_silver_status.c2c4b77279: BEGIN
[0m07:17:55.990971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:17:57.545186 [debug] [Thread-1 (]: SQL status: BEGIN in 2.359 seconds
[0m07:17:57.545632 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_method.de459907f5"
[0m07:17:57.545930 [debug] [Thread-1 (]: On test.retail_dbt.not_null_payments_silver_method.de459907f5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_payments_silver_method.de459907f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select method
from "postgres"."silver"."payments_silver"
where method is null



  
  
      
    ) dbt_internal_test
[0m07:17:57.775024 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.229 seconds
[0m07:17:57.776458 [debug] [Thread-1 (]: On test.retail_dbt.not_null_payments_silver_method.de459907f5: ROLLBACK
[0m07:17:58.002246 [debug] [Thread-1 (]: On test.retail_dbt.not_null_payments_silver_method.de459907f5: Close
[0m07:17:58.003032 [info ] [Thread-1 (]: 44 of 114 PASS not_null_payments_silver_method ................................. [[32mPASS[0m in 2.82s]
[0m07:17:58.003709 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_payments_silver_method.de459907f5
[0m07:17:58.004079 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4
[0m07:17:58.004494 [info ] [Thread-1 (]: 48 of 114 START test not_null_pricing_history_silver_effective_date ............ [RUN]
[0m07:17:58.004927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_payments_silver_method.de459907f5, now test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4)
[0m07:17:58.005256 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4
[0m07:17:58.008579 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4"
[0m07:17:58.009082 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4
[0m07:17:58.011134 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4"
[0m07:17:58.011702 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4"
[0m07:17:58.012025 [debug] [Thread-1 (]: On test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4: BEGIN
[0m07:17:58.012390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:17:58.108252 [debug] [Thread-3 (]: SQL status: BEGIN in 2.458 seconds
[0m07:17:58.108741 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2"
[0m07:17:58.109093 [debug] [Thread-3 (]: On test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select paid_at
from "postgres"."silver"."payments_silver"
where paid_at is null



  
  
      
    ) dbt_internal_test
[0m07:17:58.244274 [debug] [Thread-2 (]: SQL status: BEGIN in 2.253 seconds
[0m07:17:58.244737 [debug] [Thread-4 (]: SQL status: BEGIN in 2.284 seconds
[0m07:17:58.245117 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_status.c2c4b77279"
[0m07:17:58.245533 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b"
[0m07:17:58.245925 [debug] [Thread-2 (]: On test.retail_dbt.not_null_payments_silver_status.c2c4b77279: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_payments_silver_status.c2c4b77279"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "postgres"."silver"."payments_silver"
where status is null



  
  
      
    ) dbt_internal_test
[0m07:17:58.246303 [debug] [Thread-4 (]: On test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "postgres"."silver"."payments_silver"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m07:17:58.375604 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.266 seconds
[0m07:17:58.377158 [debug] [Thread-3 (]: On test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2: ROLLBACK
[0m07:17:58.481441 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:17:58.481940 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:17:58.483098 [debug] [Thread-4 (]: On test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b: ROLLBACK
[0m07:17:58.484101 [debug] [Thread-2 (]: On test.retail_dbt.not_null_payments_silver_status.c2c4b77279: ROLLBACK
[0m07:17:58.634446 [debug] [Thread-3 (]: On test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2: Close
[0m07:17:58.635281 [info ] [Thread-3 (]: 45 of 114 PASS not_null_payments_silver_paid_at ................................ [[32mPASS[0m in 2.99s]
[0m07:17:58.635824 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2
[0m07:17:58.636203 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250
[0m07:17:58.636627 [info ] [Thread-3 (]: 49 of 114 START test not_null_pricing_history_silver_history_id ................ [RUN]
[0m07:17:58.637036 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_payments_silver_paid_at.fb99aa72f2, now test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250)
[0m07:17:58.637363 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250
[0m07:17:58.640538 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250"
[0m07:17:58.641025 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250
[0m07:17:58.643992 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250"
[0m07:17:58.644491 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250"
[0m07:17:58.644811 [debug] [Thread-3 (]: On test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250: BEGIN
[0m07:17:58.645107 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:17:58.719710 [debug] [Thread-2 (]: On test.retail_dbt.not_null_payments_silver_status.c2c4b77279: Close
[0m07:17:58.720945 [debug] [Thread-4 (]: On test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b: Close
[0m07:17:58.720615 [info ] [Thread-2 (]: 47 of 114 PASS not_null_payments_silver_status ................................. [[32mPASS[0m in 2.74s]
[0m07:17:58.721694 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_payments_silver_status.c2c4b77279
[0m07:17:58.722498 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52
[0m07:17:58.722177 [info ] [Thread-4 (]: 46 of 114 PASS not_null_payments_silver_payment_id ............................. [[32mPASS[0m in 2.77s]
[0m07:17:58.723241 [info ] [Thread-2 (]: 50 of 114 START test not_null_pricing_history_silver_price ..................... [RUN]
[0m07:17:58.723841 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b
[0m07:17:58.724303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_payments_silver_status.c2c4b77279, now test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52)
[0m07:17:58.724811 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d
[0m07:17:58.725325 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52
[0m07:17:58.725751 [info ] [Thread-4 (]: 51 of 114 START test not_null_pricing_history_silver_product_id ................ [RUN]
[0m07:17:58.728962 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52"
[0m07:17:58.729388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_payments_silver_payment_id.c1d20ab72b, now test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d)
[0m07:17:58.729900 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d
[0m07:17:58.732748 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d"
[0m07:17:58.733231 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52
[0m07:17:58.733614 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d
[0m07:17:58.735648 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52"
[0m07:17:58.737529 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d"
[0m07:17:58.738171 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d"
[0m07:17:58.738533 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52"
[0m07:17:58.738907 [debug] [Thread-4 (]: On test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d: BEGIN
[0m07:17:58.739332 [debug] [Thread-2 (]: On test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52: BEGIN
[0m07:17:58.739712 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:17:58.740084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:00.522271 [debug] [Thread-1 (]: SQL status: BEGIN in 2.510 seconds
[0m07:18:00.522711 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4"
[0m07:18:00.523054 [debug] [Thread-1 (]: On test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "postgres"."silver"."pricing_history_silver"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:00.675114 [debug] [Thread-3 (]: SQL status: BEGIN in 2.030 seconds
[0m07:18:00.675604 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250"
[0m07:18:00.675964 [debug] [Thread-3 (]: On test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select history_id
from "postgres"."silver"."pricing_history_silver"
where history_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:00.785606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:18:00.787177 [debug] [Thread-1 (]: On test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4: ROLLBACK
[0m07:18:00.890201 [debug] [Thread-4 (]: SQL status: BEGIN in 2.150 seconds
[0m07:18:00.890634 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d"
[0m07:18:00.890963 [debug] [Thread-4 (]: On test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."pricing_history_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:00.897530 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.221 seconds
[0m07:18:00.898681 [debug] [Thread-3 (]: On test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250: ROLLBACK
[0m07:18:01.060263 [debug] [Thread-1 (]: On test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4: Close
[0m07:18:01.060999 [info ] [Thread-1 (]: 48 of 114 PASS not_null_pricing_history_silver_effective_date .................. [[32mPASS[0m in 3.06s]
[0m07:18:01.061474 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4
[0m07:18:01.061809 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560
[0m07:18:01.062174 [info ] [Thread-1 (]: 52 of 114 START test not_null_products_silver_brand_id ......................... [RUN]
[0m07:18:01.062576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_pricing_history_silver_effective_date.e4ecdc8dc4, now test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560)
[0m07:18:01.062895 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560
[0m07:18:01.065963 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560"
[0m07:18:01.066450 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560
[0m07:18:01.068287 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560"
[0m07:18:01.068914 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560"
[0m07:18:01.069234 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560: BEGIN
[0m07:18:01.069484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:01.114017 [debug] [Thread-3 (]: On test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250: Close
[0m07:18:01.115326 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.224 seconds
[0m07:18:01.114879 [info ] [Thread-3 (]: 49 of 114 PASS not_null_pricing_history_silver_history_id ...................... [[32mPASS[0m in 2.48s]
[0m07:18:01.116961 [debug] [Thread-4 (]: On test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d: ROLLBACK
[0m07:18:01.117674 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250
[0m07:18:01.118190 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_products_silver_category_id.2a4206bc12
[0m07:18:01.118687 [info ] [Thread-3 (]: 53 of 114 START test not_null_products_silver_category_id ...................... [RUN]
[0m07:18:01.119227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_pricing_history_silver_history_id.e867959250, now test.retail_dbt.not_null_products_silver_category_id.2a4206bc12)
[0m07:18:01.119626 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_products_silver_category_id.2a4206bc12
[0m07:18:01.123807 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_category_id.2a4206bc12"
[0m07:18:01.124301 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_products_silver_category_id.2a4206bc12
[0m07:18:01.182704 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_category_id.2a4206bc12"
[0m07:18:01.183392 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_category_id.2a4206bc12"
[0m07:18:01.183702 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_category_id.2a4206bc12: BEGIN
[0m07:18:01.183974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:01.281199 [debug] [Thread-2 (]: SQL status: BEGIN in 2.541 seconds
[0m07:18:01.281730 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52"
[0m07:18:01.282097 [debug] [Thread-2 (]: On test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "postgres"."silver"."pricing_history_silver"
where price is null



  
  
      
    ) dbt_internal_test
[0m07:18:01.344711 [debug] [Thread-4 (]: On test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d: Close
[0m07:18:01.345701 [info ] [Thread-4 (]: 51 of 114 PASS not_null_pricing_history_silver_product_id ...................... [[32mPASS[0m in 2.62s]
[0m07:18:01.346421 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d
[0m07:18:01.346929 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_products_silver_created_at.f661bb341b
[0m07:18:01.347440 [info ] [Thread-4 (]: 54 of 114 START test not_null_products_silver_created_at ....................... [RUN]
[0m07:18:01.347880 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_pricing_history_silver_product_id.35adcf9c8d, now test.retail_dbt.not_null_products_silver_created_at.f661bb341b)
[0m07:18:01.348259 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_products_silver_created_at.f661bb341b
[0m07:18:01.351671 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_created_at.f661bb341b"
[0m07:18:01.352185 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_products_silver_created_at.f661bb341b
[0m07:18:01.354022 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_created_at.f661bb341b"
[0m07:18:01.354582 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_created_at.f661bb341b"
[0m07:18:01.354928 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_created_at.f661bb341b: BEGIN
[0m07:18:01.355275 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:01.522354 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:18:01.523907 [debug] [Thread-2 (]: On test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52: ROLLBACK
[0m07:18:01.768154 [debug] [Thread-2 (]: On test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52: Close
[0m07:18:01.768988 [info ] [Thread-2 (]: 50 of 114 PASS not_null_pricing_history_silver_price ........................... [[32mPASS[0m in 3.04s]
[0m07:18:01.769536 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52
[0m07:18:01.769931 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_products_silver_name.2eb427bac7
[0m07:18:01.770430 [info ] [Thread-2 (]: 55 of 114 START test not_null_products_silver_name ............................. [RUN]
[0m07:18:01.770848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_pricing_history_silver_price.b1fde7cb52, now test.retail_dbt.not_null_products_silver_name.2eb427bac7)
[0m07:18:01.771203 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_products_silver_name.2eb427bac7
[0m07:18:01.774469 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_name.2eb427bac7"
[0m07:18:01.774998 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_products_silver_name.2eb427bac7
[0m07:18:01.776944 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_name.2eb427bac7"
[0m07:18:01.777495 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_name.2eb427bac7"
[0m07:18:01.777867 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_name.2eb427bac7: BEGIN
[0m07:18:01.778172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:03.610455 [debug] [Thread-1 (]: SQL status: BEGIN in 2.541 seconds
[0m07:18:03.610979 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560"
[0m07:18:03.611400 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select brand_id
from "postgres"."silver"."products_silver"
where brand_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:03.816695 [debug] [Thread-3 (]: SQL status: BEGIN in 2.633 seconds
[0m07:18:03.817196 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_category_id.2a4206bc12"
[0m07:18:03.817563 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_category_id.2a4206bc12: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_category_id.2a4206bc12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from "postgres"."silver"."products_silver"
where category_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:03.940043 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.328 seconds
[0m07:18:03.941487 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560: ROLLBACK
[0m07:18:04.189212 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.371 seconds
[0m07:18:04.190663 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_category_id.2a4206bc12: ROLLBACK
[0m07:18:04.433585 [debug] [Thread-4 (]: SQL status: BEGIN in 3.078 seconds
[0m07:18:04.434008 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_created_at.f661bb341b"
[0m07:18:04.434307 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_created_at.f661bb341b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_created_at.f661bb341b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from "postgres"."silver"."products_silver"
where created_at is null



  
  
      
    ) dbt_internal_test
[0m07:18:04.506117 [debug] [Thread-2 (]: SQL status: BEGIN in 2.728 seconds
[0m07:18:04.506596 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_name.2eb427bac7"
[0m07:18:04.507101 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_name.2eb427bac7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_name.2eb427bac7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."products_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:18:04.658612 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.224 seconds
[0m07:18:04.660040 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_created_at.f661bb341b: ROLLBACK
[0m07:18:04.746690 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560: Close
[0m07:18:04.747747 [info ] [Thread-1 (]: 52 of 114 PASS not_null_products_silver_brand_id ............................... [[32mPASS[0m in 3.69s]
[0m07:18:04.748462 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560
[0m07:18:04.748920 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_products_silver_price.1d7617dbc8
[0m07:18:04.749427 [info ] [Thread-1 (]: 56 of 114 START test not_null_products_silver_price ............................ [RUN]
[0m07:18:04.749940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_brand_id.e24a5ce560, now test.retail_dbt.not_null_products_silver_price.1d7617dbc8)
[0m07:18:04.750370 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_products_silver_price.1d7617dbc8
[0m07:18:04.754087 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_price.1d7617dbc8"
[0m07:18:04.754580 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_products_silver_price.1d7617dbc8
[0m07:18:04.756480 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_price.1d7617dbc8"
[0m07:18:04.757002 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_price.1d7617dbc8"
[0m07:18:04.757325 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_price.1d7617dbc8: BEGIN
[0m07:18:04.757609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:04.769734 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:18:04.771202 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_name.2eb427bac7: ROLLBACK
[0m07:18:04.884633 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_created_at.f661bb341b: Close
[0m07:18:04.885369 [info ] [Thread-4 (]: 54 of 114 PASS not_null_products_silver_created_at ............................. [[32mPASS[0m in 3.54s]
[0m07:18:04.885875 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_products_silver_created_at.f661bb341b
[0m07:18:04.886223 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d
[0m07:18:04.886620 [info ] [Thread-4 (]: 57 of 114 START test not_null_products_silver_product_id ....................... [RUN]
[0m07:18:04.887135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_created_at.f661bb341b, now test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d)
[0m07:18:04.887503 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d
[0m07:18:04.892391 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d"
[0m07:18:04.892957 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d
[0m07:18:04.894660 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d"
[0m07:18:04.895244 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d"
[0m07:18:04.896074 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d: BEGIN
[0m07:18:04.896381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:04.978686 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_category_id.2a4206bc12: Close
[0m07:18:04.979545 [info ] [Thread-3 (]: 53 of 114 PASS not_null_products_silver_category_id ............................ [[32mPASS[0m in 3.86s]
[0m07:18:04.980297 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_products_silver_category_id.2a4206bc12
[0m07:18:04.980759 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_products_silver_season.93161b0991
[0m07:18:04.981238 [info ] [Thread-3 (]: 58 of 114 START test not_null_products_silver_season ........................... [RUN]
[0m07:18:04.981719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_category_id.2a4206bc12, now test.retail_dbt.not_null_products_silver_season.93161b0991)
[0m07:18:04.982072 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_products_silver_season.93161b0991
[0m07:18:04.985596 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_season.93161b0991"
[0m07:18:04.986100 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_products_silver_season.93161b0991
[0m07:18:04.988125 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_season.93161b0991"
[0m07:18:04.988600 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_season.93161b0991"
[0m07:18:04.988885 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_season.93161b0991: BEGIN
[0m07:18:04.989199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:05.043331 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_name.2eb427bac7: Close
[0m07:18:05.044185 [info ] [Thread-2 (]: 55 of 114 PASS not_null_products_silver_name ................................... [[32mPASS[0m in 3.27s]
[0m07:18:05.044851 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_products_silver_name.2eb427bac7
[0m07:18:05.045305 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6
[0m07:18:05.045751 [info ] [Thread-2 (]: 59 of 114 START test not_null_products_silver_supplier_id ...................... [RUN]
[0m07:18:05.046231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_name.2eb427bac7, now test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6)
[0m07:18:05.046586 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6
[0m07:18:05.050131 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6"
[0m07:18:05.050719 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6
[0m07:18:05.052786 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6"
[0m07:18:05.053277 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6"
[0m07:18:05.053631 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6: BEGIN
[0m07:18:05.053975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:06.934265 [debug] [Thread-4 (]: SQL status: BEGIN in 2.038 seconds
[0m07:18:06.934825 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d"
[0m07:18:06.935372 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."products_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:07.092115 [debug] [Thread-3 (]: SQL status: BEGIN in 2.103 seconds
[0m07:18:07.092575 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_season.93161b0991"
[0m07:18:07.092899 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_season.93161b0991: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_season.93161b0991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "postgres"."silver"."products_silver"
where season is null



  
  
      
    ) dbt_internal_test
[0m07:18:07.157221 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.221 seconds
[0m07:18:07.158497 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d: ROLLBACK
[0m07:18:07.196858 [debug] [Thread-1 (]: SQL status: BEGIN in 2.439 seconds
[0m07:18:07.197211 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_price.1d7617dbc8"
[0m07:18:07.197571 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_price.1d7617dbc8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_price.1d7617dbc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "postgres"."silver"."products_silver"
where price is null



  
  
      
    ) dbt_internal_test
[0m07:18:07.325045 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.232 seconds
[0m07:18:07.326385 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_season.93161b0991: ROLLBACK
[0m07:18:07.376746 [debug] [Thread-4 (]: On test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d: Close
[0m07:18:07.377525 [info ] [Thread-4 (]: 57 of 114 PASS not_null_products_silver_product_id ............................. [[32mPASS[0m in 2.49s]
[0m07:18:07.378041 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d
[0m07:18:07.378403 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8
[0m07:18:07.378818 [info ] [Thread-4 (]: 60 of 114 START test not_null_promotions_silver_end_date ....................... [RUN]
[0m07:18:07.379261 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_product_id.ac9520ee8d, now test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8)
[0m07:18:07.379571 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8
[0m07:18:07.382764 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8"
[0m07:18:07.383257 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8
[0m07:18:07.385968 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8"
[0m07:18:07.386448 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8"
[0m07:18:07.386765 [debug] [Thread-4 (]: On test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8: BEGIN
[0m07:18:07.387127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:07.423136 [debug] [Thread-2 (]: SQL status: BEGIN in 2.369 seconds
[0m07:18:07.423562 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6"
[0m07:18:07.423902 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver"."products_silver"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:07.454675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.257 seconds
[0m07:18:07.455972 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_price.1d7617dbc8: ROLLBACK
[0m07:18:07.568413 [debug] [Thread-3 (]: On test.retail_dbt.not_null_products_silver_season.93161b0991: Close
[0m07:18:07.569138 [info ] [Thread-3 (]: 58 of 114 PASS not_null_products_silver_season ................................. [[32mPASS[0m in 2.59s]
[0m07:18:07.569641 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_products_silver_season.93161b0991
[0m07:18:07.569993 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_promotions_silver_name.6337430c9c
[0m07:18:07.570399 [info ] [Thread-3 (]: 61 of 114 START test not_null_promotions_silver_name ........................... [RUN]
[0m07:18:07.570794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_season.93161b0991, now test.retail_dbt.not_null_promotions_silver_name.6337430c9c)
[0m07:18:07.571224 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_promotions_silver_name.6337430c9c
[0m07:18:07.574470 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_promotions_silver_name.6337430c9c"
[0m07:18:07.574982 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_promotions_silver_name.6337430c9c
[0m07:18:07.576766 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_promotions_silver_name.6337430c9c"
[0m07:18:07.577251 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_name.6337430c9c"
[0m07:18:07.577557 [debug] [Thread-3 (]: On test.retail_dbt.not_null_promotions_silver_name.6337430c9c: BEGIN
[0m07:18:07.577868 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:07.643709 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.219 seconds
[0m07:18:07.645066 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6: ROLLBACK
[0m07:18:07.709076 [debug] [Thread-1 (]: On test.retail_dbt.not_null_products_silver_price.1d7617dbc8: Close
[0m07:18:07.709815 [info ] [Thread-1 (]: 56 of 114 PASS not_null_products_silver_price .................................. [[32mPASS[0m in 2.96s]
[0m07:18:07.710363 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_products_silver_price.1d7617dbc8
[0m07:18:07.710771 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60
[0m07:18:07.711216 [info ] [Thread-1 (]: 62 of 114 START test not_null_promotions_silver_promotion_id ................... [RUN]
[0m07:18:07.711628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_price.1d7617dbc8, now test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60)
[0m07:18:07.711930 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60
[0m07:18:07.715391 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60"
[0m07:18:07.715873 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60
[0m07:18:07.717692 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60"
[0m07:18:07.718172 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60"
[0m07:18:07.718476 [debug] [Thread-1 (]: On test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60: BEGIN
[0m07:18:07.718798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:07.870992 [debug] [Thread-2 (]: On test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6: Close
[0m07:18:07.871770 [info ] [Thread-2 (]: 59 of 114 PASS not_null_products_silver_supplier_id ............................ [[32mPASS[0m in 2.83s]
[0m07:18:07.872282 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6
[0m07:18:07.872629 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43
[0m07:18:07.873029 [info ] [Thread-2 (]: 63 of 114 START test not_null_promotions_silver_start_date ..................... [RUN]
[0m07:18:07.873434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_products_silver_supplier_id.f8bf6dd3c6, now test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43)
[0m07:18:07.873855 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43
[0m07:18:07.877257 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43"
[0m07:18:07.877751 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43
[0m07:18:07.879744 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43"
[0m07:18:07.880226 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43"
[0m07:18:07.880573 [debug] [Thread-2 (]: On test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43: BEGIN
[0m07:18:07.880848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:11.759667 [debug] [Thread-4 (]: SQL status: BEGIN in 2.572 seconds
[0m07:18:11.760179 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8"
[0m07:18:11.760529 [debug] [Thread-4 (]: On test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "postgres"."silver"."promotions_silver"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:11.944141 [debug] [Thread-3 (]: SQL status: BEGIN in 2.566 seconds
[0m07:18:11.944587 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_name.6337430c9c"
[0m07:18:11.944957 [debug] [Thread-3 (]: On test.retail_dbt.not_null_promotions_silver_name.6337430c9c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_promotions_silver_name.6337430c9c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."promotions_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:18:12.088237 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.327 seconds
[0m07:18:12.088669 [debug] [Thread-1 (]: SQL status: BEGIN in 2.570 seconds
[0m07:18:12.090154 [debug] [Thread-4 (]: On test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8: ROLLBACK
[0m07:18:12.090574 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60"
[0m07:18:12.091016 [debug] [Thread-1 (]: On test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select promotion_id
from "postgres"."silver"."promotions_silver"
where promotion_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:12.374441 [debug] [Thread-2 (]: SQL status: BEGIN in 2.693 seconds
[0m07:18:12.374979 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43"
[0m07:18:12.375337 [debug] [Thread-2 (]: On test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "postgres"."silver"."promotions_silver"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:12.389849 [debug] [Thread-4 (]: On test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8: Close
[0m07:18:12.390758 [info ] [Thread-4 (]: 60 of 114 PASS not_null_promotions_silver_end_date ............................. [[32mPASS[0m in 5.01s]
[0m07:18:12.391421 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8
[0m07:18:12.391881 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d
[0m07:18:12.392394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.301 seconds
[0m07:18:12.392790 [info ] [Thread-4 (]: 64 of 114 START test not_null_purchase_orders_silver_order_date ................ [RUN]
[0m07:18:12.394163 [debug] [Thread-1 (]: On test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60: ROLLBACK
[0m07:18:12.394687 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_promotions_silver_end_date.a8843536c8, now test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d)
[0m07:18:12.395277 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d
[0m07:18:12.400078 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d"
[0m07:18:12.400649 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d
[0m07:18:12.402465 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d"
[0m07:18:12.402991 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d"
[0m07:18:12.403332 [debug] [Thread-4 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d: BEGIN
[0m07:18:12.403703 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:12.661013 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.285 seconds
[0m07:18:12.662414 [debug] [Thread-2 (]: On test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43: ROLLBACK
[0m07:18:12.700453 [debug] [Thread-1 (]: On test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60: Close
[0m07:18:12.701535 [info ] [Thread-1 (]: 62 of 114 PASS not_null_promotions_silver_promotion_id ......................... [[32mPASS[0m in 4.99s]
[0m07:18:12.702163 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60
[0m07:18:12.702576 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034
[0m07:18:12.702994 [info ] [Thread-1 (]: 65 of 114 START test not_null_purchase_orders_silver_order_id .................. [RUN]
[0m07:18:12.703490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_promotions_silver_promotion_id.b988028c60, now test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034)
[0m07:18:12.703818 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034
[0m07:18:12.707361 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034"
[0m07:18:12.707933 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034
[0m07:18:12.709881 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034"
[0m07:18:12.710399 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034"
[0m07:18:12.710734 [debug] [Thread-1 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034: BEGIN
[0m07:18:12.711035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:12.783163 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.838 seconds
[0m07:18:12.784761 [debug] [Thread-3 (]: On test.retail_dbt.not_null_promotions_silver_name.6337430c9c: ROLLBACK
[0m07:18:12.948872 [debug] [Thread-2 (]: On test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43: Close
[0m07:18:12.949756 [info ] [Thread-2 (]: 63 of 114 PASS not_null_promotions_silver_start_date ........................... [[32mPASS[0m in 5.08s]
[0m07:18:12.950369 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43
[0m07:18:12.950790 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943
[0m07:18:12.951210 [info ] [Thread-2 (]: 66 of 114 START test not_null_purchase_orders_silver_status .................... [RUN]
[0m07:18:12.951710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_promotions_silver_start_date.9d08c0ea43, now test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943)
[0m07:18:12.952048 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943
[0m07:18:12.955669 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943"
[0m07:18:12.956165 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943
[0m07:18:12.958130 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943"
[0m07:18:12.958655 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943"
[0m07:18:12.958964 [debug] [Thread-2 (]: On test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943: BEGIN
[0m07:18:12.959301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:13.242424 [debug] [Thread-3 (]: On test.retail_dbt.not_null_promotions_silver_name.6337430c9c: Close
[0m07:18:13.243426 [info ] [Thread-3 (]: 61 of 114 PASS not_null_promotions_silver_name ................................. [[32mPASS[0m in 5.67s]
[0m07:18:13.244047 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_promotions_silver_name.6337430c9c
[0m07:18:13.244459 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5
[0m07:18:13.244910 [info ] [Thread-3 (]: 67 of 114 START test not_null_purchase_orders_silver_supplier_id ............... [RUN]
[0m07:18:13.245505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_promotions_silver_name.6337430c9c, now test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5)
[0m07:18:13.245828 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5
[0m07:18:13.249317 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5"
[0m07:18:13.249876 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5
[0m07:18:13.251910 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5"
[0m07:18:13.252447 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5"
[0m07:18:13.252757 [debug] [Thread-3 (]: On test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5: BEGIN
[0m07:18:13.253077 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:14.908475 [debug] [Thread-1 (]: SQL status: BEGIN in 2.197 seconds
[0m07:18:14.909007 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034"
[0m07:18:14.909340 [debug] [Thread-1 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "postgres"."silver"."purchase_orders_silver"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:14.958080 [debug] [Thread-4 (]: SQL status: BEGIN in 2.554 seconds
[0m07:18:14.958566 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d"
[0m07:18:14.958882 [debug] [Thread-4 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "postgres"."silver"."purchase_orders_silver"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:15.131228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.222 seconds
[0m07:18:15.132443 [debug] [Thread-1 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034: ROLLBACK
[0m07:18:15.187080 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.228 seconds
[0m07:18:15.188496 [debug] [Thread-4 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d: ROLLBACK
[0m07:18:15.354114 [debug] [Thread-1 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034: Close
[0m07:18:15.354920 [info ] [Thread-1 (]: 65 of 114 PASS not_null_purchase_orders_silver_order_id ........................ [[32mPASS[0m in 2.65s]
[0m07:18:15.355488 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034
[0m07:18:15.355845 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_returns_silver_item_id.c11f187f38
[0m07:18:15.356257 [info ] [Thread-1 (]: 68 of 114 START test not_null_returns_silver_item_id ........................... [RUN]
[0m07:18:15.356740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_purchase_orders_silver_order_id.465030e034, now test.retail_dbt.not_null_returns_silver_item_id.c11f187f38)
[0m07:18:15.357046 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_returns_silver_item_id.c11f187f38
[0m07:18:15.361960 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_returns_silver_item_id.c11f187f38"
[0m07:18:15.362475 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_returns_silver_item_id.c11f187f38
[0m07:18:15.364287 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_returns_silver_item_id.c11f187f38"
[0m07:18:15.364803 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_item_id.c11f187f38"
[0m07:18:15.365101 [debug] [Thread-1 (]: On test.retail_dbt.not_null_returns_silver_item_id.c11f187f38: BEGIN
[0m07:18:15.365397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:15.418658 [debug] [Thread-4 (]: On test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d: Close
[0m07:18:15.419525 [info ] [Thread-4 (]: 64 of 114 PASS not_null_purchase_orders_silver_order_date ...................... [[32mPASS[0m in 3.02s]
[0m07:18:15.420235 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d
[0m07:18:15.420608 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_returns_silver_reason.4566784310
[0m07:18:15.421052 [info ] [Thread-4 (]: 69 of 114 START test not_null_returns_silver_reason ............................ [RUN]
[0m07:18:15.421666 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_purchase_orders_silver_order_date.763925638d, now test.retail_dbt.not_null_returns_silver_reason.4566784310)
[0m07:18:15.422162 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_returns_silver_reason.4566784310
[0m07:18:15.425543 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_returns_silver_reason.4566784310"
[0m07:18:15.426137 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_returns_silver_reason.4566784310
[0m07:18:15.428198 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_returns_silver_reason.4566784310"
[0m07:18:15.428717 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_reason.4566784310"
[0m07:18:15.429031 [debug] [Thread-4 (]: On test.retail_dbt.not_null_returns_silver_reason.4566784310: BEGIN
[0m07:18:15.429302 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:15.464697 [debug] [Thread-2 (]: SQL status: BEGIN in 2.505 seconds
[0m07:18:15.465199 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943"
[0m07:18:15.465632 [debug] [Thread-2 (]: On test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "postgres"."silver"."purchase_orders_silver"
where status is null



  
  
      
    ) dbt_internal_test
[0m07:18:15.723294 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.257 seconds
[0m07:18:15.724593 [debug] [Thread-2 (]: On test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943: ROLLBACK
[0m07:18:16.035556 [debug] [Thread-2 (]: On test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943: Close
[0m07:18:16.036394 [info ] [Thread-2 (]: 66 of 114 PASS not_null_purchase_orders_silver_status .......................... [[32mPASS[0m in 3.08s]
[0m07:18:16.037003 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943
[0m07:18:16.037409 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5
[0m07:18:16.037878 [info ] [Thread-2 (]: 70 of 114 START test not_null_returns_silver_return_date ....................... [RUN]
[0m07:18:16.038403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_purchase_orders_silver_status.c17b884943, now test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5)
[0m07:18:16.038806 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5
[0m07:18:16.042264 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5"
[0m07:18:16.042770 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5
[0m07:18:16.044928 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5"
[0m07:18:16.045540 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5"
[0m07:18:16.045841 [debug] [Thread-2 (]: On test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5: BEGIN
[0m07:18:16.046181 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:16.344222 [debug] [Thread-3 (]: SQL status: BEGIN in 3.091 seconds
[0m07:18:16.344817 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5"
[0m07:18:16.345352 [debug] [Thread-3 (]: On test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver"."purchase_orders_silver"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:16.651425 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.305 seconds
[0m07:18:16.652740 [debug] [Thread-3 (]: On test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5: ROLLBACK
[0m07:18:16.883630 [debug] [Thread-3 (]: On test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5: Close
[0m07:18:16.884385 [info ] [Thread-3 (]: 67 of 114 PASS not_null_purchase_orders_silver_supplier_id ..................... [[32mPASS[0m in 3.64s]
[0m07:18:16.884921 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5
[0m07:18:16.885301 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2
[0m07:18:16.885697 [info ] [Thread-3 (]: 71 of 114 START test not_null_returns_silver_return_id ......................... [RUN]
[0m07:18:16.886059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_purchase_orders_silver_supplier_id.ec936eb5b5, now test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2)
[0m07:18:16.886390 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2
[0m07:18:16.889508 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2"
[0m07:18:16.890011 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2
[0m07:18:16.892642 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2"
[0m07:18:16.893123 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2"
[0m07:18:16.893429 [debug] [Thread-3 (]: On test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2: BEGIN
[0m07:18:16.893704 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:17.802055 [debug] [Thread-4 (]: SQL status: BEGIN in 2.373 seconds
[0m07:18:17.802645 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_reason.4566784310"
[0m07:18:17.803079 [debug] [Thread-4 (]: On test.retail_dbt.not_null_returns_silver_reason.4566784310: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_returns_silver_reason.4566784310"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reason
from "postgres"."silver"."returns_silver"
where reason is null



  
  
      
    ) dbt_internal_test
[0m07:18:18.085059 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.281 seconds
[0m07:18:18.085674 [debug] [Thread-1 (]: SQL status: BEGIN in 2.720 seconds
[0m07:18:18.087020 [debug] [Thread-4 (]: On test.retail_dbt.not_null_returns_silver_reason.4566784310: ROLLBACK
[0m07:18:18.087468 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_item_id.c11f187f38"
[0m07:18:18.087974 [debug] [Thread-1 (]: On test.retail_dbt.not_null_returns_silver_item_id.c11f187f38: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_returns_silver_item_id.c11f187f38"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "postgres"."silver"."returns_silver"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:18.386551 [debug] [Thread-4 (]: On test.retail_dbt.not_null_returns_silver_reason.4566784310: Close
[0m07:18:18.387436 [info ] [Thread-4 (]: 69 of 114 PASS not_null_returns_silver_reason .................................. [[32mPASS[0m in 2.97s]
[0m07:18:18.387931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.299 seconds
[0m07:18:18.388444 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_returns_silver_reason.4566784310
[0m07:18:18.389756 [debug] [Thread-1 (]: On test.retail_dbt.not_null_returns_silver_item_id.c11f187f38: ROLLBACK
[0m07:18:18.390213 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a
[0m07:18:18.390763 [info ] [Thread-4 (]: 72 of 114 START test not_null_sales_items_silver_business_validation_flag ...... [RUN]
[0m07:18:18.391276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_returns_silver_reason.4566784310, now test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a)
[0m07:18:18.391709 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a
[0m07:18:18.394904 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a"
[0m07:18:18.395457 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a
[0m07:18:18.397174 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a"
[0m07:18:18.397659 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a"
[0m07:18:18.397977 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a: BEGIN
[0m07:18:18.398246 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:18.536649 [debug] [Thread-2 (]: SQL status: BEGIN in 2.490 seconds
[0m07:18:18.537192 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5"
[0m07:18:18.537590 [debug] [Thread-2 (]: On test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_date
from "postgres"."silver"."returns_silver"
where return_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:18.685023 [debug] [Thread-1 (]: On test.retail_dbt.not_null_returns_silver_item_id.c11f187f38: Close
[0m07:18:18.685917 [info ] [Thread-1 (]: 68 of 114 PASS not_null_returns_silver_item_id ................................. [[32mPASS[0m in 3.33s]
[0m07:18:18.686689 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_returns_silver_item_id.c11f187f38
[0m07:18:18.687183 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed
[0m07:18:18.687765 [info ] [Thread-1 (]: 73 of 114 START test not_null_sales_items_silver_discount ...................... [RUN]
[0m07:18:18.688289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_returns_silver_item_id.c11f187f38, now test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed)
[0m07:18:18.688680 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed
[0m07:18:18.692434 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed"
[0m07:18:18.692982 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed
[0m07:18:18.695063 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed"
[0m07:18:18.695694 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed"
[0m07:18:18.696005 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed: BEGIN
[0m07:18:18.696279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:18.767666 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.230 seconds
[0m07:18:18.769004 [debug] [Thread-2 (]: On test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5: ROLLBACK
[0m07:18:18.999496 [debug] [Thread-2 (]: On test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5: Close
[0m07:18:19.000444 [info ] [Thread-2 (]: 70 of 114 PASS not_null_returns_silver_return_date ............................. [[32mPASS[0m in 2.96s]
[0m07:18:19.000983 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5
[0m07:18:19.001343 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d
[0m07:18:19.001736 [info ] [Thread-2 (]: 74 of 114 START test not_null_sales_items_silver_gross_amount .................. [RUN]
[0m07:18:19.002124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_returns_silver_return_date.d4c90371c5, now test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d)
[0m07:18:19.002418 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d
[0m07:18:19.005451 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d"
[0m07:18:19.005920 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d
[0m07:18:19.007711 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d"
[0m07:18:19.008194 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d"
[0m07:18:19.008481 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d: BEGIN
[0m07:18:19.008775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:19.431016 [debug] [Thread-3 (]: SQL status: BEGIN in 2.537 seconds
[0m07:18:19.431616 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2"
[0m07:18:19.432134 [debug] [Thread-3 (]: On test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_id
from "postgres"."silver"."returns_silver"
where return_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:19.678015 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:18:19.679660 [debug] [Thread-3 (]: On test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2: ROLLBACK
[0m07:18:19.972423 [debug] [Thread-3 (]: On test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2: Close
[0m07:18:19.973415 [info ] [Thread-3 (]: 71 of 114 PASS not_null_returns_silver_return_id ............................... [[32mPASS[0m in 3.09s]
[0m07:18:19.974217 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2
[0m07:18:19.974690 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955
[0m07:18:19.975144 [info ] [Thread-3 (]: 75 of 114 START test not_null_sales_items_silver_item_id ....................... [RUN]
[0m07:18:19.975709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_returns_silver_return_id.5102a4a0a2, now test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955)
[0m07:18:19.976082 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955
[0m07:18:19.981178 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955"
[0m07:18:19.981644 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955
[0m07:18:19.983307 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955"
[0m07:18:19.983831 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955"
[0m07:18:19.984122 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955: BEGIN
[0m07:18:19.984412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:21.041934 [debug] [Thread-4 (]: SQL status: BEGIN in 2.644 seconds
[0m07:18:21.042499 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a"
[0m07:18:21.042932 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business_validation_flag
from "postgres"."silver"."sales_items_silver"
where business_validation_flag is null



  
  
      
    ) dbt_internal_test
[0m07:18:21.376363 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.333 seconds
[0m07:18:21.377860 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a: ROLLBACK
[0m07:18:21.629085 [debug] [Thread-2 (]: SQL status: BEGIN in 2.620 seconds
[0m07:18:21.629653 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d"
[0m07:18:21.630137 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gross_amount
from "postgres"."silver"."sales_items_silver"
where gross_amount is null



  
  
      
    ) dbt_internal_test
[0m07:18:21.649712 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a: Close
[0m07:18:21.650624 [info ] [Thread-4 (]: 72 of 114 PASS not_null_sales_items_silver_business_validation_flag ............ [[32mPASS[0m in 3.26s]
[0m07:18:21.651284 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a
[0m07:18:21.651824 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730
[0m07:18:21.652365 [info ] [Thread-4 (]: 76 of 114 START test not_null_sales_items_silver_net_amount .................... [RUN]
[0m07:18:21.652977 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_business_validation_flag.fc94ea645a, now test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730)
[0m07:18:21.653384 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730
[0m07:18:21.656997 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730"
[0m07:18:21.657538 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730
[0m07:18:21.659512 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730"
[0m07:18:21.660056 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730"
[0m07:18:21.660399 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730: BEGIN
[0m07:18:21.660703 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:21.898645 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.268 seconds
[0m07:18:21.900502 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d: ROLLBACK
[0m07:18:22.148871 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d: Close
[0m07:18:22.149514 [debug] [Thread-1 (]: SQL status: BEGIN in 3.453 seconds
[0m07:18:22.150063 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed"
[0m07:18:22.150719 [info ] [Thread-2 (]: 74 of 114 PASS not_null_sales_items_silver_gross_amount ........................ [[32mPASS[0m in 3.15s]
[0m07:18:22.151272 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select discount
from "postgres"."silver"."sales_items_silver"
where discount is null



  
  
      
    ) dbt_internal_test
[0m07:18:22.152004 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d
[0m07:18:22.152729 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c
[0m07:18:22.153274 [info ] [Thread-2 (]: 77 of 114 START test not_null_sales_items_silver_product_id .................... [RUN]
[0m07:18:22.153820 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_gross_amount.a4eef2ff4d, now test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c)
[0m07:18:22.154291 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c
[0m07:18:22.158317 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c"
[0m07:18:22.158915 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c
[0m07:18:22.161266 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c"
[0m07:18:22.161901 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c"
[0m07:18:22.162250 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c: BEGIN
[0m07:18:22.162598 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:22.416361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:18:22.417622 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed: ROLLBACK
[0m07:18:22.650415 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed: Close
[0m07:18:22.651304 [info ] [Thread-1 (]: 73 of 114 PASS not_null_sales_items_silver_discount ............................ [[32mPASS[0m in 3.96s]
[0m07:18:22.652123 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed
[0m07:18:22.652607 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd
[0m07:18:22.653016 [info ] [Thread-1 (]: 78 of 114 START test not_null_sales_items_silver_quantity ...................... [RUN]
[0m07:18:22.653424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_discount.7062a6a5ed, now test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd)
[0m07:18:22.653717 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd
[0m07:18:22.656983 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd"
[0m07:18:22.657470 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd
[0m07:18:22.659143 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd"
[0m07:18:22.659819 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd"
[0m07:18:22.660181 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd: BEGIN
[0m07:18:22.660456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:22.908636 [debug] [Thread-3 (]: SQL status: BEGIN in 2.924 seconds
[0m07:18:22.909368 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955"
[0m07:18:22.909781 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "postgres"."silver"."sales_items_silver"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:23.169051 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.259 seconds
[0m07:18:23.170551 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955: ROLLBACK
[0m07:18:23.423402 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955: Close
[0m07:18:23.424244 [info ] [Thread-3 (]: 75 of 114 PASS not_null_sales_items_silver_item_id ............................. [[32mPASS[0m in 3.45s]
[0m07:18:23.424816 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955
[0m07:18:23.425198 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588
[0m07:18:23.425600 [info ] [Thread-3 (]: 79 of 114 START test not_null_sales_items_silver_tax ........................... [RUN]
[0m07:18:23.426052 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_item_id.db1727c955, now test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588)
[0m07:18:23.426359 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588
[0m07:18:23.430615 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588"
[0m07:18:23.431141 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588
[0m07:18:23.432808 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588"
[0m07:18:23.433275 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588"
[0m07:18:23.433562 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588: BEGIN
[0m07:18:23.433864 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:24.444106 [debug] [Thread-2 (]: SQL status: BEGIN in 2.281 seconds
[0m07:18:24.444572 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c"
[0m07:18:24.444936 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."sales_items_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:24.700568 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.255 seconds
[0m07:18:24.702136 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c: ROLLBACK
[0m07:18:24.751737 [debug] [Thread-4 (]: SQL status: BEGIN in 3.091 seconds
[0m07:18:24.752249 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730"
[0m07:18:24.752586 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select net_amount
from "postgres"."silver"."sales_items_silver"
where net_amount is null



  
  
      
    ) dbt_internal_test
[0m07:18:24.937675 [debug] [Thread-1 (]: SQL status: BEGIN in 2.277 seconds
[0m07:18:24.938111 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd"
[0m07:18:24.938415 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver"."sales_items_silver"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m07:18:24.950881 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c: Close
[0m07:18:24.951723 [info ] [Thread-2 (]: 77 of 114 PASS not_null_sales_items_silver_product_id .......................... [[32mPASS[0m in 2.80s]
[0m07:18:24.952242 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c
[0m07:18:24.952606 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46
[0m07:18:24.952962 [info ] [Thread-2 (]: 80 of 114 START test not_null_sales_items_silver_transaction_id ................ [RUN]
[0m07:18:24.953353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_product_id.d90d226a0c, now test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46)
[0m07:18:24.953721 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46
[0m07:18:24.956756 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46"
[0m07:18:24.957243 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46
[0m07:18:24.958970 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46"
[0m07:18:24.959451 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46"
[0m07:18:24.959737 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46: BEGIN
[0m07:18:24.960055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:25.019532 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.267 seconds
[0m07:18:25.020853 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730: ROLLBACK
[0m07:18:25.197282 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.258 seconds
[0m07:18:25.198537 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd: ROLLBACK
[0m07:18:25.278667 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730: Close
[0m07:18:25.279587 [info ] [Thread-4 (]: 76 of 114 PASS not_null_sales_items_silver_net_amount .......................... [[32mPASS[0m in 3.63s]
[0m07:18:25.280301 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730
[0m07:18:25.280772 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b
[0m07:18:25.281428 [info ] [Thread-4 (]: 81 of 114 START test not_null_sales_items_silver_unit_price .................... [RUN]
[0m07:18:25.282032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_net_amount.afde194730, now test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b)
[0m07:18:25.282395 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b
[0m07:18:25.285724 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b"
[0m07:18:25.286218 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b
[0m07:18:25.287925 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b"
[0m07:18:25.288410 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b"
[0m07:18:25.288728 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b: BEGIN
[0m07:18:25.288995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:25.452566 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd: Close
[0m07:18:25.453373 [info ] [Thread-1 (]: 78 of 114 PASS not_null_sales_items_silver_quantity ............................ [[32mPASS[0m in 2.80s]
[0m07:18:25.453924 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd
[0m07:18:25.454324 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371
[0m07:18:25.454703 [info ] [Thread-1 (]: 82 of 114 START test not_null_sales_transactions_silver_customer_id ............ [RUN]
[0m07:18:25.455093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_quantity.541fc853cd, now test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371)
[0m07:18:25.455468 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371
[0m07:18:25.458509 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371"
[0m07:18:25.458997 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371
[0m07:18:25.459395 [debug] [Thread-3 (]: SQL status: BEGIN in 2.025 seconds
[0m07:18:25.462138 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371"
[0m07:18:25.462583 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588"
[0m07:18:25.463121 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax
from "postgres"."silver"."sales_items_silver"
where tax is null



  
  
      
    ) dbt_internal_test
[0m07:18:25.463656 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371"
[0m07:18:25.463972 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371: BEGIN
[0m07:18:25.464251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:25.693822 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.230 seconds
[0m07:18:25.695242 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588: ROLLBACK
[0m07:18:25.919932 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588: Close
[0m07:18:25.920749 [info ] [Thread-3 (]: 79 of 114 PASS not_null_sales_items_silver_tax ................................. [[32mPASS[0m in 2.49s]
[0m07:18:25.921306 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588
[0m07:18:25.921730 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad
[0m07:18:25.922142 [info ] [Thread-3 (]: 83 of 114 START test not_null_sales_transactions_silver_employee_id ............ [RUN]
[0m07:18:25.922585 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_tax.d8eacf8588, now test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad)
[0m07:18:25.922912 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad
[0m07:18:25.926226 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad"
[0m07:18:25.926882 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad
[0m07:18:25.929012 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad"
[0m07:18:25.929588 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad"
[0m07:18:25.930017 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad: BEGIN
[0m07:18:25.930410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:27.243652 [debug] [Thread-2 (]: SQL status: BEGIN in 2.283 seconds
[0m07:18:27.244092 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46"
[0m07:18:27.244399 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "postgres"."silver"."sales_items_silver"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:27.288884 [debug] [Thread-4 (]: SQL status: BEGIN in 2.000 seconds
[0m07:18:27.289274 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b"
[0m07:18:27.289633 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from "postgres"."silver"."sales_items_silver"
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m07:18:27.504083 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.259 seconds
[0m07:18:27.505438 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46: ROLLBACK
[0m07:18:27.516182 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:18:27.517542 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b: ROLLBACK
[0m07:18:27.748861 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b: Close
[0m07:18:27.749827 [info ] [Thread-4 (]: 81 of 114 PASS not_null_sales_items_silver_unit_price .......................... [[32mPASS[0m in 2.47s]
[0m07:18:27.750390 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b
[0m07:18:27.750816 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706
[0m07:18:27.751207 [info ] [Thread-4 (]: 84 of 114 START test not_null_sales_transactions_silver_payment_id ............. [RUN]
[0m07:18:27.751826 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_unit_price.83bc8f6f4b, now test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706)
[0m07:18:27.752164 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706
[0m07:18:27.756055 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706"
[0m07:18:27.756589 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706
[0m07:18:27.758558 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706"
[0m07:18:27.759121 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706"
[0m07:18:27.759450 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706: BEGIN
[0m07:18:27.759787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:27.764452 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46: Close
[0m07:18:27.765122 [info ] [Thread-2 (]: 80 of 114 PASS not_null_sales_items_silver_transaction_id ...................... [[32mPASS[0m in 2.81s]
[0m07:18:27.765650 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46
[0m07:18:27.766025 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0
[0m07:18:27.766403 [info ] [Thread-2 (]: 85 of 114 START test not_null_sales_transactions_silver_store_id ............... [RUN]
[0m07:18:27.766833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_items_silver_transaction_id.47979a6b46, now test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0)
[0m07:18:27.767210 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0
[0m07:18:27.770278 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0"
[0m07:18:27.770782 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0
[0m07:18:27.772526 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0"
[0m07:18:27.773032 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0"
[0m07:18:27.773361 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0: BEGIN
[0m07:18:27.773663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:28.033021 [debug] [Thread-1 (]: SQL status: BEGIN in 2.569 seconds
[0m07:18:28.033471 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371"
[0m07:18:28.033831 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver"."sales_transactions_silver"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:28.340028 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.306 seconds
[0m07:18:28.341468 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371: ROLLBACK
[0m07:18:28.505579 [debug] [Thread-3 (]: SQL status: BEGIN in 2.575 seconds
[0m07:18:28.506051 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad"
[0m07:18:28.506407 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from "postgres"."silver"."sales_transactions_silver"
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:28.641819 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371: Close
[0m07:18:28.642726 [info ] [Thread-1 (]: 82 of 114 PASS not_null_sales_transactions_silver_customer_id .................. [[32mPASS[0m in 3.19s]
[0m07:18:28.643306 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371
[0m07:18:28.643730 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f
[0m07:18:28.644182 [info ] [Thread-1 (]: 86 of 114 START test not_null_sales_transactions_silver_total_amount ........... [RUN]
[0m07:18:28.644608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_customer_id.0cba059371, now test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f)
[0m07:18:28.644942 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f
[0m07:18:28.649124 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f"
[0m07:18:28.649656 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f
[0m07:18:28.651542 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f"
[0m07:18:28.652079 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f"
[0m07:18:28.652392 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f: BEGIN
[0m07:18:28.652732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:28.797644 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.291 seconds
[0m07:18:28.798961 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad: ROLLBACK
[0m07:18:29.084557 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad: Close
[0m07:18:29.085524 [info ] [Thread-3 (]: 83 of 114 PASS not_null_sales_transactions_silver_employee_id .................. [[32mPASS[0m in 3.16s]
[0m07:18:29.086079 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad
[0m07:18:29.086496 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7
[0m07:18:29.086947 [info ] [Thread-3 (]: 87 of 114 START test not_null_sales_transactions_silver_transaction_date ....... [RUN]
[0m07:18:29.087409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_employee_id.088a404cad, now test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7)
[0m07:18:29.087765 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7
[0m07:18:29.091322 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7"
[0m07:18:29.091891 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7
[0m07:18:29.093766 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7"
[0m07:18:29.094295 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7"
[0m07:18:29.094650 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7: BEGIN
[0m07:18:29.094984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:29.911227 [debug] [Thread-4 (]: SQL status: BEGIN in 2.151 seconds
[0m07:18:29.911818 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706"
[0m07:18:29.912195 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "postgres"."silver"."sales_transactions_silver"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:30.152030 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.239 seconds
[0m07:18:30.153403 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706: ROLLBACK
[0m07:18:30.314672 [debug] [Thread-2 (]: SQL status: BEGIN in 2.541 seconds
[0m07:18:30.315185 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0"
[0m07:18:30.315591 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."sales_transactions_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:30.378419 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706: Close
[0m07:18:30.379213 [info ] [Thread-4 (]: 84 of 114 PASS not_null_sales_transactions_silver_payment_id ................... [[32mPASS[0m in 2.63s]
[0m07:18:30.379809 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706
[0m07:18:30.380198 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b
[0m07:18:30.380624 [info ] [Thread-4 (]: 88 of 114 START test not_null_sales_transactions_silver_transaction_id ......... [RUN]
[0m07:18:30.381036 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_payment_id.020fe22706, now test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b)
[0m07:18:30.381335 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b
[0m07:18:30.384579 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b"
[0m07:18:30.385076 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b
[0m07:18:30.386734 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b"
[0m07:18:30.387201 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b"
[0m07:18:30.387481 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b: BEGIN
[0m07:18:30.387772 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:30.576329 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.260 seconds
[0m07:18:30.577647 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0: ROLLBACK
[0m07:18:30.833536 [debug] [Thread-2 (]: On test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0: Close
[0m07:18:30.834323 [info ] [Thread-2 (]: 85 of 114 PASS not_null_sales_transactions_silver_store_id ..................... [[32mPASS[0m in 3.07s]
[0m07:18:30.834886 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0
[0m07:18:30.835268 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b
[0m07:18:30.835742 [info ] [Thread-2 (]: 89 of 114 START test not_null_shipments_silver_order_id ........................ [RUN]
[0m07:18:30.836136 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_store_id.3c2472f6c0, now test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b)
[0m07:18:30.836457 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b
[0m07:18:30.839705 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b"
[0m07:18:30.840184 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b
[0m07:18:30.842672 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b"
[0m07:18:30.843152 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b"
[0m07:18:30.843490 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b: BEGIN
[0m07:18:30.843805 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:31.513267 [debug] [Thread-3 (]: SQL status: BEGIN in 2.418 seconds
[0m07:18:31.513734 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7"
[0m07:18:31.514081 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "postgres"."silver"."sales_transactions_silver"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:31.762683 [debug] [Thread-1 (]: SQL status: BEGIN in 3.110 seconds
[0m07:18:31.763131 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f"
[0m07:18:31.763464 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "postgres"."silver"."sales_transactions_silver"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m07:18:31.772384 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.258 seconds
[0m07:18:31.773570 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7: ROLLBACK
[0m07:18:32.018134 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.254 seconds
[0m07:18:32.019584 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f: ROLLBACK
[0m07:18:32.026309 [debug] [Thread-3 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7: Close
[0m07:18:32.027099 [info ] [Thread-3 (]: 87 of 114 PASS not_null_sales_transactions_silver_transaction_date ............. [[32mPASS[0m in 2.94s]
[0m07:18:32.027739 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7
[0m07:18:32.028119 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_shipments_silver_received_date.a083993648
[0m07:18:32.028510 [info ] [Thread-3 (]: 90 of 114 START test not_null_shipments_silver_received_date ................... [RUN]
[0m07:18:32.028896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_transaction_date.59131f37e7, now test.retail_dbt.not_null_shipments_silver_received_date.a083993648)
[0m07:18:32.029190 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_shipments_silver_received_date.a083993648
[0m07:18:32.032278 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_shipments_silver_received_date.a083993648"
[0m07:18:32.032761 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_shipments_silver_received_date.a083993648
[0m07:18:32.034455 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_shipments_silver_received_date.a083993648"
[0m07:18:32.034950 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_received_date.a083993648"
[0m07:18:32.035275 [debug] [Thread-3 (]: On test.retail_dbt.not_null_shipments_silver_received_date.a083993648: BEGIN
[0m07:18:32.035597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:32.274048 [debug] [Thread-1 (]: On test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f: Close
[0m07:18:32.274883 [info ] [Thread-1 (]: 86 of 114 PASS not_null_sales_transactions_silver_total_amount ................. [[32mPASS[0m in 3.63s]
[0m07:18:32.275565 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f
[0m07:18:32.275967 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98
[0m07:18:32.276348 [info ] [Thread-1 (]: 91 of 114 START test not_null_shipments_silver_shipment_id ..................... [RUN]
[0m07:18:32.276840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_total_amount.6e07d2cc0f, now test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98)
[0m07:18:32.277163 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98
[0m07:18:32.280324 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98"
[0m07:18:32.280961 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98
[0m07:18:32.282823 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98"
[0m07:18:32.283309 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98"
[0m07:18:32.283657 [debug] [Thread-1 (]: On test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98: BEGIN
[0m07:18:32.283924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:32.381498 [debug] [Thread-4 (]: SQL status: BEGIN in 1.994 seconds
[0m07:18:32.381913 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b"
[0m07:18:32.382223 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "postgres"."silver"."sales_transactions_silver"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:32.604426 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.222 seconds
[0m07:18:32.605715 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b: ROLLBACK
[0m07:18:32.825959 [debug] [Thread-4 (]: On test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b: Close
[0m07:18:32.826817 [info ] [Thread-4 (]: 88 of 114 PASS not_null_sales_transactions_silver_transaction_id ............... [[32mPASS[0m in 2.45s]
[0m07:18:32.827410 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b
[0m07:18:32.827795 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee
[0m07:18:32.828237 [info ] [Thread-4 (]: 92 of 114 START test not_null_shipments_silver_shipped_date .................... [RUN]
[0m07:18:32.828771 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_sales_transactions_silver_transaction_id.736115426b, now test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee)
[0m07:18:32.829083 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee
[0m07:18:32.832817 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee"
[0m07:18:32.833297 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee
[0m07:18:32.834949 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee"
[0m07:18:32.835494 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee"
[0m07:18:32.835787 [debug] [Thread-4 (]: On test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee: BEGIN
[0m07:18:32.836088 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:33.197865 [debug] [Thread-2 (]: SQL status: BEGIN in 2.354 seconds
[0m07:18:33.198340 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b"
[0m07:18:33.198728 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "postgres"."silver"."shipments_silver"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:33.452169 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.253 seconds
[0m07:18:33.453564 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b: ROLLBACK
[0m07:18:33.719817 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b: Close
[0m07:18:33.720685 [info ] [Thread-2 (]: 89 of 114 PASS not_null_shipments_silver_order_id .............................. [[32mPASS[0m in 2.88s]
[0m07:18:33.721256 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b
[0m07:18:33.721656 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902
[0m07:18:33.722057 [info ] [Thread-2 (]: 93 of 114 START test not_null_shipments_silver_store_id ........................ [RUN]
[0m07:18:33.722459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_shipments_silver_order_id.6b7ddbfc6b, now test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902)
[0m07:18:33.722767 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902
[0m07:18:33.726013 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902"
[0m07:18:33.726504 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902
[0m07:18:33.729148 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902"
[0m07:18:33.729630 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902"
[0m07:18:33.729920 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902: BEGIN
[0m07:18:33.730227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:34.393270 [debug] [Thread-3 (]: SQL status: BEGIN in 2.358 seconds
[0m07:18:34.393773 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_received_date.a083993648"
[0m07:18:34.394229 [debug] [Thread-3 (]: On test.retail_dbt.not_null_shipments_silver_received_date.a083993648: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_shipments_silver_received_date.a083993648"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_date
from "postgres"."silver"."shipments_silver"
where received_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:34.656612 [debug] [Thread-1 (]: SQL status: BEGIN in 2.373 seconds
[0m07:18:34.657116 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98"
[0m07:18:34.657489 [debug] [Thread-1 (]: On test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipment_id
from "postgres"."silver"."shipments_silver"
where shipment_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:34.665596 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.271 seconds
[0m07:18:34.667017 [debug] [Thread-3 (]: On test.retail_dbt.not_null_shipments_silver_received_date.a083993648: ROLLBACK
[0m07:18:34.922117 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:18:34.923696 [debug] [Thread-1 (]: On test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98: ROLLBACK
[0m07:18:34.936209 [debug] [Thread-3 (]: On test.retail_dbt.not_null_shipments_silver_received_date.a083993648: Close
[0m07:18:34.936922 [info ] [Thread-3 (]: 90 of 114 PASS not_null_shipments_silver_received_date ......................... [[32mPASS[0m in 2.91s]
[0m07:18:34.937437 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_shipments_silver_received_date.a083993648
[0m07:18:34.937806 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d
[0m07:18:34.938180 [info ] [Thread-3 (]: 94 of 114 START test not_null_stock_movements_silver_movement_date ............. [RUN]
[0m07:18:34.938570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_shipments_silver_received_date.a083993648, now test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d)
[0m07:18:34.938872 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d
[0m07:18:34.941994 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d"
[0m07:18:34.942488 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d
[0m07:18:34.944293 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d"
[0m07:18:34.944781 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d"
[0m07:18:34.945118 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d: BEGIN
[0m07:18:34.945415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:35.100863 [debug] [Thread-4 (]: SQL status: BEGIN in 2.265 seconds
[0m07:18:35.101334 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee"
[0m07:18:35.101668 [debug] [Thread-4 (]: On test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_date
from "postgres"."silver"."shipments_silver"
where shipped_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:35.205465 [debug] [Thread-1 (]: On test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98: Close
[0m07:18:35.206292 [info ] [Thread-1 (]: 91 of 114 PASS not_null_shipments_silver_shipment_id ........................... [[32mPASS[0m in 2.93s]
[0m07:18:35.206940 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98
[0m07:18:35.207327 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf
[0m07:18:35.207801 [info ] [Thread-1 (]: 95 of 114 START test not_null_stock_movements_silver_movement_id ............... [RUN]
[0m07:18:35.208233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_shipments_silver_shipment_id.ab52987a98, now test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf)
[0m07:18:35.208592 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf
[0m07:18:35.212020 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf"
[0m07:18:35.212554 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf
[0m07:18:35.214476 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf"
[0m07:18:35.214983 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf"
[0m07:18:35.215292 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf: BEGIN
[0m07:18:35.215641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:35.369996 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.268 seconds
[0m07:18:35.371631 [debug] [Thread-4 (]: On test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee: ROLLBACK
[0m07:18:35.639167 [debug] [Thread-4 (]: On test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee: Close
[0m07:18:35.640103 [info ] [Thread-4 (]: 92 of 114 PASS not_null_shipments_silver_shipped_date .......................... [[32mPASS[0m in 2.81s]
[0m07:18:35.640680 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee
[0m07:18:35.641074 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630
[0m07:18:35.641529 [info ] [Thread-4 (]: 96 of 114 START test not_null_stock_movements_silver_movement_type ............. [RUN]
[0m07:18:35.641961 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_shipments_silver_shipped_date.75a36020ee, now test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630)
[0m07:18:35.642295 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630
[0m07:18:35.645660 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630"
[0m07:18:35.646184 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630
[0m07:18:35.648017 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630"
[0m07:18:35.648519 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630"
[0m07:18:35.648883 [debug] [Thread-4 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630: BEGIN
[0m07:18:35.649182 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:35.893278 [debug] [Thread-2 (]: SQL status: BEGIN in 2.163 seconds
[0m07:18:35.893752 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902"
[0m07:18:35.894085 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."shipments_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:36.143758 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.249 seconds
[0m07:18:36.145136 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902: ROLLBACK
[0m07:18:36.395069 [debug] [Thread-2 (]: On test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902: Close
[0m07:18:36.395957 [info ] [Thread-2 (]: 93 of 114 PASS not_null_shipments_silver_store_id .............................. [[32mPASS[0m in 2.67s]
[0m07:18:36.396516 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902
[0m07:18:36.396903 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1
[0m07:18:36.397368 [info ] [Thread-2 (]: 97 of 114 START test not_null_stock_movements_silver_product_id ................ [RUN]
[0m07:18:36.397873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_shipments_silver_store_id.cd277ca902, now test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1)
[0m07:18:36.398283 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1
[0m07:18:36.402618 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1"
[0m07:18:36.403202 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1
[0m07:18:36.468709 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1"
[0m07:18:36.469373 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1"
[0m07:18:36.469709 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1: BEGIN
[0m07:18:36.470033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:37.511161 [debug] [Thread-3 (]: SQL status: BEGIN in 2.566 seconds
[0m07:18:37.511671 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d"
[0m07:18:37.512018 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_date
from "postgres"."silver"."stock_movements_silver"
where movement_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:37.562305 [debug] [Thread-1 (]: SQL status: BEGIN in 2.347 seconds
[0m07:18:37.562715 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf"
[0m07:18:37.563202 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_id
from "postgres"."silver"."stock_movements_silver"
where movement_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:37.792437 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.280 seconds
[0m07:18:37.793836 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d: ROLLBACK
[0m07:18:37.806498 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.243 seconds
[0m07:18:37.807704 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf: ROLLBACK
[0m07:18:37.995781 [debug] [Thread-4 (]: SQL status: BEGIN in 2.346 seconds
[0m07:18:37.996344 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630"
[0m07:18:37.996694 [debug] [Thread-4 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_type
from "postgres"."silver"."stock_movements_silver"
where movement_type is null



  
  
      
    ) dbt_internal_test
[0m07:18:38.053009 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf: Close
[0m07:18:38.053794 [info ] [Thread-1 (]: 95 of 114 PASS not_null_stock_movements_silver_movement_id ..................... [[32mPASS[0m in 2.85s]
[0m07:18:38.054382 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf
[0m07:18:38.054778 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded
[0m07:18:38.055206 [info ] [Thread-1 (]: 98 of 114 START test not_null_stock_movements_silver_quantity .................. [RUN]
[0m07:18:38.055681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stock_movements_silver_movement_id.9441e6c7bf, now test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded)
[0m07:18:38.056042 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded
[0m07:18:38.059629 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded"
[0m07:18:38.060164 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded
[0m07:18:38.062018 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded"
[0m07:18:38.062578 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded"
[0m07:18:38.062926 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded: BEGIN
[0m07:18:38.063318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:38.073735 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d: Close
[0m07:18:38.074576 [info ] [Thread-3 (]: 94 of 114 PASS not_null_stock_movements_silver_movement_date ................... [[32mPASS[0m in 3.14s]
[0m07:18:38.075108 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d
[0m07:18:38.075524 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582
[0m07:18:38.075947 [info ] [Thread-3 (]: 99 of 114 START test not_null_stock_movements_silver_store_id .................. [RUN]
[0m07:18:38.076335 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stock_movements_silver_movement_date.efe72dd68d, now test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582)
[0m07:18:38.076690 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582
[0m07:18:38.079740 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582"
[0m07:18:38.080231 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582
[0m07:18:38.082041 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582"
[0m07:18:38.082544 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582"
[0m07:18:38.082889 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582: BEGIN
[0m07:18:38.083183 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:38.243261 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.246 seconds
[0m07:18:38.244599 [debug] [Thread-4 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630: ROLLBACK
[0m07:18:38.477257 [debug] [Thread-4 (]: On test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630: Close
[0m07:18:38.478239 [info ] [Thread-4 (]: 96 of 114 PASS not_null_stock_movements_silver_movement_type ................... [[32mPASS[0m in 2.84s]
[0m07:18:38.478985 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630
[0m07:18:38.479502 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d
[0m07:18:38.479995 [info ] [Thread-4 (]: 100 of 114 START test not_null_store_visits_silver_customer_id ................. [RUN]
[0m07:18:38.480490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stock_movements_silver_movement_type.a5e3a59630, now test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d)
[0m07:18:38.480894 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d
[0m07:18:38.484487 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d"
[0m07:18:38.484998 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d
[0m07:18:38.486879 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d"
[0m07:18:38.487518 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d"
[0m07:18:38.487840 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d: BEGIN
[0m07:18:38.488121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:38.850777 [debug] [Thread-2 (]: SQL status: BEGIN in 2.381 seconds
[0m07:18:38.851332 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1"
[0m07:18:38.851805 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."stock_movements_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:39.103788 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.251 seconds
[0m07:18:39.105304 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1: ROLLBACK
[0m07:18:39.356945 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1: Close
[0m07:18:39.357871 [info ] [Thread-2 (]: 97 of 114 PASS not_null_stock_movements_silver_product_id ...................... [[32mPASS[0m in 2.96s]
[0m07:18:39.358584 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1
[0m07:18:39.358957 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282
[0m07:18:39.359407 [info ] [Thread-2 (]: 101 of 114 START test not_null_store_visits_silver_store_id .................... [RUN]
[0m07:18:39.359833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stock_movements_silver_product_id.893e7e84b1, now test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282)
[0m07:18:39.360153 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282
[0m07:18:39.364176 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282"
[0m07:18:39.364687 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282
[0m07:18:39.366431 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282"
[0m07:18:39.366928 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282"
[0m07:18:39.367268 [debug] [Thread-2 (]: On test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282: BEGIN
[0m07:18:39.367635 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:40.397339 [debug] [Thread-3 (]: SQL status: BEGIN in 2.314 seconds
[0m07:18:40.397869 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582"
[0m07:18:40.398248 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."stock_movements_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:40.493104 [debug] [Thread-1 (]: SQL status: BEGIN in 2.430 seconds
[0m07:18:40.493617 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded"
[0m07:18:40.494040 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver"."stock_movements_silver"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m07:18:40.555297 [debug] [Thread-4 (]: SQL status: BEGIN in 2.067 seconds
[0m07:18:40.555869 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d"
[0m07:18:40.556227 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver"."store_visits_silver"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:40.662576 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:18:40.663880 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582: ROLLBACK
[0m07:18:40.756844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:18:40.757940 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded: ROLLBACK
[0m07:18:40.784859 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.228 seconds
[0m07:18:40.785945 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d: ROLLBACK
[0m07:18:40.917266 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582: Close
[0m07:18:40.918055 [info ] [Thread-3 (]: 99 of 114 PASS not_null_stock_movements_silver_store_id ........................ [[32mPASS[0m in 2.84s]
[0m07:18:40.918628 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582
[0m07:18:40.918974 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d
[0m07:18:40.919338 [info ] [Thread-3 (]: 102 of 114 START test not_null_store_visits_silver_visit_date .................. [RUN]
[0m07:18:40.919774 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stock_movements_silver_store_id.87dd62d582, now test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d)
[0m07:18:40.920074 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d
[0m07:18:40.923238 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d"
[0m07:18:40.923719 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d
[0m07:18:40.925419 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d"
[0m07:18:40.925884 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d"
[0m07:18:40.926177 [debug] [Thread-3 (]: On test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d: BEGIN
[0m07:18:40.926444 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:41.011828 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d: Close
[0m07:18:41.012550 [info ] [Thread-4 (]: 100 of 114 PASS not_null_store_visits_silver_customer_id ....................... [[32mPASS[0m in 2.53s]
[0m07:18:41.013051 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d
[0m07:18:41.013412 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203
[0m07:18:41.013774 [info ] [Thread-4 (]: 103 of 114 START test not_null_store_visits_silver_visit_id .................... [RUN]
[0m07:18:41.014165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_store_visits_silver_customer_id.57f338221d, now test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203)
[0m07:18:41.014489 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203
[0m07:18:41.017521 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203"
[0m07:18:41.018007 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203
[0m07:18:41.019732 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203"
[0m07:18:41.020220 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203"
[0m07:18:41.020551 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203: BEGIN
[0m07:18:41.020846 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:41.038598 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded: Close
[0m07:18:41.039334 [info ] [Thread-1 (]: 98 of 114 PASS not_null_stock_movements_silver_quantity ........................ [[32mPASS[0m in 2.98s]
[0m07:18:41.039866 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded
[0m07:18:41.040232 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_stores_silver_location.9e197b2d81
[0m07:18:41.040609 [info ] [Thread-1 (]: 104 of 114 START test not_null_stores_silver_location .......................... [RUN]
[0m07:18:41.040967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stock_movements_silver_quantity.2ffe698ded, now test.retail_dbt.not_null_stores_silver_location.9e197b2d81)
[0m07:18:41.041296 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_stores_silver_location.9e197b2d81
[0m07:18:41.044163 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_stores_silver_location.9e197b2d81"
[0m07:18:41.044610 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_stores_silver_location.9e197b2d81
[0m07:18:41.047128 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_stores_silver_location.9e197b2d81"
[0m07:18:41.047611 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_location.9e197b2d81"
[0m07:18:41.047930 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stores_silver_location.9e197b2d81: BEGIN
[0m07:18:41.048218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:45.144103 [debug] [Thread-2 (]: SQL status: BEGIN in 4.091 seconds
[0m07:18:45.144599 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282"
[0m07:18:45.144957 [debug] [Thread-2 (]: On test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."store_visits_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:45.438176 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.293 seconds
[0m07:18:45.439752 [debug] [Thread-2 (]: On test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282: ROLLBACK
[0m07:18:45.715924 [debug] [Thread-2 (]: On test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282: Close
[0m07:18:45.716923 [info ] [Thread-2 (]: 101 of 114 PASS not_null_store_visits_silver_store_id .......................... [[32mPASS[0m in 6.36s]
[0m07:18:45.717646 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282
[0m07:18:45.718113 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa
[0m07:18:45.718650 [info ] [Thread-2 (]: 105 of 114 START test not_null_stores_silver_manager_id ........................ [RUN]
[0m07:18:45.719198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_store_visits_silver_store_id.4276ef5282, now test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa)
[0m07:18:45.719570 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa
[0m07:18:45.724350 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa"
[0m07:18:45.725174 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa
[0m07:18:45.728531 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa"
[0m07:18:45.729283 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa"
[0m07:18:45.729741 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa: BEGIN
[0m07:18:45.730223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:47.851397 [debug] [Thread-3 (]: SQL status: BEGIN in 5.239 seconds
[0m07:18:47.851870 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d"
[0m07:18:47.852198 [debug] [Thread-3 (]: On test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_date
from "postgres"."silver"."store_visits_silver"
where visit_date is null



  
  
      
    ) dbt_internal_test
[0m07:18:48.008066 [debug] [Thread-2 (]: SQL status: BEGIN in 2.278 seconds
[0m07:18:48.008536 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa"
[0m07:18:48.008834 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manager_id
from "postgres"."silver"."stores_silver"
where manager_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:48.077585 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.225 seconds
[0m07:18:48.078891 [debug] [Thread-3 (]: On test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d: ROLLBACK
[0m07:18:48.215884 [debug] [Thread-1 (]: SQL status: BEGIN in 5.482 seconds
[0m07:18:48.216314 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_location.9e197b2d81"
[0m07:18:48.216631 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stores_silver_location.9e197b2d81: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stores_silver_location.9e197b2d81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location
from "postgres"."silver"."stores_silver"
where location is null



  
  
      
    ) dbt_internal_test
[0m07:18:48.243521 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.234 seconds
[0m07:18:48.244905 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa: ROLLBACK
[0m07:18:48.295891 [debug] [Thread-3 (]: On test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d: Close
[0m07:18:48.296725 [info ] [Thread-3 (]: 102 of 114 PASS not_null_store_visits_silver_visit_date ........................ [[32mPASS[0m in 7.38s]
[0m07:18:48.297433 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d
[0m07:18:48.297885 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_stores_silver_name.c7d29b75c3
[0m07:18:48.298341 [info ] [Thread-3 (]: 106 of 114 START test not_null_stores_silver_name .............................. [RUN]
[0m07:18:48.298744 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_store_visits_silver_visit_date.adefa3499d, now test.retail_dbt.not_null_stores_silver_name.c7d29b75c3)
[0m07:18:48.299066 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_stores_silver_name.c7d29b75c3
[0m07:18:48.302163 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_stores_silver_name.c7d29b75c3"
[0m07:18:48.302651 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_stores_silver_name.c7d29b75c3
[0m07:18:48.304439 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_stores_silver_name.c7d29b75c3"
[0m07:18:48.304905 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_name.c7d29b75c3"
[0m07:18:48.305226 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stores_silver_name.c7d29b75c3: BEGIN
[0m07:18:48.305501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:48.477148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.260 seconds
[0m07:18:48.478658 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stores_silver_location.9e197b2d81: ROLLBACK
[0m07:18:48.479250 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa: Close
[0m07:18:48.480029 [info ] [Thread-2 (]: 105 of 114 PASS not_null_stores_silver_manager_id .............................. [[32mPASS[0m in 2.76s]
[0m07:18:48.480742 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa
[0m07:18:48.481253 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097
[0m07:18:48.481735 [info ] [Thread-2 (]: 107 of 114 START test not_null_stores_silver_store_id .......................... [RUN]
[0m07:18:48.482244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stores_silver_manager_id.c3c7ff2ffa, now test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097)
[0m07:18:48.482640 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097
[0m07:18:48.486273 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097"
[0m07:18:48.486740 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097
[0m07:18:48.488585 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097"
[0m07:18:48.489086 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097"
[0m07:18:48.489391 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097: BEGIN
[0m07:18:48.489744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:48.737811 [debug] [Thread-1 (]: On test.retail_dbt.not_null_stores_silver_location.9e197b2d81: Close
[0m07:18:48.738823 [info ] [Thread-1 (]: 104 of 114 PASS not_null_stores_silver_location ................................ [[32mPASS[0m in 7.70s]
[0m07:18:48.739369 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_stores_silver_location.9e197b2d81
[0m07:18:48.739760 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888
[0m07:18:48.740152 [info ] [Thread-1 (]: 108 of 114 START test not_null_suppliers_silver_contact_info ................... [RUN]
[0m07:18:48.740541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stores_silver_location.9e197b2d81, now test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888)
[0m07:18:48.740830 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888
[0m07:18:48.745146 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888"
[0m07:18:48.745639 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888
[0m07:18:48.747374 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888"
[0m07:18:48.747845 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888"
[0m07:18:48.748174 [debug] [Thread-1 (]: On test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888: BEGIN
[0m07:18:48.748452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:48.792892 [debug] [Thread-4 (]: SQL status: BEGIN in 6.086 seconds
[0m07:18:48.793279 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203"
[0m07:18:48.793627 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "postgres"."silver"."store_visits_silver"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:49.011672 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.218 seconds
[0m07:18:49.013037 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203: ROLLBACK
[0m07:18:49.230980 [debug] [Thread-4 (]: On test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203: Close
[0m07:18:49.231807 [info ] [Thread-4 (]: 103 of 114 PASS not_null_store_visits_silver_visit_id .......................... [[32mPASS[0m in 8.22s]
[0m07:18:49.232325 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203
[0m07:18:49.232688 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_suppliers_silver_name.61cee018b3
[0m07:18:49.233072 [info ] [Thread-4 (]: 109 of 114 START test not_null_suppliers_silver_name ........................... [RUN]
[0m07:18:49.233513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_store_visits_silver_visit_id.04f76e4203, now test.retail_dbt.not_null_suppliers_silver_name.61cee018b3)
[0m07:18:49.233837 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_suppliers_silver_name.61cee018b3
[0m07:18:49.236876 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_suppliers_silver_name.61cee018b3"
[0m07:18:49.237378 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_suppliers_silver_name.61cee018b3
[0m07:18:49.239126 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_suppliers_silver_name.61cee018b3"
[0m07:18:49.239592 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_suppliers_silver_name.61cee018b3"
[0m07:18:49.239897 [debug] [Thread-4 (]: On test.retail_dbt.not_null_suppliers_silver_name.61cee018b3: BEGIN
[0m07:18:49.240193 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:50.774567 [debug] [Thread-2 (]: SQL status: BEGIN in 2.285 seconds
[0m07:18:50.775019 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097"
[0m07:18:50.775327 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver"."stores_silver"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:50.917673 [debug] [Thread-3 (]: SQL status: BEGIN in 2.612 seconds
[0m07:18:50.918149 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_stores_silver_name.c7d29b75c3"
[0m07:18:50.918504 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stores_silver_name.c7d29b75c3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_stores_silver_name.c7d29b75c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."stores_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:18:51.026613 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.251 seconds
[0m07:18:51.027884 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097: ROLLBACK
[0m07:18:51.102523 [debug] [Thread-1 (]: SQL status: BEGIN in 2.354 seconds
[0m07:18:51.102881 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888"
[0m07:18:51.103234 [debug] [Thread-1 (]: On test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select contact_info
from "postgres"."silver"."suppliers_silver"
where contact_info is null



  
  
      
    ) dbt_internal_test
[0m07:18:51.202378 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.284 seconds
[0m07:18:51.203525 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stores_silver_name.c7d29b75c3: ROLLBACK
[0m07:18:51.278649 [debug] [Thread-4 (]: SQL status: BEGIN in 2.038 seconds
[0m07:18:51.279057 [debug] [Thread-2 (]: On test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097: Close
[0m07:18:51.279431 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_suppliers_silver_name.61cee018b3"
[0m07:18:51.279870 [debug] [Thread-4 (]: On test.retail_dbt.not_null_suppliers_silver_name.61cee018b3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_suppliers_silver_name.61cee018b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver"."suppliers_silver"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:18:51.280407 [info ] [Thread-2 (]: 107 of 114 PASS not_null_stores_silver_store_id ................................ [[32mPASS[0m in 2.80s]
[0m07:18:51.280988 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097
[0m07:18:51.281428 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042
[0m07:18:51.281867 [info ] [Thread-2 (]: 110 of 114 START test not_null_suppliers_silver_supplier_id .................... [RUN]
[0m07:18:51.282340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stores_silver_store_id.7b5b9ac097, now test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042)
[0m07:18:51.282666 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042
[0m07:18:51.285757 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042"
[0m07:18:51.286247 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042
[0m07:18:51.288014 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042"
[0m07:18:51.288482 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042"
[0m07:18:51.288762 [debug] [Thread-2 (]: On test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042: BEGIN
[0m07:18:51.289065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:18:51.364119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.260 seconds
[0m07:18:51.365418 [debug] [Thread-1 (]: On test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888: ROLLBACK
[0m07:18:51.485322 [debug] [Thread-3 (]: On test.retail_dbt.not_null_stores_silver_name.c7d29b75c3: Close
[0m07:18:51.486064 [info ] [Thread-3 (]: 106 of 114 PASS not_null_stores_silver_name .................................... [[32mPASS[0m in 3.19s]
[0m07:18:51.486586 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_stores_silver_name.c7d29b75c3
[0m07:18:51.486958 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d
[0m07:18:51.487389 [info ] [Thread-3 (]: 111 of 114 START test not_null_tax_rules_silver_product_id ..................... [RUN]
[0m07:18:51.487872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_stores_silver_name.c7d29b75c3, now test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d)
[0m07:18:51.488274 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d
[0m07:18:51.492017 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d"
[0m07:18:51.492524 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d
[0m07:18:51.494428 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d"
[0m07:18:51.494928 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d"
[0m07:18:51.495300 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d: BEGIN
[0m07:18:51.495642 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:51.503778 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.223 seconds
[0m07:18:51.506588 [debug] [Thread-4 (]: On test.retail_dbt.not_null_suppliers_silver_name.61cee018b3: ROLLBACK
[0m07:18:51.728835 [debug] [Thread-4 (]: On test.retail_dbt.not_null_suppliers_silver_name.61cee018b3: Close
[0m07:18:51.729607 [info ] [Thread-4 (]: 109 of 114 PASS not_null_suppliers_silver_name ................................. [[32mPASS[0m in 2.50s]
[0m07:18:51.730119 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_suppliers_silver_name.61cee018b3
[0m07:18:51.730481 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21
[0m07:18:51.730839 [info ] [Thread-4 (]: 112 of 114 START test not_null_tax_rules_silver_region ......................... [RUN]
[0m07:18:51.731212 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_suppliers_silver_name.61cee018b3, now test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21)
[0m07:18:51.731507 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21
[0m07:18:51.734451 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21"
[0m07:18:51.734910 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21
[0m07:18:51.736547 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21"
[0m07:18:51.737010 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21"
[0m07:18:51.737304 [debug] [Thread-4 (]: On test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21: BEGIN
[0m07:18:51.737595 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:18:52.115148 [debug] [Thread-1 (]: On test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888: Close
[0m07:18:52.116052 [info ] [Thread-1 (]: 108 of 114 PASS not_null_suppliers_silver_contact_info ......................... [[32mPASS[0m in 3.38s]
[0m07:18:52.116753 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888
[0m07:18:52.117294 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254
[0m07:18:52.117781 [info ] [Thread-1 (]: 113 of 114 START test not_null_tax_rules_silver_tax_id ......................... [RUN]
[0m07:18:52.118256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_suppliers_silver_contact_info.a90509e888, now test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254)
[0m07:18:52.118613 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254
[0m07:18:52.122386 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254"
[0m07:18:52.123087 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254
[0m07:18:52.125925 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254"
[0m07:18:52.126574 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254"
[0m07:18:52.127026 [debug] [Thread-1 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254: BEGIN
[0m07:18:52.127450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:18:53.507304 [debug] [Thread-3 (]: SQL status: BEGIN in 2.012 seconds
[0m07:18:53.507797 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d"
[0m07:18:53.508187 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver"."tax_rules_silver"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:53.718579 [debug] [Thread-4 (]: SQL status: BEGIN in 1.981 seconds
[0m07:18:53.719077 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21"
[0m07:18:53.719519 [debug] [Thread-4 (]: On test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "postgres"."silver"."tax_rules_silver"
where region is null



  
  
      
    ) dbt_internal_test
[0m07:18:53.744217 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:18:53.745627 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d: ROLLBACK
[0m07:18:53.937167 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.217 seconds
[0m07:18:53.938872 [debug] [Thread-4 (]: On test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21: ROLLBACK
[0m07:18:53.975167 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d: Close
[0m07:18:53.976009 [info ] [Thread-3 (]: 111 of 114 PASS not_null_tax_rules_silver_product_id ........................... [[32mPASS[0m in 2.49s]
[0m07:18:53.976620 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d
[0m07:18:53.977087 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898
[0m07:18:53.977718 [info ] [Thread-3 (]: 114 of 114 START test not_null_tax_rules_silver_tax_rate ....................... [RUN]
[0m07:18:53.978146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_tax_rules_silver_product_id.1223163e5d, now test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898)
[0m07:18:53.978445 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898
[0m07:18:53.981838 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898"
[0m07:18:53.982321 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898
[0m07:18:53.984148 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898"
[0m07:18:53.984632 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898"
[0m07:18:53.984966 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898: BEGIN
[0m07:18:53.985294 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:18:54.155781 [debug] [Thread-4 (]: On test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21: Close
[0m07:18:54.156621 [info ] [Thread-4 (]: 112 of 114 PASS not_null_tax_rules_silver_region ............................... [[32mPASS[0m in 2.43s]
[0m07:18:54.157327 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21
[0m07:18:54.407202 [debug] [Thread-1 (]: SQL status: BEGIN in 2.280 seconds
[0m07:18:54.407818 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254"
[0m07:18:54.408251 [debug] [Thread-1 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_id
from "postgres"."silver"."tax_rules_silver"
where tax_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:54.438994 [debug] [Thread-2 (]: SQL status: BEGIN in 3.150 seconds
[0m07:18:54.439681 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042"
[0m07:18:54.440156 [debug] [Thread-2 (]: On test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver"."suppliers_silver"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:18:54.658422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.250 seconds
[0m07:18:54.659653 [debug] [Thread-1 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254: ROLLBACK
[0m07:18:54.696242 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.256 seconds
[0m07:18:54.697307 [debug] [Thread-2 (]: On test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042: ROLLBACK
[0m07:18:54.909686 [debug] [Thread-1 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254: Close
[0m07:18:54.910495 [info ] [Thread-1 (]: 113 of 114 PASS not_null_tax_rules_silver_tax_id ............................... [[32mPASS[0m in 2.79s]
[0m07:18:54.911061 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254
[0m07:18:54.964508 [debug] [Thread-2 (]: On test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042: Close
[0m07:18:54.965200 [info ] [Thread-2 (]: 110 of 114 PASS not_null_suppliers_silver_supplier_id .......................... [[32mPASS[0m in 3.68s]
[0m07:18:54.965839 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042
[0m07:18:56.868104 [debug] [Thread-3 (]: SQL status: BEGIN in 2.883 seconds
[0m07:18:56.868573 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898"
[0m07:18:56.868885 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_rate
from "postgres"."silver"."tax_rules_silver"
where tax_rate is null



  
  
      
    ) dbt_internal_test
[0m07:18:57.095558 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:18:57.096810 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898: ROLLBACK
[0m07:18:57.323506 [debug] [Thread-3 (]: On test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898: Close
[0m07:18:57.324275 [info ] [Thread-3 (]: 114 of 114 PASS not_null_tax_rules_silver_tax_rate ............................. [[32mPASS[0m in 3.35s]
[0m07:18:57.324864 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898
[0m07:18:57.326665 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:57.326977 [debug] [MainThread]: On master: BEGIN
[0m07:18:57.327238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:18:59.668743 [debug] [MainThread]: SQL status: BEGIN in 2.341 seconds
[0m07:18:59.669189 [debug] [MainThread]: On master: COMMIT
[0m07:18:59.669505 [debug] [MainThread]: Using postgres connection "master"
[0m07:18:59.669800 [debug] [MainThread]: On master: COMMIT
[0m07:18:59.923681 [debug] [MainThread]: SQL status: COMMIT in 0.254 seconds
[0m07:18:59.924075 [debug] [MainThread]: On master: Close
[0m07:18:59.924627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:18:59.924883 [debug] [MainThread]: Connection 'test.retail_dbt.not_null_tax_rules_silver_region.c6687fdd21' was properly closed.
[0m07:18:59.925161 [debug] [MainThread]: Connection 'test.retail_dbt.not_null_tax_rules_silver_tax_rate.8f3dac0898' was properly closed.
[0m07:18:59.925466 [debug] [MainThread]: Connection 'test.retail_dbt.not_null_suppliers_silver_supplier_id.82e9077042' was properly closed.
[0m07:18:59.925704 [debug] [MainThread]: Connection 'test.retail_dbt.not_null_tax_rules_silver_tax_id.24ed2c7254' was properly closed.
[0m07:18:59.926071 [info ] [MainThread]: 
[0m07:18:59.926403 [info ] [MainThread]: Finished running 114 data tests in 0 hours 1 minutes and 45.31 seconds (105.31s).
[0m07:18:59.937321 [debug] [MainThread]: Command end result
[0m07:19:00.028973 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:19:00.031558 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:19:00.039408 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:19:00.039697 [info ] [MainThread]: 
[0m07:19:00.040022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:19:00.040319 [info ] [MainThread]: 
[0m07:19:00.040651 [info ] [MainThread]: Done. PASS=114 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=114
[0m07:19:00.041473 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 101.20748, "process_in_blocks": "0", "process_kernel_time": 0.605351, "process_mem_max_rss": "143384", "process_out_blocks": "12152", "process_user_time": 4.521349}
[0m07:19:00.041833 [debug] [MainThread]: Command `dbt test` succeeded at 07:19:00.041762 after 101.21 seconds
[0m07:19:00.042125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798591aef230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79858f542a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7985929db110>]}
[0m07:19:00.042427 [debug] [MainThread]: Flushing usage events
[0m07:19:01.091133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:19:04.101591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336246fc170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733624ed5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733625563410>]}


============================== 07:19:04.106695 | c707b709-e4e4-43c8-b6b2-eae3a215d9c2 ==============================
[0m07:19:04.106695 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:19:04.107103 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot --profiles-dir /home/airflow/.dbt', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '/home/airflow/.dbt', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m07:19:04.239978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733623de8410>]}
[0m07:19:04.288519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336270042c0>]}
[0m07:19:04.289263 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:19:04.378891 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:19:04.521580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:19:04.521953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:19:04.573700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733624f47440>]}
[0m07:19:04.752179 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:19:04.754499 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:19:04.788599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733621df7a10>]}
[0m07:19:04.788988 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:19:04.789349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733621dc0110>]}
[0m07:19:04.794779 [info ] [MainThread]: 
[0m07:19:04.795099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:19:04.795369 [info ] [MainThread]: 
[0m07:19:04.795767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:19:04.798879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m07:19:04.825998 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:19:04.826283 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:19:04.826560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:06.964255 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.138 seconds
[0m07:19:06.965495 [debug] [ThreadPool]: On list_postgres: Close
[0m07:19:06.971275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_silver_staging)
[0m07:19:06.976195 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:19:06.976621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m07:19:06.976945 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:19:06.977555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m07:19:06.978949 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:19:06.979541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:19:06.979851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:06.981405 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:19:06.981740 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:19:06.983203 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:19:06.983669 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:19:06.983981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:06.984353 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:19:06.984755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:06.985368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:09.029595 [debug] [ThreadPool]: SQL status: BEGIN in 2.044 seconds
[0m07:19:09.030002 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:19:09.030350 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:19:09.271767 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.241 seconds
[0m07:19:09.273381 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:19:09.351691 [debug] [ThreadPool]: SQL status: BEGIN in 2.367 seconds
[0m07:19:09.352108 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:19:09.352437 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:19:09.390408 [debug] [ThreadPool]: SQL status: BEGIN in 2.410 seconds
[0m07:19:09.390829 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:19:09.391190 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:19:09.513466 [debug] [ThreadPool]: SQL status: BEGIN in 2.529 seconds
[0m07:19:09.514000 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:19:09.514380 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:19:09.516335 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:19:09.632122 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.279 seconds
[0m07:19:09.633817 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:19:09.672496 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.281 seconds
[0m07:19:09.673966 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:19:09.810142 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.295 seconds
[0m07:19:09.811253 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:19:09.912844 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:19:09.951710 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:19:10.096522 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:19:10.106095 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:10.106418 [debug] [MainThread]: On master: BEGIN
[0m07:19:10.106714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:19:15.577747 [debug] [MainThread]: SQL status: BEGIN in 5.148 seconds
[0m07:19:15.578252 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:15.578590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:19:15.819580 [debug] [MainThread]: SQL status: SELECT 40 in 0.241 seconds
[0m07:19:15.821331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733623d30d70>]}
[0m07:19:15.821762 [debug] [MainThread]: On master: ROLLBACK
[0m07:19:16.060750 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:16.061158 [debug] [MainThread]: On master: BEGIN
[0m07:19:16.555603 [debug] [MainThread]: SQL status: BEGIN in 0.494 seconds
[0m07:19:16.556102 [debug] [MainThread]: On master: COMMIT
[0m07:19:16.556509 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:16.556889 [debug] [MainThread]: On master: COMMIT
[0m07:19:16.813241 [debug] [MainThread]: SQL status: COMMIT in 0.256 seconds
[0m07:19:16.813709 [debug] [MainThread]: On master: Close
[0m07:19:16.818687 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.dim_brands_snapshot
[0m07:19:16.819117 [debug] [Thread-2 (]: Began running node snapshot.retail_dbt.dim_categories_snapshot
[0m07:19:16.819665 [debug] [Thread-3 (]: Began running node snapshot.retail_dbt.dim_customers_snapshot
[0m07:19:16.820671 [debug] [Thread-4 (]: Began running node snapshot.retail_dbt.dim_employees_snapshot
[0m07:19:16.820265 [info ] [Thread-1 (]: 1 of 9 START snapshot silver.dim_brands_snapshot ............................... [RUN]
[0m07:19:16.821365 [info ] [Thread-2 (]: 2 of 9 START snapshot silver.dim_categories_snapshot ........................... [RUN]
[0m07:19:16.821934 [info ] [Thread-3 (]: 3 of 9 START snapshot silver.dim_customers_snapshot ............................ [RUN]
[0m07:19:16.822954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now snapshot.retail_dbt.dim_brands_snapshot)
[0m07:19:16.822377 [info ] [Thread-4 (]: 4 of 9 START snapshot silver.dim_employees_snapshot ............................ [RUN]
[0m07:19:16.823488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now snapshot.retail_dbt.dim_categories_snapshot)
[0m07:19:16.823889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now snapshot.retail_dbt.dim_customers_snapshot)
[0m07:19:16.824361 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.dim_brands_snapshot
[0m07:19:16.824726 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now snapshot.retail_dbt.dim_employees_snapshot)
[0m07:19:16.825128 [debug] [Thread-2 (]: Began compiling node snapshot.retail_dbt.dim_categories_snapshot
[0m07:19:16.825516 [debug] [Thread-3 (]: Began compiling node snapshot.retail_dbt.dim_customers_snapshot
[0m07:19:16.832066 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.dim_brands_snapshot
[0m07:19:16.832426 [debug] [Thread-4 (]: Began compiling node snapshot.retail_dbt.dim_employees_snapshot
[0m07:19:16.835067 [debug] [Thread-2 (]: Began executing node snapshot.retail_dbt.dim_categories_snapshot
[0m07:19:16.837714 [debug] [Thread-3 (]: Began executing node snapshot.retail_dbt.dim_customers_snapshot
[0m07:19:16.856173 [debug] [Thread-4 (]: Began executing node snapshot.retail_dbt.dim_employees_snapshot
[0m07:19:16.934497 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_brands_snapshot"
[0m07:19:16.935040 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_categories_snapshot"
[0m07:19:16.936181 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_customers_snapshot"
[0m07:19:16.938816 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_employees_snapshot"
[0m07:19:16.939265 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_brands_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(brand_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."brands_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:16.939729 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_categories_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(category_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."categories_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:16.940246 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_customers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."customers_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:16.940745 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_employees_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(employee_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."employees_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:16.941179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:16.941628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:19:16.942039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:19:16.942394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:19:19.241505 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.300 seconds
[0m07:19:19.244438 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_categories_snapshot"
[0m07:19:19.244779 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_categories_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:19.246194 [debug] [Thread-3 (]: SQL status: SELECT 0 in 2.304 seconds
[0m07:19:19.246825 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_customers_snapshot"
[0m07:19:19.247141 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_customers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:19.315807 [debug] [Thread-4 (]: SQL status: SELECT 0 in 2.373 seconds
[0m07:19:19.316494 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_employees_snapshot"
[0m07:19:19.316815 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_employees_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:19.485249 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.240 seconds
[0m07:19:19.485924 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_categories_snapshot"
[0m07:19:19.486530 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_categories_snapshot"
[0m07:19:19.486845 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: BEGIN
[0m07:19:19.493804 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.246 seconds
[0m07:19:19.494262 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_customers_snapshot"
[0m07:19:19.494798 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_customers_snapshot"
[0m07:19:19.495104 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: BEGIN
[0m07:19:19.562568 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.245 seconds
[0m07:19:19.563104 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_employees_snapshot"
[0m07:19:19.563599 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_employees_snapshot"
[0m07:19:19.563943 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: BEGIN
[0m07:19:19.743436 [debug] [Thread-2 (]: SQL status: BEGIN in 0.256 seconds
[0m07:19:19.743845 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_categories_snapshot"
[0m07:19:19.744240 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_categories_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_categories_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(category_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."categories_silver"
    ) sbq



  );
  
  
[0m07:19:19.746984 [debug] [Thread-3 (]: SQL status: BEGIN in 0.252 seconds
[0m07:19:19.747346 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_customers_snapshot"
[0m07:19:19.747695 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_customers_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_customers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."customers_silver"
    ) sbq



  );
  
  
[0m07:19:19.810199 [debug] [Thread-4 (]: SQL status: BEGIN in 0.246 seconds
[0m07:19:19.810576 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_employees_snapshot"
[0m07:19:19.810927 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_employees_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_employees_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(employee_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."employees_silver"
    ) sbq



  );
  
  
[0m07:19:19.986354 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.242 seconds
[0m07:19:19.999823 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: COMMIT
[0m07:19:20.000176 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_categories_snapshot"
[0m07:19:20.000507 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: COMMIT
[0m07:19:20.001217 [debug] [Thread-3 (]: SQL status: SELECT 902 in 0.253 seconds
[0m07:19:20.002531 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: COMMIT
[0m07:19:20.002924 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_customers_snapshot"
[0m07:19:20.003348 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: COMMIT
[0m07:19:20.066821 [debug] [Thread-4 (]: SQL status: SELECT 200 in 0.255 seconds
[0m07:19:20.067879 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: COMMIT
[0m07:19:20.068246 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_employees_snapshot"
[0m07:19:20.068573 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: COMMIT
[0m07:19:20.246269 [debug] [Thread-2 (]: SQL status: COMMIT in 0.245 seconds
[0m07:19:20.247833 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_categories_snapshot: Close
[0m07:19:20.249278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733626f85b50>]}
[0m07:19:20.249648 [debug] [Thread-3 (]: SQL status: COMMIT in 0.246 seconds
[0m07:19:20.250327 [info ] [Thread-2 (]: 2 of 9 OK snapshotted silver.dim_categories_snapshot ........................... [[32mSELECT 10[0m in 3.42s]
[0m07:19:20.251212 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_customers_snapshot: Close
[0m07:19:20.251865 [debug] [Thread-2 (]: Finished running node snapshot.retail_dbt.dim_categories_snapshot
[0m07:19:20.252479 [debug] [Thread-2 (]: Began running node snapshot.retail_dbt.dim_loyalty_programs_snapshot
[0m07:19:20.253005 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733621b761e0>]}
[0m07:19:20.253522 [info ] [Thread-2 (]: 5 of 9 START snapshot silver.dim_loyalty_programs_snapshot ..................... [RUN]
[0m07:19:20.254284 [info ] [Thread-3 (]: 3 of 9 OK snapshotted silver.dim_customers_snapshot ............................ [[32mSELECT 902[0m in 3.43s]
[0m07:19:20.254797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.dim_categories_snapshot, now snapshot.retail_dbt.dim_loyalty_programs_snapshot)
[0m07:19:20.255422 [debug] [Thread-3 (]: Finished running node snapshot.retail_dbt.dim_customers_snapshot
[0m07:19:20.255880 [debug] [Thread-2 (]: Began compiling node snapshot.retail_dbt.dim_loyalty_programs_snapshot
[0m07:19:20.256421 [debug] [Thread-3 (]: Began running node snapshot.retail_dbt.dim_products_snapshot
[0m07:19:20.259662 [debug] [Thread-2 (]: Began executing node snapshot.retail_dbt.dim_loyalty_programs_snapshot
[0m07:19:20.260135 [info ] [Thread-3 (]: 6 of 9 START snapshot silver.dim_products_snapshot ............................. [RUN]
[0m07:19:20.263709 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_loyalty_programs_snapshot"
[0m07:19:20.264108 [debug] [Thread-1 (]: SQL status: SELECT 0 in 3.323 seconds
[0m07:19:20.264566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.dim_customers_snapshot, now snapshot.retail_dbt.dim_products_snapshot)
[0m07:19:20.264981 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_loyalty_programs_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(loyalty_program_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

-- Bảng này trong danh sách của bạn là 'loyalty_programs' (không có _silver)
select * from "postgres"."silver"."loyalty_programs_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:20.265666 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_brands_snapshot"
[0m07:19:20.266067 [debug] [Thread-3 (]: Began compiling node snapshot.retail_dbt.dim_products_snapshot
[0m07:19:20.266492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:19:20.266888 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_brands_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:20.310024 [debug] [Thread-3 (]: Began executing node snapshot.retail_dbt.dim_products_snapshot
[0m07:19:20.313981 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_products_snapshot"
[0m07:19:20.314356 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_products_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."products_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:20.314705 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:19:20.316637 [debug] [Thread-4 (]: SQL status: COMMIT in 0.248 seconds
[0m07:19:20.317314 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_employees_snapshot: Close
[0m07:19:20.317919 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336245112e0>]}
[0m07:19:20.318526 [info ] [Thread-4 (]: 4 of 9 OK snapshotted silver.dim_employees_snapshot ............................ [[32mSELECT 200[0m in 3.49s]
[0m07:19:20.319034 [debug] [Thread-4 (]: Finished running node snapshot.retail_dbt.dim_employees_snapshot
[0m07:19:20.319387 [debug] [Thread-4 (]: Began running node snapshot.retail_dbt.dim_promotions_snapshot
[0m07:19:20.319826 [info ] [Thread-4 (]: 7 of 9 START snapshot silver.dim_promotions_snapshot ........................... [RUN]
[0m07:19:20.320207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.dim_employees_snapshot, now snapshot.retail_dbt.dim_promotions_snapshot)
[0m07:19:20.320534 [debug] [Thread-4 (]: Began compiling node snapshot.retail_dbt.dim_promotions_snapshot
[0m07:19:20.323061 [debug] [Thread-4 (]: Began executing node snapshot.retail_dbt.dim_promotions_snapshot
[0m07:19:20.325659 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_promotions_snapshot"
[0m07:19:20.325962 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_promotions_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(promotion_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."promotions_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:20.326275 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:19:20.547358 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.237 seconds
[0m07:19:20.548043 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_brands_snapshot"
[0m07:19:20.548608 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_brands_snapshot"
[0m07:19:20.548945 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: BEGIN
[0m07:19:20.776602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m07:19:20.777075 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_brands_snapshot"
[0m07:19:20.777416 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_brands_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_brands_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(brand_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."brands_silver"
    ) sbq



  );
  
  
[0m07:19:21.003165 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.225 seconds
[0m07:19:21.004541 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: COMMIT
[0m07:19:21.004923 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_brands_snapshot"
[0m07:19:21.005217 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: COMMIT
[0m07:19:21.230467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.225 seconds
[0m07:19:21.231245 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_brands_snapshot: Close
[0m07:19:21.231930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733620250650>]}
[0m07:19:21.232547 [info ] [Thread-1 (]: 1 of 9 OK snapshotted silver.dim_brands_snapshot ............................... [[32mSELECT 10[0m in 4.41s]
[0m07:19:21.233052 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.dim_brands_snapshot
[0m07:19:21.233402 [debug] [Thread-1 (]: Began running node snapshot.retail_dbt.dim_stores_snapshot
[0m07:19:21.233834 [info ] [Thread-1 (]: 8 of 9 START snapshot silver.dim_stores_snapshot ............................... [RUN]
[0m07:19:21.234225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.dim_brands_snapshot, now snapshot.retail_dbt.dim_stores_snapshot)
[0m07:19:21.234527 [debug] [Thread-1 (]: Began compiling node snapshot.retail_dbt.dim_stores_snapshot
[0m07:19:21.237088 [debug] [Thread-1 (]: Began executing node snapshot.retail_dbt.dim_stores_snapshot
[0m07:19:21.239461 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_stores_snapshot"
[0m07:19:21.239805 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_stores_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."stores_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:21.240156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:22.344169 [debug] [Thread-4 (]: SQL status: SELECT 0 in 2.018 seconds
[0m07:19:22.344936 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_promotions_snapshot"
[0m07:19:22.345260 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_promotions_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:22.345960 [debug] [Thread-3 (]: SQL status: SELECT 0 in 2.031 seconds
[0m07:19:22.346607 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_products_snapshot"
[0m07:19:22.346905 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_products_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:22.565679 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.220 seconds
[0m07:19:22.566218 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_promotions_snapshot"
[0m07:19:22.566755 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_promotions_snapshot"
[0m07:19:22.567052 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: BEGIN
[0m07:19:22.568626 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.221 seconds
[0m07:19:22.569075 [debug] [Thread-3 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_products_snapshot"
[0m07:19:22.569583 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_products_snapshot"
[0m07:19:22.569905 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: BEGIN
[0m07:19:22.720002 [debug] [Thread-2 (]: SQL status: SELECT 0 in 2.453 seconds
[0m07:19:22.720727 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_loyalty_programs_snapshot"
[0m07:19:22.721070 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_loyalty_programs_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:22.788697 [debug] [Thread-4 (]: SQL status: BEGIN in 0.221 seconds
[0m07:19:22.789057 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_promotions_snapshot"
[0m07:19:22.789403 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_promotions_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_promotions_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(promotion_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."promotions_silver"
    ) sbq



  );
  
  
[0m07:19:22.791134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.221 seconds
[0m07:19:22.791432 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_products_snapshot"
[0m07:19:22.791777 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_products_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_products_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(product_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."products_silver"
    ) sbq



  );
  
  
[0m07:19:22.997952 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.276 seconds
[0m07:19:22.998596 [debug] [Thread-2 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_loyalty_programs_snapshot"
[0m07:19:22.999117 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_loyalty_programs_snapshot"
[0m07:19:22.999411 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: BEGIN
[0m07:19:23.010785 [debug] [Thread-4 (]: SQL status: SELECT 248 in 0.221 seconds
[0m07:19:23.011940 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: COMMIT
[0m07:19:23.012267 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_promotions_snapshot"
[0m07:19:23.012554 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: COMMIT
[0m07:19:23.014373 [debug] [Thread-3 (]: SQL status: SELECT 400 in 0.222 seconds
[0m07:19:23.015348 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: COMMIT
[0m07:19:23.015651 [debug] [Thread-3 (]: Using postgres connection "snapshot.retail_dbt.dim_products_snapshot"
[0m07:19:23.016003 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: COMMIT
[0m07:19:23.232523 [debug] [Thread-4 (]: SQL status: COMMIT in 0.220 seconds
[0m07:19:23.234393 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_promotions_snapshot: Close
[0m07:19:23.234977 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733620103d70>]}
[0m07:19:23.235596 [info ] [Thread-4 (]: 7 of 9 OK snapshotted silver.dim_promotions_snapshot ........................... [[32mSELECT 248[0m in 2.91s]
[0m07:19:23.236177 [debug] [Thread-4 (]: Finished running node snapshot.retail_dbt.dim_promotions_snapshot
[0m07:19:23.236514 [debug] [Thread-4 (]: Began running node snapshot.retail_dbt.dim_suppliers_snapshot
[0m07:19:23.236958 [info ] [Thread-4 (]: 9 of 9 START snapshot silver.dim_suppliers_snapshot ............................ [RUN]
[0m07:19:23.237352 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.retail_dbt.dim_promotions_snapshot, now snapshot.retail_dbt.dim_suppliers_snapshot)
[0m07:19:23.237679 [debug] [Thread-4 (]: Began compiling node snapshot.retail_dbt.dim_suppliers_snapshot
[0m07:19:23.240088 [debug] [Thread-4 (]: Began executing node snapshot.retail_dbt.dim_suppliers_snapshot
[0m07:19:23.242488 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_suppliers_snapshot"
[0m07:19:23.242809 [debug] [Thread-3 (]: SQL status: COMMIT in 0.226 seconds
[0m07:19:23.243211 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_suppliers_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(supplier_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."suppliers_silver"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:23.243961 [debug] [Thread-3 (]: On snapshot.retail_dbt.dim_products_snapshot: Close
[0m07:19:23.244396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:19:23.245057 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733622016930>]}
[0m07:19:23.245708 [info ] [Thread-3 (]: 6 of 9 OK snapshotted silver.dim_products_snapshot ............................. [[32mSELECT 400[0m in 2.98s]
[0m07:19:23.246466 [debug] [Thread-3 (]: Finished running node snapshot.retail_dbt.dim_products_snapshot
[0m07:19:23.278366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.279 seconds
[0m07:19:23.278716 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_loyalty_programs_snapshot"
[0m07:19:23.279079 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_loyalty_programs_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_loyalty_programs_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(loyalty_program_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

-- Bảng này trong danh sách của bạn là 'loyalty_programs' (không có _silver)
select * from "postgres"."silver"."loyalty_programs_silver"
    ) sbq



  );
  
  
[0m07:19:23.536804 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.257 seconds
[0m07:19:23.537935 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: COMMIT
[0m07:19:23.538246 [debug] [Thread-2 (]: Using postgres connection "snapshot.retail_dbt.dim_loyalty_programs_snapshot"
[0m07:19:23.538554 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: COMMIT
[0m07:19:23.802454 [debug] [Thread-2 (]: SQL status: COMMIT in 0.264 seconds
[0m07:19:23.803174 [debug] [Thread-2 (]: On snapshot.retail_dbt.dim_loyalty_programs_snapshot: Close
[0m07:19:23.803773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336202e7d40>]}
[0m07:19:23.804443 [info ] [Thread-2 (]: 5 of 9 OK snapshotted silver.dim_loyalty_programs_snapshot ..................... [[32mSELECT 5[0m in 3.55s]
[0m07:19:23.804952 [debug] [Thread-2 (]: Finished running node snapshot.retail_dbt.dim_loyalty_programs_snapshot
[0m07:19:23.826446 [debug] [Thread-1 (]: SQL status: SELECT 0 in 2.586 seconds
[0m07:19:23.827113 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_stores_snapshot"
[0m07:19:23.827416 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_stores_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:24.045641 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.218 seconds
[0m07:19:24.046166 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_stores_snapshot"
[0m07:19:24.046709 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_stores_snapshot"
[0m07:19:24.047001 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: BEGIN
[0m07:19:24.267821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.220 seconds
[0m07:19:24.268371 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_stores_snapshot"
[0m07:19:24.268736 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_stores_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_stores_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(store_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."stores_silver"
    ) sbq



  );
  
  
[0m07:19:24.490179 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.221 seconds
[0m07:19:24.492192 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: COMMIT
[0m07:19:24.492621 [debug] [Thread-1 (]: Using postgres connection "snapshot.retail_dbt.dim_stores_snapshot"
[0m07:19:24.492962 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: COMMIT
[0m07:19:24.739403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.246 seconds
[0m07:19:24.740375 [debug] [Thread-1 (]: On snapshot.retail_dbt.dim_stores_snapshot: Close
[0m07:19:24.741448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733620257b60>]}
[0m07:19:24.742483 [info ] [Thread-1 (]: 8 of 9 OK snapshotted silver.dim_stores_snapshot ............................... [[32mSELECT 20[0m in 3.51s]
[0m07:19:24.743328 [debug] [Thread-1 (]: Finished running node snapshot.retail_dbt.dim_stores_snapshot
[0m07:19:25.729554 [debug] [Thread-4 (]: SQL status: SELECT 0 in 2.485 seconds
[0m07:19:25.730508 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_suppliers_snapshot"
[0m07:19:25.730959 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_suppliers_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m07:19:25.971349 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.240 seconds
[0m07:19:25.972072 [debug] [Thread-4 (]: Writing runtime sql for node "snapshot.retail_dbt.dim_suppliers_snapshot"
[0m07:19:25.972762 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_suppliers_snapshot"
[0m07:19:25.973191 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: BEGIN
[0m07:19:26.207308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.234 seconds
[0m07:19:26.207835 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_suppliers_snapshot"
[0m07:19:26.208312 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "snapshot.retail_dbt.dim_suppliers_snapshot"} */

      
  
    

  create  table "postgres"."silver"."dim_suppliers_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(supplier_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        

select * from "postgres"."silver"."suppliers_silver"
    ) sbq



  );
  
  
[0m07:19:26.441585 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.233 seconds
[0m07:19:26.443110 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: COMMIT
[0m07:19:26.443581 [debug] [Thread-4 (]: Using postgres connection "snapshot.retail_dbt.dim_suppliers_snapshot"
[0m07:19:26.443998 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: COMMIT
[0m07:19:26.678162 [debug] [Thread-4 (]: SQL status: COMMIT in 0.234 seconds
[0m07:19:26.679049 [debug] [Thread-4 (]: On snapshot.retail_dbt.dim_suppliers_snapshot: Close
[0m07:19:26.679792 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c707b709-e4e4-43c8-b6b2-eae3a215d9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7336202b64b0>]}
[0m07:19:26.680548 [info ] [Thread-4 (]: 9 of 9 OK snapshotted silver.dim_suppliers_snapshot ............................ [[32mSELECT 10[0m in 3.44s]
[0m07:19:26.681263 [debug] [Thread-4 (]: Finished running node snapshot.retail_dbt.dim_suppliers_snapshot
[0m07:19:26.683123 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:26.683529 [debug] [MainThread]: On master: BEGIN
[0m07:19:26.683895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:19:31.040662 [debug] [MainThread]: SQL status: BEGIN in 2.444 seconds
[0m07:19:31.041053 [debug] [MainThread]: On master: COMMIT
[0m07:19:31.041387 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:31.041654 [debug] [MainThread]: On master: COMMIT
[0m07:19:31.267178 [debug] [MainThread]: SQL status: COMMIT in 0.225 seconds
[0m07:19:31.267558 [debug] [MainThread]: On master: Close
[0m07:19:31.268199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:19:31.268498 [debug] [MainThread]: Connection 'snapshot.retail_dbt.dim_loyalty_programs_snapshot' was properly closed.
[0m07:19:31.268786 [debug] [MainThread]: Connection 'snapshot.retail_dbt.dim_stores_snapshot' was properly closed.
[0m07:19:31.269020 [debug] [MainThread]: Connection 'snapshot.retail_dbt.dim_products_snapshot' was properly closed.
[0m07:19:31.269293 [debug] [MainThread]: Connection 'snapshot.retail_dbt.dim_suppliers_snapshot' was properly closed.
[0m07:19:31.269576 [info ] [MainThread]: 
[0m07:19:31.269934 [info ] [MainThread]: Finished running 9 snapshots in 0 hours 0 minutes and 26.47 seconds (26.47s).
[0m07:19:31.271395 [debug] [MainThread]: Command end result
[0m07:19:31.362456 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:19:31.364890 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:19:31.369231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:19:31.369525 [info ] [MainThread]: 
[0m07:19:31.369888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:19:31.370166 [info ] [MainThread]: 
[0m07:19:31.370498 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m07:19:31.371281 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 25.0749, "process_in_blocks": "0", "process_kernel_time": 0.319324, "process_mem_max_rss": "141680", "process_out_blocks": "9576", "process_user_time": 2.666563}
[0m07:19:31.371655 [debug] [MainThread]: Command `dbt snapshot` succeeded at 07:19:31.371581 after 25.08 seconds
[0m07:19:31.371961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73362642a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73362584db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733622936120>]}
[0m07:19:31.372293 [debug] [MainThread]: Flushing usage events
[0m07:19:32.590408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:19:35.521577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09f925e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d5e6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d38a930>]}


============================== 07:19:35.528098 | 678678b4-34aa-4ee4-bc54-749aa86ea9a4 ==============================
[0m07:19:35.528098 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:19:35.528627 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/home/airflow/.dbt', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt run --select path:models/golden --full-refresh --profiles-dir /home/airflow/.dbt', 'no_print': 'None'}
[0m07:19:35.672554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09bd45640>]}
[0m07:19:35.723158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d7209e0>]}
[0m07:19:35.723953 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:19:35.822333 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:19:35.972660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:19:35.973038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:19:36.028867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09b9af6e0>]}
[0m07:19:36.220635 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:19:36.223175 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:19:36.260465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09c9f8ec0>]}
[0m07:19:36.260898 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:19:36.261276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09a0eb260>]}
[0m07:19:36.271364 [info ] [MainThread]: 
[0m07:19:36.271709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:19:36.272006 [info ] [MainThread]: 
[0m07:19:36.272471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:19:36.276468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m07:19:36.306116 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:19:36.306434 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:19:36.306726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:38.807538 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.501 seconds
[0m07:19:38.808711 [debug] [ThreadPool]: On list_postgres: Close
[0m07:19:38.809481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_silver_to_golden)
[0m07:19:38.809958 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "silver_to_golden"
"
[0m07:19:38.814130 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_to_golden"
[0m07:19:38.814397 [debug] [ThreadPool]: On create_postgres_silver_to_golden: BEGIN
[0m07:19:38.814681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:41.163892 [debug] [ThreadPool]: SQL status: BEGIN in 2.349 seconds
[0m07:19:41.164399 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_to_golden"
[0m07:19:41.164661 [debug] [ThreadPool]: On create_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_postgres_silver_to_golden"} */
create schema if not exists "silver_to_golden"
[0m07:19:41.431851 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.267 seconds
[0m07:19:41.432713 [debug] [ThreadPool]: On create_postgres_silver_to_golden: COMMIT
[0m07:19:41.433010 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_to_golden"
[0m07:19:41.433265 [debug] [ThreadPool]: On create_postgres_silver_to_golden: COMMIT
[0m07:19:41.697667 [debug] [ThreadPool]: SQL status: COMMIT in 0.264 seconds
[0m07:19:41.698093 [debug] [ThreadPool]: On create_postgres_silver_to_golden: Close
[0m07:19:41.703774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_silver_to_golden, now list_postgres_silver_staging)
[0m07:19:41.708416 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:19:41.708839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m07:19:41.709154 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:19:41.709764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m07:19:41.711365 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:19:41.711964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:19:41.712366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:41.713917 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:19:41.714262 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:19:41.715717 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:19:41.716199 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:19:41.716519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:41.716885 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:19:41.717185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:41.717707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:47.440319 [debug] [ThreadPool]: SQL status: BEGIN in 4.912 seconds
[0m07:19:47.440775 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:19:47.441146 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:19:47.463063 [debug] [ThreadPool]: SQL status: BEGIN in 4.936 seconds
[0m07:19:47.463490 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:19:47.463872 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:19:47.670675 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.229 seconds
[0m07:19:47.672168 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:19:47.693150 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.229 seconds
[0m07:19:47.695034 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:19:47.706452 [debug] [ThreadPool]: SQL status: BEGIN in 5.183 seconds
[0m07:19:47.706841 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:19:47.707217 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:19:47.721615 [debug] [ThreadPool]: SQL status: BEGIN in 5.194 seconds
[0m07:19:47.722026 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:19:47.722432 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:19:47.892074 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:19:47.916804 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:19:47.967476 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.260 seconds
[0m07:19:47.968786 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:19:47.978317 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.255 seconds
[0m07:19:47.979539 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:19:48.218575 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:19:48.232613 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:19:48.244049 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:48.244513 [debug] [MainThread]: On master: BEGIN
[0m07:19:48.244885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:19:50.545830 [debug] [MainThread]: SQL status: BEGIN in 2.301 seconds
[0m07:19:50.546225 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:50.546573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:19:50.777463 [debug] [MainThread]: SQL status: SELECT 40 in 0.230 seconds
[0m07:19:50.779147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09a0cfe00>]}
[0m07:19:50.779585 [debug] [MainThread]: On master: ROLLBACK
[0m07:19:50.999829 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:51.000277 [debug] [MainThread]: On master: BEGIN
[0m07:19:51.440992 [debug] [MainThread]: SQL status: BEGIN in 0.440 seconds
[0m07:19:51.441360 [debug] [MainThread]: On master: COMMIT
[0m07:19:51.441696 [debug] [MainThread]: Using postgres connection "master"
[0m07:19:51.442002 [debug] [MainThread]: On master: COMMIT
[0m07:19:51.680720 [debug] [MainThread]: SQL status: COMMIT in 0.238 seconds
[0m07:19:51.681113 [debug] [MainThread]: On master: Close
[0m07:19:51.685263 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_brands_scd
[0m07:19:51.685641 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_campaigns
[0m07:19:51.686681 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_categories_scd
[0m07:19:51.686292 [info ] [Thread-1 (]: 1 of 23 START sql table model silver_to_golden.dim_brands_scd .................. [RUN]
[0m07:19:51.687752 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_customers_scd
[0m07:19:51.687418 [info ] [Thread-2 (]: 2 of 23 START sql table model silver_to_golden.dim_campaigns ................... [RUN]
[0m07:19:51.688328 [info ] [Thread-3 (]: 3 of 23 START sql table model silver_to_golden.dim_categories_scd .............. [RUN]
[0m07:19:51.688819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now model.retail_dbt.dim_brands_scd)
[0m07:19:51.689280 [info ] [Thread-4 (]: 4 of 23 START sql table model silver_to_golden.dim_customers_scd ............... [RUN]
[0m07:19:51.689731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now model.retail_dbt.dim_campaigns)
[0m07:19:51.690173 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now model.retail_dbt.dim_categories_scd)
[0m07:19:51.690581 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_brands_scd
[0m07:19:51.691021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now model.retail_dbt.dim_customers_scd)
[0m07:19:51.691460 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_campaigns
[0m07:19:51.691825 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_categories_scd
[0m07:19:51.697816 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_brands_scd"
[0m07:19:51.698162 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_customers_scd
[0m07:19:51.700813 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_campaigns"
[0m07:19:51.703209 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_categories_scd"
[0m07:19:51.705555 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_customers_scd"
[0m07:19:51.706192 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_brands_scd
[0m07:19:51.717191 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_campaigns
[0m07:19:51.722720 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_customers_scd
[0m07:19:51.742963 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_brands_scd"
[0m07:19:51.745929 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_campaigns"
[0m07:19:51.746254 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_categories_scd
[0m07:19:51.748502 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_customers_scd"
[0m07:19:51.751086 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_categories_scd"
[0m07:19:51.751604 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_brands_scd"
[0m07:19:51.752534 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: BEGIN
[0m07:19:51.753036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:51.753479 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_campaigns"
[0m07:19:51.754048 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_customers_scd"
[0m07:19:51.754439 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_categories_scd"
[0m07:19:51.754893 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: BEGIN
[0m07:19:51.755330 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: BEGIN
[0m07:19:51.755841 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: BEGIN
[0m07:19:51.756253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:19:51.756704 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:19:51.757105 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:19:53.962230 [debug] [Thread-1 (]: SQL status: BEGIN in 2.209 seconds
[0m07:19:53.962756 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_brands_scd"
[0m07:19:53.963170 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_brands_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_brands_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as brand_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_brands_snapshot"
  );
  
[0m07:19:54.207368 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.244 seconds
[0m07:19:54.215099 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_brands_scd"
[0m07:19:54.215512 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_brands_scd"} */
alter table "postgres"."silver_to_golden"."dim_brands_scd__dbt_tmp" rename to "dim_brands_scd"
[0m07:19:54.257189 [debug] [Thread-3 (]: SQL status: BEGIN in 2.500 seconds
[0m07:19:54.257702 [debug] [Thread-4 (]: SQL status: BEGIN in 2.501 seconds
[0m07:19:54.258095 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_categories_scd"
[0m07:19:54.258494 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_customers_scd"
[0m07:19:54.258902 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_categories_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_categories_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as category_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_categories_snapshot"
  );
  
[0m07:19:54.259351 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customers_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_customers_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as customer_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_customers_snapshot"
  );
  
[0m07:19:54.260944 [debug] [Thread-2 (]: SQL status: BEGIN in 2.505 seconds
[0m07:19:54.261268 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_campaigns"
[0m07:19:54.261627 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_campaigns"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_campaigns__dbt_tmp"
  
  
    as
  
  (
    
select * from "postgres"."silver"."campaigns_silver"
  );
  
[0m07:19:54.464949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.249 seconds
[0m07:19:54.476084 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: COMMIT
[0m07:19:54.476455 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_brands_scd"
[0m07:19:54.476761 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: COMMIT
[0m07:19:54.540780 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.281 seconds
[0m07:19:54.541245 [debug] [Thread-4 (]: SQL status: SELECT 902 in 0.281 seconds
[0m07:19:54.544135 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_categories_scd"
[0m07:19:54.544532 [debug] [Thread-2 (]: SQL status: SELECT 177 in 0.283 seconds
[0m07:19:54.547579 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_customers_scd"
[0m07:19:54.548019 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_categories_scd"} */
alter table "postgres"."silver_to_golden"."dim_categories_scd__dbt_tmp" rename to "dim_categories_scd"
[0m07:19:54.593398 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_campaigns"
[0m07:19:54.593912 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customers_scd"} */
alter table "postgres"."silver_to_golden"."dim_customers_scd__dbt_tmp" rename to "dim_customers_scd"
[0m07:19:54.594460 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_campaigns"} */
alter table "postgres"."silver_to_golden"."dim_campaigns__dbt_tmp" rename to "dim_campaigns"
[0m07:19:54.733628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.256 seconds
[0m07:19:54.739150 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_brands_scd__dbt_backup"
[0m07:19:54.743419 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_brands_scd"
[0m07:19:54.743793 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_brands_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_brands_scd__dbt_backup" cascade
[0m07:19:54.871811 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.277 seconds
[0m07:19:54.873174 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: COMMIT
[0m07:19:54.873568 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_customers_scd"
[0m07:19:54.873917 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: COMMIT
[0m07:19:54.875327 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.280 seconds
[0m07:19:54.876497 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: COMMIT
[0m07:19:54.876838 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_campaigns"
[0m07:19:54.877205 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: COMMIT
[0m07:19:54.882924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.288 seconds
[0m07:19:54.883977 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: COMMIT
[0m07:19:54.884305 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_categories_scd"
[0m07:19:54.884662 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: COMMIT
[0m07:19:54.990658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.246 seconds
[0m07:19:54.993038 [debug] [Thread-1 (]: On model.retail_dbt.dim_brands_scd: Close
[0m07:19:54.994512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09a069bb0>]}
[0m07:19:54.995078 [info ] [Thread-1 (]: 1 of 23 OK created sql table model silver_to_golden.dim_brands_scd ............. [[32mSELECT 10[0m in 3.30s]
[0m07:19:54.995632 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_brands_scd
[0m07:19:54.996048 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_discount_rules
[0m07:19:54.996580 [info ] [Thread-1 (]: 5 of 23 START sql table model silver_to_golden.dim_discount_rules .............. [RUN]
[0m07:19:54.997060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_brands_scd, now model.retail_dbt.dim_discount_rules)
[0m07:19:54.997518 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_discount_rules
[0m07:19:55.000728 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_discount_rules"
[0m07:19:55.001256 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_discount_rules
[0m07:19:55.004052 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_discount_rules"
[0m07:19:55.004559 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_discount_rules"
[0m07:19:55.004869 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: BEGIN
[0m07:19:55.005167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:55.165767 [debug] [Thread-4 (]: SQL status: COMMIT in 0.291 seconds
[0m07:19:55.166217 [debug] [Thread-2 (]: SQL status: COMMIT in 0.289 seconds
[0m07:19:55.168539 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_customers_scd__dbt_backup"
[0m07:19:55.170588 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_campaigns__dbt_backup"
[0m07:19:55.171263 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_customers_scd"
[0m07:19:55.171780 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_campaigns"
[0m07:19:55.172146 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_customers_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_customers_scd__dbt_backup" cascade
[0m07:19:55.172519 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_campaigns"} */
drop table if exists "postgres"."silver_to_golden"."dim_campaigns__dbt_backup" cascade
[0m07:19:55.175486 [debug] [Thread-3 (]: SQL status: COMMIT in 0.290 seconds
[0m07:19:55.178325 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_categories_scd__dbt_backup"
[0m07:19:55.178860 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_categories_scd"
[0m07:19:55.179231 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_categories_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_categories_scd__dbt_backup" cascade
[0m07:19:55.455236 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.282 seconds
[0m07:19:55.455781 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.276 seconds
[0m07:19:55.457047 [debug] [Thread-4 (]: On model.retail_dbt.dim_customers_scd: Close
[0m07:19:55.457437 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.284 seconds
[0m07:19:55.458649 [debug] [Thread-3 (]: On model.retail_dbt.dim_categories_scd: Close
[0m07:19:55.459926 [debug] [Thread-2 (]: On model.retail_dbt.dim_campaigns: Close
[0m07:19:55.460478 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af099ec3080>]}
[0m07:19:55.461718 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af098d5f080>]}
[0m07:19:55.461292 [info ] [Thread-4 (]: 4 of 23 OK created sql table model silver_to_golden.dim_customers_scd .......... [[32mSELECT 902[0m in 3.77s]
[0m07:19:55.462288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af099eb64b0>]}
[0m07:19:55.462868 [info ] [Thread-3 (]: 3 of 23 OK created sql table model silver_to_golden.dim_categories_scd ......... [[32mSELECT 10[0m in 3.77s]
[0m07:19:55.463535 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_customers_scd
[0m07:19:55.464164 [info ] [Thread-2 (]: 2 of 23 OK created sql table model silver_to_golden.dim_campaigns .............. [[32mSELECT 177[0m in 3.77s]
[0m07:19:55.464899 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_categories_scd
[0m07:19:55.465440 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_employees_scd
[0m07:19:55.466149 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_campaigns
[0m07:19:55.466610 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_loyalty_programs_scd
[0m07:19:55.467170 [info ] [Thread-4 (]: 6 of 23 START sql table model silver_to_golden.dim_employees_scd ............... [RUN]
[0m07:19:55.467757 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_products_scd
[0m07:19:55.468336 [info ] [Thread-3 (]: 7 of 23 START sql table model silver_to_golden.dim_loyalty_programs_scd ........ [RUN]
[0m07:19:55.468794 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_customers_scd, now model.retail_dbt.dim_employees_scd)
[0m07:19:55.469219 [info ] [Thread-2 (]: 8 of 23 START sql table model silver_to_golden.dim_products_scd ................ [RUN]
[0m07:19:55.469703 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_categories_scd, now model.retail_dbt.dim_loyalty_programs_scd)
[0m07:19:55.470133 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_employees_scd
[0m07:19:55.470499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_campaigns, now model.retail_dbt.dim_products_scd)
[0m07:19:55.470901 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_loyalty_programs_scd
[0m07:19:55.473660 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_employees_scd"
[0m07:19:55.474073 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_products_scd
[0m07:19:55.476413 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:55.479033 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_products_scd"
[0m07:19:55.479764 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_employees_scd
[0m07:19:55.482878 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_employees_scd"
[0m07:19:55.483438 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_loyalty_programs_scd
[0m07:19:55.486316 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:55.486772 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_products_scd
[0m07:19:55.489482 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_products_scd"
[0m07:19:55.489904 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_employees_scd"
[0m07:19:55.490478 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: BEGIN
[0m07:19:55.490902 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:55.491316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:19:55.491772 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_products_scd"
[0m07:19:55.492948 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: BEGIN
[0m07:19:55.493475 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: BEGIN
[0m07:19:55.493877 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:19:55.494315 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:19:57.425634 [debug] [Thread-1 (]: SQL status: BEGIN in 2.420 seconds
[0m07:19:57.426063 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_discount_rules"
[0m07:19:57.426563 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_discount_rules"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_discount_rules__dbt_tmp"
  
  
    as
  
  (
    
select * from "postgres"."silver"."discount_rules_silver"
  );
  
[0m07:19:57.601134 [debug] [Thread-3 (]: SQL status: BEGIN in 2.107 seconds
[0m07:19:57.601584 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:57.601885 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_loyalty_programs_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_loyalty_programs_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as loyalty_program_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_loyalty_programs_snapshot"
  );
  
[0m07:19:57.679257 [debug] [Thread-1 (]: SQL status: SELECT 454 in 0.252 seconds
[0m07:19:57.681839 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_discount_rules"
[0m07:19:57.682163 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_discount_rules"} */
alter table "postgres"."silver_to_golden"."dim_discount_rules__dbt_tmp" rename to "dim_discount_rules"
[0m07:19:57.818644 [debug] [Thread-2 (]: SQL status: BEGIN in 2.324 seconds
[0m07:19:57.819122 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_products_scd"
[0m07:19:57.819434 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_products_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_products_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as product_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_products_snapshot"
  );
  
[0m07:19:57.831370 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.229 seconds
[0m07:19:57.833945 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:57.834247 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_loyalty_programs_scd"} */
alter table "postgres"."silver_to_golden"."dim_loyalty_programs_scd__dbt_tmp" rename to "dim_loyalty_programs_scd"
[0m07:19:57.931852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.249 seconds
[0m07:19:57.932835 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: COMMIT
[0m07:19:57.933141 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_discount_rules"
[0m07:19:57.933431 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: COMMIT
[0m07:19:58.077660 [debug] [Thread-2 (]: SQL status: SELECT 400 in 0.258 seconds
[0m07:19:58.080316 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_products_scd"
[0m07:19:58.080614 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_products_scd"} */
alter table "postgres"."silver_to_golden"."dim_products_scd__dbt_tmp" rename to "dim_products_scd"
[0m07:19:58.190147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.256 seconds
[0m07:19:58.192353 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_discount_rules__dbt_backup"
[0m07:19:58.192843 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_discount_rules"
[0m07:19:58.193140 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_discount_rules"} */
drop table if exists "postgres"."silver_to_golden"."dim_discount_rules__dbt_backup" cascade
[0m07:19:58.339088 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.258 seconds
[0m07:19:58.340315 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: COMMIT
[0m07:19:58.340776 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_products_scd"
[0m07:19:58.341140 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: COMMIT
[0m07:19:58.444142 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.251 seconds
[0m07:19:58.445468 [debug] [Thread-1 (]: On model.retail_dbt.dim_discount_rules: Close
[0m07:19:58.446088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af098d26bd0>]}
[0m07:19:58.446578 [info ] [Thread-1 (]: 5 of 23 OK created sql table model silver_to_golden.dim_discount_rules ......... [[32mSELECT 454[0m in 3.45s]
[0m07:19:58.447105 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_discount_rules
[0m07:19:58.447436 [debug] [Thread-1 (]: Began running node model.retail_dbt.dim_promotions_scd
[0m07:19:58.447930 [info ] [Thread-1 (]: 9 of 23 START sql table model silver_to_golden.dim_promotions_scd .............. [RUN]
[0m07:19:58.448308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_discount_rules, now model.retail_dbt.dim_promotions_scd)
[0m07:19:58.448632 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.dim_promotions_scd
[0m07:19:58.451159 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.dim_promotions_scd"
[0m07:19:58.451636 [debug] [Thread-1 (]: Began executing node model.retail_dbt.dim_promotions_scd
[0m07:19:58.454099 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.dim_promotions_scd"
[0m07:19:58.454591 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_promotions_scd"
[0m07:19:58.454934 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: BEGIN
[0m07:19:58.455204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:19:58.511188 [debug] [Thread-4 (]: SQL status: BEGIN in 3.020 seconds
[0m07:19:58.511595 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_employees_scd"
[0m07:19:58.511939 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_employees_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_employees_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as employee_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_employees_snapshot"
  );
  
[0m07:19:58.518172 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.684 seconds
[0m07:19:58.519429 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: COMMIT
[0m07:19:58.519746 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:58.520065 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: COMMIT
[0m07:19:58.595101 [debug] [Thread-2 (]: SQL status: COMMIT in 0.254 seconds
[0m07:19:58.598212 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_products_scd__dbt_backup"
[0m07:19:58.598653 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_products_scd"
[0m07:19:58.599015 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_products_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_products_scd__dbt_backup" cascade
[0m07:19:58.753334 [debug] [Thread-3 (]: SQL status: COMMIT in 0.233 seconds
[0m07:19:58.755449 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_loyalty_programs_scd__dbt_backup"
[0m07:19:58.755913 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_loyalty_programs_scd"
[0m07:19:58.756228 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_loyalty_programs_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_loyalty_programs_scd__dbt_backup" cascade
[0m07:19:58.769839 [debug] [Thread-4 (]: SQL status: SELECT 200 in 0.258 seconds
[0m07:19:58.772334 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_employees_scd"
[0m07:19:58.772886 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_employees_scd"} */
alter table "postgres"."silver_to_golden"."dim_employees_scd__dbt_tmp" rename to "dim_employees_scd"
[0m07:19:58.852963 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.254 seconds
[0m07:19:58.854025 [debug] [Thread-2 (]: On model.retail_dbt.dim_products_scd: Close
[0m07:19:58.854576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af098332570>]}
[0m07:19:58.855092 [info ] [Thread-2 (]: 8 of 23 OK created sql table model silver_to_golden.dim_products_scd ........... [[32mSELECT 400[0m in 3.38s]
[0m07:19:58.855595 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_products_scd
[0m07:19:58.855943 [debug] [Thread-2 (]: Began running node model.retail_dbt.dim_stores_scd
[0m07:19:58.856407 [info ] [Thread-2 (]: 10 of 23 START sql table model silver_to_golden.dim_stores_scd ................. [RUN]
[0m07:19:58.856771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_products_scd, now model.retail_dbt.dim_stores_scd)
[0m07:19:58.857099 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.dim_stores_scd
[0m07:19:58.859576 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.dim_stores_scd"
[0m07:19:58.860067 [debug] [Thread-2 (]: Began executing node model.retail_dbt.dim_stores_scd
[0m07:19:58.862507 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.dim_stores_scd"
[0m07:19:58.862974 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_stores_scd"
[0m07:19:58.863296 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: BEGIN
[0m07:19:58.863607 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:19:58.985849 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.229 seconds
[0m07:19:58.987176 [debug] [Thread-3 (]: On model.retail_dbt.dim_loyalty_programs_scd: Close
[0m07:19:58.987800 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0984b7da0>]}
[0m07:19:58.988299 [info ] [Thread-3 (]: 7 of 23 OK created sql table model silver_to_golden.dim_loyalty_programs_scd ... [[32mSELECT 5[0m in 3.52s]
[0m07:19:58.988819 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_loyalty_programs_scd
[0m07:19:58.989159 [debug] [Thread-3 (]: Began running node model.retail_dbt.dim_suppliers_scd
[0m07:19:58.989597 [info ] [Thread-3 (]: 11 of 23 START sql table model silver_to_golden.dim_suppliers_scd .............. [RUN]
[0m07:19:58.989981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_loyalty_programs_scd, now model.retail_dbt.dim_suppliers_scd)
[0m07:19:58.990301 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.dim_suppliers_scd
[0m07:19:58.992818 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.dim_suppliers_scd"
[0m07:19:58.993279 [debug] [Thread-3 (]: Began executing node model.retail_dbt.dim_suppliers_scd
[0m07:19:58.995856 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.dim_suppliers_scd"
[0m07:19:58.996334 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_suppliers_scd"
[0m07:19:58.996653 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: BEGIN
[0m07:19:58.996952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:19:59.025856 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.253 seconds
[0m07:19:59.027104 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: COMMIT
[0m07:19:59.027437 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_employees_scd"
[0m07:19:59.027723 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: COMMIT
[0m07:19:59.297014 [debug] [Thread-4 (]: SQL status: COMMIT in 0.269 seconds
[0m07:19:59.300438 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_employees_scd__dbt_backup"
[0m07:19:59.300917 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_employees_scd"
[0m07:19:59.301240 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_employees_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_employees_scd__dbt_backup" cascade
[0m07:19:59.575591 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.274 seconds
[0m07:19:59.576848 [debug] [Thread-4 (]: On model.retail_dbt.dim_employees_scd: Close
[0m07:19:59.577416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09849b1a0>]}
[0m07:19:59.577913 [info ] [Thread-4 (]: 6 of 23 OK created sql table model silver_to_golden.dim_employees_scd .......... [[32mSELECT 200[0m in 4.11s]
[0m07:19:59.578431 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_employees_scd
[0m07:19:59.578852 [debug] [Thread-4 (]: Began running node model.retail_dbt.dim_tax_rules
[0m07:19:59.579314 [info ] [Thread-4 (]: 12 of 23 START sql table model silver_to_golden.dim_tax_rules .................. [RUN]
[0m07:19:59.579707 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_employees_scd, now model.retail_dbt.dim_tax_rules)
[0m07:19:59.580003 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.dim_tax_rules
[0m07:19:59.582554 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.dim_tax_rules"
[0m07:19:59.583065 [debug] [Thread-4 (]: Began executing node model.retail_dbt.dim_tax_rules
[0m07:19:59.585667 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.dim_tax_rules"
[0m07:19:59.586127 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_tax_rules"
[0m07:19:59.586408 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: BEGIN
[0m07:19:59.586721 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:00.570270 [debug] [Thread-1 (]: SQL status: BEGIN in 2.115 seconds
[0m07:20:00.570861 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_promotions_scd"
[0m07:20:00.571309 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_promotions_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_promotions_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as promotion_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_promotions_snapshot"
  );
  
[0m07:20:00.805617 [debug] [Thread-1 (]: SQL status: SELECT 248 in 0.234 seconds
[0m07:20:00.808703 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_promotions_scd"
[0m07:20:00.809091 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_promotions_scd"} */
alter table "postgres"."silver_to_golden"."dim_promotions_scd__dbt_tmp" rename to "dim_promotions_scd"
[0m07:20:00.917544 [debug] [Thread-2 (]: SQL status: BEGIN in 2.054 seconds
[0m07:20:00.918042 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_stores_scd"
[0m07:20:00.918478 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_stores_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_stores_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as store_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_stores_snapshot"
  );
  
[0m07:20:01.035867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.226 seconds
[0m07:20:01.037277 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: COMMIT
[0m07:20:01.037681 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_promotions_scd"
[0m07:20:01.038033 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: COMMIT
[0m07:20:01.123119 [debug] [Thread-3 (]: SQL status: BEGIN in 2.126 seconds
[0m07:20:01.123579 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_suppliers_scd"
[0m07:20:01.123994 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_suppliers_scd"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_suppliers_scd__dbt_tmp"
  
  
    as
  
  (
    
select
  *,
  dbt_scd_id  as supplier_sk,
  dbt_valid_from as valid_from,
  dbt_valid_to   as valid_to,
  (dbt_valid_to is null) as is_current
from "postgres"."silver"."dim_suppliers_snapshot"
  );
  
[0m07:20:01.174756 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.256 seconds
[0m07:20:01.178206 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_stores_scd"
[0m07:20:01.178584 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_stores_scd"} */
alter table "postgres"."silver_to_golden"."dim_stores_scd__dbt_tmp" rename to "dim_stores_scd"
[0m07:20:01.266402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.228 seconds
[0m07:20:01.268855 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_promotions_scd__dbt_backup"
[0m07:20:01.269497 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.dim_promotions_scd"
[0m07:20:01.269856 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_promotions_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_promotions_scd__dbt_backup" cascade
[0m07:20:01.351493 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.227 seconds
[0m07:20:01.354619 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_suppliers_scd"
[0m07:20:01.355061 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_suppliers_scd"} */
alter table "postgres"."silver_to_golden"."dim_suppliers_scd__dbt_tmp" rename to "dim_suppliers_scd"
[0m07:20:01.408768 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.230 seconds
[0m07:20:01.409965 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: COMMIT
[0m07:20:01.410306 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_stores_scd"
[0m07:20:01.410596 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: COMMIT
[0m07:20:01.503646 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.233 seconds
[0m07:20:01.505165 [debug] [Thread-1 (]: On model.retail_dbt.dim_promotions_scd: Close
[0m07:20:01.505963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09a0e88f0>]}
[0m07:20:01.506626 [info ] [Thread-1 (]: 9 of 23 OK created sql table model silver_to_golden.dim_promotions_scd ......... [[32mSELECT 248[0m in 3.06s]
[0m07:20:01.507389 [debug] [Thread-1 (]: Finished running node model.retail_dbt.dim_promotions_scd
[0m07:20:01.507897 [debug] [Thread-1 (]: Began running node model.retail_dbt.fct_customer_feedback
[0m07:20:01.508519 [info ] [Thread-1 (]: 13 of 23 START sql table model silver_to_golden.fct_customer_feedback .......... [RUN]
[0m07:20:01.509074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_promotions_scd, now model.retail_dbt.fct_customer_feedback)
[0m07:20:01.509525 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fct_customer_feedback
[0m07:20:01.515376 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fct_customer_feedback"
[0m07:20:01.515946 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fct_customer_feedback
[0m07:20:01.518973 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fct_customer_feedback"
[0m07:20:01.519574 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_customer_feedback"
[0m07:20:01.519919 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: BEGIN
[0m07:20:01.520263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:01.603377 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.248 seconds
[0m07:20:01.604837 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: COMMIT
[0m07:20:01.605287 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_suppliers_scd"
[0m07:20:01.605687 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: COMMIT
[0m07:20:01.630262 [debug] [Thread-4 (]: SQL status: BEGIN in 2.043 seconds
[0m07:20:01.630695 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_tax_rules"
[0m07:20:01.631155 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_tax_rules"} */

  
    

  create  table "postgres"."silver_to_golden"."dim_tax_rules__dbt_tmp"
  
  
    as
  
  (
    
select * from "postgres"."silver"."tax_rules_silver"
  );
  
[0m07:20:01.654481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.243 seconds
[0m07:20:01.657405 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_stores_scd__dbt_backup"
[0m07:20:01.657907 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.dim_stores_scd"
[0m07:20:01.658228 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_stores_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_stores_scd__dbt_backup" cascade
[0m07:20:01.852222 [debug] [Thread-3 (]: SQL status: COMMIT in 0.246 seconds
[0m07:20:01.854714 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_suppliers_scd__dbt_backup"
[0m07:20:01.855436 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.dim_suppliers_scd"
[0m07:20:01.855810 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_suppliers_scd"} */
drop table if exists "postgres"."silver_to_golden"."dim_suppliers_scd__dbt_backup" cascade
[0m07:20:01.873402 [debug] [Thread-4 (]: SQL status: SELECT 387 in 0.242 seconds
[0m07:20:01.877030 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_tax_rules"
[0m07:20:01.877468 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_tax_rules"} */
alter table "postgres"."silver_to_golden"."dim_tax_rules__dbt_tmp" rename to "dim_tax_rules"
[0m07:20:01.907265 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.249 seconds
[0m07:20:01.908600 [debug] [Thread-2 (]: On model.retail_dbt.dim_stores_scd: Close
[0m07:20:01.909308 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0984f4e90>]}
[0m07:20:01.909976 [info ] [Thread-2 (]: 10 of 23 OK created sql table model silver_to_golden.dim_stores_scd ............ [[32mSELECT 20[0m in 3.05s]
[0m07:20:01.910544 [debug] [Thread-2 (]: Finished running node model.retail_dbt.dim_stores_scd
[0m07:20:01.910971 [debug] [Thread-2 (]: Began running node model.retail_dbt.fct_inventory
[0m07:20:01.911441 [info ] [Thread-2 (]: 14 of 23 START sql table model silver_to_golden.fct_inventory .................. [RUN]
[0m07:20:01.911895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_stores_scd, now model.retail_dbt.fct_inventory)
[0m07:20:01.912251 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fct_inventory
[0m07:20:01.915386 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fct_inventory"
[0m07:20:01.915910 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fct_inventory
[0m07:20:01.918686 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fct_inventory"
[0m07:20:01.919227 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_inventory"
[0m07:20:01.919704 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: BEGIN
[0m07:20:01.920059 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:02.098999 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.243 seconds
[0m07:20:02.100575 [debug] [Thread-3 (]: On model.retail_dbt.dim_suppliers_scd: Close
[0m07:20:02.101348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0983584a0>]}
[0m07:20:02.101987 [info ] [Thread-3 (]: 11 of 23 OK created sql table model silver_to_golden.dim_suppliers_scd ......... [[32mSELECT 10[0m in 3.11s]
[0m07:20:02.102703 [debug] [Thread-3 (]: Finished running node model.retail_dbt.dim_suppliers_scd
[0m07:20:02.103198 [debug] [Thread-3 (]: Began running node model.retail_dbt.fct_payments
[0m07:20:02.103727 [info ] [Thread-3 (]: 15 of 23 START sql table model silver_to_golden.fct_payments ................... [RUN]
[0m07:20:02.104131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_suppliers_scd, now model.retail_dbt.fct_payments)
[0m07:20:02.104495 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fct_payments
[0m07:20:02.109212 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fct_payments"
[0m07:20:02.109741 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fct_payments
[0m07:20:02.112868 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fct_payments"
[0m07:20:02.113477 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_payments"
[0m07:20:02.113880 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: BEGIN
[0m07:20:02.114270 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:02.118472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.241 seconds
[0m07:20:02.119933 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: COMMIT
[0m07:20:02.120299 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_tax_rules"
[0m07:20:02.120606 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: COMMIT
[0m07:20:02.362262 [debug] [Thread-4 (]: SQL status: COMMIT in 0.241 seconds
[0m07:20:02.365300 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_to_golden"."dim_tax_rules__dbt_backup"
[0m07:20:02.366048 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.dim_tax_rules"
[0m07:20:02.366444 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.dim_tax_rules"} */
drop table if exists "postgres"."silver_to_golden"."dim_tax_rules__dbt_backup" cascade
[0m07:20:02.606099 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.239 seconds
[0m07:20:02.607813 [debug] [Thread-4 (]: On model.retail_dbt.dim_tax_rules: Close
[0m07:20:02.608648 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d1d8f80>]}
[0m07:20:02.609349 [info ] [Thread-4 (]: 12 of 23 OK created sql table model silver_to_golden.dim_tax_rules ............. [[32mSELECT 387[0m in 3.03s]
[0m07:20:02.610050 [debug] [Thread-4 (]: Finished running node model.retail_dbt.dim_tax_rules
[0m07:20:02.610533 [debug] [Thread-4 (]: Began running node model.retail_dbt.fct_pricing_history
[0m07:20:02.611194 [info ] [Thread-4 (]: 16 of 23 START sql table model silver_to_golden.fct_pricing_history ............ [RUN]
[0m07:20:02.611639 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.dim_tax_rules, now model.retail_dbt.fct_pricing_history)
[0m07:20:02.612024 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fct_pricing_history
[0m07:20:02.616039 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fct_pricing_history"
[0m07:20:02.616606 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fct_pricing_history
[0m07:20:02.619608 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fct_pricing_history"
[0m07:20:02.620141 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_pricing_history"
[0m07:20:02.620459 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: BEGIN
[0m07:20:02.620763 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:04.231479 [debug] [Thread-3 (]: SQL status: BEGIN in 2.117 seconds
[0m07:20:04.231914 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_payments"
[0m07:20:04.232254 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_payments"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_payments__dbt_tmp"
  
  
    as
  
  (
    

with payments_gold as (
    select
        p.payment_id,
        p.method,
        p.status,
        p.paid_at,
        st.transaction_id,
        st.customer_id,
        st.store_id,
        st.employee_id,
        c.name as customer_name,
        sto.name as store_name,
        e.name as employee_name,
        date_part('year', p.paid_at) as paid_year,
        date_part('month', p.paid_at) as paid_month,
        date_part('day', p.paid_at) as paid_day
    from "postgres"."silver"."payments_silver" p
    left join "postgres"."silver"."sales_transactions_silver" st on p.payment_id = st.payment_id
    left join "postgres"."silver"."customers_silver" c on st.customer_id = c.customer_id
    left join "postgres"."silver"."stores_silver" sto on st.store_id = sto.store_id
    left join "postgres"."silver"."employees_silver" e on st.employee_id = e.employee_id
    where p.payment_id is null
        or p.method is null or p.method = 'N/A'
        or p.status is null or p.status = 'N/A'
        or p.paid_at is null
        or st.transaction_id is null
        or st.customer_id is null
        or st.store_id is null
        or st.employee_id is null
        or c.name is null or c.name = 'N/A'
        or sto.name is null or sto.name = 'N/A'
        or e.name is null or e.name = 'N/A'
)

select * from payments_gold
  );
  
[0m07:20:04.545711 [debug] [Thread-3 (]: SQL status: SELECT 13951 in 0.313 seconds
[0m07:20:04.548509 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_payments"
[0m07:20:04.548869 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_payments"} */
alter table "postgres"."silver_to_golden"."fct_payments__dbt_tmp" rename to "fct_payments"
[0m07:20:04.753456 [debug] [Thread-4 (]: SQL status: BEGIN in 2.133 seconds
[0m07:20:04.753912 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_pricing_history"
[0m07:20:04.754237 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_pricing_history"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_pricing_history__dbt_tmp"
  
  
    as
  
  (
    

with pricing_history_gold as (
    select
        ph.history_id,
        ph.product_id,
        ph.price,
        ph.effective_date,
        p.name as product_name,
        c.name as category_name,
        b.name as brand_name,
        s.name as supplier_name,
        date_part('year', ph.effective_date) as effective_year,
        date_part('month', ph.effective_date) as effective_month
    from "postgres"."silver"."pricing_history_silver" ph
    left join "postgres"."silver"."products_silver" p on ph.product_id = p.product_id
    left join "postgres"."silver"."categories_silver" c on p.category_id = c.category_id
    left join "postgres"."silver"."brands_silver" b on p.brand_id = b.brand_id
    left join "postgres"."silver"."suppliers_silver" s on p.supplier_id = s.supplier_id
    where ph.history_id is not null
        and ph.product_id is not null
        and ph.price is not null
        and ph.effective_date is not null
        and p.name is not null and p.name != 'N/A'
        and c.name is not null and c.name != 'N/A'
        and b.name is not null and b.name != 'N/A'
        and s.name is not null and s.name != 'N/A'
)

select * from pricing_history_gold
  );
  
[0m07:20:04.771650 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.222 seconds
[0m07:20:04.772775 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: COMMIT
[0m07:20:04.773127 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_payments"
[0m07:20:04.773442 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: COMMIT
[0m07:20:04.989774 [debug] [Thread-2 (]: SQL status: BEGIN in 3.070 seconds
[0m07:20:04.990198 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_inventory"
[0m07:20:04.990520 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_inventory"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_inventory__dbt_tmp"
  
  
    as
  
  (
    

with inventory_gold as (
    select
        i.inventory_id,
        i.store_id,
        i.product_id,
        i.quantity,
        i.last_updated,
        p.name as product_name,
        sto.name as store_name,
        date_part('year', i.last_updated) as last_updated_year,
        date_part('month', i.last_updated) as last_updated_month,
        date_part('day', i.last_updated) as last_updated_day
    from "postgres"."silver"."inventory_silver" i
    left join "postgres"."silver"."products_silver" p on i.product_id = p.product_id
    left join "postgres"."silver"."stores_silver" sto on i.store_id = sto.store_id
    where i.inventory_id is not null
        and i.store_id is not null
        and i.product_id is not null
        and i.quantity is not null
        and i.last_updated is not null
        and p.name is not null and p.name != 'N/A'
        and sto.name is not null and sto.name != 'N/A'
)

select * from inventory_gold
  );
  
[0m07:20:04.990939 [debug] [Thread-4 (]: SQL status: SELECT 6479 in 0.236 seconds
[0m07:20:04.993729 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_pricing_history"
[0m07:20:04.994038 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_pricing_history"} */
alter table "postgres"."silver_to_golden"."fct_pricing_history__dbt_tmp" rename to "fct_pricing_history"
[0m07:20:04.994377 [debug] [Thread-3 (]: SQL status: COMMIT in 0.221 seconds
[0m07:20:04.996934 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_payments__dbt_backup"
[0m07:20:04.997434 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_payments"
[0m07:20:04.997757 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_payments"} */
drop table if exists "postgres"."silver_to_golden"."fct_payments__dbt_backup" cascade
[0m07:20:05.217903 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.223 seconds
[0m07:20:05.218389 [debug] [Thread-2 (]: SQL status: SELECT 1254 in 0.227 seconds
[0m07:20:05.219514 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: COMMIT
[0m07:20:05.219857 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.222 seconds
[0m07:20:05.222389 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_inventory"
[0m07:20:05.222849 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_pricing_history"
[0m07:20:05.223244 [debug] [Thread-1 (]: SQL status: BEGIN in 3.703 seconds
[0m07:20:05.224279 [debug] [Thread-3 (]: On model.retail_dbt.fct_payments: Close
[0m07:20:05.224666 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_inventory"} */
alter table "postgres"."silver_to_golden"."fct_inventory__dbt_tmp" rename to "fct_inventory"
[0m07:20:05.225018 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: COMMIT
[0m07:20:05.225404 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_customer_feedback"
[0m07:20:05.226139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09a3c38c0>]}
[0m07:20:05.226654 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_customer_feedback"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_customer_feedback__dbt_tmp"
  
  
    as
  
  (
    

with customer_feedback_gold as (
    select
        cf.feedback_id,
        cf.customer_id,
        cf.store_id,
        cf.product_id,
        cf.rating,
        cf.comments,
        cf.feedback_date,
        c.name as customer_name,
        sto.name as store_name,
        p.name as product_name,
        date_part('year', cf.feedback_date) as feedback_year,
        date_part('month', cf.feedback_date) as feedback_month,
        date_part('day', cf.feedback_date) as feedback_day
    from "postgres"."silver"."customer_feedback_silver" cf
    left join "postgres"."silver"."customers_silver" c on cf.customer_id = c.customer_id
    left join "postgres"."silver"."stores_silver" sto on cf.store_id = sto.store_id
    left join "postgres"."silver"."products_silver" p on cf.product_id = p.product_id
    where cf.feedback_id is not null
        and cf.customer_id is not null
        and cf.store_id is not null
        and cf.product_id is not null
        and cf.rating is not null
        and cf.comments is not null and cf.comments != 'N/A'
        and cf.feedback_date is not null
        and c.name is not null and c.name != 'N/A'
        and sto.name is not null and sto.name != 'N/A'
        and p.name is not null and p.name != 'N/A'
)

select * from customer_feedback_gold
  );
  
[0m07:20:05.227302 [info ] [Thread-3 (]: 15 of 23 OK created sql table model silver_to_golden.fct_payments .............. [[32mSELECT 13951[0m in 3.12s]
[0m07:20:05.227969 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fct_payments
[0m07:20:05.228334 [debug] [Thread-3 (]: Began running node model.retail_dbt.fct_purchase_orders
[0m07:20:05.228761 [info ] [Thread-3 (]: 17 of 23 START sql table model silver_to_golden.fct_purchase_orders ............ [RUN]
[0m07:20:05.229153 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_payments, now model.retail_dbt.fct_purchase_orders)
[0m07:20:05.229440 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fct_purchase_orders
[0m07:20:05.232020 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fct_purchase_orders"
[0m07:20:05.232489 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fct_purchase_orders
[0m07:20:05.235012 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fct_purchase_orders"
[0m07:20:05.235448 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_purchase_orders"
[0m07:20:05.235728 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: BEGIN
[0m07:20:05.236033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:05.446193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.220 seconds
[0m07:20:05.447409 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: COMMIT
[0m07:20:05.447751 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_inventory"
[0m07:20:05.448060 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: COMMIT
[0m07:20:05.452691 [debug] [Thread-4 (]: SQL status: COMMIT in 0.227 seconds
[0m07:20:05.454978 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_pricing_history__dbt_backup"
[0m07:20:05.455428 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_pricing_history"
[0m07:20:05.455750 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_pricing_history"} */
drop table if exists "postgres"."silver_to_golden"."fct_pricing_history__dbt_backup" cascade
[0m07:20:05.492543 [debug] [Thread-1 (]: SQL status: SELECT 2753 in 0.265 seconds
[0m07:20:05.495031 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_customer_feedback"
[0m07:20:05.495371 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_customer_feedback"} */
alter table "postgres"."silver_to_golden"."fct_customer_feedback__dbt_tmp" rename to "fct_customer_feedback"
[0m07:20:05.670147 [debug] [Thread-2 (]: SQL status: COMMIT in 0.222 seconds
[0m07:20:05.672326 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_inventory__dbt_backup"
[0m07:20:05.672778 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_inventory"
[0m07:20:05.673091 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_inventory"} */
drop table if exists "postgres"."silver_to_golden"."fct_inventory__dbt_backup" cascade
[0m07:20:05.679293 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.223 seconds
[0m07:20:05.680387 [debug] [Thread-4 (]: On model.retail_dbt.fct_pricing_history: Close
[0m07:20:05.680943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09824ffe0>]}
[0m07:20:05.681414 [info ] [Thread-4 (]: 16 of 23 OK created sql table model silver_to_golden.fct_pricing_history ....... [[32mSELECT 6479[0m in 3.07s]
[0m07:20:05.681907 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fct_pricing_history
[0m07:20:05.682283 [debug] [Thread-4 (]: Began running node model.retail_dbt.fct_returns
[0m07:20:05.682749 [info ] [Thread-4 (]: 18 of 23 START sql table model silver_to_golden.fct_returns .................... [RUN]
[0m07:20:05.683197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_pricing_history, now model.retail_dbt.fct_returns)
[0m07:20:05.683487 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fct_returns
[0m07:20:05.687309 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fct_returns"
[0m07:20:05.687801 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fct_returns
[0m07:20:05.690300 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fct_returns"
[0m07:20:05.690756 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_returns"
[0m07:20:05.691098 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: BEGIN
[0m07:20:05.691373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:05.756782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.261 seconds
[0m07:20:05.757892 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: COMMIT
[0m07:20:05.758191 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_customer_feedback"
[0m07:20:05.758466 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: COMMIT
[0m07:20:05.896072 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.223 seconds
[0m07:20:05.897339 [debug] [Thread-2 (]: On model.retail_dbt.fct_inventory: Close
[0m07:20:05.897939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0983efd70>]}
[0m07:20:05.898423 [info ] [Thread-2 (]: 14 of 23 OK created sql table model silver_to_golden.fct_inventory ............. [[32mSELECT 1254[0m in 3.99s]
[0m07:20:05.898982 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fct_inventory
[0m07:20:05.899323 [debug] [Thread-2 (]: Began running node model.retail_dbt.fct_sales_items
[0m07:20:05.899764 [info ] [Thread-2 (]: 19 of 23 START sql table model silver_to_golden.fct_sales_items ................ [RUN]
[0m07:20:05.900152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_inventory, now model.retail_dbt.fct_sales_items)
[0m07:20:05.900468 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.fct_sales_items
[0m07:20:05.903613 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.fct_sales_items"
[0m07:20:05.904087 [debug] [Thread-2 (]: Began executing node model.retail_dbt.fct_sales_items
[0m07:20:05.906730 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.fct_sales_items"
[0m07:20:05.907284 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_sales_items"
[0m07:20:05.907581 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: BEGIN
[0m07:20:05.907890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:06.015858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.257 seconds
[0m07:20:06.018051 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_customer_feedback__dbt_backup"
[0m07:20:06.018491 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_customer_feedback"
[0m07:20:06.018820 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_customer_feedback"} */
drop table if exists "postgres"."silver_to_golden"."fct_customer_feedback__dbt_backup" cascade
[0m07:20:06.272870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.254 seconds
[0m07:20:06.274067 [debug] [Thread-1 (]: On model.retail_dbt.fct_customer_feedback: Close
[0m07:20:06.274659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af098311fd0>]}
[0m07:20:06.275225 [info ] [Thread-1 (]: 13 of 23 OK created sql table model silver_to_golden.fct_customer_feedback ..... [[32mSELECT 2753[0m in 4.77s]
[0m07:20:06.275733 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fct_customer_feedback
[0m07:20:06.276075 [debug] [Thread-1 (]: Began running node model.retail_dbt.fct_sales_transactions
[0m07:20:06.276502 [info ] [Thread-1 (]: 20 of 23 START sql table model silver_to_golden.fct_sales_transactions ......... [RUN]
[0m07:20:06.276886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_customer_feedback, now model.retail_dbt.fct_sales_transactions)
[0m07:20:06.277225 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fct_sales_transactions
[0m07:20:06.280384 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fct_sales_transactions"
[0m07:20:06.280859 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fct_sales_transactions
[0m07:20:06.284168 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fct_sales_transactions"
[0m07:20:06.284624 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_sales_transactions"
[0m07:20:06.284901 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: BEGIN
[0m07:20:06.285170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:07.345588 [debug] [Thread-3 (]: SQL status: BEGIN in 2.109 seconds
[0m07:20:07.345992 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_purchase_orders"
[0m07:20:07.346353 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_purchase_orders"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_purchase_orders__dbt_tmp"
  
  
    as
  
  (
    

with purchase_orders_gold as (
    select
        po.order_id,
        po.supplier_id,
        po.order_date,
        po.status,
        s.name as supplier_name,
        date_part('year', po.order_date) as order_year,
        date_part('month', po.order_date) as order_month,
        date_part('day', po.order_date) as order_day
    from "postgres"."silver"."purchase_orders_silver" po
    left join "postgres"."silver"."suppliers_silver" s on po.supplier_id = s.supplier_id
    where po.order_id is not null
        and po.supplier_id is not null
        and po.order_date is not null
        and po.status is not null and po.status != 'N/A'
        and s.name is not null and s.name != 'N/A'
)

select * from purchase_orders_gold
  );
  
[0m07:20:07.571711 [debug] [Thread-3 (]: SQL status: SELECT 895 in 0.225 seconds
[0m07:20:07.574317 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_purchase_orders"
[0m07:20:07.574663 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_purchase_orders"} */
alter table "postgres"."silver_to_golden"."fct_purchase_orders__dbt_tmp" rename to "fct_purchase_orders"
[0m07:20:07.774837 [debug] [Thread-4 (]: SQL status: BEGIN in 2.083 seconds
[0m07:20:07.775258 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_returns"
[0m07:20:07.775580 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_returns"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_returns__dbt_tmp"
  
  
    as
  
  (
    

with returns_gold as (
    select
        r.return_id,
        r.item_id,
        r.reason,
        r.return_date,
        si.product_id,
        si.quantity as returned_quantity,
        p.name as product_name,
        st.customer_id,
        sto.name as store_name,
        date_part('year', r.return_date) as return_year,
        date_part('month', r.return_date) as return_month,
        date_part('day', r.return_date) as return_day
    from "postgres"."silver"."returns_silver" r
    left join "postgres"."silver"."sales_items_silver" si on r.item_id = si.item_id
    left join "postgres"."silver"."sales_transactions_silver" st on si.transaction_id = st.transaction_id
    left join "postgres"."silver"."products_silver" p on si.product_id = p.product_id
    left join "postgres"."silver"."stores_silver" sto on st.store_id = sto.store_id
    where r.return_id is not null
        and r.item_id is not null
        and r.reason is not null and r.reason != 'N/A'
        and r.return_date is not null
        and si.product_id is not null
        and si.quantity is not null
        and p.name is not null and p.name != 'N/A'
        and st.customer_id is not null
        and sto.name is not null and sto.name != 'N/A'
)

select * from returns_gold
  );
  
[0m07:20:07.795418 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.220 seconds
[0m07:20:07.796549 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: COMMIT
[0m07:20:07.796853 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_purchase_orders"
[0m07:20:07.797132 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: COMMIT
[0m07:20:08.017769 [debug] [Thread-3 (]: SQL status: COMMIT in 0.220 seconds
[0m07:20:08.019822 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_purchase_orders__dbt_backup"
[0m07:20:08.020256 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_purchase_orders"
[0m07:20:08.020560 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_purchase_orders"} */
drop table if exists "postgres"."silver_to_golden"."fct_purchase_orders__dbt_backup" cascade
[0m07:20:08.037691 [debug] [Thread-4 (]: SQL status: SELECT 3223 in 0.262 seconds
[0m07:20:08.040007 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_returns"
[0m07:20:08.040302 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_returns"} */
alter table "postgres"."silver_to_golden"."fct_returns__dbt_tmp" rename to "fct_returns"
[0m07:20:08.243231 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.222 seconds
[0m07:20:08.244632 [debug] [Thread-3 (]: On model.retail_dbt.fct_purchase_orders: Close
[0m07:20:08.245259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af098119580>]}
[0m07:20:08.245824 [info ] [Thread-3 (]: 17 of 23 OK created sql table model silver_to_golden.fct_purchase_orders ....... [[32mSELECT 895[0m in 3.02s]
[0m07:20:08.246385 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fct_purchase_orders
[0m07:20:08.246908 [debug] [Thread-3 (]: Began running node model.retail_dbt.fct_shipments
[0m07:20:08.247412 [info ] [Thread-3 (]: 21 of 23 START sql table model silver_to_golden.fct_shipments .................. [RUN]
[0m07:20:08.247872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_purchase_orders, now model.retail_dbt.fct_shipments)
[0m07:20:08.248232 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.fct_shipments
[0m07:20:08.251754 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.fct_shipments"
[0m07:20:08.252153 [debug] [Thread-2 (]: SQL status: BEGIN in 2.344 seconds
[0m07:20:08.252709 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_sales_items"
[0m07:20:08.253128 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_sales_items"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_sales_items__dbt_tmp"
  
  
    as
  
  (
    

with sales_items_gold as (
    select
        si.item_id,
        si.transaction_id,
        si.product_id,
        si.quantity,
        si.unit_price,
        si.discount,
        si.tax,
        si.gross_amount,
        si.net_amount,
        si.business_validation_flag,
        p.name as product_name,
        c.name as category_name,
        st.customer_id,
        sto.name as store_name,
        date_part('year', st.transaction_date) as transaction_year,
        date_part('month', st.transaction_date) as transaction_month
    from "postgres"."silver"."sales_items_silver" si
    left join "postgres"."silver"."products_silver" p on si.product_id = p.product_id
    left join "postgres"."silver"."categories_silver" c on p.category_id = c.category_id
    left join "postgres"."silver"."sales_transactions_silver" st on si.transaction_id = st.transaction_id
    left join "postgres"."silver"."stores_silver" sto on st.store_id = sto.store_id
    where si.item_id is not null
        and si.transaction_id is not null
        and si.product_id is not null
        and si.quantity is not null
        and si.unit_price is not null
        and si.discount is not null
        and si.tax is not null
        and si.gross_amount is not null
        and si.net_amount is not null
        and si.business_validation_flag is not null and si.business_validation_flag != 'N/A'
        and p.name is not null and p.name != 'N/A'
        and c.name is not null and c.name != 'N/A'
        and st.customer_id is not null
        and sto.name is not null and sto.name != 'N/A'
)

select * from sales_items_gold
  );
  
[0m07:20:08.253645 [debug] [Thread-3 (]: Began executing node model.retail_dbt.fct_shipments
[0m07:20:08.256932 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.fct_shipments"
[0m07:20:08.257429 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_shipments"
[0m07:20:08.257764 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: BEGIN
[0m07:20:08.258063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:08.274907 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.234 seconds
[0m07:20:08.275991 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: COMMIT
[0m07:20:08.276341 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_returns"
[0m07:20:08.276648 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: COMMIT
[0m07:20:08.390416 [debug] [Thread-1 (]: SQL status: BEGIN in 2.105 seconds
[0m07:20:08.390978 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_sales_transactions"
[0m07:20:08.391355 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_sales_transactions"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_sales_transactions__dbt_tmp"
  
  
    as
  
  (
    

with sales_transactions_gold as (
    select
        st.transaction_id,
        st.customer_id,
        st.store_id,
        st.employee_id,
        st.transaction_date,
        st.total_amount,
        st.payment_id,
        c.name as customer_name,
        sto.name as store_name,
        e.name as employee_name,
        pay.method as payment_method,
        date_part('year', st.transaction_date) as transaction_year,
        date_part('month', st.transaction_date) as transaction_month,
        date_part('day', st.transaction_date) as transaction_day
    from "postgres"."silver"."sales_transactions_silver" st
    left join "postgres"."silver"."customers_silver" c on st.customer_id = c.customer_id
    left join "postgres"."silver"."stores_silver" sto on st.store_id = sto.store_id
    left join "postgres"."silver"."employees_silver" e on st.employee_id = e.employee_id
    left join "postgres"."silver"."payments_silver" pay on st.payment_id = pay.payment_id
    where st.transaction_id is not null
        and st.customer_id is not null
        and st.store_id is not null
        and st.employee_id is not null
        and st.transaction_date is not null
        and st.total_amount is not null
        and st.payment_id is not null
        and c.name is not null and c.name != 'N/A'
        and sto.name is not null and sto.name != 'N/A'
        and e.name is not null and e.name != 'N/A'
        and pay.method is not null and pay.method != 'N/A'
)

select * from sales_transactions_gold
  );
  
[0m07:20:08.527713 [debug] [Thread-4 (]: SQL status: COMMIT in 0.251 seconds
[0m07:20:08.530483 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_returns__dbt_backup"
[0m07:20:08.531176 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_returns"
[0m07:20:08.531590 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_returns"} */
drop table if exists "postgres"."silver_to_golden"."fct_returns__dbt_backup" cascade
[0m07:20:08.781824 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.250 seconds
[0m07:20:08.783180 [debug] [Thread-4 (]: On model.retail_dbt.fct_returns: Close
[0m07:20:08.783823 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0983eab40>]}
[0m07:20:08.784364 [info ] [Thread-4 (]: 18 of 23 OK created sql table model silver_to_golden.fct_returns ............... [[32mSELECT 3223[0m in 3.10s]
[0m07:20:08.784923 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fct_returns
[0m07:20:08.785288 [debug] [Thread-4 (]: Began running node model.retail_dbt.fct_stock_movements
[0m07:20:08.785773 [info ] [Thread-4 (]: 22 of 23 START sql table model silver_to_golden.fct_stock_movements ............ [RUN]
[0m07:20:08.786198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_returns, now model.retail_dbt.fct_stock_movements)
[0m07:20:08.786541 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.fct_stock_movements
[0m07:20:08.790348 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.fct_stock_movements"
[0m07:20:08.790858 [debug] [Thread-4 (]: Began executing node model.retail_dbt.fct_stock_movements
[0m07:20:08.793542 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.fct_stock_movements"
[0m07:20:08.794021 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_stock_movements"
[0m07:20:08.794369 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: BEGIN
[0m07:20:08.794664 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:08.801651 [debug] [Thread-1 (]: SQL status: SELECT 36049 in 0.410 seconds
[0m07:20:08.804252 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_sales_transactions"
[0m07:20:08.804577 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_sales_transactions"} */
alter table "postgres"."silver_to_golden"."fct_sales_transactions__dbt_tmp" rename to "fct_sales_transactions"
[0m07:20:08.840595 [debug] [Thread-2 (]: SQL status: SELECT 72072 in 0.587 seconds
[0m07:20:08.842998 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_sales_items"
[0m07:20:08.843325 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_sales_items"} */
alter table "postgres"."silver_to_golden"."fct_sales_items__dbt_tmp" rename to "fct_sales_items"
[0m07:20:09.049097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.244 seconds
[0m07:20:09.050329 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: COMMIT
[0m07:20:09.050672 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_sales_transactions"
[0m07:20:09.051019 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: COMMIT
[0m07:20:09.123191 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.279 seconds
[0m07:20:09.124182 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: COMMIT
[0m07:20:09.124512 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_sales_items"
[0m07:20:09.124816 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: COMMIT
[0m07:20:09.296054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.245 seconds
[0m07:20:09.298374 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_sales_transactions__dbt_backup"
[0m07:20:09.298891 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_sales_transactions"
[0m07:20:09.299214 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_sales_transactions"} */
drop table if exists "postgres"."silver_to_golden"."fct_sales_transactions__dbt_backup" cascade
[0m07:20:09.401345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.276 seconds
[0m07:20:09.403756 [debug] [Thread-2 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_sales_items__dbt_backup"
[0m07:20:09.404235 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.fct_sales_items"
[0m07:20:09.404579 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_sales_items"} */
drop table if exists "postgres"."silver_to_golden"."fct_sales_items__dbt_backup" cascade
[0m07:20:09.543242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.244 seconds
[0m07:20:09.544554 [debug] [Thread-1 (]: On model.retail_dbt.fct_sales_transactions: Close
[0m07:20:09.545194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09816c9b0>]}
[0m07:20:09.545770 [info ] [Thread-1 (]: 20 of 23 OK created sql table model silver_to_golden.fct_sales_transactions .... [[32mSELECT 36049[0m in 3.27s]
[0m07:20:09.546321 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fct_sales_transactions
[0m07:20:09.546731 [debug] [Thread-1 (]: Began running node model.retail_dbt.fct_store_visits
[0m07:20:09.547253 [info ] [Thread-1 (]: 23 of 23 START sql table model silver_to_golden.fct_store_visits ............... [RUN]
[0m07:20:09.547702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.fct_sales_transactions, now model.retail_dbt.fct_store_visits)
[0m07:20:09.548078 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.fct_store_visits
[0m07:20:09.551245 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.fct_store_visits"
[0m07:20:09.551727 [debug] [Thread-1 (]: Began executing node model.retail_dbt.fct_store_visits
[0m07:20:09.555432 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.fct_store_visits"
[0m07:20:09.556024 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_store_visits"
[0m07:20:09.556338 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: BEGIN
[0m07:20:09.556631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:09.685304 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.280 seconds
[0m07:20:09.687301 [debug] [Thread-2 (]: On model.retail_dbt.fct_sales_items: Close
[0m07:20:09.688178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0981261e0>]}
[0m07:20:09.688967 [info ] [Thread-2 (]: 19 of 23 OK created sql table model silver_to_golden.fct_sales_items ........... [[32mSELECT 72072[0m in 3.79s]
[0m07:20:09.689709 [debug] [Thread-2 (]: Finished running node model.retail_dbt.fct_sales_items
[0m07:20:11.014337 [debug] [Thread-4 (]: SQL status: BEGIN in 2.220 seconds
[0m07:20:11.014899 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_stock_movements"
[0m07:20:11.015256 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_stock_movements"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_stock_movements__dbt_tmp"
  
  
    as
  
  (
    

with stock_movements_gold as (
    select
        sm.movement_id,
        sm.product_id,
        sm.store_id,
        sm.movement_type,
        sm.quantity,
        sm.movement_date,
        p.name as product_name,
        sto.name as store_name,
        date_part('year', sm.movement_date) as movement_year,
        date_part('month', sm.movement_date) as movement_month
    from "postgres"."silver"."stock_movements_silver" sm
    left join "postgres"."silver"."products_silver" p on sm.product_id = p.product_id
    left join "postgres"."silver"."stores_silver" sto on sm.store_id = sto.store_id
    where sm.movement_id is not null
        and sm.product_id is not null
        and sm.store_id is not null
        and sm.movement_type is not null and sm.movement_type != 'N/A'
        and sm.quantity is not null
        and sm.movement_date is not null
        and p.name is not null and p.name != 'N/A'
        and sto.name is not null and sto.name != 'N/A'
)

select * from stock_movements_gold
  );
  
[0m07:20:11.117546 [debug] [Thread-3 (]: SQL status: BEGIN in 2.859 seconds
[0m07:20:11.117949 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_shipments"
[0m07:20:11.118361 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_shipments"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_shipments__dbt_tmp"
  
  
    as
  
  (
    

with shipments_gold as (
    select
        sh.shipment_id,
        sh.order_id,
        sh.store_id,
        sh.shipped_date,
        sh.received_date,
        po.supplier_id,
        s.name as supplier_name,
        sto.name as store_name,
        date_part('year', sh.shipped_date) as shipped_year,
        date_part('month', sh.shipped_date) as shipped_month,
        date_part('day', sh.shipped_date) as shipped_day,
        date_part('year', sh.received_date) as received_year,
        date_part('month', sh.received_date) as received_month,
        date_part('day', sh.received_date) as received_day,
        EXTRACT(EPOCH FROM (sh.received_date - sh.shipped_date)) / 86400 as shipment_duration_days
    from "postgres"."silver"."shipments_silver" sh
    left join "postgres"."silver"."purchase_orders_silver" po on sh.order_id = po.order_id
    left join "postgres"."silver"."suppliers_silver" s on po.supplier_id = s.supplier_id
    left join "postgres"."silver"."stores_silver" sto on sh.store_id = sto.store_id
    where sh.shipment_id is not null
        and sh.order_id is not null
        and sh.store_id is not null
        and sh.shipped_date is not null
        and sh.received_date is not null
        and po.supplier_id is not null
        and s.name is not null and s.name != 'N/A'
        and sto.name is not null and sto.name != 'N/A'
)

select * from shipments_gold
  );
  
[0m07:20:11.274715 [debug] [Thread-4 (]: SQL status: SELECT 6455 in 0.259 seconds
[0m07:20:11.277713 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_stock_movements"
[0m07:20:11.278047 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_stock_movements"} */
alter table "postgres"."silver_to_golden"."fct_stock_movements__dbt_tmp" rename to "fct_stock_movements"
[0m07:20:11.520135 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.242 seconds
[0m07:20:11.521429 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: COMMIT
[0m07:20:11.521787 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_stock_movements"
[0m07:20:11.522122 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: COMMIT
[0m07:20:11.748028 [debug] [Thread-4 (]: SQL status: COMMIT in 0.226 seconds
[0m07:20:11.750936 [debug] [Thread-4 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_stock_movements__dbt_backup"
[0m07:20:11.751535 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.fct_stock_movements"
[0m07:20:11.751908 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_stock_movements"} */
drop table if exists "postgres"."silver_to_golden"."fct_stock_movements__dbt_backup" cascade
[0m07:20:11.860784 [debug] [Thread-1 (]: SQL status: BEGIN in 2.304 seconds
[0m07:20:11.861236 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_store_visits"
[0m07:20:11.861581 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_store_visits"} */

  
    

  create  table "postgres"."silver_to_golden"."fct_store_visits__dbt_tmp"
  
  
    as
  
  (
    

with store_visits_gold as (
    select
        sv.visit_id,
        sv.customer_id,
        sv.store_id,
        sv.visit_date,
        c.name as customer_name,
        sto.name as store_name,
        date_part('year', sv.visit_date) as visit_year,
        date_part('month', sv.visit_date) as visit_month,
        date_part('day', sv.visit_date) as visit_day
    from "postgres"."silver"."store_visits_silver" sv
    left join "postgres"."silver"."customers_silver" c on sv.customer_id = c.customer_id
    left join "postgres"."silver"."stores_silver" sto on sv.store_id = sto.store_id
)

select * from store_visits_gold
  );
  
[0m07:20:11.866339 [debug] [Thread-3 (]: SQL status: SELECT 368 in 0.748 seconds
[0m07:20:11.868980 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_shipments"
[0m07:20:11.869276 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_shipments"} */
alter table "postgres"."silver_to_golden"."fct_shipments__dbt_tmp" rename to "fct_shipments"
[0m07:20:11.974725 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.222 seconds
[0m07:20:11.975986 [debug] [Thread-4 (]: On model.retail_dbt.fct_stock_movements: Close
[0m07:20:11.976638 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0981a2db0>]}
[0m07:20:11.977194 [info ] [Thread-4 (]: 22 of 23 OK created sql table model silver_to_golden.fct_stock_movements ....... [[32mSELECT 6455[0m in 3.19s]
[0m07:20:11.977718 [debug] [Thread-4 (]: Finished running node model.retail_dbt.fct_stock_movements
[0m07:20:12.094584 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.225 seconds
[0m07:20:12.095701 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: COMMIT
[0m07:20:12.096007 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_shipments"
[0m07:20:12.096288 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: COMMIT
[0m07:20:12.104671 [debug] [Thread-1 (]: SQL status: SELECT 8999 in 0.243 seconds
[0m07:20:12.107331 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_store_visits"
[0m07:20:12.107632 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_store_visits"} */
alter table "postgres"."silver_to_golden"."fct_store_visits__dbt_tmp" rename to "fct_store_visits"
[0m07:20:12.328867 [debug] [Thread-3 (]: SQL status: COMMIT in 0.232 seconds
[0m07:20:12.331109 [debug] [Thread-3 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_shipments__dbt_backup"
[0m07:20:12.331598 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.fct_shipments"
[0m07:20:12.331894 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_shipments"} */
drop table if exists "postgres"."silver_to_golden"."fct_shipments__dbt_backup" cascade
[0m07:20:12.332741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.225 seconds
[0m07:20:12.333791 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: COMMIT
[0m07:20:12.334087 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_store_visits"
[0m07:20:12.334444 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: COMMIT
[0m07:20:12.562748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.228 seconds
[0m07:20:12.565126 [debug] [Thread-1 (]: Applying DROP to: "postgres"."silver_to_golden"."fct_store_visits__dbt_backup"
[0m07:20:12.565547 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.233 seconds
[0m07:20:12.566251 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.fct_store_visits"
[0m07:20:12.567514 [debug] [Thread-3 (]: On model.retail_dbt.fct_shipments: Close
[0m07:20:12.567903 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.fct_store_visits"} */
drop table if exists "postgres"."silver_to_golden"."fct_store_visits__dbt_backup" cascade
[0m07:20:12.568578 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0981a81d0>]}
[0m07:20:12.569162 [info ] [Thread-3 (]: 21 of 23 OK created sql table model silver_to_golden.fct_shipments ............. [[32mSELECT 368[0m in 4.32s]
[0m07:20:12.569745 [debug] [Thread-3 (]: Finished running node model.retail_dbt.fct_shipments
[0m07:20:12.796460 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.228 seconds
[0m07:20:12.797673 [debug] [Thread-1 (]: On model.retail_dbt.fct_store_visits: Close
[0m07:20:12.798254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678678b4-34aa-4ee4-bc54-749aa86ea9a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af0981265d0>]}
[0m07:20:14.080101 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m07:20:14.080873 [info ] [Thread-1 (]: 23 of 23 OK created sql table model silver_to_golden.fct_store_visits .......... [[32mSELECT 8999[0m in 3.25s]
[0m07:20:14.081386 [debug] [Thread-1 (]: Finished running node model.retail_dbt.fct_store_visits
[0m07:20:14.083398 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:14.083785 [debug] [MainThread]: On master: BEGIN
[0m07:20:14.084038 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:20:18.582632 [debug] [MainThread]: SQL status: BEGIN in 2.744 seconds
[0m07:20:18.583307 [debug] [MainThread]: On master: COMMIT
[0m07:20:18.583756 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:18.584112 [debug] [MainThread]: On master: COMMIT
[0m07:20:18.893675 [debug] [MainThread]: SQL status: COMMIT in 0.309 seconds
[0m07:20:18.894184 [debug] [MainThread]: On master: Close
[0m07:20:18.894950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:18.895331 [debug] [MainThread]: Connection 'model.retail_dbt.fct_sales_items' was properly closed.
[0m07:20:18.895654 [debug] [MainThread]: Connection 'model.retail_dbt.fct_shipments' was properly closed.
[0m07:20:18.896014 [debug] [MainThread]: Connection 'model.retail_dbt.fct_store_visits' was properly closed.
[0m07:20:18.896314 [debug] [MainThread]: Connection 'model.retail_dbt.fct_stock_movements' was properly closed.
[0m07:20:18.896765 [info ] [MainThread]: 
[0m07:20:18.897127 [info ] [MainThread]: Finished running 23 table models in 0 hours 0 minutes and 42.62 seconds (42.62s).
[0m07:20:18.900133 [debug] [MainThread]: Command end result
[0m07:20:19.066688 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:20:19.069698 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:20:19.074933 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:20:19.075248 [info ] [MainThread]: 
[0m07:20:19.075621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:20:19.075948 [info ] [MainThread]: 
[0m07:20:19.076295 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m07:20:19.077121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.033794, "process_in_blocks": "0", "process_kernel_time": 0.371177, "process_mem_max_rss": "142784", "process_out_blocks": "10064", "process_user_time": 3.126764}
[0m07:20:19.077531 [debug] [MainThread]: Command `dbt run` succeeded at 07:20:19.077435 after 41.03 seconds
[0m07:20:19.077923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d894fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d897a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af09d894ef0>]}
[0m07:20:19.078253 [debug] [MainThread]: Flushing usage events
[0m07:20:20.322376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:20:23.436079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efda75f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efdc668fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efda43ad20>]}


============================== 07:20:23.442029 | c16f8bdb-c6eb-478c-a3c6-dc8c8882e059 ==============================
[0m07:20:23.442029 [info ] [MainThread]: Running with dbt=1.10.9
[0m07:20:23.442480 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --select path:models/golden --profiles-dir /home/airflow/.dbt', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'profiles_dir': '/home/airflow/.dbt', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m07:20:23.594484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c16f8bdb-c6eb-478c-a3c6-dc8c8882e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd9b16570>]}
[0m07:20:23.642644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c16f8bdb-c6eb-478c-a3c6-dc8c8882e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efda7a2f30>]}
[0m07:20:23.643297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:20:23.731679 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m07:20:23.870592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:20:23.870917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:20:23.922419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c16f8bdb-c6eb-478c-a3c6-dc8c8882e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd8ff2d80>]}
[0m07:20:24.099368 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:20:24.101745 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:20:24.142677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c16f8bdb-c6eb-478c-a3c6-dc8c8882e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd93f9640>]}
[0m07:20:24.143054 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m07:20:24.143380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c16f8bdb-c6eb-478c-a3c6-dc8c8882e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd76eaa20>]}
[0m07:20:24.157826 [info ] [MainThread]: 
[0m07:20:24.158145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:20:24.158439 [info ] [MainThread]: 
[0m07:20:24.158874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:20:24.165377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m07:20:24.166097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m07:20:24.171977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m07:20:24.176017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_staging'
[0m07:20:24.200324 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:20:24.200633 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:20:24.200948 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m07:20:24.201270 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:20:24.201647 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:20:24.201978 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m07:20:24.202290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:24.202626 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m07:20:24.202956 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m07:20:24.203291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:24.203750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:24.204122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:26.351363 [debug] [ThreadPool]: SQL status: BEGIN in 2.148 seconds
[0m07:20:26.351749 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m07:20:26.352043 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m07:20:26.362071 [debug] [ThreadPool]: SQL status: BEGIN in 2.160 seconds
[0m07:20:26.362370 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m07:20:26.362639 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m07:20:26.581701 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.229 seconds
[0m07:20:26.583301 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m07:20:26.591203 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.228 seconds
[0m07:20:26.592420 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m07:20:26.603401 [debug] [ThreadPool]: SQL status: BEGIN in 2.400 seconds
[0m07:20:26.603728 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m07:20:26.604029 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m07:20:26.625716 [debug] [ThreadPool]: SQL status: BEGIN in 2.422 seconds
[0m07:20:26.626135 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m07:20:26.626436 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m07:20:26.810383 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m07:20:26.862442 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.258 seconds
[0m07:20:26.863842 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m07:20:26.887690 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.261 seconds
[0m07:20:26.888991 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m07:20:27.120475 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m07:20:27.144909 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m07:20:27.273764 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m07:20:27.284357 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:27.284663 [debug] [MainThread]: On master: BEGIN
[0m07:20:27.284900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:20:29.864388 [debug] [MainThread]: SQL status: BEGIN in 2.579 seconds
[0m07:20:29.864772 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:29.865127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:20:30.092181 [debug] [MainThread]: SQL status: SELECT 40 in 0.227 seconds
[0m07:20:30.093927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c16f8bdb-c6eb-478c-a3c6-dc8c8882e059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd930a2d0>]}
[0m07:20:30.094369 [debug] [MainThread]: On master: ROLLBACK
[0m07:20:30.314869 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:30.315298 [debug] [MainThread]: On master: BEGIN
[0m07:20:30.757346 [debug] [MainThread]: SQL status: BEGIN in 0.442 seconds
[0m07:20:30.757854 [debug] [MainThread]: On master: COMMIT
[0m07:20:30.758142 [debug] [MainThread]: Using postgres connection "master"
[0m07:20:30.758438 [debug] [MainThread]: On master: COMMIT
[0m07:20:30.978681 [debug] [MainThread]: SQL status: COMMIT in 0.220 seconds
[0m07:20:30.979121 [debug] [MainThread]: On master: Close
[0m07:20:30.985795 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772
[0m07:20:30.986271 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5
[0m07:20:30.987048 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6
[0m07:20:30.987535 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239
[0m07:20:30.986655 [info ] [Thread-1 (]: 1 of 262 START test not_null_dim_brands_scd_brand_id ........................... [RUN]
[0m07:20:30.988078 [info ] [Thread-2 (]: 2 of 262 START test not_null_dim_brands_scd_brand_sk ........................... [RUN]
[0m07:20:30.988554 [info ] [Thread-3 (]: 3 of 262 START test not_null_dim_brands_scd_dbt_scd_id ......................... [RUN]
[0m07:20:30.989036 [info ] [Thread-4 (]: 4 of 262 START test not_null_dim_brands_scd_dbt_updated_at ..................... [RUN]
[0m07:20:30.989530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772)
[0m07:20:30.989936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5)
[0m07:20:30.990303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6)
[0m07:20:30.990718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239)
[0m07:20:30.991071 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772
[0m07:20:30.991437 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5
[0m07:20:30.991821 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6
[0m07:20:30.992179 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239
[0m07:20:31.006810 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5"
[0m07:20:31.008474 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772"
[0m07:20:31.011742 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6"
[0m07:20:31.014988 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239"
[0m07:20:31.015950 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772
[0m07:20:31.016398 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5
[0m07:20:31.022156 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6
[0m07:20:31.030874 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772"
[0m07:20:31.033650 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5"
[0m07:20:31.073271 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6"
[0m07:20:31.073688 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239
[0m07:20:31.074590 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772"
[0m07:20:31.076765 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239"
[0m07:20:31.077231 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5"
[0m07:20:31.077615 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772: BEGIN
[0m07:20:31.077978 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6"
[0m07:20:31.078420 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5: BEGIN
[0m07:20:31.078782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:31.079155 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239"
[0m07:20:31.079462 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6: BEGIN
[0m07:20:31.079811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:31.080323 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239: BEGIN
[0m07:20:31.080701 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:31.081265 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:33.804435 [debug] [Thread-1 (]: SQL status: BEGIN in 2.726 seconds
[0m07:20:33.804835 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772"
[0m07:20:33.805146 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select brand_id
from "postgres"."silver_to_golden"."dim_brands_scd"
where brand_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:34.034158 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.229 seconds
[0m07:20:34.037543 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772: ROLLBACK
[0m07:20:34.037897 [debug] [Thread-4 (]: SQL status: BEGIN in 2.957 seconds
[0m07:20:34.038262 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239"
[0m07:20:34.038612 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_brands_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:34.123056 [debug] [Thread-3 (]: SQL status: BEGIN in 3.042 seconds
[0m07:20:34.123367 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6"
[0m07:20:34.123662 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_brands_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:34.261338 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772: Close
[0m07:20:34.262212 [info ] [Thread-1 (]: 1 of 262 PASS not_null_dim_brands_scd_brand_id ................................. [[32mPASS[0m in 3.27s]
[0m07:20:34.262731 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772
[0m07:20:34.263105 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295
[0m07:20:34.263575 [info ] [Thread-1 (]: 5 of 262 START test not_null_dim_brands_scd_dbt_valid_from ..................... [RUN]
[0m07:20:34.264006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_brand_id.3b2e1b3772, now test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295)
[0m07:20:34.264301 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295
[0m07:20:34.267495 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295"
[0m07:20:34.267987 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295
[0m07:20:34.269861 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295"
[0m07:20:34.270360 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295"
[0m07:20:34.270645 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295: BEGIN
[0m07:20:34.270971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:34.296576 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.258 seconds
[0m07:20:34.297793 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239: ROLLBACK
[0m07:20:34.389032 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.265 seconds
[0m07:20:34.390236 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6: ROLLBACK
[0m07:20:34.561836 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239: Close
[0m07:20:34.562687 [info ] [Thread-4 (]: 4 of 262 PASS not_null_dim_brands_scd_dbt_updated_at ........................... [[32mPASS[0m in 3.57s]
[0m07:20:34.563254 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239
[0m07:20:34.563662 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a
[0m07:20:34.564120 [info ] [Thread-4 (]: 6 of 262 START test not_null_dim_brands_scd_dbt_valid_to ....................... [RUN]
[0m07:20:34.564576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_dbt_updated_at.909731b239, now test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a)
[0m07:20:34.564928 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a
[0m07:20:34.568380 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a"
[0m07:20:34.568913 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a
[0m07:20:34.570713 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a"
[0m07:20:34.571224 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a"
[0m07:20:34.571580 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a: BEGIN
[0m07:20:34.571906 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:34.670277 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6: Close
[0m07:20:34.671184 [info ] [Thread-3 (]: 3 of 262 PASS not_null_dim_brands_scd_dbt_scd_id ............................... [[32mPASS[0m in 3.68s]
[0m07:20:34.671826 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6
[0m07:20:34.672222 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55
[0m07:20:34.672630 [info ] [Thread-3 (]: 7 of 262 START test not_null_dim_brands_scd_is_current ......................... [RUN]
[0m07:20:34.673086 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_dbt_scd_id.ad68bfdaf6, now test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55)
[0m07:20:34.673449 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55
[0m07:20:34.677180 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55"
[0m07:20:34.677726 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55
[0m07:20:34.680777 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55"
[0m07:20:34.681325 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55"
[0m07:20:34.681695 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55: BEGIN
[0m07:20:34.681998 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:34.715599 [debug] [Thread-2 (]: SQL status: BEGIN in 3.636 seconds
[0m07:20:34.716104 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5"
[0m07:20:34.716560 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select brand_sk
from "postgres"."silver_to_golden"."dim_brands_scd"
where brand_sk is null



  
  
      
    ) dbt_internal_test
[0m07:20:34.991872 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:20:34.993269 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5: ROLLBACK
[0m07:20:35.811001 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5: Close
[0m07:20:35.811947 [info ] [Thread-2 (]: 2 of 262 PASS not_null_dim_brands_scd_brand_sk ................................. [[32mPASS[0m in 4.82s]
[0m07:20:35.812636 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5
[0m07:20:35.813088 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4
[0m07:20:35.813581 [info ] [Thread-2 (]: 8 of 262 START test not_null_dim_brands_scd_name ............................... [RUN]
[0m07:20:35.814073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_brand_sk.d9538046e5, now test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4)
[0m07:20:35.814464 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4
[0m07:20:35.818153 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4"
[0m07:20:35.818693 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4
[0m07:20:35.820657 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4"
[0m07:20:35.821163 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4"
[0m07:20:35.821530 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4: BEGIN
[0m07:20:35.821836 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:36.417875 [debug] [Thread-1 (]: SQL status: BEGIN in 2.147 seconds
[0m07:20:36.418408 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295"
[0m07:20:36.418835 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_brands_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:20:36.664824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.246 seconds
[0m07:20:36.666506 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295: ROLLBACK
[0m07:20:36.915220 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295: Close
[0m07:20:36.916371 [info ] [Thread-1 (]: 5 of 262 PASS not_null_dim_brands_scd_dbt_valid_from ........................... [[32mPASS[0m in 2.65s]
[0m07:20:36.917144 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295
[0m07:20:36.917593 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5
[0m07:20:36.918034 [info ] [Thread-1 (]: 9 of 262 START test not_null_dim_brands_scd_staged_at .......................... [RUN]
[0m07:20:36.918493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_dbt_valid_from.3d7351d295, now test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5)
[0m07:20:36.918859 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5
[0m07:20:36.922790 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5"
[0m07:20:36.923400 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5
[0m07:20:36.925535 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5"
[0m07:20:36.926118 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5"
[0m07:20:36.926436 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5: BEGIN
[0m07:20:36.926762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:37.098766 [debug] [Thread-4 (]: SQL status: BEGIN in 2.527 seconds
[0m07:20:37.099316 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a"
[0m07:20:37.099806 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_brands_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:20:37.310835 [debug] [Thread-3 (]: SQL status: BEGIN in 2.629 seconds
[0m07:20:37.311489 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55"
[0m07:20:37.311907 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_brands_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:20:37.375727 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:20:37.377207 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a: ROLLBACK
[0m07:20:37.565305 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.253 seconds
[0m07:20:37.566898 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55: ROLLBACK
[0m07:20:37.838369 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55: Close
[0m07:20:37.839322 [info ] [Thread-3 (]: 7 of 262 PASS not_null_dim_brands_scd_is_current ............................... [[32mPASS[0m in 3.17s]
[0m07:20:37.839893 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55
[0m07:20:37.840282 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa
[0m07:20:37.840695 [info ] [Thread-3 (]: 10 of 262 START test not_null_dim_brands_scd_valid_from ........................ [RUN]
[0m07:20:37.841129 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_is_current.80ce1d1c55, now test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa)
[0m07:20:37.841537 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa
[0m07:20:37.845056 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa"
[0m07:20:37.845564 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa
[0m07:20:37.847214 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa"
[0m07:20:37.847712 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa"
[0m07:20:37.848022 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa: BEGIN
[0m07:20:37.848330 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:38.098794 [debug] [Thread-2 (]: SQL status: BEGIN in 2.277 seconds
[0m07:20:38.099258 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4"
[0m07:20:38.099603 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_brands_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:20:38.120447 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a: Close
[0m07:20:38.121103 [error] [Thread-4 (]: 6 of 262 FAIL 10 not_null_dim_brands_scd_dbt_valid_to .......................... [[31mFAIL 10[0m in 3.56s]
[0m07:20:38.121660 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a
[0m07:20:38.122050 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0
[0m07:20:38.122439 [info ] [Thread-4 (]: 11 of 262 START test not_null_dim_brands_scd_valid_to .......................... [RUN]
[0m07:20:38.122861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_dbt_valid_to.dfae77005a, now test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0)
[0m07:20:38.123170 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0
[0m07:20:38.127539 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0"
[0m07:20:38.128044 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0
[0m07:20:38.129849 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0"
[0m07:20:38.130343 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0"
[0m07:20:38.130630 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0: BEGIN
[0m07:20:38.130947 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:38.335545 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:20:38.336939 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4: ROLLBACK
[0m07:20:38.565779 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4: Close
[0m07:20:38.566572 [info ] [Thread-2 (]: 8 of 262 PASS not_null_dim_brands_scd_name ..................................... [[32mPASS[0m in 2.75s]
[0m07:20:38.567167 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4
[0m07:20:38.567552 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_campaigns_budget.2df449c486
[0m07:20:38.567946 [info ] [Thread-2 (]: 12 of 262 START test not_null_dim_campaigns_budget ............................. [RUN]
[0m07:20:38.568356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_name.c6466cd9a4, now test.retail_dbt.not_null_dim_campaigns_budget.2df449c486)
[0m07:20:38.568654 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_campaigns_budget.2df449c486
[0m07:20:38.571840 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_campaigns_budget.2df449c486"
[0m07:20:38.572323 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_campaigns_budget.2df449c486
[0m07:20:38.574111 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_campaigns_budget.2df449c486"
[0m07:20:38.574592 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_budget.2df449c486"
[0m07:20:38.574869 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_budget.2df449c486: BEGIN
[0m07:20:38.575189 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:39.254899 [debug] [Thread-1 (]: SQL status: BEGIN in 2.328 seconds
[0m07:20:39.255403 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5"
[0m07:20:39.255765 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select staged_at
from "postgres"."silver_to_golden"."dim_brands_scd"
where staged_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:39.508549 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.252 seconds
[0m07:20:39.509843 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5: ROLLBACK
[0m07:20:39.768833 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5: Close
[0m07:20:39.769722 [info ] [Thread-1 (]: 9 of 262 PASS not_null_dim_brands_scd_staged_at ................................ [[32mPASS[0m in 2.85s]
[0m07:20:39.770310 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5
[0m07:20:39.770702 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344
[0m07:20:39.771146 [info ] [Thread-1 (]: 13 of 262 START test not_null_dim_campaigns_campaign_id ........................ [RUN]
[0m07:20:39.771551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_staged_at.c1b687ebe5, now test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344)
[0m07:20:39.771847 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344
[0m07:20:39.775176 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344"
[0m07:20:39.775680 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344
[0m07:20:39.777691 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344"
[0m07:20:39.778184 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344"
[0m07:20:39.778496 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344: BEGIN
[0m07:20:39.778815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:40.484556 [debug] [Thread-4 (]: SQL status: BEGIN in 2.354 seconds
[0m07:20:40.484990 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0"
[0m07:20:40.485328 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_brands_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:20:40.679763 [debug] [Thread-3 (]: SQL status: BEGIN in 2.831 seconds
[0m07:20:40.680279 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa"
[0m07:20:40.680600 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_brands_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:20:40.721174 [debug] [Thread-2 (]: SQL status: BEGIN in 2.146 seconds
[0m07:20:40.721740 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_budget.2df449c486"
[0m07:20:40.722147 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_budget.2df449c486: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_campaigns_budget.2df449c486"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select budget
from "postgres"."silver_to_golden"."dim_campaigns"
where budget is null



  
  
      
    ) dbt_internal_test
[0m07:20:40.751989 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.266 seconds
[0m07:20:40.753633 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0: ROLLBACK
[0m07:20:40.936002 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.255 seconds
[0m07:20:40.937341 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa: ROLLBACK
[0m07:20:41.019035 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0: Close
[0m07:20:41.019723 [error] [Thread-4 (]: 11 of 262 FAIL 10 not_null_dim_brands_scd_valid_to ............................. [[31mFAIL 10[0m in 2.90s]
[0m07:20:41.020267 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0
[0m07:20:41.020644 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4
[0m07:20:41.021039 [info ] [Thread-4 (]: 14 of 262 START test not_null_dim_campaigns_end_date ........................... [RUN]
[0m07:20:41.021406 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_valid_to.c5332449c0, now test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4)
[0m07:20:41.021779 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4
[0m07:20:41.024950 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4"
[0m07:20:41.025449 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4
[0m07:20:41.027156 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4"
[0m07:20:41.027686 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4"
[0m07:20:41.028006 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4: BEGIN
[0m07:20:41.028319 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:41.190462 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa: Close
[0m07:20:41.192469 [info ] [Thread-3 (]: 10 of 262 PASS not_null_dim_brands_scd_valid_from .............................. [[32mPASS[0m in 3.35s]
[0m07:20:41.193058 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa
[0m07:20:41.193441 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_campaigns_name.96fa971944
[0m07:20:41.193869 [info ] [Thread-3 (]: 15 of 262 START test not_null_dim_campaigns_name ............................... [RUN]
[0m07:20:41.194282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_brands_scd_valid_from.56ca0ccdfa, now test.retail_dbt.not_null_dim_campaigns_name.96fa971944)
[0m07:20:41.194613 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_campaigns_name.96fa971944
[0m07:20:41.197618 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_campaigns_name.96fa971944"
[0m07:20:41.198156 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_campaigns_name.96fa971944
[0m07:20:41.200052 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_campaigns_name.96fa971944"
[0m07:20:41.200554 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_name.96fa971944"
[0m07:20:41.200880 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_campaigns_name.96fa971944: BEGIN
[0m07:20:41.201166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:41.429784 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.707 seconds
[0m07:20:41.431082 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_budget.2df449c486: ROLLBACK
[0m07:20:41.651242 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_budget.2df449c486: Close
[0m07:20:41.652052 [info ] [Thread-2 (]: 12 of 262 PASS not_null_dim_campaigns_budget ................................... [[32mPASS[0m in 3.08s]
[0m07:20:41.652590 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_campaigns_budget.2df449c486
[0m07:20:41.652959 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396
[0m07:20:41.653409 [info ] [Thread-2 (]: 16 of 262 START test not_null_dim_campaigns_staged_at .......................... [RUN]
[0m07:20:41.653873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_campaigns_budget.2df449c486, now test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396)
[0m07:20:41.654168 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396
[0m07:20:41.657303 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396"
[0m07:20:41.657814 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396
[0m07:20:41.659507 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396"
[0m07:20:41.659993 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396"
[0m07:20:41.660314 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396: BEGIN
[0m07:20:41.660613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:42.097173 [debug] [Thread-1 (]: SQL status: BEGIN in 2.318 seconds
[0m07:20:42.097741 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344"
[0m07:20:42.098083 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select campaign_id
from "postgres"."silver_to_golden"."dim_campaigns"
where campaign_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:42.373677 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:20:42.375096 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344: ROLLBACK
[0m07:20:42.647226 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344: Close
[0m07:20:42.648184 [info ] [Thread-1 (]: 13 of 262 PASS not_null_dim_campaigns_campaign_id .............................. [[32mPASS[0m in 2.88s]
[0m07:20:42.648759 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344
[0m07:20:42.649130 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761
[0m07:20:42.649645 [info ] [Thread-1 (]: 17 of 262 START test not_null_dim_campaigns_start_date ......................... [RUN]
[0m07:20:42.650119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_campaigns_campaign_id.b113a46344, now test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761)
[0m07:20:42.650474 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761
[0m07:20:42.654035 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761"
[0m07:20:42.654608 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761
[0m07:20:42.656501 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761"
[0m07:20:42.657035 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761"
[0m07:20:42.657374 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761: BEGIN
[0m07:20:42.657712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:43.321408 [debug] [Thread-3 (]: SQL status: BEGIN in 2.120 seconds
[0m07:20:43.321932 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_name.96fa971944"
[0m07:20:43.322329 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_campaigns_name.96fa971944: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_campaigns_name.96fa971944"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_campaigns"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:20:43.336454 [debug] [Thread-4 (]: SQL status: BEGIN in 2.308 seconds
[0m07:20:43.336808 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4"
[0m07:20:43.337173 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "postgres"."silver_to_golden"."dim_campaigns"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m07:20:43.562564 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:20:43.563941 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_campaigns_name.96fa971944: ROLLBACK
[0m07:20:43.584983 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.247 seconds
[0m07:20:43.586578 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4: ROLLBACK
[0m07:20:43.802509 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_campaigns_name.96fa971944: Close
[0m07:20:43.803411 [info ] [Thread-3 (]: 15 of 262 PASS not_null_dim_campaigns_name ..................................... [[32mPASS[0m in 2.61s]
[0m07:20:43.803969 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_campaigns_name.96fa971944
[0m07:20:43.804368 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4
[0m07:20:43.804786 [info ] [Thread-3 (]: 18 of 262 START test not_null_dim_categories_scd_category_id ................... [RUN]
[0m07:20:43.805181 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_campaigns_name.96fa971944, now test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4)
[0m07:20:43.805585 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4
[0m07:20:43.808944 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4"
[0m07:20:43.809492 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4
[0m07:20:43.812336 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4"
[0m07:20:43.812854 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4"
[0m07:20:43.813184 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4: BEGIN
[0m07:20:43.813523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:43.839470 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4: Close
[0m07:20:43.840240 [info ] [Thread-4 (]: 14 of 262 PASS not_null_dim_campaigns_end_date ................................. [[32mPASS[0m in 2.82s]
[0m07:20:43.840793 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4
[0m07:20:43.841156 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf
[0m07:20:43.841607 [info ] [Thread-4 (]: 19 of 262 START test not_null_dim_categories_scd_category_sk ................... [RUN]
[0m07:20:43.842021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_campaigns_end_date.1c340a76b4, now test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf)
[0m07:20:43.842394 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf
[0m07:20:43.845272 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf"
[0m07:20:43.845753 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf
[0m07:20:43.847529 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf"
[0m07:20:43.848037 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf"
[0m07:20:43.848383 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf: BEGIN
[0m07:20:43.848738 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:44.226739 [debug] [Thread-2 (]: SQL status: BEGIN in 2.566 seconds
[0m07:20:44.227384 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396"
[0m07:20:44.227740 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select staged_at
from "postgres"."silver_to_golden"."dim_campaigns"
where staged_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:44.509792 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.282 seconds
[0m07:20:44.511186 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396: ROLLBACK
[0m07:20:44.794764 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396: Close
[0m07:20:44.795788 [info ] [Thread-2 (]: 16 of 262 PASS not_null_dim_campaigns_staged_at ................................ [[32mPASS[0m in 3.14s]
[0m07:20:44.796483 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396
[0m07:20:44.797035 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8
[0m07:20:44.797869 [info ] [Thread-2 (]: 20 of 262 START test not_null_dim_categories_scd_dbt_scd_id .................... [RUN]
[0m07:20:44.798576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_campaigns_staged_at.8cda809396, now test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8)
[0m07:20:44.799073 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8
[0m07:20:44.803928 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8"
[0m07:20:44.804687 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8
[0m07:20:44.807542 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8"
[0m07:20:44.808162 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8"
[0m07:20:44.808574 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8: BEGIN
[0m07:20:44.808936 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:44.992202 [debug] [Thread-1 (]: SQL status: BEGIN in 2.334 seconds
[0m07:20:44.992734 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761"
[0m07:20:44.993129 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "postgres"."silver_to_golden"."dim_campaigns"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m07:20:45.252577 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.259 seconds
[0m07:20:45.254373 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761: ROLLBACK
[0m07:20:45.494797 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761: Close
[0m07:20:45.495559 [info ] [Thread-1 (]: 17 of 262 PASS not_null_dim_campaigns_start_date ............................... [[32mPASS[0m in 2.85s]
[0m07:20:45.496065 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761
[0m07:20:45.496447 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39
[0m07:20:45.496876 [info ] [Thread-1 (]: 21 of 262 START test not_null_dim_categories_scd_dbt_updated_at ................ [RUN]
[0m07:20:45.497318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_campaigns_start_date.482b5b3761, now test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39)
[0m07:20:45.497643 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39
[0m07:20:45.500765 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39"
[0m07:20:45.501264 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39
[0m07:20:45.503057 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39"
[0m07:20:45.503556 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39"
[0m07:20:45.503875 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39: BEGIN
[0m07:20:45.504187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:46.169942 [debug] [Thread-3 (]: SQL status: BEGIN in 2.356 seconds
[0m07:20:46.170388 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4"
[0m07:20:46.170764 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from "postgres"."silver_to_golden"."dim_categories_scd"
where category_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:46.415048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.244 seconds
[0m07:20:46.416268 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4: ROLLBACK
[0m07:20:46.627428 [debug] [Thread-4 (]: SQL status: BEGIN in 2.779 seconds
[0m07:20:46.627906 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf"
[0m07:20:46.628225 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_sk
from "postgres"."silver_to_golden"."dim_categories_scd"
where category_sk is null



  
  
      
    ) dbt_internal_test
[0m07:20:46.661432 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4: Close
[0m07:20:46.662306 [info ] [Thread-3 (]: 18 of 262 PASS not_null_dim_categories_scd_category_id ......................... [[32mPASS[0m in 2.86s]
[0m07:20:46.662843 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4
[0m07:20:46.663240 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca
[0m07:20:46.663671 [info ] [Thread-3 (]: 22 of 262 START test not_null_dim_categories_scd_dbt_valid_from ................ [RUN]
[0m07:20:46.664060 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_category_id.d57e3f2fe4, now test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca)
[0m07:20:46.664420 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca
[0m07:20:46.668406 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca"
[0m07:20:46.668901 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca
[0m07:20:46.670625 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca"
[0m07:20:46.671108 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca"
[0m07:20:46.671449 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca: BEGIN
[0m07:20:46.671731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:46.870272 [debug] [Thread-2 (]: SQL status: BEGIN in 2.061 seconds
[0m07:20:46.870689 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8"
[0m07:20:46.871005 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_categories_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:46.914892 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.286 seconds
[0m07:20:46.916306 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf: ROLLBACK
[0m07:20:47.091483 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.220 seconds
[0m07:20:47.092737 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8: ROLLBACK
[0m07:20:47.205790 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf: Close
[0m07:20:47.206626 [info ] [Thread-4 (]: 19 of 262 PASS not_null_dim_categories_scd_category_sk ......................... [[32mPASS[0m in 3.36s]
[0m07:20:47.207210 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf
[0m07:20:47.207661 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640
[0m07:20:47.208174 [info ] [Thread-4 (]: 23 of 262 START test not_null_dim_categories_scd_dbt_valid_to .................. [RUN]
[0m07:20:47.208662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_category_sk.96df2a66cf, now test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640)
[0m07:20:47.209075 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640
[0m07:20:47.212982 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640"
[0m07:20:47.213600 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640
[0m07:20:47.215624 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640"
[0m07:20:47.216223 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640"
[0m07:20:47.216525 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640: BEGIN
[0m07:20:47.216839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:47.344863 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8: Close
[0m07:20:47.345788 [info ] [Thread-2 (]: 20 of 262 PASS not_null_dim_categories_scd_dbt_scd_id .......................... [[32mPASS[0m in 2.55s]
[0m07:20:47.346328 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8
[0m07:20:47.346716 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7
[0m07:20:47.347153 [info ] [Thread-2 (]: 24 of 262 START test not_null_dim_categories_scd_is_current .................... [RUN]
[0m07:20:47.347597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_dbt_scd_id.dd413e98d8, now test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7)
[0m07:20:47.347927 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7
[0m07:20:47.351078 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7"
[0m07:20:47.351549 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7
[0m07:20:47.353242 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7"
[0m07:20:47.353745 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7"
[0m07:20:47.354029 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7: BEGIN
[0m07:20:47.354329 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:49.680608 [debug] [Thread-1 (]: SQL status: BEGIN in 2.435 seconds
[0m07:20:49.681053 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39"
[0m07:20:49.681378 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_categories_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:49.945384 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:20:49.947062 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39: ROLLBACK
[0m07:20:50.223399 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39: Close
[0m07:20:50.224420 [info ] [Thread-1 (]: 21 of 262 PASS not_null_dim_categories_scd_dbt_updated_at ...................... [[32mPASS[0m in 4.73s]
[0m07:20:50.225228 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39
[0m07:20:50.225820 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126
[0m07:20:50.226553 [info ] [Thread-1 (]: 25 of 262 START test not_null_dim_categories_scd_name .......................... [RUN]
[0m07:20:50.227138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_dbt_updated_at.db8d94fc39, now test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126)
[0m07:20:50.227576 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126
[0m07:20:50.231674 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126"
[0m07:20:50.232214 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126
[0m07:20:50.235160 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126"
[0m07:20:50.235732 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126"
[0m07:20:50.236048 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126: BEGIN
[0m07:20:50.236361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:50.498093 [debug] [Thread-3 (]: SQL status: BEGIN in 2.085 seconds
[0m07:20:50.498637 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca"
[0m07:20:50.499066 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_categories_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:20:50.744734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:20:50.746329 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca: ROLLBACK
[0m07:20:50.993060 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca: Close
[0m07:20:50.994063 [info ] [Thread-3 (]: 22 of 262 PASS not_null_dim_categories_scd_dbt_valid_from ...................... [[32mPASS[0m in 4.33s]
[0m07:20:50.994748 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca
[0m07:20:50.995229 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0
[0m07:20:50.995699 [info ] [Thread-3 (]: 26 of 262 START test not_null_dim_categories_scd_staged_at ..................... [RUN]
[0m07:20:50.996202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_dbt_valid_from.f655d038ca, now test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0)
[0m07:20:50.996593 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0
[0m07:20:51.001168 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0"
[0m07:20:51.001934 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0
[0m07:20:51.004823 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0"
[0m07:20:51.005610 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0"
[0m07:20:51.006097 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0: BEGIN
[0m07:20:51.006574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:51.172221 [debug] [Thread-4 (]: SQL status: BEGIN in 2.214 seconds
[0m07:20:51.172661 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640"
[0m07:20:51.173004 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_categories_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:20:51.426911 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.253 seconds
[0m07:20:51.428429 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640: ROLLBACK
[0m07:20:51.652567 [debug] [Thread-2 (]: SQL status: BEGIN in 2.557 seconds
[0m07:20:51.653140 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7"
[0m07:20:51.653633 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_categories_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:20:51.683249 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640: Close
[0m07:20:51.684103 [error] [Thread-4 (]: 23 of 262 FAIL 10 not_null_dim_categories_scd_dbt_valid_to ..................... [[31mFAIL 10[0m in 4.48s]
[0m07:20:51.684724 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640
[0m07:20:51.685129 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686
[0m07:20:51.685586 [info ] [Thread-4 (]: 27 of 262 START test not_null_dim_categories_scd_valid_from .................... [RUN]
[0m07:20:51.686067 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_dbt_valid_to.997f516640, now test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686)
[0m07:20:51.686394 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686
[0m07:20:51.690029 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686"
[0m07:20:51.690597 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686
[0m07:20:51.692654 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686"
[0m07:20:51.693186 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686"
[0m07:20:51.693500 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686: BEGIN
[0m07:20:51.693854 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:51.956711 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.303 seconds
[0m07:20:51.958353 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7: ROLLBACK
[0m07:20:52.253269 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7: Close
[0m07:20:52.254094 [info ] [Thread-2 (]: 24 of 262 PASS not_null_dim_categories_scd_is_current .......................... [[32mPASS[0m in 4.91s]
[0m07:20:52.254780 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7
[0m07:20:52.255230 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046
[0m07:20:52.255672 [info ] [Thread-2 (]: 28 of 262 START test not_null_dim_categories_scd_valid_to ...................... [RUN]
[0m07:20:52.256121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_is_current.e82f2605e7, now test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046)
[0m07:20:52.256437 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046
[0m07:20:52.260162 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046"
[0m07:20:52.260752 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046
[0m07:20:52.263143 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046"
[0m07:20:52.263696 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046"
[0m07:20:52.264040 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046: BEGIN
[0m07:20:52.264341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:52.726375 [debug] [Thread-1 (]: SQL status: BEGIN in 2.490 seconds
[0m07:20:52.726863 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126"
[0m07:20:52.727218 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_categories_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:20:53.000489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:20:53.001996 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126: ROLLBACK
[0m07:20:53.278643 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126: Close
[0m07:20:53.279562 [info ] [Thread-1 (]: 25 of 262 PASS not_null_dim_categories_scd_name ................................ [[32mPASS[0m in 3.05s]
[0m07:20:53.280248 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126
[0m07:20:53.280743 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165
[0m07:20:53.281259 [info ] [Thread-1 (]: 29 of 262 START test not_null_dim_customers_scd_created_at ..................... [RUN]
[0m07:20:53.281992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_name.e1787b6126, now test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165)
[0m07:20:53.282466 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165
[0m07:20:53.286420 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165"
[0m07:20:53.286970 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165
[0m07:20:53.289844 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165"
[0m07:20:53.290395 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165"
[0m07:20:53.290770 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165: BEGIN
[0m07:20:53.291068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:53.581526 [debug] [Thread-3 (]: SQL status: BEGIN in 2.575 seconds
[0m07:20:53.582055 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0"
[0m07:20:53.582384 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select staged_at
from "postgres"."silver_to_golden"."dim_categories_scd"
where staged_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:53.867175 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.284 seconds
[0m07:20:53.868595 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0: ROLLBACK
[0m07:20:54.156111 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0: Close
[0m07:20:54.157017 [info ] [Thread-3 (]: 26 of 262 PASS not_null_dim_categories_scd_staged_at ........................... [[32mPASS[0m in 3.16s]
[0m07:20:54.157607 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0
[0m07:20:54.158015 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b
[0m07:20:54.158428 [info ] [Thread-3 (]: 30 of 262 START test not_null_dim_customers_scd_customer_id .................... [RUN]
[0m07:20:54.158895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_staged_at.03ba82dab0, now test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b)
[0m07:20:54.159258 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b
[0m07:20:54.162719 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b"
[0m07:20:54.163263 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b
[0m07:20:54.165017 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b"
[0m07:20:54.165547 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b"
[0m07:20:54.165915 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b: BEGIN
[0m07:20:54.166259 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:54.482250 [debug] [Thread-2 (]: SQL status: BEGIN in 2.218 seconds
[0m07:20:54.482757 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046"
[0m07:20:54.483103 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_categories_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:20:54.727031 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.243 seconds
[0m07:20:54.728415 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046: ROLLBACK
[0m07:20:54.730763 [debug] [Thread-4 (]: SQL status: BEGIN in 3.037 seconds
[0m07:20:54.731150 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686"
[0m07:20:54.731574 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_categories_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:20:54.971138 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046: Close
[0m07:20:54.972081 [error] [Thread-2 (]: 28 of 262 FAIL 10 not_null_dim_categories_scd_valid_to ......................... [[31mFAIL 10[0m in 2.72s]
[0m07:20:54.972778 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046
[0m07:20:54.973234 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73
[0m07:20:54.973731 [info ] [Thread-2 (]: 31 of 262 START test not_null_dim_customers_scd_customer_sk .................... [RUN]
[0m07:20:54.974173 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_valid_to.39024b6046, now test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73)
[0m07:20:54.974596 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73
[0m07:20:54.978264 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73"
[0m07:20:54.978827 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73
[0m07:20:54.980849 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73"
[0m07:20:54.981209 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.249 seconds
[0m07:20:54.982685 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686: ROLLBACK
[0m07:20:54.983182 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73"
[0m07:20:54.983618 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73: BEGIN
[0m07:20:54.984025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:55.220358 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686: Close
[0m07:20:55.221244 [info ] [Thread-4 (]: 27 of 262 PASS not_null_dim_categories_scd_valid_from .......................... [[32mPASS[0m in 3.54s]
[0m07:20:55.221992 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686
[0m07:20:55.222445 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3
[0m07:20:55.222978 [info ] [Thread-4 (]: 32 of 262 START test not_null_dim_customers_scd_dbt_scd_id ..................... [RUN]
[0m07:20:55.223393 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_categories_scd_valid_from.3f6c56d686, now test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3)
[0m07:20:55.223686 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3
[0m07:20:55.226703 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3"
[0m07:20:55.227185 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3
[0m07:20:55.228924 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3"
[0m07:20:55.229398 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3"
[0m07:20:55.229690 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3: BEGIN
[0m07:20:55.229994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:55.720269 [debug] [Thread-1 (]: SQL status: BEGIN in 2.429 seconds
[0m07:20:55.720756 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165"
[0m07:20:55.721184 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from "postgres"."silver_to_golden"."dim_customers_scd"
where created_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:55.970236 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.249 seconds
[0m07:20:55.971722 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165: ROLLBACK
[0m07:20:56.226369 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165: Close
[0m07:20:56.227285 [info ] [Thread-1 (]: 29 of 262 PASS not_null_dim_customers_scd_created_at ........................... [[32mPASS[0m in 2.95s]
[0m07:20:56.227995 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165
[0m07:20:56.228462 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd
[0m07:20:56.228971 [info ] [Thread-1 (]: 33 of 262 START test not_null_dim_customers_scd_dbt_updated_at ................. [RUN]
[0m07:20:56.229482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_created_at.6b44bd0165, now test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd)
[0m07:20:56.229887 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd
[0m07:20:56.234185 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd"
[0m07:20:56.234706 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd
[0m07:20:56.236447 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd"
[0m07:20:56.236947 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd"
[0m07:20:56.237251 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd: BEGIN
[0m07:20:56.237529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:56.706859 [debug] [Thread-3 (]: SQL status: BEGIN in 2.540 seconds
[0m07:20:56.707335 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b"
[0m07:20:56.707645 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."dim_customers_scd"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:56.926935 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.219 seconds
[0m07:20:56.928431 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b: ROLLBACK
[0m07:20:57.148689 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b: Close
[0m07:20:57.149529 [info ] [Thread-3 (]: 30 of 262 PASS not_null_dim_customers_scd_customer_id .......................... [[32mPASS[0m in 2.99s]
[0m07:20:57.150157 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b
[0m07:20:57.150643 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3
[0m07:20:57.151130 [info ] [Thread-3 (]: 34 of 262 START test not_null_dim_customers_scd_dbt_valid_from ................. [RUN]
[0m07:20:57.151647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_customer_id.56933c880b, now test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3)
[0m07:20:57.152086 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3
[0m07:20:57.155522 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3"
[0m07:20:57.156022 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3
[0m07:20:57.157763 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3"
[0m07:20:57.158241 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3"
[0m07:20:57.158566 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3: BEGIN
[0m07:20:57.158865 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:20:57.250957 [debug] [Thread-2 (]: SQL status: BEGIN in 2.267 seconds
[0m07:20:57.251474 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73"
[0m07:20:57.251834 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from "postgres"."silver_to_golden"."dim_customers_scd"
where customer_sk is null



  
  
      
    ) dbt_internal_test
[0m07:20:57.499717 [debug] [Thread-4 (]: SQL status: BEGIN in 2.270 seconds
[0m07:20:57.500144 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3"
[0m07:20:57.500450 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_customers_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:20:57.501067 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.249 seconds
[0m07:20:57.502360 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73: ROLLBACK
[0m07:20:57.753049 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73: Close
[0m07:20:57.753554 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.253 seconds
[0m07:20:57.754845 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3: ROLLBACK
[0m07:20:57.755339 [info ] [Thread-2 (]: 31 of 262 PASS not_null_dim_customers_scd_customer_sk .......................... [[32mPASS[0m in 2.78s]
[0m07:20:57.755903 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73
[0m07:20:57.756475 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119
[0m07:20:57.756855 [info ] [Thread-2 (]: 35 of 262 START test not_null_dim_customers_scd_dbt_valid_to ................... [RUN]
[0m07:20:57.757262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_customer_sk.a516213f73, now test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119)
[0m07:20:57.757591 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119
[0m07:20:57.760716 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119"
[0m07:20:57.761217 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119
[0m07:20:57.763063 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119"
[0m07:20:57.763551 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119"
[0m07:20:57.763871 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119: BEGIN
[0m07:20:57.764184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:20:58.009643 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3: Close
[0m07:20:58.010425 [info ] [Thread-4 (]: 32 of 262 PASS not_null_dim_customers_scd_dbt_scd_id ........................... [[32mPASS[0m in 2.79s]
[0m07:20:58.010998 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3
[0m07:20:58.011348 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a
[0m07:20:58.011730 [info ] [Thread-4 (]: 36 of 262 START test not_null_dim_customers_scd_email .......................... [RUN]
[0m07:20:58.012123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_dbt_scd_id.793c4db6f3, now test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a)
[0m07:20:58.012439 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a
[0m07:20:58.015606 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a"
[0m07:20:58.016098 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a
[0m07:20:58.018513 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a"
[0m07:20:58.018999 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a"
[0m07:20:58.019312 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a: BEGIN
[0m07:20:58.019583 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:20:58.250903 [debug] [Thread-1 (]: SQL status: BEGIN in 2.013 seconds
[0m07:20:58.251462 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd"
[0m07:20:58.251900 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_customers_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:20:58.471194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.219 seconds
[0m07:20:58.472514 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd: ROLLBACK
[0m07:20:58.690947 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd: Close
[0m07:20:58.691828 [info ] [Thread-1 (]: 33 of 262 PASS not_null_dim_customers_scd_dbt_updated_at ....................... [[32mPASS[0m in 2.46s]
[0m07:20:58.692438 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd
[0m07:20:58.692815 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f
[0m07:20:58.693209 [info ] [Thread-1 (]: 37 of 262 START test not_null_dim_customers_scd_is_current ..................... [RUN]
[0m07:20:58.693578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_dbt_updated_at.5585ab9cdd, now test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f)
[0m07:20:58.693908 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f
[0m07:20:58.697115 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f"
[0m07:20:58.697607 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f
[0m07:20:58.699532 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f"
[0m07:20:58.700042 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f"
[0m07:20:58.700319 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f: BEGIN
[0m07:20:58.700630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:20:59.644227 [debug] [Thread-3 (]: SQL status: BEGIN in 2.485 seconds
[0m07:20:59.644727 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3"
[0m07:20:59.645136 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_customers_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:20:59.910639 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.265 seconds
[0m07:20:59.911919 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3: ROLLBACK
[0m07:21:00.059241 [debug] [Thread-4 (]: SQL status: BEGIN in 2.040 seconds
[0m07:21:00.059718 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a"
[0m07:21:00.060039 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "postgres"."silver_to_golden"."dim_customers_scd"
where email is null



  
  
      
    ) dbt_internal_test
[0m07:21:00.177062 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3: Close
[0m07:21:00.177835 [info ] [Thread-3 (]: 34 of 262 PASS not_null_dim_customers_scd_dbt_valid_from ....................... [[32mPASS[0m in 3.03s]
[0m07:21:00.178633 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3
[0m07:21:00.178991 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a
[0m07:21:00.179395 [info ] [Thread-3 (]: 38 of 262 START test not_null_dim_customers_scd_loyalty_program_id ............. [RUN]
[0m07:21:00.179825 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_dbt_valid_from.5ed37ae6c3, now test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a)
[0m07:21:00.180145 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a
[0m07:21:00.183335 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a"
[0m07:21:00.183818 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a
[0m07:21:00.185779 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a"
[0m07:21:00.186298 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a"
[0m07:21:00.186614 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a: BEGIN
[0m07:21:00.186881 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:00.287037 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:21:00.288242 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a: ROLLBACK
[0m07:21:00.515360 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a: Close
[0m07:21:00.516147 [info ] [Thread-4 (]: 36 of 262 PASS not_null_dim_customers_scd_email ................................ [[32mPASS[0m in 2.50s]
[0m07:21:00.516644 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a
[0m07:21:00.516997 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b
[0m07:21:00.517377 [info ] [Thread-4 (]: 39 of 262 START test not_null_dim_customers_scd_name ........................... [RUN]
[0m07:21:00.517739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_email.dca7a01a3a, now test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b)
[0m07:21:00.518071 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b
[0m07:21:00.521197 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b"
[0m07:21:00.521742 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b
[0m07:21:00.523493 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b"
[0m07:21:00.523972 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b"
[0m07:21:00.524281 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b: BEGIN
[0m07:21:00.524575 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:00.956367 [debug] [Thread-1 (]: SQL status: BEGIN in 2.256 seconds
[0m07:21:00.956802 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f"
[0m07:21:00.957149 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_customers_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:21:01.204674 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.247 seconds
[0m07:21:01.205893 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f: ROLLBACK
[0m07:21:01.454012 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f: Close
[0m07:21:01.455050 [info ] [Thread-1 (]: 37 of 262 PASS not_null_dim_customers_scd_is_current ........................... [[32mPASS[0m in 2.76s]
[0m07:21:01.455748 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f
[0m07:21:01.456197 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2
[0m07:21:01.456676 [info ] [Thread-1 (]: 40 of 262 START test not_null_dim_customers_scd_phone .......................... [RUN]
[0m07:21:01.457159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_is_current.18e6f7ab8f, now test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2)
[0m07:21:01.457558 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2
[0m07:21:01.463634 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2"
[0m07:21:01.464164 [debug] [Thread-2 (]: SQL status: BEGIN in 3.700 seconds
[0m07:21:01.464696 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119"
[0m07:21:01.465120 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_customers_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:01.465542 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2
[0m07:21:01.469544 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2"
[0m07:21:01.470535 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2"
[0m07:21:01.471061 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2: BEGIN
[0m07:21:01.471534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:01.724723 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.259 seconds
[0m07:21:01.726072 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119: ROLLBACK
[0m07:21:01.983341 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119: Close
[0m07:21:01.984136 [error] [Thread-2 (]: 35 of 262 FAIL 902 not_null_dim_customers_scd_dbt_valid_to ..................... [[31mFAIL 902[0m in 4.23s]
[0m07:21:01.984771 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119
[0m07:21:01.985182 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84
[0m07:21:01.985624 [info ] [Thread-2 (]: 41 of 262 START test not_null_dim_customers_scd_valid_from ..................... [RUN]
[0m07:21:01.986061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_dbt_valid_to.ac2963c119, now test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84)
[0m07:21:01.986386 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84
[0m07:21:01.989637 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84"
[0m07:21:01.990187 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84
[0m07:21:01.991902 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84"
[0m07:21:01.992369 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84"
[0m07:21:01.992665 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84: BEGIN
[0m07:21:01.993138 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:02.171385 [debug] [Thread-3 (]: SQL status: BEGIN in 1.984 seconds
[0m07:21:02.171826 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a"
[0m07:21:02.172138 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_id
from "postgres"."silver_to_golden"."dim_customers_scd"
where loyalty_program_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:02.392425 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.220 seconds
[0m07:21:02.393837 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a: ROLLBACK
[0m07:21:02.547424 [debug] [Thread-4 (]: SQL status: BEGIN in 2.023 seconds
[0m07:21:02.547870 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b"
[0m07:21:02.548175 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_customers_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:21:02.611454 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a: Close
[0m07:21:02.612262 [info ] [Thread-3 (]: 38 of 262 PASS not_null_dim_customers_scd_loyalty_program_id ................... [[32mPASS[0m in 2.43s]
[0m07:21:02.612767 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a
[0m07:21:02.613232 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601
[0m07:21:02.613707 [info ] [Thread-3 (]: 42 of 262 START test not_null_dim_customers_scd_valid_to ....................... [RUN]
[0m07:21:02.614275 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_loyalty_program_id.98d673395a, now test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601)
[0m07:21:02.614794 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601
[0m07:21:02.618153 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601"
[0m07:21:02.618691 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601
[0m07:21:02.620601 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601"
[0m07:21:02.621099 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601"
[0m07:21:02.621430 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601: BEGIN
[0m07:21:02.621730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:02.781569 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.233 seconds
[0m07:21:02.782937 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b: ROLLBACK
[0m07:21:03.023861 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b: Close
[0m07:21:03.024731 [info ] [Thread-4 (]: 39 of 262 PASS not_null_dim_customers_scd_name ................................. [[32mPASS[0m in 2.51s]
[0m07:21:03.025576 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b
[0m07:21:03.026008 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8
[0m07:21:03.026427 [info ] [Thread-4 (]: 43 of 262 START test not_null_dim_discount_rules_discount_type ................. [RUN]
[0m07:21:03.026919 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_name.26c4fede0b, now test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8)
[0m07:21:03.027288 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8
[0m07:21:03.031217 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8"
[0m07:21:03.031773 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8
[0m07:21:03.033711 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8"
[0m07:21:03.034238 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8"
[0m07:21:03.034603 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8: BEGIN
[0m07:21:03.034898 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:03.848344 [debug] [Thread-1 (]: SQL status: BEGIN in 2.377 seconds
[0m07:21:03.848896 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2"
[0m07:21:03.849345 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phone
from "postgres"."silver_to_golden"."dim_customers_scd"
where phone is null



  
  
      
    ) dbt_internal_test
[0m07:21:03.981256 [debug] [Thread-2 (]: SQL status: BEGIN in 1.988 seconds
[0m07:21:03.981742 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84"
[0m07:21:03.982153 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_customers_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:04.077304 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.228 seconds
[0m07:21:04.078986 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2: ROLLBACK
[0m07:21:04.198256 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.216 seconds
[0m07:21:04.199607 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84: ROLLBACK
[0m07:21:04.304513 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2: Close
[0m07:21:04.305394 [info ] [Thread-1 (]: 40 of 262 PASS not_null_dim_customers_scd_phone ................................ [[32mPASS[0m in 2.85s]
[0m07:21:04.306038 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2
[0m07:21:04.306505 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b
[0m07:21:04.306924 [info ] [Thread-1 (]: 44 of 262 START test not_null_dim_discount_rules_product_id .................... [RUN]
[0m07:21:04.307346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_phone.eaebcaf4c2, now test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b)
[0m07:21:04.307675 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b
[0m07:21:04.311639 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b"
[0m07:21:04.312140 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b
[0m07:21:04.313948 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b"
[0m07:21:04.314598 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b"
[0m07:21:04.314991 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b: BEGIN
[0m07:21:04.315398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:04.413972 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84: Close
[0m07:21:04.414840 [info ] [Thread-2 (]: 41 of 262 PASS not_null_dim_customers_scd_valid_from ........................... [[32mPASS[0m in 2.43s]
[0m07:21:04.415367 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84
[0m07:21:04.415733 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062
[0m07:21:04.416146 [info ] [Thread-2 (]: 45 of 262 START test not_null_dim_discount_rules_rule_id ....................... [RUN]
[0m07:21:04.416553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_valid_from.d76146eb84, now test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062)
[0m07:21:04.417027 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062
[0m07:21:04.420098 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062"
[0m07:21:04.420586 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062
[0m07:21:04.422299 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062"
[0m07:21:04.422812 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062"
[0m07:21:04.423093 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062: BEGIN
[0m07:21:04.423403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:04.989177 [debug] [Thread-3 (]: SQL status: BEGIN in 2.367 seconds
[0m07:21:04.989702 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601"
[0m07:21:04.990047 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_customers_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:05.246550 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.256 seconds
[0m07:21:05.248414 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601: ROLLBACK
[0m07:21:05.374175 [debug] [Thread-4 (]: SQL status: BEGIN in 2.339 seconds
[0m07:21:05.374654 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8"
[0m07:21:05.375016 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select discount_type
from "postgres"."silver_to_golden"."dim_discount_rules"
where discount_type is null



  
  
      
    ) dbt_internal_test
[0m07:21:05.502891 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601: Close
[0m07:21:05.503678 [error] [Thread-3 (]: 42 of 262 FAIL 902 not_null_dim_customers_scd_valid_to ......................... [[31mFAIL 902[0m in 2.89s]
[0m07:21:05.504217 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601
[0m07:21:05.504573 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0
[0m07:21:05.505009 [info ] [Thread-3 (]: 46 of 262 START test not_null_dim_discount_rules_valid_from .................... [RUN]
[0m07:21:05.505418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_customers_scd_valid_to.6e22a57601, now test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0)
[0m07:21:05.505722 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0
[0m07:21:05.508829 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0"
[0m07:21:05.509323 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0
[0m07:21:05.511005 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0"
[0m07:21:05.511460 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0"
[0m07:21:05.511770 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0: BEGIN
[0m07:21:05.512073 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:06.126786 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.751 seconds
[0m07:21:06.128044 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8: ROLLBACK
[0m07:21:06.299066 [debug] [Thread-1 (]: SQL status: BEGIN in 1.984 seconds
[0m07:21:06.299524 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b"
[0m07:21:06.299898 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."dim_discount_rules"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:06.384476 [debug] [Thread-2 (]: SQL status: BEGIN in 1.961 seconds
[0m07:21:06.384990 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062"
[0m07:21:06.385367 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rule_id
from "postgres"."silver_to_golden"."dim_discount_rules"
where rule_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:06.407685 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8: Close
[0m07:21:06.408452 [info ] [Thread-4 (]: 43 of 262 PASS not_null_dim_discount_rules_discount_type ....................... [[32mPASS[0m in 3.38s]
[0m07:21:06.408955 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8
[0m07:21:06.409316 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875
[0m07:21:06.409725 [info ] [Thread-4 (]: 47 of 262 START test not_null_dim_discount_rules_valid_to ...................... [RUN]
[0m07:21:06.410104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_discount_rules_discount_type.a759a6bff8, now test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875)
[0m07:21:06.410420 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875
[0m07:21:06.413662 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875"
[0m07:21:06.414155 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875
[0m07:21:06.416532 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875"
[0m07:21:06.417058 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875"
[0m07:21:06.417340 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875: BEGIN
[0m07:21:06.417660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:06.518047 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.218 seconds
[0m07:21:06.519290 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b: ROLLBACK
[0m07:21:06.607027 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.221 seconds
[0m07:21:06.608522 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062: ROLLBACK
[0m07:21:06.738979 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b: Close
[0m07:21:06.739777 [info ] [Thread-1 (]: 44 of 262 PASS not_null_dim_discount_rules_product_id .......................... [[32mPASS[0m in 2.43s]
[0m07:21:06.740299 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b
[0m07:21:06.740672 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6
[0m07:21:06.741035 [info ] [Thread-1 (]: 48 of 262 START test not_null_dim_discount_rules_value ......................... [RUN]
[0m07:21:06.741415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_discount_rules_product_id.8ab02eea4b, now test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6)
[0m07:21:06.741730 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6
[0m07:21:06.805363 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6"
[0m07:21:06.805978 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6
[0m07:21:06.807667 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6"
[0m07:21:06.808154 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6"
[0m07:21:06.808439 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6: BEGIN
[0m07:21:06.808734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:06.832931 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062: Close
[0m07:21:06.834114 [info ] [Thread-2 (]: 45 of 262 PASS not_null_dim_discount_rules_rule_id ............................. [[32mPASS[0m in 2.42s]
[0m07:21:06.834729 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062
[0m07:21:06.835100 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6
[0m07:21:06.835472 [info ] [Thread-2 (]: 49 of 262 START test not_null_dim_employees_scd_dbt_scd_id ..................... [RUN]
[0m07:21:06.835865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_discount_rules_rule_id.bea823b062, now test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6)
[0m07:21:06.836160 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6
[0m07:21:06.839630 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6"
[0m07:21:06.840136 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6
[0m07:21:06.841870 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6"
[0m07:21:06.842361 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6"
[0m07:21:06.842702 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6: BEGIN
[0m07:21:06.842975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:08.239626 [debug] [Thread-3 (]: SQL status: BEGIN in 2.727 seconds
[0m07:21:08.240117 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0"
[0m07:21:08.240531 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_discount_rules"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:08.499034 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.258 seconds
[0m07:21:08.500271 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0: ROLLBACK
[0m07:21:08.757933 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0: Close
[0m07:21:08.758955 [info ] [Thread-3 (]: 46 of 262 PASS not_null_dim_discount_rules_valid_from .......................... [[32mPASS[0m in 3.25s]
[0m07:21:08.759710 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0
[0m07:21:08.760303 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7
[0m07:21:08.760873 [info ] [Thread-3 (]: 50 of 262 START test not_null_dim_employees_scd_dbt_updated_at ................. [RUN]
[0m07:21:08.761452 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_discount_rules_valid_from.96af6b93c0, now test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7)
[0m07:21:08.761906 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7
[0m07:21:08.765254 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7"
[0m07:21:08.765781 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7
[0m07:21:08.767869 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7"
[0m07:21:08.768393 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7"
[0m07:21:08.768710 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7: BEGIN
[0m07:21:08.768988 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:09.468732 [debug] [Thread-2 (]: SQL status: BEGIN in 2.626 seconds
[0m07:21:09.469237 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6"
[0m07:21:09.469591 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_employees_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:09.483658 [debug] [Thread-4 (]: SQL status: BEGIN in 3.066 seconds
[0m07:21:09.484057 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875"
[0m07:21:09.484384 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_discount_rules"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:09.629911 [debug] [Thread-1 (]: SQL status: BEGIN in 2.821 seconds
[0m07:21:09.630389 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6"
[0m07:21:09.630784 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select value
from "postgres"."silver_to_golden"."dim_discount_rules"
where value is null



  
  
      
    ) dbt_internal_test
[0m07:21:09.693716 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.224 seconds
[0m07:21:09.695172 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6: ROLLBACK
[0m07:21:09.874954 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.244 seconds
[0m07:21:09.876372 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6: ROLLBACK
[0m07:21:09.919940 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6: Close
[0m07:21:09.920789 [info ] [Thread-2 (]: 49 of 262 PASS not_null_dim_employees_scd_dbt_scd_id ........................... [[32mPASS[0m in 3.08s]
[0m07:21:09.921402 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6
[0m07:21:09.921875 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c
[0m07:21:09.922388 [info ] [Thread-2 (]: 51 of 262 START test not_null_dim_employees_scd_dbt_valid_from ................. [RUN]
[0m07:21:09.922901 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_dbt_scd_id.f47f324dd6, now test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c)
[0m07:21:09.923378 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c
[0m07:21:09.926644 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c"
[0m07:21:09.927119 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c
[0m07:21:09.929831 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c"
[0m07:21:09.930361 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c"
[0m07:21:09.930721 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c: BEGIN
[0m07:21:09.931035 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:10.120007 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6: Close
[0m07:21:10.120983 [info ] [Thread-1 (]: 48 of 262 PASS not_null_dim_discount_rules_value ............................... [[32mPASS[0m in 3.38s]
[0m07:21:10.121747 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6
[0m07:21:10.122226 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a
[0m07:21:10.122698 [info ] [Thread-1 (]: 52 of 262 START test not_null_dim_employees_scd_dbt_valid_to ................... [RUN]
[0m07:21:10.123185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_discount_rules_value.e6ec5427b6, now test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a)
[0m07:21:10.123606 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a
[0m07:21:10.126997 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a"
[0m07:21:10.127511 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a
[0m07:21:10.129229 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a"
[0m07:21:10.129726 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a"
[0m07:21:10.130045 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a: BEGIN
[0m07:21:10.130366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:10.624343 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.140 seconds
[0m07:21:10.625779 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875: ROLLBACK
[0m07:21:10.775975 [debug] [Thread-3 (]: SQL status: BEGIN in 2.007 seconds
[0m07:21:10.776367 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7"
[0m07:21:10.776667 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_employees_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:21:10.849815 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875: Close
[0m07:21:10.850682 [info ] [Thread-4 (]: 47 of 262 PASS not_null_dim_discount_rules_valid_to ............................ [[32mPASS[0m in 4.44s]
[0m07:21:10.851386 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875
[0m07:21:10.851806 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3
[0m07:21:10.852403 [info ] [Thread-4 (]: 53 of 262 START test not_null_dim_employees_scd_employee_id .................... [RUN]
[0m07:21:10.852896 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_discount_rules_valid_to.42ac252875, now test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3)
[0m07:21:10.853255 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3
[0m07:21:10.856753 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3"
[0m07:21:10.857247 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3
[0m07:21:10.859138 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3"
[0m07:21:10.859651 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3"
[0m07:21:10.859938 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3: BEGIN
[0m07:21:10.860221 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:10.996601 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.220 seconds
[0m07:21:10.998176 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7: ROLLBACK
[0m07:21:11.227796 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7: Close
[0m07:21:11.228667 [info ] [Thread-3 (]: 50 of 262 PASS not_null_dim_employees_scd_dbt_updated_at ....................... [[32mPASS[0m in 2.47s]
[0m07:21:11.229296 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7
[0m07:21:11.229652 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100
[0m07:21:11.230251 [info ] [Thread-3 (]: 54 of 262 START test not_null_dim_employees_scd_employee_sk .................... [RUN]
[0m07:21:11.230697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_dbt_updated_at.bcf03562d7, now test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100)
[0m07:21:11.231050 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100
[0m07:21:11.235301 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100"
[0m07:21:11.236216 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100
[0m07:21:11.238341 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100"
[0m07:21:11.238928 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100"
[0m07:21:11.239258 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100: BEGIN
[0m07:21:11.239556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:12.142157 [debug] [Thread-1 (]: SQL status: BEGIN in 2.012 seconds
[0m07:21:12.142765 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a"
[0m07:21:12.143258 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_employees_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:12.301247 [debug] [Thread-2 (]: SQL status: BEGIN in 2.370 seconds
[0m07:21:12.302056 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c"
[0m07:21:12.302836 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_employees_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:12.379368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:21:12.380869 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a: ROLLBACK
[0m07:21:12.569935 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.266 seconds
[0m07:21:12.571580 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c: ROLLBACK
[0m07:21:12.607351 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a: Close
[0m07:21:12.608431 [error] [Thread-1 (]: 52 of 262 FAIL 200 not_null_dim_employees_scd_dbt_valid_to ..................... [[31mFAIL 200[0m in 2.48s]
[0m07:21:12.609075 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a
[0m07:21:12.609492 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2
[0m07:21:12.609883 [info ] [Thread-1 (]: 55 of 262 START test not_null_dim_employees_scd_is_current ..................... [RUN]
[0m07:21:12.610331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_dbt_valid_to.d1aead151a, now test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2)
[0m07:21:12.610720 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2
[0m07:21:12.615440 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2"
[0m07:21:12.615968 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2
[0m07:21:12.617885 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2"
[0m07:21:12.618417 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2"
[0m07:21:12.618758 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2: BEGIN
[0m07:21:12.619044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:12.840897 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c: Close
[0m07:21:12.842062 [info ] [Thread-2 (]: 51 of 262 PASS not_null_dim_employees_scd_dbt_valid_from ....................... [[32mPASS[0m in 2.92s]
[0m07:21:12.842688 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c
[0m07:21:12.843071 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_name.de3a965790
[0m07:21:12.843504 [info ] [Thread-2 (]: 56 of 262 START test not_null_dim_employees_scd_name ........................... [RUN]
[0m07:21:12.844056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_dbt_valid_from.a49438694c, now test.retail_dbt.not_null_dim_employees_scd_name.de3a965790)
[0m07:21:12.844477 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_name.de3a965790
[0m07:21:12.847862 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_name.de3a965790"
[0m07:21:12.848392 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_name.de3a965790
[0m07:21:12.850169 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_name.de3a965790"
[0m07:21:12.850688 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_name.de3a965790"
[0m07:21:12.850988 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_name.de3a965790: BEGIN
[0m07:21:12.851323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:13.202785 [debug] [Thread-4 (]: SQL status: BEGIN in 2.342 seconds
[0m07:21:13.203319 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3"
[0m07:21:13.203684 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from "postgres"."silver_to_golden"."dim_employees_scd"
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:13.374503 [debug] [Thread-3 (]: SQL status: BEGIN in 2.135 seconds
[0m07:21:13.375547 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100"
[0m07:21:13.375931 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_sk
from "postgres"."silver_to_golden"."dim_employees_scd"
where employee_sk is null



  
  
      
    ) dbt_internal_test
[0m07:21:13.434561 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.230 seconds
[0m07:21:13.436000 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3: ROLLBACK
[0m07:21:13.610955 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:21:13.612454 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100: ROLLBACK
[0m07:21:13.670229 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3: Close
[0m07:21:13.671229 [info ] [Thread-4 (]: 53 of 262 PASS not_null_dim_employees_scd_employee_id .......................... [[32mPASS[0m in 2.82s]
[0m07:21:13.671899 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3
[0m07:21:13.672389 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7
[0m07:21:13.672926 [info ] [Thread-4 (]: 57 of 262 START test not_null_dim_employees_scd_role ........................... [RUN]
[0m07:21:13.673435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_employee_id.8522bc8cd3, now test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7)
[0m07:21:13.673822 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7
[0m07:21:13.677131 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7"
[0m07:21:13.677642 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7
[0m07:21:13.679520 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7"
[0m07:21:13.680034 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7"
[0m07:21:13.680370 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7: BEGIN
[0m07:21:13.680658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:13.845038 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100: Close
[0m07:21:13.845821 [info ] [Thread-3 (]: 54 of 262 PASS not_null_dim_employees_scd_employee_sk .......................... [[32mPASS[0m in 2.62s]
[0m07:21:13.846373 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100
[0m07:21:13.846808 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15
[0m07:21:13.847217 [info ] [Thread-3 (]: 58 of 262 START test not_null_dim_employees_scd_store_id ....................... [RUN]
[0m07:21:13.847640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_employee_sk.46b10e0100, now test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15)
[0m07:21:13.847966 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15
[0m07:21:13.851343 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15"
[0m07:21:13.851875 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15
[0m07:21:13.854770 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15"
[0m07:21:13.855289 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15"
[0m07:21:13.855588 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: BEGIN
[0m07:21:13.855900 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:15.032741 [debug] [Thread-2 (]: SQL status: BEGIN in 2.181 seconds
[0m07:21:15.033204 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_name.de3a965790"
[0m07:21:15.033526 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_name.de3a965790: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_name.de3a965790"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_employees_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:21:15.169422 [debug] [Thread-1 (]: SQL status: BEGIN in 2.550 seconds
[0m07:21:15.170008 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2"
[0m07:21:15.170456 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_employees_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:21:15.274647 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.241 seconds
[0m07:21:15.276256 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_name.de3a965790: ROLLBACK
[0m07:21:15.437489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.267 seconds
[0m07:21:15.438852 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2: ROLLBACK
[0m07:21:15.514743 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_name.de3a965790: Close
[0m07:21:15.515663 [info ] [Thread-2 (]: 56 of 262 PASS not_null_dim_employees_scd_name ................................. [[32mPASS[0m in 2.67s]
[0m07:21:15.516501 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_name.de3a965790
[0m07:21:15.517005 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac
[0m07:21:15.517433 [info ] [Thread-2 (]: 59 of 262 START test not_null_dim_employees_scd_valid_from ..................... [RUN]
[0m07:21:15.517833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_name.de3a965790, now test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac)
[0m07:21:15.518189 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac
[0m07:21:15.522043 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac"
[0m07:21:15.522584 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac
[0m07:21:15.524368 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac"
[0m07:21:15.524887 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac"
[0m07:21:15.525234 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac: BEGIN
[0m07:21:15.525558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:15.718989 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2: Close
[0m07:21:15.719803 [info ] [Thread-1 (]: 55 of 262 PASS not_null_dim_employees_scd_is_current ........................... [[32mPASS[0m in 3.11s]
[0m07:21:15.720394 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2
[0m07:21:15.720794 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3
[0m07:21:15.721235 [info ] [Thread-1 (]: 60 of 262 START test not_null_dim_employees_scd_valid_to ....................... [RUN]
[0m07:21:15.721658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_is_current.e8e5357df2, now test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3)
[0m07:21:15.721964 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3
[0m07:21:15.725684 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3"
[0m07:21:15.726185 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3
[0m07:21:15.728044 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3"
[0m07:21:15.728542 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3"
[0m07:21:15.728839 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3: BEGIN
[0m07:21:15.729160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:15.811899 [debug] [Thread-4 (]: SQL status: BEGIN in 2.131 seconds
[0m07:21:15.812415 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7"
[0m07:21:15.812861 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select role
from "postgres"."silver_to_golden"."dim_employees_scd"
where role is null



  
  
      
    ) dbt_internal_test
[0m07:21:15.981604 [debug] [Thread-3 (]: SQL status: BEGIN in 2.126 seconds
[0m07:21:15.982060 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15"
[0m07:21:15.982528 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."dim_employees_scd"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:16.052393 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.239 seconds
[0m07:21:16.053922 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7: ROLLBACK
[0m07:21:16.234030 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.251 seconds
[0m07:21:16.235408 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: ROLLBACK
[0m07:21:16.287524 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7: Close
[0m07:21:16.288609 [info ] [Thread-4 (]: 57 of 262 PASS not_null_dim_employees_scd_role ................................. [[32mPASS[0m in 2.61s]
[0m07:21:16.289332 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7
[0m07:21:16.289834 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b
[0m07:21:16.290415 [info ] [Thread-4 (]: 61 of 262 START test not_null_dim_loyalty_programs_scd_dbt_scd_id .............. [RUN]
[0m07:21:16.290939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_role.4466e0f8a7, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b)
[0m07:21:16.291342 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b
[0m07:21:16.294974 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"
[0m07:21:16.295682 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b
[0m07:21:16.297950 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"
[0m07:21:16.298549 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"
[0m07:21:16.298891 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: BEGIN
[0m07:21:16.299188 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:16.473904 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15: Close
[0m07:21:16.474804 [info ] [Thread-3 (]: 58 of 262 PASS not_null_dim_employees_scd_store_id ............................. [[32mPASS[0m in 2.63s]
[0m07:21:16.475511 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15
[0m07:21:16.475999 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m07:21:16.476487 [info ] [Thread-3 (]: 62 of 262 START test not_null_dim_loyalty_programs_scd_dbt_updated_at .......... [RUN]
[0m07:21:16.477110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_store_id.8b22391c15, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2)
[0m07:21:16.477519 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m07:21:16.482868 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m07:21:16.483395 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m07:21:16.485190 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m07:21:16.485718 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m07:21:16.486024 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: BEGIN
[0m07:21:16.486355 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:17.879200 [debug] [Thread-1 (]: SQL status: BEGIN in 2.150 seconds
[0m07:21:17.879762 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3"
[0m07:21:17.880191 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_employees_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:17.947689 [debug] [Thread-2 (]: SQL status: BEGIN in 2.422 seconds
[0m07:21:17.948273 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac"
[0m07:21:17.948828 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_employees_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:18.123512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.243 seconds
[0m07:21:18.125307 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3: ROLLBACK
[0m07:21:18.213102 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:21:18.214946 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac: ROLLBACK
[0m07:21:18.370308 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3: Close
[0m07:21:18.371285 [error] [Thread-1 (]: 60 of 262 FAIL 200 not_null_dim_employees_scd_valid_to ......................... [[31mFAIL 200[0m in 2.65s]
[0m07:21:18.371863 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3
[0m07:21:18.372279 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m07:21:18.372702 [info ] [Thread-1 (]: 63 of 262 START test not_null_dim_loyalty_programs_scd_dbt_valid_from .......... [RUN]
[0m07:21:18.373095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_valid_to.a3ee7e82d3, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210)
[0m07:21:18.373473 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m07:21:18.377029 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m07:21:18.377559 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m07:21:18.379366 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m07:21:18.379883 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m07:21:18.380226 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: BEGIN
[0m07:21:18.380519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:18.485953 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac: Close
[0m07:21:18.486822 [info ] [Thread-2 (]: 59 of 262 PASS not_null_dim_employees_scd_valid_from ........................... [[32mPASS[0m in 2.97s]
[0m07:21:18.487456 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac
[0m07:21:18.487878 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m07:21:18.488322 [info ] [Thread-2 (]: 64 of 262 START test not_null_dim_loyalty_programs_scd_dbt_valid_to ............ [RUN]
[0m07:21:18.488754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_employees_scd_valid_from.18363deeac, now test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4)
[0m07:21:18.489072 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m07:21:18.492743 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m07:21:18.493291 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m07:21:18.495538 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m07:21:18.496094 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m07:21:18.496402 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: BEGIN
[0m07:21:18.496757 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:18.602590 [debug] [Thread-3 (]: SQL status: BEGIN in 2.116 seconds
[0m07:21:18.603078 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"
[0m07:21:18.603434 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:21:18.791504 [debug] [Thread-4 (]: SQL status: BEGIN in 2.492 seconds
[0m07:21:18.792022 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"
[0m07:21:18.792399 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:18.848445 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.244 seconds
[0m07:21:18.849794 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: ROLLBACK
[0m07:21:19.074310 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.281 seconds
[0m07:21:19.075682 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: ROLLBACK
[0m07:21:19.090817 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2: Close
[0m07:21:19.091611 [info ] [Thread-3 (]: 62 of 262 PASS not_null_dim_loyalty_programs_scd_dbt_updated_at ................ [[32mPASS[0m in 2.61s]
[0m07:21:19.092186 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2
[0m07:21:19.092609 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m07:21:19.093084 [info ] [Thread-3 (]: 65 of 262 START test not_null_dim_loyalty_programs_scd_is_current .............. [RUN]
[0m07:21:19.093632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_updated_at.c9d70f49a2, now test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11)
[0m07:21:19.093979 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m07:21:19.097288 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m07:21:19.097808 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m07:21:19.099677 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m07:21:19.100164 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m07:21:19.100476 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: BEGIN
[0m07:21:19.100756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:19.340161 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b: Close
[0m07:21:19.341055 [info ] [Thread-4 (]: 61 of 262 PASS not_null_dim_loyalty_programs_scd_dbt_scd_id .................... [[32mPASS[0m in 3.05s]
[0m07:21:19.341659 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b
[0m07:21:19.342097 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m07:21:19.342613 [info ] [Thread-4 (]: 66 of 262 START test not_null_dim_loyalty_programs_scd_loyalty_program_id ...... [RUN]
[0m07:21:19.343087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_scd_id.038f10ad7b, now test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa)
[0m07:21:19.343485 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m07:21:19.347856 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m07:21:19.348356 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m07:21:19.349982 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m07:21:19.350509 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m07:21:19.350841 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: BEGIN
[0m07:21:19.351166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:21.021335 [debug] [Thread-2 (]: SQL status: BEGIN in 2.095 seconds
[0m07:21:21.021733 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"
[0m07:21:21.022107 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:21.251051 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.229 seconds
[0m07:21:21.252562 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: ROLLBACK
[0m07:21:21.373458 [debug] [Thread-1 (]: SQL status: BEGIN in 2.563 seconds
[0m07:21:21.374079 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"
[0m07:21:21.374577 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:21.478054 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4: Close
[0m07:21:21.478855 [error] [Thread-2 (]: 64 of 262 FAIL 5 not_null_dim_loyalty_programs_scd_dbt_valid_to ................ [[31mFAIL 5[0m in 2.99s]
[0m07:21:21.479430 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4
[0m07:21:21.479980 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m07:21:21.480484 [info ] [Thread-2 (]: 67 of 262 START test not_null_dim_loyalty_programs_scd_loyalty_program_sk ...... [RUN]
[0m07:21:21.480943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_to.4c513e1ea4, now test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4)
[0m07:21:21.481382 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m07:21:21.484946 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m07:21:21.485496 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m07:21:21.487517 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m07:21:21.488216 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m07:21:21.488689 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: BEGIN
[0m07:21:21.489023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:21.602189 [debug] [Thread-3 (]: SQL status: BEGIN in 2.072 seconds
[0m07:21:21.602687 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"
[0m07:21:21.603151 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:21:21.637784 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.263 seconds
[0m07:21:21.639175 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: ROLLBACK
[0m07:21:21.833256 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.230 seconds
[0m07:21:21.834726 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: ROLLBACK
[0m07:21:22.062925 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11: Close
[0m07:21:22.063977 [info ] [Thread-3 (]: 65 of 262 PASS not_null_dim_loyalty_programs_scd_is_current .................... [[32mPASS[0m in 2.97s]
[0m07:21:22.064535 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11
[0m07:21:22.064902 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m07:21:22.065375 [info ] [Thread-3 (]: 68 of 262 START test not_null_dim_loyalty_programs_scd_name .................... [RUN]
[0m07:21:22.065788 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_is_current.43f58f8f11, now test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a)
[0m07:21:22.066090 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m07:21:22.069482 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m07:21:22.069995 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m07:21:22.072011 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m07:21:22.072687 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m07:21:22.073047 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: BEGIN
[0m07:21:22.073366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:22.414546 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210: Close
[0m07:21:22.415425 [info ] [Thread-1 (]: 63 of 262 PASS not_null_dim_loyalty_programs_scd_dbt_valid_from ................ [[32mPASS[0m in 4.04s]
[0m07:21:22.416104 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210
[0m07:21:22.416539 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m07:21:22.416983 [info ] [Thread-1 (]: 69 of 262 START test not_null_dim_loyalty_programs_scd_points_per_dollar ....... [RUN]
[0m07:21:22.417506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_dbt_valid_from.7dac90a210, now test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c)
[0m07:21:22.417866 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m07:21:22.421308 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m07:21:22.421818 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m07:21:22.424783 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m07:21:22.425288 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m07:21:22.425607 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: BEGIN
[0m07:21:22.425893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:22.440192 [debug] [Thread-4 (]: SQL status: BEGIN in 2.660 seconds
[0m07:21:22.440678 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"
[0m07:21:22.441093 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_id
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where loyalty_program_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:22.667773 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:21:22.669143 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: ROLLBACK
[0m07:21:22.895442 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa: Close
[0m07:21:22.896343 [info ] [Thread-4 (]: 66 of 262 PASS not_null_dim_loyalty_programs_scd_loyalty_program_id ............ [[32mPASS[0m in 3.55s]
[0m07:21:22.896944 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa
[0m07:21:22.897356 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m07:21:22.897753 [info ] [Thread-4 (]: 70 of 262 START test not_null_dim_loyalty_programs_scd_valid_from .............. [RUN]
[0m07:21:22.898161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_id.e84dfa91aa, now test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f)
[0m07:21:22.898463 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m07:21:22.901995 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m07:21:22.902538 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m07:21:22.904632 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m07:21:22.905209 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m07:21:22.905508 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: BEGIN
[0m07:21:22.905835 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:23.871182 [debug] [Thread-2 (]: SQL status: BEGIN in 2.382 seconds
[0m07:21:23.871696 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"
[0m07:21:23.872076 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select loyalty_program_sk
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where loyalty_program_sk is null



  
  
      
    ) dbt_internal_test
[0m07:21:24.133931 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.261 seconds
[0m07:21:24.135347 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: ROLLBACK
[0m07:21:24.394276 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4: Close
[0m07:21:24.395258 [info ] [Thread-2 (]: 67 of 262 PASS not_null_dim_loyalty_programs_scd_loyalty_program_sk ............ [[32mPASS[0m in 2.91s]
[0m07:21:24.396065 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4
[0m07:21:24.396587 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m07:21:24.397097 [info ] [Thread-2 (]: 71 of 262 START test not_null_dim_loyalty_programs_scd_valid_to ................ [RUN]
[0m07:21:24.397647 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_loyalty_program_sk.84ba447ff4, now test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182)
[0m07:21:24.398045 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m07:21:24.401654 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m07:21:24.402195 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m07:21:24.404125 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m07:21:24.404654 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m07:21:24.404942 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: BEGIN
[0m07:21:24.405260 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:24.502278 [debug] [Thread-1 (]: SQL status: BEGIN in 2.076 seconds
[0m07:21:24.502687 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"
[0m07:21:24.503057 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select points_per_dollar
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where points_per_dollar is null



  
  
      
    ) dbt_internal_test
[0m07:21:24.730627 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:21:24.732057 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: ROLLBACK
[0m07:21:24.968974 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c: Close
[0m07:21:24.969817 [info ] [Thread-1 (]: 69 of 262 PASS not_null_dim_loyalty_programs_scd_points_per_dollar ............. [[32mPASS[0m in 2.55s]
[0m07:21:24.970415 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c
[0m07:21:24.970833 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m07:21:24.971237 [info ] [Thread-1 (]: 72 of 262 START test not_null_dim_products_scd_brand_id ........................ [RUN]
[0m07:21:24.971720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_points_per_dollar.efe31e239c, now test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3)
[0m07:21:24.972113 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m07:21:24.975526 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m07:21:24.976091 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m07:21:24.977942 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m07:21:24.978489 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m07:21:24.978795 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: BEGIN
[0m07:21:24.979135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:25.018026 [debug] [Thread-4 (]: SQL status: BEGIN in 2.112 seconds
[0m07:21:25.018424 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"
[0m07:21:25.018791 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:25.117531 [debug] [Thread-3 (]: SQL status: BEGIN in 3.044 seconds
[0m07:21:25.118102 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"
[0m07:21:25.118559 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:21:25.265181 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.246 seconds
[0m07:21:25.266730 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: ROLLBACK
[0m07:21:25.514897 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f: Close
[0m07:21:25.515940 [info ] [Thread-4 (]: 70 of 262 PASS not_null_dim_loyalty_programs_scd_valid_from .................... [[32mPASS[0m in 2.62s]
[0m07:21:25.516781 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f
[0m07:21:25.517281 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m07:21:25.517810 [info ] [Thread-4 (]: 73 of 262 START test not_null_dim_products_scd_category_id ..................... [RUN]
[0m07:21:25.518373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_from.8260f64e1f, now test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5)
[0m07:21:25.518810 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m07:21:25.523979 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m07:21:25.524554 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m07:21:25.526480 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m07:21:25.527023 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m07:21:25.527405 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: BEGIN
[0m07:21:25.527813 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:25.891238 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.772 seconds
[0m07:21:25.893001 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: ROLLBACK
[0m07:21:26.141023 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a: Close
[0m07:21:26.141905 [info ] [Thread-3 (]: 68 of 262 PASS not_null_dim_loyalty_programs_scd_name .......................... [[32mPASS[0m in 4.08s]
[0m07:21:26.142523 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a
[0m07:21:26.143054 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m07:21:26.143495 [info ] [Thread-3 (]: 74 of 262 START test not_null_dim_products_scd_created_at ...................... [RUN]
[0m07:21:26.144058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_name.3db7e3f58a, now test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39)
[0m07:21:26.144454 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m07:21:26.147980 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m07:21:26.148501 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m07:21:26.150397 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m07:21:26.150925 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m07:21:26.151231 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: BEGIN
[0m07:21:26.151523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:26.667317 [debug] [Thread-2 (]: SQL status: BEGIN in 2.262 seconds
[0m07:21:26.667828 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"
[0m07:21:26.668244 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:26.908393 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:21:26.909716 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: ROLLBACK
[0m07:21:27.508651 [debug] [Thread-1 (]: SQL status: BEGIN in 2.529 seconds
[0m07:21:27.509145 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"
[0m07:21:27.509505 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select brand_id
from "postgres"."silver_to_golden"."dim_products_scd"
where brand_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:27.628560 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182: Close
[0m07:21:27.629432 [error] [Thread-2 (]: 71 of 262 FAIL 5 not_null_dim_loyalty_programs_scd_valid_to .................... [[31mFAIL 5[0m in 3.23s]
[0m07:21:27.630032 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182
[0m07:21:27.630489 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m07:21:27.630951 [info ] [Thread-2 (]: 75 of 262 START test not_null_dim_products_scd_dbt_scd_id ...................... [RUN]
[0m07:21:27.631408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_loyalty_programs_scd_valid_to.e800634182, now test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e)
[0m07:21:27.631729 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m07:21:27.635843 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m07:21:27.636397 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m07:21:27.638374 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m07:21:27.638917 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m07:21:27.639265 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: BEGIN
[0m07:21:27.639808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:27.702372 [debug] [Thread-4 (]: SQL status: BEGIN in 2.175 seconds
[0m07:21:27.702806 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"
[0m07:21:27.703175 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from "postgres"."silver_to_golden"."dim_products_scd"
where category_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:27.777050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.267 seconds
[0m07:21:27.778545 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: ROLLBACK
[0m07:21:27.938183 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:21:27.939736 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: ROLLBACK
[0m07:21:28.043810 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3: Close
[0m07:21:28.044759 [info ] [Thread-1 (]: 72 of 262 PASS not_null_dim_products_scd_brand_id .............................. [[32mPASS[0m in 3.07s]
[0m07:21:28.045373 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3
[0m07:21:28.045852 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m07:21:28.046320 [info ] [Thread-1 (]: 76 of 262 START test not_null_dim_products_scd_dbt_updated_at .................. [RUN]
[0m07:21:28.046793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_brand_id.c6bec72bb3, now test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9)
[0m07:21:28.047180 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m07:21:28.050741 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m07:21:28.051226 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m07:21:28.053074 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m07:21:28.053583 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m07:21:28.053887 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: BEGIN
[0m07:21:28.054176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:28.516478 [debug] [Thread-3 (]: SQL status: BEGIN in 2.365 seconds
[0m07:21:28.517015 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"
[0m07:21:28.517426 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from "postgres"."silver_to_golden"."dim_products_scd"
where created_at is null



  
  
      
    ) dbt_internal_test
[0m07:21:28.650512 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5: Close
[0m07:21:28.651429 [info ] [Thread-4 (]: 73 of 262 PASS not_null_dim_products_scd_category_id ........................... [[32mPASS[0m in 3.13s]
[0m07:21:28.652220 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5
[0m07:21:28.652715 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m07:21:28.653214 [info ] [Thread-4 (]: 77 of 262 START test not_null_dim_products_scd_dbt_valid_from .................. [RUN]
[0m07:21:28.653734 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_category_id.525f0df4c5, now test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468)
[0m07:21:28.654067 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m07:21:28.658540 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m07:21:28.659074 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m07:21:28.660969 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m07:21:28.661515 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m07:21:28.661858 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: BEGIN
[0m07:21:28.662187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:28.763346 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:21:28.764950 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: ROLLBACK
[0m07:21:29.018794 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39: Close
[0m07:21:29.019800 [info ] [Thread-3 (]: 74 of 262 PASS not_null_dim_products_scd_created_at ............................ [[32mPASS[0m in 2.88s]
[0m07:21:29.020564 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39
[0m07:21:29.021065 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m07:21:29.021574 [info ] [Thread-3 (]: 78 of 262 START test not_null_dim_products_scd_dbt_valid_to .................... [RUN]
[0m07:21:29.022084 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_created_at.359e29dc39, now test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3)
[0m07:21:29.022494 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m07:21:29.026667 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m07:21:29.027307 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m07:21:29.029504 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m07:21:29.030040 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m07:21:29.030392 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: BEGIN
[0m07:21:29.030683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:30.131619 [debug] [Thread-2 (]: SQL status: BEGIN in 2.492 seconds
[0m07:21:30.132250 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"
[0m07:21:30.132718 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:30.272502 [debug] [Thread-1 (]: SQL status: BEGIN in 2.218 seconds
[0m07:21:30.272963 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"
[0m07:21:30.273290 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:21:30.406229 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:21:30.407771 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: ROLLBACK
[0m07:21:30.515660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.242 seconds
[0m07:21:30.517035 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: ROLLBACK
[0m07:21:30.686282 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e: Close
[0m07:21:30.687093 [info ] [Thread-2 (]: 75 of 262 PASS not_null_dim_products_scd_dbt_scd_id ............................ [[32mPASS[0m in 3.06s]
[0m07:21:30.687670 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e
[0m07:21:30.688103 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m07:21:30.688519 [info ] [Thread-2 (]: 79 of 262 START test not_null_dim_products_scd_is_current ...................... [RUN]
[0m07:21:30.688982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_scd_id.64fe98147e, now test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d)
[0m07:21:30.689351 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m07:21:30.692781 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m07:21:30.693334 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m07:21:30.695164 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m07:21:30.695635 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m07:21:30.695994 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: BEGIN
[0m07:21:30.696293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:30.758818 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9: Close
[0m07:21:30.759678 [info ] [Thread-1 (]: 76 of 262 PASS not_null_dim_products_scd_dbt_updated_at ........................ [[32mPASS[0m in 2.71s]
[0m07:21:30.760418 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9
[0m07:21:30.760859 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m07:21:30.761373 [info ] [Thread-1 (]: 80 of 262 START test not_null_dim_products_scd_name ............................ [RUN]
[0m07:21:30.761912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_updated_at.ad195b0ea9, now test.retail_dbt.not_null_dim_products_scd_name.2e07a01976)
[0m07:21:30.762354 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m07:21:30.766314 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m07:21:30.766836 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m07:21:30.769633 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m07:21:30.770176 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m07:21:30.770524 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: BEGIN
[0m07:21:30.770816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:30.878634 [debug] [Thread-4 (]: SQL status: BEGIN in 2.216 seconds
[0m07:21:30.879056 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"
[0m07:21:30.879438 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:31.634560 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.755 seconds
[0m07:21:31.636149 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: ROLLBACK
[0m07:21:31.754054 [debug] [Thread-3 (]: SQL status: BEGIN in 2.723 seconds
[0m07:21:31.754571 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"
[0m07:21:31.754915 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_products_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:32.024854 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.269 seconds
[0m07:21:32.026194 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: ROLLBACK
[0m07:21:32.301160 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3: Close
[0m07:21:32.302045 [error] [Thread-3 (]: 78 of 262 FAIL 400 not_null_dim_products_scd_dbt_valid_to ...................... [[31mFAIL 400[0m in 3.28s]
[0m07:21:32.302598 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3
[0m07:21:32.302988 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m07:21:32.303410 [info ] [Thread-3 (]: 81 of 262 START test not_null_dim_products_scd_price ........................... [RUN]
[0m07:21:32.303940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_valid_to.06eb6909d3, now test.retail_dbt.not_null_dim_products_scd_price.d616170fd5)
[0m07:21:32.304325 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m07:21:32.308500 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m07:21:32.309069 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m07:21:32.311093 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m07:21:32.311635 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m07:21:32.312027 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: BEGIN
[0m07:21:32.312376 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:33.413588 [debug] [Thread-2 (]: SQL status: BEGIN in 2.717 seconds
[0m07:21:33.414077 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"
[0m07:21:33.414429 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_products_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:21:33.450333 [debug] [Thread-1 (]: SQL status: BEGIN in 2.679 seconds
[0m07:21:33.450878 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"
[0m07:21:33.451215 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_name.2e07a01976"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_products_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:21:33.472259 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468: Close
[0m07:21:33.473134 [info ] [Thread-4 (]: 77 of 262 PASS not_null_dim_products_scd_dbt_valid_from ........................ [[32mPASS[0m in 4.82s]
[0m07:21:33.473774 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468
[0m07:21:33.474157 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m07:21:33.474593 [info ] [Thread-4 (]: 82 of 262 START test not_null_dim_products_scd_product_id ...................... [RUN]
[0m07:21:33.475111 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_dbt_valid_from.129e676468, now test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7)
[0m07:21:33.475429 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m07:21:33.478931 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m07:21:33.479468 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m07:21:33.481357 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m07:21:33.481866 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m07:21:33.482161 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: BEGIN
[0m07:21:33.482490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:33.686273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.271 seconds
[0m07:21:33.687705 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: ROLLBACK
[0m07:21:33.730754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:21:33.732285 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: ROLLBACK
[0m07:21:33.959025 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d: Close
[0m07:21:33.959973 [info ] [Thread-2 (]: 79 of 262 PASS not_null_dim_products_scd_is_current ............................ [[32mPASS[0m in 3.27s]
[0m07:21:33.960652 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d
[0m07:21:33.961158 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m07:21:33.961682 [info ] [Thread-2 (]: 83 of 262 START test not_null_dim_products_scd_product_sk ...................... [RUN]
[0m07:21:33.962137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_is_current.f1a053499d, now test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef)
[0m07:21:33.962507 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m07:21:33.966042 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m07:21:33.966601 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m07:21:33.968460 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m07:21:33.969034 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m07:21:33.969379 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: BEGIN
[0m07:21:33.969712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:34.051680 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_name.2e07a01976: Close
[0m07:21:34.052578 [info ] [Thread-1 (]: 80 of 262 PASS not_null_dim_products_scd_name .................................. [[32mPASS[0m in 3.29s]
[0m07:21:34.053186 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_name.2e07a01976
[0m07:21:34.053620 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m07:21:34.054049 [info ] [Thread-1 (]: 84 of 262 START test not_null_dim_products_scd_season .......................... [RUN]
[0m07:21:34.054449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_name.2e07a01976, now test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2)
[0m07:21:34.054833 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m07:21:34.059119 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m07:21:34.059731 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m07:21:34.061631 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m07:21:34.062217 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m07:21:34.062564 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: BEGIN
[0m07:21:34.062893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:34.539043 [debug] [Thread-3 (]: SQL status: BEGIN in 2.227 seconds
[0m07:21:34.539574 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"
[0m07:21:34.540070 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_price.d616170fd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "postgres"."silver_to_golden"."dim_products_scd"
where price is null



  
  
      
    ) dbt_internal_test
[0m07:21:34.781011 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:21:34.782571 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: ROLLBACK
[0m07:21:35.018898 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_price.d616170fd5: Close
[0m07:21:35.019699 [info ] [Thread-3 (]: 81 of 262 PASS not_null_dim_products_scd_price ................................. [[32mPASS[0m in 2.72s]
[0m07:21:35.020340 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_price.d616170fd5
[0m07:21:35.020700 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m07:21:35.021120 [info ] [Thread-3 (]: 85 of 262 START test not_null_dim_products_scd_supplier_id ..................... [RUN]
[0m07:21:35.021528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_price.d616170fd5, now test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf)
[0m07:21:35.021835 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m07:21:35.025089 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m07:21:35.025610 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m07:21:35.027368 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m07:21:35.027891 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m07:21:35.028214 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: BEGIN
[0m07:21:35.028504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:37.415452 [debug] [Thread-4 (]: SQL status: BEGIN in 2.195 seconds
[0m07:21:37.416028 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"
[0m07:21:37.416383 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."dim_products_scd"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:37.680506 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:21:37.681913 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: ROLLBACK
[0m07:21:37.952998 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7: Close
[0m07:21:37.954099 [info ] [Thread-4 (]: 82 of 262 PASS not_null_dim_products_scd_product_id ............................ [[32mPASS[0m in 4.48s]
[0m07:21:37.954894 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7
[0m07:21:37.955382 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m07:21:37.956052 [info ] [Thread-4 (]: 86 of 262 START test not_null_dim_products_scd_valid_from ...................... [RUN]
[0m07:21:37.956627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_product_id.888f04d8f7, now test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b)
[0m07:21:37.957046 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m07:21:37.962207 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m07:21:37.963140 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m07:21:37.965724 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m07:21:37.966349 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m07:21:37.966691 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: BEGIN
[0m07:21:37.967020 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:38.402075 [debug] [Thread-2 (]: SQL status: BEGIN in 2.694 seconds
[0m07:21:38.402627 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"
[0m07:21:38.403007 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from "postgres"."silver_to_golden"."dim_products_scd"
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m07:21:38.410441 [debug] [Thread-1 (]: SQL status: BEGIN in 2.609 seconds
[0m07:21:38.410945 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"
[0m07:21:38.411407 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select season
from "postgres"."silver_to_golden"."dim_products_scd"
where season is null



  
  
      
    ) dbt_internal_test
[0m07:21:38.701846 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.298 seconds
[0m07:21:38.703445 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: ROLLBACK
[0m07:21:38.750033 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.338 seconds
[0m07:21:38.751492 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: ROLLBACK
[0m07:21:39.003627 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef: Close
[0m07:21:39.004539 [info ] [Thread-2 (]: 83 of 262 PASS not_null_dim_products_scd_product_sk ............................ [[32mPASS[0m in 5.04s]
[0m07:21:39.005150 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef
[0m07:21:39.005578 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m07:21:39.006025 [info ] [Thread-2 (]: 87 of 262 START test not_null_dim_products_scd_valid_to ........................ [RUN]
[0m07:21:39.006565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_product_sk.08e66abbef, now test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34)
[0m07:21:39.006917 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m07:21:39.010643 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m07:21:39.011223 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m07:21:39.014346 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m07:21:39.014938 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m07:21:39.015296 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: BEGIN
[0m07:21:39.015617 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:39.056407 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2: Close
[0m07:21:39.057395 [info ] [Thread-1 (]: 84 of 262 PASS not_null_dim_products_scd_season ................................ [[32mPASS[0m in 5.00s]
[0m07:21:39.058035 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2
[0m07:21:39.058559 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m07:21:39.059009 [info ] [Thread-1 (]: 88 of 262 START test not_null_dim_promotions_scd_dbt_scd_id .................... [RUN]
[0m07:21:39.059501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_season.1a2da695e2, now test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f)
[0m07:21:39.059899 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m07:21:39.064204 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m07:21:39.064924 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m07:21:39.067544 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m07:21:39.068180 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m07:21:39.068525 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: BEGIN
[0m07:21:39.068868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:39.758104 [debug] [Thread-3 (]: SQL status: BEGIN in 2.991 seconds
[0m07:21:39.758689 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"
[0m07:21:39.759212 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."dim_products_scd"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:40.044910 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.285 seconds
[0m07:21:40.046741 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: ROLLBACK
[0m07:21:40.307682 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf: Close
[0m07:21:40.308606 [info ] [Thread-3 (]: 85 of 262 PASS not_null_dim_products_scd_supplier_id ........................... [[32mPASS[0m in 5.29s]
[0m07:21:40.309178 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf
[0m07:21:40.309613 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m07:21:40.310161 [info ] [Thread-3 (]: 89 of 262 START test not_null_dim_promotions_scd_dbt_updated_at ................ [RUN]
[0m07:21:40.310653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_supplier_id.a891d79aaf, now test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439)
[0m07:21:40.311012 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m07:21:40.314884 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m07:21:40.315485 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m07:21:40.317546 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m07:21:40.318111 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m07:21:40.318483 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: BEGIN
[0m07:21:40.318854 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:40.323172 [debug] [Thread-4 (]: SQL status: BEGIN in 2.356 seconds
[0m07:21:40.323652 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"
[0m07:21:40.324126 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_products_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:40.590422 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.266 seconds
[0m07:21:40.592052 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: ROLLBACK
[0m07:21:40.861815 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b: Close
[0m07:21:40.862914 [info ] [Thread-4 (]: 86 of 262 PASS not_null_dim_products_scd_valid_from ............................ [[32mPASS[0m in 2.91s]
[0m07:21:40.863625 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b
[0m07:21:40.864144 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m07:21:40.864656 [info ] [Thread-4 (]: 90 of 262 START test not_null_dim_promotions_scd_dbt_valid_from ................ [RUN]
[0m07:21:40.865204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_valid_from.ff3104926b, now test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8)
[0m07:21:40.865657 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m07:21:40.869498 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m07:21:40.870079 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m07:21:40.872008 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m07:21:40.872596 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m07:21:40.872955 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: BEGIN
[0m07:21:40.873275 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:41.815208 [debug] [Thread-1 (]: SQL status: BEGIN in 2.746 seconds
[0m07:21:41.815734 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"
[0m07:21:41.816103 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:42.117520 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.301 seconds
[0m07:21:42.119398 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: ROLLBACK
[0m07:21:42.420381 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f: Close
[0m07:21:42.421306 [info ] [Thread-1 (]: 88 of 262 PASS not_null_dim_promotions_scd_dbt_scd_id .......................... [[32mPASS[0m in 3.36s]
[0m07:21:42.421923 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f
[0m07:21:42.422407 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m07:21:42.422842 [info ] [Thread-1 (]: 91 of 262 START test not_null_dim_promotions_scd_dbt_valid_to .................. [RUN]
[0m07:21:42.423304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_scd_id.b1c88a581f, now test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7)
[0m07:21:42.423680 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m07:21:42.427215 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m07:21:42.427839 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m07:21:42.496477 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m07:21:42.497315 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m07:21:42.497727 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: BEGIN
[0m07:21:42.498098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:42.918473 [debug] [Thread-2 (]: SQL status: BEGIN in 3.903 seconds
[0m07:21:42.918949 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"
[0m07:21:42.919318 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_products_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:43.099306 [debug] [Thread-3 (]: SQL status: BEGIN in 2.780 seconds
[0m07:21:43.099794 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"
[0m07:21:43.100177 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:21:43.195114 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:21:43.196729 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: ROLLBACK
[0m07:21:43.198356 [debug] [Thread-4 (]: SQL status: BEGIN in 2.325 seconds
[0m07:21:43.198812 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"
[0m07:21:43.199157 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:43.379765 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:21:43.381139 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: ROLLBACK
[0m07:21:43.438705 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.239 seconds
[0m07:21:43.440140 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: ROLLBACK
[0m07:21:43.476301 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34: Close
[0m07:21:43.477133 [error] [Thread-2 (]: 87 of 262 FAIL 400 not_null_dim_products_scd_valid_to .......................... [[31mFAIL 400[0m in 4.47s]
[0m07:21:43.477739 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34
[0m07:21:43.478160 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m07:21:43.478602 [info ] [Thread-2 (]: 92 of 262 START test not_null_dim_promotions_scd_end_date ...................... [RUN]
[0m07:21:43.479060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_products_scd_valid_to.07fb76bf34, now test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5)
[0m07:21:43.479381 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m07:21:43.483213 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m07:21:43.483827 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m07:21:43.485759 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m07:21:43.486333 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m07:21:43.486655 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: BEGIN
[0m07:21:43.486986 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:43.662851 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439: Close
[0m07:21:43.663744 [info ] [Thread-3 (]: 89 of 262 PASS not_null_dim_promotions_scd_dbt_updated_at ...................... [[32mPASS[0m in 3.35s]
[0m07:21:43.664362 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439
[0m07:21:43.664773 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m07:21:43.665186 [info ] [Thread-3 (]: 93 of 262 START test not_null_dim_promotions_scd_is_current .................... [RUN]
[0m07:21:43.665638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_updated_at.f5373d9439, now test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247)
[0m07:21:43.666002 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m07:21:43.669781 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m07:21:43.670355 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m07:21:43.672267 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m07:21:43.672803 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m07:21:43.673147 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: BEGIN
[0m07:21:43.673463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:43.679316 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8: Close
[0m07:21:43.680031 [info ] [Thread-4 (]: 90 of 262 PASS not_null_dim_promotions_scd_dbt_valid_from ...................... [[32mPASS[0m in 2.81s]
[0m07:21:43.680582 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8
[0m07:21:43.680977 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m07:21:43.681442 [info ] [Thread-4 (]: 94 of 262 START test not_null_dim_promotions_scd_name .......................... [RUN]
[0m07:21:43.681976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_from.f013709fc8, now test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a)
[0m07:21:43.682405 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m07:21:43.685777 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m07:21:43.686313 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m07:21:43.688204 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m07:21:43.688742 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m07:21:43.689084 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: BEGIN
[0m07:21:43.689413 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:45.725413 [debug] [Thread-1 (]: SQL status: BEGIN in 3.227 seconds
[0m07:21:45.725978 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"
[0m07:21:45.726425 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_promotions_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:45.873147 [debug] [Thread-2 (]: SQL status: BEGIN in 2.386 seconds
[0m07:21:45.873641 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"
[0m07:21:45.874092 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select end_date
from "postgres"."silver_to_golden"."dim_promotions_scd"
where end_date is null



  
  
      
    ) dbt_internal_test
[0m07:21:45.882914 [debug] [Thread-3 (]: SQL status: BEGIN in 2.209 seconds
[0m07:21:45.883295 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"
[0m07:21:45.883592 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_promotions_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:21:45.954219 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:21:45.955741 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: ROLLBACK
[0m07:21:46.086917 [debug] [Thread-4 (]: SQL status: BEGIN in 2.397 seconds
[0m07:21:46.087463 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"
[0m07:21:46.087956 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_promotions_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:21:46.115391 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.231 seconds
[0m07:21:46.116866 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: ROLLBACK
[0m07:21:46.121903 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.247 seconds
[0m07:21:46.123213 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: ROLLBACK
[0m07:21:46.189518 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7: Close
[0m07:21:46.190459 [error] [Thread-1 (]: 91 of 262 FAIL 248 not_null_dim_promotions_scd_dbt_valid_to .................... [[31mFAIL 248[0m in 3.77s]
[0m07:21:46.191109 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7
[0m07:21:46.191531 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m07:21:46.191974 [info ] [Thread-1 (]: 95 of 262 START test not_null_dim_promotions_scd_promotion_id .................. [RUN]
[0m07:21:46.192450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_dbt_valid_to.dc9326ebd7, now test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4)
[0m07:21:46.192870 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m07:21:46.198137 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m07:21:46.198676 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m07:21:46.200659 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m07:21:46.201627 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m07:21:46.202041 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: BEGIN
[0m07:21:46.202400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:46.600447 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5: Close
[0m07:21:46.601424 [info ] [Thread-2 (]: 92 of 262 PASS not_null_dim_promotions_scd_end_date ............................ [[32mPASS[0m in 3.12s]
[0m07:21:46.602210 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5
[0m07:21:46.602691 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m07:21:46.603095 [info ] [Thread-2 (]: 96 of 262 START test not_null_dim_promotions_scd_promotion_sk .................. [RUN]
[0m07:21:46.603557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_end_date.fdca100ea5, now test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5)
[0m07:21:46.603914 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m07:21:46.607516 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m07:21:46.608097 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m07:21:46.610096 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m07:21:46.610639 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m07:21:46.610935 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: BEGIN
[0m07:21:46.611256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:46.800185 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247: Close
[0m07:21:46.801299 [info ] [Thread-3 (]: 93 of 262 PASS not_null_dim_promotions_scd_is_current .......................... [[32mPASS[0m in 3.14s]
[0m07:21:46.802001 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247
[0m07:21:46.802438 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m07:21:46.802943 [info ] [Thread-3 (]: 97 of 262 START test not_null_dim_promotions_scd_start_date .................... [RUN]
[0m07:21:46.803380 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_is_current.c1c92cb247, now test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5)
[0m07:21:46.803711 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m07:21:46.806681 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m07:21:46.807177 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m07:21:46.808959 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m07:21:46.809432 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m07:21:46.809722 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: BEGIN
[0m07:21:46.810021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:46.821368 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.733 seconds
[0m07:21:46.822845 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: ROLLBACK
[0m07:21:47.075281 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a: Close
[0m07:21:47.076349 [info ] [Thread-4 (]: 94 of 262 PASS not_null_dim_promotions_scd_name ................................ [[32mPASS[0m in 3.39s]
[0m07:21:47.077033 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a
[0m07:21:47.077616 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m07:21:47.078231 [info ] [Thread-4 (]: 98 of 262 START test not_null_dim_promotions_scd_valid_from .................... [RUN]
[0m07:21:47.078770 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_name.eff08cd11a, now test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f)
[0m07:21:47.079165 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m07:21:47.083160 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m07:21:47.083656 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m07:21:47.085481 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m07:21:47.086009 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m07:21:47.086323 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: BEGIN
[0m07:21:47.086600 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:48.843339 [debug] [Thread-3 (]: SQL status: BEGIN in 2.033 seconds
[0m07:21:48.843779 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"
[0m07:21:48.844097 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select start_date
from "postgres"."silver_to_golden"."dim_promotions_scd"
where start_date is null



  
  
      
    ) dbt_internal_test
[0m07:21:49.065820 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.221 seconds
[0m07:21:49.067132 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: ROLLBACK
[0m07:21:49.295064 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5: Close
[0m07:21:49.295817 [info ] [Thread-3 (]: 97 of 262 PASS not_null_dim_promotions_scd_start_date .......................... [[32mPASS[0m in 2.49s]
[0m07:21:49.296357 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5
[0m07:21:49.296719 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m07:21:49.297130 [info ] [Thread-3 (]: 99 of 262 START test not_null_dim_promotions_scd_valid_to ...................... [RUN]
[0m07:21:49.297522 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_start_date.da0735dcd5, now test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417)
[0m07:21:49.297846 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m07:21:49.302159 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m07:21:49.302657 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m07:21:49.304304 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m07:21:49.304814 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m07:21:49.305141 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: BEGIN
[0m07:21:49.305454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:49.351335 [debug] [Thread-1 (]: SQL status: BEGIN in 3.149 seconds
[0m07:21:49.351714 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"
[0m07:21:49.352048 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select promotion_id
from "postgres"."silver_to_golden"."dim_promotions_scd"
where promotion_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:49.392911 [debug] [Thread-2 (]: SQL status: BEGIN in 2.782 seconds
[0m07:21:49.393289 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"
[0m07:21:49.393584 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select promotion_sk
from "postgres"."silver_to_golden"."dim_promotions_scd"
where promotion_sk is null



  
  
      
    ) dbt_internal_test
[0m07:21:49.594159 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.242 seconds
[0m07:21:49.595546 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: ROLLBACK
[0m07:21:49.643597 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.250 seconds
[0m07:21:49.644611 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: ROLLBACK
[0m07:21:49.841981 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4: Close
[0m07:21:49.842723 [info ] [Thread-1 (]: 95 of 262 PASS not_null_dim_promotions_scd_promotion_id ........................ [[32mPASS[0m in 3.65s]
[0m07:21:49.843259 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4
[0m07:21:49.843658 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m07:21:49.844073 [info ] [Thread-1 (]: 100 of 262 START test not_null_dim_stores_scd_dbt_scd_id ....................... [RUN]
[0m07:21:49.844482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_promotion_id.68a043e3c4, now test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5)
[0m07:21:49.844788 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m07:21:49.847862 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m07:21:49.848333 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m07:21:49.850100 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m07:21:49.850582 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m07:21:49.850901 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: BEGIN
[0m07:21:49.851217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:49.895413 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5: Close
[0m07:21:49.896136 [info ] [Thread-2 (]: 96 of 262 PASS not_null_dim_promotions_scd_promotion_sk ........................ [[32mPASS[0m in 3.29s]
[0m07:21:49.896646 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5
[0m07:21:49.897023 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m07:21:49.897382 [info ] [Thread-2 (]: 101 of 262 START test not_null_dim_stores_scd_dbt_updated_at ................... [RUN]
[0m07:21:49.897819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_promotion_sk.bd7c176ae5, now test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59)
[0m07:21:49.898176 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m07:21:49.901153 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m07:21:49.901657 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m07:21:49.903413 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m07:21:49.903900 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m07:21:49.904177 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: BEGIN
[0m07:21:49.904484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:50.141251 [debug] [Thread-4 (]: SQL status: BEGIN in 3.055 seconds
[0m07:21:50.141685 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"
[0m07:21:50.142098 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_promotions_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:50.363840 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.221 seconds
[0m07:21:50.365231 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: ROLLBACK
[0m07:21:51.027431 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f: Close
[0m07:21:51.028236 [info ] [Thread-4 (]: 98 of 262 PASS not_null_dim_promotions_scd_valid_from .......................... [[32mPASS[0m in 3.95s]
[0m07:21:51.028892 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f
[0m07:21:51.029290 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m07:21:51.029728 [info ] [Thread-4 (]: 102 of 262 START test not_null_dim_stores_scd_dbt_valid_from ................... [RUN]
[0m07:21:51.030175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_valid_from.e12b3e052f, now test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787)
[0m07:21:51.030498 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m07:21:51.033891 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m07:21:51.034466 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m07:21:51.037586 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m07:21:51.038125 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m07:21:51.038450 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: BEGIN
[0m07:21:51.038733 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:51.363753 [debug] [Thread-3 (]: SQL status: BEGIN in 2.058 seconds
[0m07:21:51.364194 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"
[0m07:21:51.364578 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_promotions_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:50.454302 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.220 seconds
[0m07:21:50.455847 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: ROLLBACK
[0m07:21:51.958215 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417: Close
[0m07:21:51.959130 [error] [Thread-3 (]: 99 of 262 FAIL 248 not_null_dim_promotions_scd_valid_to ........................ [[31mFAIL 248[0m in 2.66s]
[0m07:21:51.959883 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417
[0m07:21:51.960344 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m07:21:51.960860 [info ] [Thread-3 (]: 103 of 262 START test not_null_dim_stores_scd_dbt_valid_to ..................... [RUN]
[0m07:21:51.961387 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_promotions_scd_valid_to.9419731417, now test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc)
[0m07:21:51.961816 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m07:21:51.965530 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m07:21:51.966033 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m07:21:51.968023 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m07:21:51.968555 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m07:21:51.968893 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: BEGIN
[0m07:21:51.969191 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:52.101856 [debug] [Thread-2 (]: SQL status: BEGIN in 2.046 seconds
[0m07:21:52.102335 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"
[0m07:21:52.102745 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:21:52.328300 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.225 seconds
[0m07:21:52.329804 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: ROLLBACK
[0m07:21:52.352505 [debug] [Thread-1 (]: SQL status: BEGIN in 2.350 seconds
[0m07:21:52.352994 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"
[0m07:21:52.353443 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:52.555124 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59: Close
[0m07:21:52.556015 [info ] [Thread-2 (]: 101 of 262 PASS not_null_dim_stores_scd_dbt_updated_at ......................... [[32mPASS[0m in 2.66s]
[0m07:21:52.556528 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59
[0m07:21:52.556863 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m07:21:52.557225 [info ] [Thread-2 (]: 104 of 262 START test not_null_dim_stores_scd_is_current ....................... [RUN]
[0m07:21:52.557635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_updated_at.e345a23f59, now test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257)
[0m07:21:52.557943 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m07:21:52.560798 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m07:21:52.561272 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m07:21:52.563037 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m07:21:52.563506 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m07:21:52.563794 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: BEGIN
[0m07:21:52.564091 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:52.612140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.258 seconds
[0m07:21:52.613642 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: ROLLBACK
[0m07:21:52.875622 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5: Close
[0m07:21:52.876603 [info ] [Thread-1 (]: 100 of 262 PASS not_null_dim_stores_scd_dbt_scd_id ............................. [[32mPASS[0m in 3.03s]
[0m07:21:52.877386 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5
[0m07:21:52.877882 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m07:21:52.878364 [info ] [Thread-1 (]: 105 of 262 START test not_null_dim_stores_scd_location ......................... [RUN]
[0m07:21:52.878875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_scd_id.6c8439aad5, now test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58)
[0m07:21:52.879292 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m07:21:52.882906 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m07:21:52.883486 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m07:21:52.885778 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m07:21:52.886407 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m07:21:52.886808 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: BEGIN
[0m07:21:52.887170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:53.631859 [debug] [Thread-4 (]: SQL status: BEGIN in 2.441 seconds
[0m07:21:53.632333 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"
[0m07:21:53.632664 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:21:54.128516 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.495 seconds
[0m07:21:54.130020 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: ROLLBACK
[0m07:21:54.381589 [debug] [Thread-3 (]: SQL status: BEGIN in 2.412 seconds
[0m07:21:54.382100 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"
[0m07:21:54.382441 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_stores_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:21:54.433870 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787: Close
[0m07:21:54.434710 [info ] [Thread-4 (]: 102 of 262 PASS not_null_dim_stores_scd_dbt_valid_from ......................... [[32mPASS[0m in 3.40s]
[0m07:21:54.435313 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787
[0m07:21:54.435684 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m07:21:54.436138 [info ] [Thread-4 (]: 106 of 262 START test not_null_dim_stores_scd_manager_id ....................... [RUN]
[0m07:21:54.436606 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_valid_from.d644927787, now test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8)
[0m07:21:54.436958 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m07:21:54.441523 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m07:21:54.442062 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m07:21:54.443938 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m07:21:54.444470 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m07:21:54.444781 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: BEGIN
[0m07:21:54.445132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:54.623541 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.241 seconds
[0m07:21:54.624908 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: ROLLBACK
[0m07:21:54.863344 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc: Close
[0m07:21:54.864150 [error] [Thread-3 (]: 103 of 262 FAIL 20 not_null_dim_stores_scd_dbt_valid_to ........................ [[31mFAIL 20[0m in 2.90s]
[0m07:21:54.864731 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc
[0m07:21:54.865113 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m07:21:54.865615 [info ] [Thread-3 (]: 107 of 262 START test not_null_dim_stores_scd_name ............................. [RUN]
[0m07:21:54.866105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_dbt_valid_to.a973a28dbc, now test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999)
[0m07:21:54.866460 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m07:21:54.869814 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m07:21:54.870321 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m07:21:54.872268 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m07:21:54.872757 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m07:21:54.873073 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: BEGIN
[0m07:21:54.873362 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:55.336475 [debug] [Thread-1 (]: SQL status: BEGIN in 2.449 seconds
[0m07:21:55.336948 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"
[0m07:21:55.337307 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location
from "postgres"."silver_to_golden"."dim_stores_scd"
where location is null



  
  
      
    ) dbt_internal_test
[0m07:21:55.569820 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.232 seconds
[0m07:21:55.571246 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: ROLLBACK
[0m07:21:55.802839 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58: Close
[0m07:21:55.803730 [info ] [Thread-1 (]: 105 of 262 PASS not_null_dim_stores_scd_location ............................... [[32mPASS[0m in 2.92s]
[0m07:21:55.804302 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58
[0m07:21:55.804666 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m07:21:55.805087 [info ] [Thread-1 (]: 108 of 262 START test not_null_dim_stores_scd_store_id ......................... [RUN]
[0m07:21:55.805507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_location.0fb1fcff58, now test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f)
[0m07:21:55.805845 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m07:21:55.809013 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m07:21:55.809509 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m07:21:55.811193 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m07:21:55.811698 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m07:21:55.812064 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: BEGIN
[0m07:21:55.812359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:55.954551 [debug] [Thread-2 (]: SQL status: BEGIN in 3.390 seconds
[0m07:21:55.954992 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"
[0m07:21:55.955311 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_stores_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:21:56.192669 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.237 seconds
[0m07:21:56.194124 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: ROLLBACK
[0m07:21:56.432428 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257: Close
[0m07:21:56.433297 [info ] [Thread-2 (]: 104 of 262 PASS not_null_dim_stores_scd_is_current ............................. [[32mPASS[0m in 3.88s]
[0m07:21:56.433921 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257
[0m07:21:56.434345 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m07:21:56.434776 [info ] [Thread-2 (]: 109 of 262 START test not_null_dim_stores_scd_store_sk ......................... [RUN]
[0m07:21:56.435212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_is_current.a5e5c85257, now test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c)
[0m07:21:56.435548 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m07:21:56.438940 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m07:21:56.439518 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m07:21:56.444011 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m07:21:56.444743 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m07:21:56.445209 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: BEGIN
[0m07:21:56.445738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:56.870752 [debug] [Thread-4 (]: SQL status: BEGIN in 2.425 seconds
[0m07:21:56.871222 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"
[0m07:21:56.871553 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select manager_id
from "postgres"."silver_to_golden"."dim_stores_scd"
where manager_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:56.925977 [debug] [Thread-3 (]: SQL status: BEGIN in 2.053 seconds
[0m07:21:56.926353 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"
[0m07:21:56.926708 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_stores_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:21:57.139107 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.267 seconds
[0m07:21:57.140383 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: ROLLBACK
[0m07:21:57.152763 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:21:57.154004 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: ROLLBACK
[0m07:21:57.379855 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999: Close
[0m07:21:57.380684 [info ] [Thread-3 (]: 107 of 262 PASS not_null_dim_stores_scd_name ................................... [[32mPASS[0m in 2.51s]
[0m07:21:57.381224 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999
[0m07:21:57.381666 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m07:21:57.382067 [info ] [Thread-3 (]: 110 of 262 START test not_null_dim_stores_scd_valid_from ....................... [RUN]
[0m07:21:57.382487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_name.57cf8fd999, now test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f)
[0m07:21:57.382794 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m07:21:57.386045 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m07:21:57.386561 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m07:21:57.388400 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m07:21:57.388908 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m07:21:57.389262 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: BEGIN
[0m07:21:57.389587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:21:57.406067 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8: Close
[0m07:21:57.406779 [info ] [Thread-4 (]: 106 of 262 PASS not_null_dim_stores_scd_manager_id ............................. [[32mPASS[0m in 2.97s]
[0m07:21:57.407344 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8
[0m07:21:57.407732 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m07:21:57.408148 [info ] [Thread-4 (]: 111 of 262 START test not_null_dim_stores_scd_valid_to ......................... [RUN]
[0m07:21:57.408568 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_manager_id.38d4e973e8, now test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24)
[0m07:21:57.408879 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m07:21:57.411969 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m07:21:57.412464 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m07:21:57.414257 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m07:21:57.414743 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m07:21:57.415032 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: BEGIN
[0m07:21:57.415349 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:21:57.953678 [debug] [Thread-1 (]: SQL status: BEGIN in 2.141 seconds
[0m07:21:57.954104 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"
[0m07:21:57.954452 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."dim_stores_scd"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:21:58.183409 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.229 seconds
[0m07:21:58.184875 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: ROLLBACK
[0m07:21:58.413920 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f: Close
[0m07:21:58.414911 [info ] [Thread-1 (]: 108 of 262 PASS not_null_dim_stores_scd_store_id ............................... [[32mPASS[0m in 2.61s]
[0m07:21:58.415668 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f
[0m07:21:58.416128 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m07:21:58.416461 [info ] [Thread-1 (]: 112 of 262 START test not_null_dim_suppliers_scd_contact_info .................. [RUN]
[0m07:21:58.417011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_store_id.eb554c331f, now test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6)
[0m07:21:58.417511 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m07:21:58.420869 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m07:21:58.421382 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m07:21:58.423220 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m07:21:58.423771 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m07:21:58.424089 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: BEGIN
[0m07:21:58.424387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:58.644605 [debug] [Thread-2 (]: SQL status: BEGIN in 2.199 seconds
[0m07:21:58.645116 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"
[0m07:21:58.645523 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_sk
from "postgres"."silver_to_golden"."dim_stores_scd"
where store_sk is null



  
  
      
    ) dbt_internal_test
[0m07:21:58.878307 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.232 seconds
[0m07:21:58.879677 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: ROLLBACK
[0m07:21:59.108265 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c: Close
[0m07:21:59.109108 [info ] [Thread-2 (]: 109 of 262 PASS not_null_dim_stores_scd_store_sk ............................... [[32mPASS[0m in 2.67s]
[0m07:21:59.109665 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c
[0m07:21:59.110104 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m07:21:59.110504 [info ] [Thread-2 (]: 113 of 262 START test not_null_dim_suppliers_scd_dbt_scd_id .................... [RUN]
[0m07:21:59.110896 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_store_sk.75a15a101c, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e)
[0m07:21:59.111232 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m07:21:59.114532 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m07:21:59.115185 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m07:21:59.118252 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m07:21:59.118778 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m07:21:59.119073 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: BEGIN
[0m07:21:59.119405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:21:59.809819 [debug] [Thread-4 (]: SQL status: BEGIN in 2.394 seconds
[0m07:21:59.810281 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"
[0m07:21:59.810619 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_stores_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:22:00.049388 [debug] [Thread-3 (]: SQL status: BEGIN in 2.660 seconds
[0m07:22:00.049895 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"
[0m07:22:00.050209 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_stores_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:22:00.074959 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:22:00.076166 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: ROLLBACK
[0m07:22:00.283158 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.233 seconds
[0m07:22:00.284630 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: ROLLBACK
[0m07:22:00.340345 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24: Close
[0m07:22:00.341214 [error] [Thread-4 (]: 111 of 262 FAIL 20 not_null_dim_stores_scd_valid_to ............................ [[31mFAIL 20[0m in 2.93s]
[0m07:22:00.341752 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24
[0m07:22:00.342134 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m07:22:00.342595 [info ] [Thread-4 (]: 114 of 262 START test not_null_dim_suppliers_scd_dbt_updated_at ................ [RUN]
[0m07:22:00.343015 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_valid_to.587d234d24, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372)
[0m07:22:00.343326 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m07:22:00.348106 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m07:22:00.349170 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m07:22:00.352601 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m07:22:00.353305 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m07:22:00.353719 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: BEGIN
[0m07:22:00.354057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:00.529679 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f: Close
[0m07:22:00.530279 [debug] [Thread-1 (]: SQL status: BEGIN in 2.106 seconds
[0m07:22:00.530739 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"
[0m07:22:00.531307 [info ] [Thread-3 (]: 110 of 262 PASS not_null_dim_stores_scd_valid_from ............................. [[32mPASS[0m in 3.15s]
[0m07:22:00.531782 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select contact_info
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where contact_info is null



  
  
      
    ) dbt_internal_test
[0m07:22:00.532295 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f
[0m07:22:00.532788 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m07:22:00.533188 [info ] [Thread-3 (]: 115 of 262 START test not_null_dim_suppliers_scd_dbt_valid_from ................ [RUN]
[0m07:22:00.533676 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_stores_scd_valid_from.8b8490821f, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710)
[0m07:22:00.533998 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m07:22:00.537412 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m07:22:00.537970 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m07:22:00.539795 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m07:22:00.540286 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m07:22:00.540577 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: BEGIN
[0m07:22:00.540882 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:00.763716 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.231 seconds
[0m07:22:00.765333 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: ROLLBACK
[0m07:22:00.995647 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6: Close
[0m07:22:00.996412 [info ] [Thread-1 (]: 112 of 262 PASS not_null_dim_suppliers_scd_contact_info ........................ [[32mPASS[0m in 2.58s]
[0m07:22:00.997050 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6
[0m07:22:00.997517 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m07:22:00.997941 [info ] [Thread-1 (]: 116 of 262 START test not_null_dim_suppliers_scd_dbt_valid_to .................. [RUN]
[0m07:22:00.998377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_contact_info.586f4ecbc6, now test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93)
[0m07:22:00.998739 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m07:22:01.002028 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m07:22:01.002535 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m07:22:01.004468 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m07:22:01.004977 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m07:22:01.005274 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: BEGIN
[0m07:22:01.005612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:01.321588 [debug] [Thread-2 (]: SQL status: BEGIN in 2.202 seconds
[0m07:22:01.322083 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"
[0m07:22:01.322411 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_scd_id
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_scd_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:01.571944 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.249 seconds
[0m07:22:01.573264 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: ROLLBACK
[0m07:22:01.823515 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e: Close
[0m07:22:01.824313 [info ] [Thread-2 (]: 113 of 262 PASS not_null_dim_suppliers_scd_dbt_scd_id .......................... [[32mPASS[0m in 2.71s]
[0m07:22:01.824905 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e
[0m07:22:01.825325 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m07:22:01.825783 [info ] [Thread-2 (]: 117 of 262 START test not_null_dim_suppliers_scd_is_current .................... [RUN]
[0m07:22:01.826244 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_scd_id.cd6b9cad0e, now test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1)
[0m07:22:01.826568 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m07:22:01.830872 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m07:22:01.831382 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m07:22:01.833166 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m07:22:01.833715 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m07:22:01.834017 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: BEGIN
[0m07:22:01.834328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:02.799430 [debug] [Thread-4 (]: SQL status: BEGIN in 2.445 seconds
[0m07:22:02.799983 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"
[0m07:22:02.800456 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_updated_at
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_updated_at is null



  
  
      
    ) dbt_internal_test
[0m07:22:02.997883 [debug] [Thread-3 (]: SQL status: BEGIN in 2.457 seconds
[0m07:22:02.998389 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"
[0m07:22:02.998818 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_from
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:22:03.054342 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.253 seconds
[0m07:22:03.055729 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: ROLLBACK
[0m07:22:03.117230 [debug] [Thread-1 (]: SQL status: BEGIN in 2.112 seconds
[0m07:22:03.117722 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"
[0m07:22:03.118044 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select dbt_valid_to
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where dbt_valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:22:03.256194 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.257 seconds
[0m07:22:03.257837 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: ROLLBACK
[0m07:22:03.307788 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372: Close
[0m07:22:03.308630 [info ] [Thread-4 (]: 114 of 262 PASS not_null_dim_suppliers_scd_dbt_updated_at ...................... [[32mPASS[0m in 2.97s]
[0m07:22:03.309236 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372
[0m07:22:03.309724 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m07:22:03.310206 [info ] [Thread-4 (]: 118 of 262 START test not_null_dim_suppliers_scd_name .......................... [RUN]
[0m07:22:03.310677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_updated_at.e8aeeea372, now test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1)
[0m07:22:03.311092 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m07:22:03.314618 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m07:22:03.315118 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m07:22:03.317106 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m07:22:03.317608 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m07:22:03.317924 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: BEGIN
[0m07:22:03.318237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:03.340981 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.223 seconds
[0m07:22:03.342390 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: ROLLBACK
[0m07:22:03.514706 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710: Close
[0m07:22:03.515898 [info ] [Thread-3 (]: 115 of 262 PASS not_null_dim_suppliers_scd_dbt_valid_from ...................... [[32mPASS[0m in 2.98s]
[0m07:22:03.516594 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710
[0m07:22:03.517110 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m07:22:03.517666 [info ] [Thread-3 (]: 119 of 262 START test not_null_dim_suppliers_scd_supplier_id ................... [RUN]
[0m07:22:03.518176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_from.c8ab1f4710, now test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a)
[0m07:22:03.518606 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m07:22:03.522045 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m07:22:03.522594 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m07:22:03.524504 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m07:22:03.525021 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m07:22:03.525311 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: BEGIN
[0m07:22:03.525628 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:03.561595 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93: Close
[0m07:22:03.562435 [error] [Thread-1 (]: 116 of 262 FAIL 10 not_null_dim_suppliers_scd_dbt_valid_to ..................... [[31mFAIL 10[0m in 2.56s]
[0m07:22:03.563130 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93
[0m07:22:03.563567 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m07:22:03.564029 [info ] [Thread-1 (]: 120 of 262 START test not_null_dim_suppliers_scd_supplier_sk ................... [RUN]
[0m07:22:03.564576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_dbt_valid_to.6c4f8f5e93, now test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773)
[0m07:22:03.564970 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m07:22:03.568582 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m07:22:03.569056 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m07:22:03.572037 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m07:22:03.572534 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m07:22:03.572818 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: BEGIN
[0m07:22:03.573092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:04.223883 [debug] [Thread-2 (]: SQL status: BEGIN in 2.389 seconds
[0m07:22:04.224422 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"
[0m07:22:04.224781 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_current
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where is_current is null



  
  
      
    ) dbt_internal_test
[0m07:22:04.455192 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.230 seconds
[0m07:22:04.456579 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: ROLLBACK
[0m07:22:05.157447 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1: Close
[0m07:22:05.158352 [info ] [Thread-2 (]: 117 of 262 PASS not_null_dim_suppliers_scd_is_current .......................... [[32mPASS[0m in 3.33s]
[0m07:22:05.158866 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1
[0m07:22:05.159250 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m07:22:05.159692 [info ] [Thread-2 (]: 121 of 262 START test not_null_dim_suppliers_scd_valid_from .................... [RUN]
[0m07:22:05.160056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_is_current.a0ea2cb2e1, now test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209)
[0m07:22:05.160401 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m07:22:05.163671 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m07:22:05.164165 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m07:22:05.166066 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m07:22:05.166631 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m07:22:05.167037 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: BEGIN
[0m07:22:05.167458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:05.627507 [debug] [Thread-4 (]: SQL status: BEGIN in 2.309 seconds
[0m07:22:05.628000 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"
[0m07:22:05.628304 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where name is null



  
  
      
    ) dbt_internal_test
[0m07:22:05.829552 [debug] [Thread-1 (]: SQL status: BEGIN in 2.256 seconds
[0m07:22:05.829999 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"
[0m07:22:05.830303 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_sk
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where supplier_sk is null



  
  
      
    ) dbt_internal_test
[0m07:22:05.848005 [debug] [Thread-3 (]: SQL status: BEGIN in 2.322 seconds
[0m07:22:05.848387 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"
[0m07:22:05.848712 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:05.850329 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.222 seconds
[0m07:22:05.851518 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: ROLLBACK
[0m07:22:06.066689 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:22:06.067912 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: ROLLBACK
[0m07:22:06.068216 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.219 seconds
[0m07:22:06.069367 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: ROLLBACK
[0m07:22:06.070981 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1: Close
[0m07:22:06.071606 [info ] [Thread-4 (]: 118 of 262 PASS not_null_dim_suppliers_scd_name ................................ [[32mPASS[0m in 2.76s]
[0m07:22:06.072227 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1
[0m07:22:06.072602 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m07:22:06.073112 [info ] [Thread-4 (]: 122 of 262 START test not_null_dim_suppliers_scd_valid_to ...................... [RUN]
[0m07:22:06.073648 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_name.11edeb06e1, now test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917)
[0m07:22:06.073985 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m07:22:06.077399 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m07:22:06.077915 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m07:22:06.079560 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m07:22:06.080077 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m07:22:06.080396 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: BEGIN
[0m07:22:06.080669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:06.289849 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a: Close
[0m07:22:06.290664 [info ] [Thread-3 (]: 119 of 262 PASS not_null_dim_suppliers_scd_supplier_id ......................... [[32mPASS[0m in 2.77s]
[0m07:22:06.291198 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a
[0m07:22:06.291620 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m07:22:06.292030 [info ] [Thread-3 (]: 123 of 262 START test not_null_dim_tax_rules_product_id ........................ [RUN]
[0m07:22:06.292431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_supplier_id.b2cfb6ed2a, now test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297)
[0m07:22:06.292728 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m07:22:06.296076 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m07:22:06.296434 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773: Close
[0m07:22:06.297075 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m07:22:06.300018 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m07:22:06.297751 [info ] [Thread-1 (]: 120 of 262 PASS not_null_dim_suppliers_scd_supplier_sk ......................... [[32mPASS[0m in 2.73s]
[0m07:22:06.300816 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773
[0m07:22:06.301310 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m07:22:06.302161 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m07:22:06.301839 [info ] [Thread-1 (]: 124 of 262 START test not_null_dim_tax_rules_region ............................ [RUN]
[0m07:22:06.302634 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: BEGIN
[0m07:22:06.303040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_supplier_sk.3062b6e773, now test.retail_dbt.not_null_dim_tax_rules_region.0377b55149)
[0m07:22:06.303420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:06.303770 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m07:22:06.306860 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m07:22:06.307332 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m07:22:06.310061 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m07:22:06.310561 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m07:22:06.310853 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: BEGIN
[0m07:22:06.311194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:07.435043 [debug] [Thread-2 (]: SQL status: BEGIN in 2.267 seconds
[0m07:22:07.435508 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"
[0m07:22:07.435830 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_from
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where valid_from is null



  
  
      
    ) dbt_internal_test
[0m07:22:07.682684 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.246 seconds
[0m07:22:07.683971 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: ROLLBACK
[0m07:22:07.939404 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209: Close
[0m07:22:07.940197 [info ] [Thread-2 (]: 121 of 262 PASS not_null_dim_suppliers_scd_valid_from .......................... [[32mPASS[0m in 2.78s]
[0m07:22:07.940769 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209
[0m07:22:07.941137 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m07:22:07.941574 [info ] [Thread-2 (]: 125 of 262 START test not_null_dim_tax_rules_tax_id ............................ [RUN]
[0m07:22:07.941982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_valid_from.ac87d1b209, now test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b)
[0m07:22:07.942299 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m07:22:07.945557 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m07:22:07.946039 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m07:22:07.947719 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m07:22:07.948208 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m07:22:07.948530 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: BEGIN
[0m07:22:07.948837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:08.630207 [debug] [Thread-1 (]: SQL status: BEGIN in 2.319 seconds
[0m07:22:08.630616 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"
[0m07:22:08.630926 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_region.0377b55149"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "postgres"."silver_to_golden"."dim_tax_rules"
where region is null



  
  
      
    ) dbt_internal_test
[0m07:22:08.686046 [debug] [Thread-4 (]: SQL status: BEGIN in 2.605 seconds
[0m07:22:08.686382 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"
[0m07:22:08.686721 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valid_to
from "postgres"."silver_to_golden"."dim_suppliers_scd"
where valid_to is null



  
  
      
    ) dbt_internal_test
[0m07:22:08.882320 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.251 seconds
[0m07:22:08.883595 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: ROLLBACK
[0m07:22:08.928184 [debug] [Thread-3 (]: SQL status: BEGIN in 2.625 seconds
[0m07:22:08.928520 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"
[0m07:22:08.928869 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."dim_tax_rules"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:08.946742 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.260 seconds
[0m07:22:08.947789 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: ROLLBACK
[0m07:22:09.130225 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_region.0377b55149: Close
[0m07:22:09.131027 [info ] [Thread-1 (]: 124 of 262 PASS not_null_dim_tax_rules_region .................................. [[32mPASS[0m in 2.83s]
[0m07:22:09.131560 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_region.0377b55149
[0m07:22:09.131933 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m07:22:09.132366 [info ] [Thread-1 (]: 126 of 262 START test not_null_dim_tax_rules_tax_rate .......................... [RUN]
[0m07:22:09.132841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_region.0377b55149, now test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1)
[0m07:22:09.133220 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m07:22:09.136442 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m07:22:09.136958 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m07:22:09.138742 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m07:22:09.139216 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m07:22:09.139541 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: BEGIN
[0m07:22:09.139824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:09.156345 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:22:09.157604 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: ROLLBACK
[0m07:22:09.205535 [debug] [Thread-4 (]: On test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917: Close
[0m07:22:09.206348 [error] [Thread-4 (]: 122 of 262 FAIL 10 not_null_dim_suppliers_scd_valid_to ......................... [[31mFAIL 10[0m in 3.13s]
[0m07:22:09.206903 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917
[0m07:22:09.207307 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m07:22:09.207700 [info ] [Thread-4 (]: 127 of 262 START test not_null_fct_customer_feedback_comments .................. [RUN]
[0m07:22:09.208112 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_suppliers_scd_valid_to.b898b9d917, now test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d)
[0m07:22:09.208406 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m07:22:09.211704 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m07:22:09.212186 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m07:22:09.213940 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m07:22:09.214403 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m07:22:09.214706 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: BEGIN
[0m07:22:09.215005 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:09.380501 [debug] [Thread-3 (]: On test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297: Close
[0m07:22:09.381265 [info ] [Thread-3 (]: 123 of 262 PASS not_null_dim_tax_rules_product_id .............................. [[32mPASS[0m in 3.09s]
[0m07:22:09.381920 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297
[0m07:22:09.382266 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m07:22:09.382679 [info ] [Thread-3 (]: 128 of 262 START test not_null_fct_customer_feedback_customer_id ............... [RUN]
[0m07:22:09.383075 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_product_id.9e61b95297, now test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3)
[0m07:22:09.383403 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m07:22:09.387518 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m07:22:09.388009 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m07:22:09.389700 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m07:22:09.390188 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m07:22:09.390468 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: BEGIN
[0m07:22:09.390779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:10.235157 [debug] [Thread-2 (]: SQL status: BEGIN in 2.286 seconds
[0m07:22:10.235615 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"
[0m07:22:10.235924 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_id
from "postgres"."silver_to_golden"."dim_tax_rules"
where tax_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:10.511372 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:22:10.512750 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: ROLLBACK
[0m07:22:10.769140 [debug] [Thread-2 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b: Close
[0m07:22:10.770002 [info ] [Thread-2 (]: 125 of 262 PASS not_null_dim_tax_rules_tax_id .................................. [[32mPASS[0m in 2.83s]
[0m07:22:10.770591 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b
[0m07:22:10.770941 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m07:22:10.771330 [info ] [Thread-2 (]: 129 of 262 START test not_null_fct_customer_feedback_customer_name ............. [RUN]
[0m07:22:10.771794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_tax_id.149c22c98b, now test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63)
[0m07:22:10.772143 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m07:22:10.775514 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m07:22:10.776070 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m07:22:10.777839 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m07:22:10.778425 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m07:22:10.778758 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: BEGIN
[0m07:22:10.779080 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:11.205031 [debug] [Thread-1 (]: SQL status: BEGIN in 2.065 seconds
[0m07:22:11.205572 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"
[0m07:22:11.205931 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax_rate
from "postgres"."silver_to_golden"."dim_tax_rules"
where tax_rate is null



  
  
      
    ) dbt_internal_test
[0m07:22:11.444982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.239 seconds
[0m07:22:11.446465 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: ROLLBACK
[0m07:22:11.528992 [debug] [Thread-3 (]: SQL status: BEGIN in 2.138 seconds
[0m07:22:11.529448 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"
[0m07:22:11.529815 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:11.584213 [debug] [Thread-4 (]: SQL status: BEGIN in 2.369 seconds
[0m07:22:11.584608 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"
[0m07:22:11.584950 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select comments
from "postgres"."silver_to_golden"."fct_customer_feedback"
where comments is null



  
  
      
    ) dbt_internal_test
[0m07:22:11.677698 [debug] [Thread-1 (]: On test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1: Close
[0m07:22:11.678587 [info ] [Thread-1 (]: 126 of 262 PASS not_null_dim_tax_rules_tax_rate ................................ [[32mPASS[0m in 2.55s]
[0m07:22:11.679157 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1
[0m07:22:11.679549 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m07:22:11.679960 [info ] [Thread-1 (]: 130 of 262 START test not_null_fct_customer_feedback_feedback_date ............. [RUN]
[0m07:22:11.680394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_dim_tax_rules_tax_rate.db33d03da1, now test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41)
[0m07:22:11.680749 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m07:22:11.684160 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m07:22:11.684672 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m07:22:11.686451 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m07:22:11.686956 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m07:22:11.687281 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: BEGIN
[0m07:22:11.687580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:11.765920 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:22:11.767183 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: ROLLBACK
[0m07:22:11.849922 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.265 seconds
[0m07:22:11.851226 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: ROLLBACK
[0m07:22:12.010598 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3: Close
[0m07:22:12.011363 [info ] [Thread-3 (]: 128 of 262 PASS not_null_fct_customer_feedback_customer_id ..................... [[32mPASS[0m in 2.63s]
[0m07:22:12.011905 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3
[0m07:22:12.012306 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m07:22:12.012678 [info ] [Thread-3 (]: 131 of 262 START test not_null_fct_customer_feedback_feedback_day .............. [RUN]
[0m07:22:12.013061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_customer_id.f3a53e00a3, now test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83)
[0m07:22:12.013386 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m07:22:12.016628 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m07:22:12.017123 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m07:22:12.019806 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m07:22:12.020290 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m07:22:12.020607 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: BEGIN
[0m07:22:12.020916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:12.632933 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d: Close
[0m07:22:12.633778 [info ] [Thread-4 (]: 127 of 262 PASS not_null_fct_customer_feedback_comments ........................ [[32mPASS[0m in 3.43s]
[0m07:22:12.634298 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d
[0m07:22:12.634667 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m07:22:12.635074 [info ] [Thread-4 (]: 132 of 262 START test not_null_fct_customer_feedback_feedback_id ............... [RUN]
[0m07:22:12.635450 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_comments.f30943758d, now test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca)
[0m07:22:12.635808 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m07:22:12.639039 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m07:22:12.639549 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m07:22:12.641272 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m07:22:12.641780 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m07:22:12.642094 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: BEGIN
[0m07:22:12.642377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:12.917467 [debug] [Thread-2 (]: SQL status: BEGIN in 2.138 seconds
[0m07:22:12.917980 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"
[0m07:22:12.918301 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "postgres"."silver_to_golden"."fct_customer_feedback"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:13.142324 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.224 seconds
[0m07:22:13.143697 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: ROLLBACK
[0m07:22:13.374063 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63: Close
[0m07:22:13.374948 [info ] [Thread-2 (]: 129 of 262 PASS not_null_fct_customer_feedback_customer_name ................... [[32mPASS[0m in 2.60s]
[0m07:22:13.375533 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63
[0m07:22:13.375921 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m07:22:13.376332 [info ] [Thread-2 (]: 133 of 262 START test not_null_fct_customer_feedback_feedback_month ............ [RUN]
[0m07:22:13.376760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_customer_name.2c828aca63, now test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87)
[0m07:22:13.377117 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m07:22:13.380497 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m07:22:13.381071 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m07:22:13.382981 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m07:22:13.383514 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m07:22:13.383807 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: BEGIN
[0m07:22:13.384128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:13.776578 [debug] [Thread-1 (]: SQL status: BEGIN in 2.089 seconds
[0m07:22:13.777059 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"
[0m07:22:13.777469 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_date
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_date is null



  
  
      
    ) dbt_internal_test
[0m07:22:14.012977 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:22:14.014384 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: ROLLBACK
[0m07:22:14.248513 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41: Close
[0m07:22:14.249396 [info ] [Thread-1 (]: 130 of 262 PASS not_null_fct_customer_feedback_feedback_date ................... [[32mPASS[0m in 2.57s]
[0m07:22:14.249998 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41
[0m07:22:14.250388 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m07:22:14.250816 [info ] [Thread-1 (]: 134 of 262 START test not_null_fct_customer_feedback_feedback_year ............. [RUN]
[0m07:22:14.251189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_date.5484fc0f41, now test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577)
[0m07:22:14.251548 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m07:22:14.254802 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m07:22:14.255320 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m07:22:14.257164 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m07:22:14.257713 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m07:22:14.258055 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: BEGIN
[0m07:22:14.258356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:15.062299 [debug] [Thread-4 (]: SQL status: BEGIN in 2.420 seconds
[0m07:22:15.062710 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"
[0m07:22:15.063065 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:15.332468 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.269 seconds
[0m07:22:15.333872 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: ROLLBACK
[0m07:22:15.511215 [debug] [Thread-2 (]: SQL status: BEGIN in 2.127 seconds
[0m07:22:15.511714 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"
[0m07:22:15.512079 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_month
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_month is null



  
  
      
    ) dbt_internal_test
[0m07:22:15.608522 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca: Close
[0m07:22:15.609317 [info ] [Thread-4 (]: 132 of 262 PASS not_null_fct_customer_feedback_feedback_id ..................... [[32mPASS[0m in 2.97s]
[0m07:22:15.609871 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca
[0m07:22:15.610251 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m07:22:15.610639 [info ] [Thread-4 (]: 135 of 262 START test not_null_fct_customer_feedback_product_id ................ [RUN]
[0m07:22:15.611026 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_id.290ec7f6ca, now test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d)
[0m07:22:15.611351 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m07:22:15.615576 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m07:22:15.616089 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m07:22:15.676254 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m07:22:15.676672 [debug] [Thread-3 (]: SQL status: BEGIN in 3.656 seconds
[0m07:22:15.677175 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"
[0m07:22:15.677643 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_day
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_day is null



  
  
      
    ) dbt_internal_test
[0m07:22:15.678097 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m07:22:15.678416 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: BEGIN
[0m07:22:15.678762 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:15.758317 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.246 seconds
[0m07:22:15.759750 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: ROLLBACK
[0m07:22:16.093672 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87: Close
[0m07:22:16.094179 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.416 seconds
[0m07:22:16.095700 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: ROLLBACK
[0m07:22:16.096217 [info ] [Thread-2 (]: 133 of 262 PASS not_null_fct_customer_feedback_feedback_month .................. [[32mPASS[0m in 2.72s]
[0m07:22:16.096796 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87
[0m07:22:16.097217 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m07:22:16.097667 [info ] [Thread-2 (]: 136 of 262 START test not_null_fct_customer_feedback_product_name .............. [RUN]
[0m07:22:16.098279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_month.441da6ee87, now test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1)
[0m07:22:16.098626 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m07:22:16.102314 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m07:22:16.102950 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m07:22:16.105353 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m07:22:16.105974 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m07:22:16.106307 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: BEGIN
[0m07:22:16.106586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:16.365234 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83: Close
[0m07:22:16.366082 [info ] [Thread-3 (]: 131 of 262 PASS not_null_fct_customer_feedback_feedback_day .................... [[32mPASS[0m in 4.35s]
[0m07:22:16.366601 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83
[0m07:22:16.366964 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m07:22:16.367368 [info ] [Thread-3 (]: 137 of 262 START test not_null_fct_customer_feedback_rating .................... [RUN]
[0m07:22:16.367741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_day.40e1bb2f83, now test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d)
[0m07:22:16.368077 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m07:22:16.371371 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m07:22:16.371903 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m07:22:16.373670 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m07:22:16.374150 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m07:22:16.374467 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: BEGIN
[0m07:22:16.374757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:17.304143 [debug] [Thread-1 (]: SQL status: BEGIN in 3.046 seconds
[0m07:22:17.304738 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"
[0m07:22:17.305177 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select feedback_year
from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_year is null



  
  
      
    ) dbt_internal_test
[0m07:22:17.581690 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.276 seconds
[0m07:22:17.583177 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: ROLLBACK
[0m07:22:17.855482 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577: Close
[0m07:22:17.856423 [info ] [Thread-1 (]: 134 of 262 PASS not_null_fct_customer_feedback_feedback_year ................... [[32mPASS[0m in 3.61s]
[0m07:22:17.857108 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577
[0m07:22:17.857605 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m07:22:17.858131 [info ] [Thread-1 (]: 138 of 262 START test not_null_fct_customer_feedback_store_id .................. [RUN]
[0m07:22:17.858692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_feedback_year.72346da577, now test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee)
[0m07:22:17.859148 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m07:22:17.862994 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m07:22:17.863579 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m07:22:17.865623 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m07:22:17.866203 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m07:22:17.866560 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: BEGIN
[0m07:22:17.866882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:18.123893 [debug] [Thread-4 (]: SQL status: BEGIN in 2.445 seconds
[0m07:22:18.124482 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"
[0m07:22:18.124913 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:18.386908 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:22:18.388537 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: ROLLBACK
[0m07:22:18.636264 [debug] [Thread-3 (]: SQL status: BEGIN in 2.261 seconds
[0m07:22:18.636838 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"
[0m07:22:18.637327 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rating
from "postgres"."silver_to_golden"."fct_customer_feedback"
where rating is null



  
  
      
    ) dbt_internal_test
[0m07:22:18.639721 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d: Close
[0m07:22:18.640597 [info ] [Thread-4 (]: 135 of 262 PASS not_null_fct_customer_feedback_product_id ...................... [[32mPASS[0m in 3.03s]
[0m07:22:18.641324 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d
[0m07:22:18.641835 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m07:22:18.642289 [info ] [Thread-4 (]: 139 of 262 START test not_null_fct_customer_feedback_store_name ................ [RUN]
[0m07:22:18.642744 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_product_id.fcca4d142d, now test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8)
[0m07:22:18.643069 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m07:22:18.648300 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m07:22:18.648935 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m07:22:18.651027 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m07:22:18.651630 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m07:22:18.651961 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: BEGIN
[0m07:22:18.652289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:18.706403 [debug] [Thread-2 (]: SQL status: BEGIN in 2.600 seconds
[0m07:22:18.706910 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"
[0m07:22:18.707454 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_customer_feedback"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:18.906078 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.268 seconds
[0m07:22:18.907603 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: ROLLBACK
[0m07:22:18.996908 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.289 seconds
[0m07:22:18.998527 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: ROLLBACK
[0m07:22:19.151262 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d: Close
[0m07:22:19.152344 [info ] [Thread-3 (]: 137 of 262 PASS not_null_fct_customer_feedback_rating .......................... [[32mPASS[0m in 2.78s]
[0m07:22:19.153170 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d
[0m07:22:19.153680 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m07:22:19.154224 [info ] [Thread-3 (]: 140 of 262 START test not_null_fct_inventory_inventory_id ...................... [RUN]
[0m07:22:19.154778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_rating.b81d0c4d8d, now test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab)
[0m07:22:19.155197 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m07:22:19.159429 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m07:22:19.160076 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m07:22:19.161972 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m07:22:19.162537 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m07:22:19.162844 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: BEGIN
[0m07:22:19.163168 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:19.289393 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1: Close
[0m07:22:19.290385 [info ] [Thread-2 (]: 136 of 262 PASS not_null_fct_customer_feedback_product_name .................... [[32mPASS[0m in 3.19s]
[0m07:22:19.291179 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1
[0m07:22:19.291623 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m07:22:19.292027 [info ] [Thread-2 (]: 141 of 262 START test not_null_fct_inventory_last_updated ...................... [RUN]
[0m07:22:19.292487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_product_name.27663ad7e1, now test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9)
[0m07:22:19.292854 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m07:22:19.296537 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m07:22:19.297111 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m07:22:19.299151 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m07:22:19.299700 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m07:22:19.300256 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: BEGIN
[0m07:22:19.300620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:20.304884 [debug] [Thread-1 (]: SQL status: BEGIN in 2.438 seconds
[0m07:22:20.305384 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"
[0m07:22:20.305758 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_customer_feedback"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:20.571862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.266 seconds
[0m07:22:20.573325 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: ROLLBACK
[0m07:22:20.838213 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee: Close
[0m07:22:20.839037 [info ] [Thread-1 (]: 138 of 262 PASS not_null_fct_customer_feedback_store_id ........................ [[32mPASS[0m in 2.98s]
[0m07:22:20.839609 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee
[0m07:22:20.839996 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m07:22:20.840444 [info ] [Thread-1 (]: 142 of 262 START test not_null_fct_inventory_last_updated_day .................. [RUN]
[0m07:22:20.840863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_store_id.e4db9a27ee, now test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d)
[0m07:22:20.841182 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m07:22:20.844596 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m07:22:20.845129 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m07:22:20.847998 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m07:22:20.848512 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m07:22:20.848854 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: BEGIN
[0m07:22:20.849169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:21.246683 [debug] [Thread-4 (]: SQL status: BEGIN in 2.594 seconds
[0m07:22:21.247154 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"
[0m07:22:21.247502 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_customer_feedback"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:21.534154 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.286 seconds
[0m07:22:21.535803 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: ROLLBACK
[0m07:22:22.176396 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8: Close
[0m07:22:22.177360 [info ] [Thread-4 (]: 139 of 262 PASS not_null_fct_customer_feedback_store_name ...................... [[32mPASS[0m in 3.53s]
[0m07:22:22.178065 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8
[0m07:22:22.178521 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m07:22:22.178950 [info ] [Thread-4 (]: 143 of 262 START test not_null_fct_inventory_last_updated_month ................ [RUN]
[0m07:22:22.179473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_customer_feedback_store_name.a504fa53f8, now test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc)
[0m07:22:22.179808 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m07:22:22.183324 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m07:22:22.183890 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m07:22:22.185955 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m07:22:22.186791 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m07:22:22.187468 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: BEGIN
[0m07:22:22.187857 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:23.686803 [debug] [Thread-2 (]: SQL status: BEGIN in 2.748 seconds
[0m07:22:23.687287 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"
[0m07:22:23.687643 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated is null



  
  
      
    ) dbt_internal_test
[0m07:22:23.780753 [debug] [Thread-3 (]: SQL status: BEGIN in 2.979 seconds
[0m07:22:23.781365 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"
[0m07:22:23.781803 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select inventory_id
from "postgres"."silver_to_golden"."fct_inventory"
where inventory_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:23.934102 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.246 seconds
[0m07:22:23.935525 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: ROLLBACK
[0m07:22:24.061409 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:22:24.062987 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: ROLLBACK
[0m07:22:24.183955 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9: Close
[0m07:22:24.184842 [info ] [Thread-2 (]: 141 of 262 PASS not_null_fct_inventory_last_updated ............................ [[32mPASS[0m in 4.89s]
[0m07:22:24.185414 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9
[0m07:22:24.185813 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m07:22:24.186289 [info ] [Thread-2 (]: 144 of 262 START test not_null_fct_inventory_last_updated_year ................. [RUN]
[0m07:22:24.186826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated.dfe083d6e9, now test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65)
[0m07:22:24.187261 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m07:22:24.191204 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m07:22:24.191778 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m07:22:24.193920 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m07:22:24.194581 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m07:22:24.194892 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: BEGIN
[0m07:22:24.195230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:24.328500 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab: Close
[0m07:22:24.329383 [info ] [Thread-3 (]: 140 of 262 PASS not_null_fct_inventory_inventory_id ............................ [[32mPASS[0m in 5.17s]
[0m07:22:24.329964 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab
[0m07:22:24.330382 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m07:22:24.330818 [info ] [Thread-3 (]: 145 of 262 START test not_null_fct_inventory_product_id ........................ [RUN]
[0m07:22:24.331358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_inventory_id.c3674522ab, now test.retail_dbt.not_null_fct_inventory_product_id.55271876bd)
[0m07:22:24.331838 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m07:22:24.335918 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m07:22:24.336485 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m07:22:24.338640 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m07:22:24.339189 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m07:22:24.339519 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: BEGIN
[0m07:22:24.339861 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:25.131363 [debug] [Thread-1 (]: SQL status: BEGIN in 2.644 seconds
[0m07:22:25.131930 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"
[0m07:22:25.132253 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated_day
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated_day is null



  
  
      
    ) dbt_internal_test
[0m07:22:25.423797 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.291 seconds
[0m07:22:25.425230 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: ROLLBACK
[0m07:22:25.701700 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d: Close
[0m07:22:25.702519 [info ] [Thread-1 (]: 142 of 262 PASS not_null_fct_inventory_last_updated_day ........................ [[32mPASS[0m in 4.86s]
[0m07:22:25.703067 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d
[0m07:22:25.703482 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m07:22:25.704005 [info ] [Thread-1 (]: 146 of 262 START test not_null_fct_inventory_product_name ...................... [RUN]
[0m07:22:25.704553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated_day.3f95fafb5d, now test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6)
[0m07:22:25.704994 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m07:22:25.708471 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m07:22:25.709026 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m07:22:25.712245 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m07:22:25.712846 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m07:22:25.713227 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: BEGIN
[0m07:22:25.713558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:26.305900 [debug] [Thread-4 (]: SQL status: BEGIN in 2.837 seconds
[0m07:22:26.306412 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"
[0m07:22:26.306737 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated_month
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated_month is null



  
  
      
    ) dbt_internal_test
[0m07:22:26.440032 [debug] [Thread-2 (]: SQL status: BEGIN in 2.245 seconds
[0m07:22:26.440460 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"
[0m07:22:26.440786 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_updated_year
from "postgres"."silver_to_golden"."fct_inventory"
where last_updated_year is null



  
  
      
    ) dbt_internal_test
[0m07:22:26.619857 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.313 seconds
[0m07:22:26.621347 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: ROLLBACK
[0m07:22:26.689027 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.248 seconds
[0m07:22:26.690558 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: ROLLBACK
[0m07:22:26.935195 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65: Close
[0m07:22:26.935738 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc: Close
[0m07:22:26.936564 [info ] [Thread-2 (]: 144 of 262 PASS not_null_fct_inventory_last_updated_year ....................... [[32mPASS[0m in 2.75s]
[0m07:22:26.937614 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65
[0m07:22:26.936988 [info ] [Thread-4 (]: 143 of 262 PASS not_null_fct_inventory_last_updated_month ...................... [[32mPASS[0m in 4.76s]
[0m07:22:26.938167 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m07:22:26.938740 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc
[0m07:22:26.939147 [info ] [Thread-2 (]: 147 of 262 START test not_null_fct_inventory_quantity .......................... [RUN]
[0m07:22:26.939693 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m07:22:26.940159 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated_year.48cd555f65, now test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b)
[0m07:22:26.940556 [info ] [Thread-4 (]: 148 of 262 START test not_null_fct_inventory_store_id .......................... [RUN]
[0m07:22:26.941013 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m07:22:26.941415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_last_updated_month.67a2657bfc, now test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718)
[0m07:22:26.944875 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m07:22:26.945304 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m07:22:26.948391 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m07:22:26.948904 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m07:22:26.951099 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m07:22:26.951487 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m07:22:26.953392 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m07:22:26.953905 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m07:22:26.954396 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: BEGIN
[0m07:22:26.954762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:26.955113 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m07:22:26.955628 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: BEGIN
[0m07:22:26.955981 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:26.976706 [debug] [Thread-3 (]: SQL status: BEGIN in 2.637 seconds
[0m07:22:26.977050 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"
[0m07:22:26.977419 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_product_id.55271876bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_inventory"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:27.269033 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.291 seconds
[0m07:22:27.270366 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: ROLLBACK
[0m07:22:27.566508 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_product_id.55271876bd: Close
[0m07:22:27.567426 [info ] [Thread-3 (]: 145 of 262 PASS not_null_fct_inventory_product_id .............................. [[32mPASS[0m in 3.24s]
[0m07:22:27.568086 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_inventory_product_id.55271876bd
[0m07:22:27.568457 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m07:22:27.568913 [info ] [Thread-3 (]: 149 of 262 START test not_null_fct_inventory_store_name ........................ [RUN]
[0m07:22:27.569379 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_product_id.55271876bd, now test.retail_dbt.not_null_fct_inventory_store_name.36742932e5)
[0m07:22:27.569704 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m07:22:27.573115 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m07:22:27.573641 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m07:22:27.575798 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m07:22:27.576350 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m07:22:27.576674 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: BEGIN
[0m07:22:27.577001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:27.902615 [debug] [Thread-1 (]: SQL status: BEGIN in 2.189 seconds
[0m07:22:27.903106 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"
[0m07:22:27.903601 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_inventory"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:28.150893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.247 seconds
[0m07:22:28.152509 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: ROLLBACK
[0m07:22:28.389331 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6: Close
[0m07:22:28.390280 [info ] [Thread-1 (]: 146 of 262 PASS not_null_fct_inventory_product_name ............................ [[32mPASS[0m in 2.69s]
[0m07:22:28.390923 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6
[0m07:22:28.391290 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m07:22:28.391761 [info ] [Thread-1 (]: 150 of 262 START test not_null_fct_pricing_history_effective_date .............. [RUN]
[0m07:22:28.392246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_product_name.ef036593c6, now test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a)
[0m07:22:28.392635 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m07:22:28.397020 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m07:22:28.397530 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m07:22:28.399131 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m07:22:28.399658 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m07:22:28.399976 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: BEGIN
[0m07:22:28.400258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:29.150607 [debug] [Thread-2 (]: SQL status: BEGIN in 2.196 seconds
[0m07:22:29.151137 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"
[0m07:22:29.151778 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver_to_golden"."fct_inventory"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m07:22:29.210790 [debug] [Thread-4 (]: SQL status: BEGIN in 2.255 seconds
[0m07:22:29.211313 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"
[0m07:22:29.211761 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_inventory"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:29.372046 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.220 seconds
[0m07:22:29.373409 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: ROLLBACK
[0m07:22:29.441035 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.229 seconds
[0m07:22:29.442313 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: ROLLBACK
[0m07:22:29.599168 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b: Close
[0m07:22:29.599934 [info ] [Thread-2 (]: 147 of 262 PASS not_null_fct_inventory_quantity ................................ [[32mPASS[0m in 2.66s]
[0m07:22:29.600489 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b
[0m07:22:29.600847 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m07:22:29.601226 [info ] [Thread-2 (]: 151 of 262 START test not_null_fct_pricing_history_effective_month ............. [RUN]
[0m07:22:29.601624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_quantity.b01f0f5d7b, now test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff)
[0m07:22:29.601960 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m07:22:29.605228 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m07:22:29.605759 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m07:22:29.607477 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m07:22:29.607936 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m07:22:29.608269 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: BEGIN
[0m07:22:29.608548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:29.671804 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718: Close
[0m07:22:29.672623 [info ] [Thread-4 (]: 148 of 262 PASS not_null_fct_inventory_store_id ................................ [[32mPASS[0m in 2.73s]
[0m07:22:29.673176 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718
[0m07:22:29.673527 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m07:22:29.674431 [debug] [Thread-3 (]: SQL status: BEGIN in 2.097 seconds
[0m07:22:29.674058 [info ] [Thread-4 (]: 152 of 262 START test not_null_fct_pricing_history_effective_year .............. [RUN]
[0m07:22:29.674915 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"
[0m07:22:29.675323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_store_id.0eb1c2b718, now test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8)
[0m07:22:29.675880 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_inventory_store_name.36742932e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_inventory"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:29.676269 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m07:22:29.680012 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m07:22:29.680509 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m07:22:29.682358 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m07:22:29.682864 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m07:22:29.683179 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: BEGIN
[0m07:22:29.683505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:29.904034 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:22:29.905388 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: ROLLBACK
[0m07:22:30.136546 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_inventory_store_name.36742932e5: Close
[0m07:22:30.137355 [info ] [Thread-3 (]: 149 of 262 PASS not_null_fct_inventory_store_name .............................. [[32mPASS[0m in 2.57s]
[0m07:22:30.137913 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_inventory_store_name.36742932e5
[0m07:22:30.138327 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m07:22:30.138703 [info ] [Thread-3 (]: 153 of 262 START test not_null_fct_pricing_history_history_id .................. [RUN]
[0m07:22:30.139104 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_inventory_store_name.36742932e5, now test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc)
[0m07:22:30.139447 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m07:22:30.142888 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m07:22:30.143393 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m07:22:30.146076 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m07:22:30.146570 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m07:22:30.146900 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: BEGIN
[0m07:22:30.147421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:31.113711 [debug] [Thread-1 (]: SQL status: BEGIN in 2.713 seconds
[0m07:22:31.114148 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"
[0m07:22:31.114507 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_date
from "postgres"."silver_to_golden"."fct_pricing_history"
where effective_date is null



  
  
      
    ) dbt_internal_test
[0m07:22:31.338130 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.223 seconds
[0m07:22:31.339641 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: ROLLBACK
[0m07:22:31.563436 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a: Close
[0m07:22:31.564304 [info ] [Thread-1 (]: 150 of 262 PASS not_null_fct_pricing_history_effective_date .................... [[32mPASS[0m in 3.17s]
[0m07:22:31.564854 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a
[0m07:22:31.565225 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m07:22:31.565628 [info ] [Thread-1 (]: 154 of 262 START test not_null_fct_pricing_history_price ....................... [RUN]
[0m07:22:31.566080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_effective_date.578e01ad9a, now test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b)
[0m07:22:31.566408 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m07:22:31.569773 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m07:22:31.570270 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m07:22:31.572023 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m07:22:31.572490 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m07:22:31.572808 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: BEGIN
[0m07:22:31.573112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:31.840950 [debug] [Thread-4 (]: SQL status: BEGIN in 2.157 seconds
[0m07:22:31.841448 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"
[0m07:22:31.841794 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_year
from "postgres"."silver_to_golden"."fct_pricing_history"
where effective_year is null



  
  
      
    ) dbt_internal_test
[0m07:22:32.072449 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.230 seconds
[0m07:22:32.074023 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: ROLLBACK
[0m07:22:32.301263 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8: Close
[0m07:22:32.302027 [info ] [Thread-4 (]: 152 of 262 PASS not_null_fct_pricing_history_effective_year .................... [[32mPASS[0m in 2.63s]
[0m07:22:32.302570 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8
[0m07:22:32.302943 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m07:22:32.303389 [info ] [Thread-4 (]: 155 of 262 START test not_null_fct_pricing_history_product_id .................. [RUN]
[0m07:22:32.303878 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_effective_year.37172b90f8, now test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865)
[0m07:22:32.304180 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m07:22:32.307292 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m07:22:32.307791 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m07:22:32.309566 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m07:22:32.309963 [debug] [Thread-3 (]: SQL status: BEGIN in 2.163 seconds
[0m07:22:32.310451 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"
[0m07:22:32.310925 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select history_id
from "postgres"."silver_to_golden"."fct_pricing_history"
where history_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:32.311443 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m07:22:32.311863 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: BEGIN
[0m07:22:32.312153 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:32.552525 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.241 seconds
[0m07:22:32.553870 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: ROLLBACK
[0m07:22:33.246621 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc: Close
[0m07:22:33.247573 [info ] [Thread-3 (]: 153 of 262 PASS not_null_fct_pricing_history_history_id ........................ [[32mPASS[0m in 3.11s]
[0m07:22:33.248213 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc
[0m07:22:33.248652 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m07:22:33.249143 [info ] [Thread-3 (]: 156 of 262 START test not_null_fct_pricing_history_product_name ................ [RUN]
[0m07:22:33.249639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_history_id.6fa60f1cbc, now test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6)
[0m07:22:33.249979 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m07:22:33.253173 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m07:22:33.253653 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m07:22:33.255390 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m07:22:33.255919 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m07:22:33.256206 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: BEGIN
[0m07:22:33.256515 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:33.879823 [debug] [Thread-2 (]: SQL status: BEGIN in 4.271 seconds
[0m07:22:33.880321 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"
[0m07:22:33.880694 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_month
from "postgres"."silver_to_golden"."fct_pricing_history"
where effective_month is null



  
  
      
    ) dbt_internal_test
[0m07:22:34.145413 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:22:34.147011 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: ROLLBACK
[0m07:22:34.371874 [debug] [Thread-1 (]: SQL status: BEGIN in 2.799 seconds
[0m07:22:34.372393 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"
[0m07:22:34.372727 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "postgres"."silver_to_golden"."fct_pricing_history"
where price is null



  
  
      
    ) dbt_internal_test
[0m07:22:34.404507 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff: Close
[0m07:22:34.405252 [info ] [Thread-2 (]: 151 of 262 PASS not_null_fct_pricing_history_effective_month ................... [[32mPASS[0m in 4.80s]
[0m07:22:34.405777 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff
[0m07:22:34.406168 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m07:22:34.406576 [info ] [Thread-2 (]: 157 of 262 START test not_null_fct_purchase_orders_order_date .................. [RUN]
[0m07:22:34.407003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_effective_month.36473878ff, now test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960)
[0m07:22:34.407311 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m07:22:34.412217 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m07:22:34.412737 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m07:22:34.414525 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m07:22:34.415021 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m07:22:34.415379 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: BEGIN
[0m07:22:34.415684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:34.598880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.226 seconds
[0m07:22:34.600352 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: ROLLBACK
[0m07:22:34.793668 [debug] [Thread-4 (]: SQL status: BEGIN in 2.481 seconds
[0m07:22:34.794205 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"
[0m07:22:34.794597 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_pricing_history"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:34.826355 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b: Close
[0m07:22:34.827142 [info ] [Thread-1 (]: 154 of 262 PASS not_null_fct_pricing_history_price ............................. [[32mPASS[0m in 3.26s]
[0m07:22:34.827732 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b
[0m07:22:34.828144 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m07:22:34.828547 [info ] [Thread-1 (]: 158 of 262 START test not_null_fct_purchase_orders_order_day ................... [RUN]
[0m07:22:34.828955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_price.91e1728b2b, now test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa)
[0m07:22:34.829274 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m07:22:34.832413 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m07:22:34.832913 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m07:22:34.834722 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m07:22:34.835206 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m07:22:34.835506 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: BEGIN
[0m07:22:34.835835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:35.067822 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:22:35.069366 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: ROLLBACK
[0m07:22:35.339312 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865: Close
[0m07:22:35.340217 [info ] [Thread-4 (]: 155 of 262 PASS not_null_fct_pricing_history_product_id ........................ [[32mPASS[0m in 3.04s]
[0m07:22:35.340788 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865
[0m07:22:35.341173 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m07:22:35.341589 [info ] [Thread-4 (]: 159 of 262 START test not_null_fct_purchase_orders_order_id .................... [RUN]
[0m07:22:35.341992 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_product_id.af202ef865, now test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa)
[0m07:22:35.342359 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m07:22:35.345759 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m07:22:35.346301 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m07:22:35.348198 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m07:22:35.348722 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m07:22:35.349055 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: BEGIN
[0m07:22:35.349351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:35.670751 [debug] [Thread-3 (]: SQL status: BEGIN in 2.414 seconds
[0m07:22:35.671242 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"
[0m07:22:35.671614 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_pricing_history"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:35.952903 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.281 seconds
[0m07:22:35.954616 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: ROLLBACK
[0m07:22:36.240132 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6: Close
[0m07:22:36.241068 [info ] [Thread-3 (]: 156 of 262 PASS not_null_fct_pricing_history_product_name ...................... [[32mPASS[0m in 2.99s]
[0m07:22:36.241762 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6
[0m07:22:36.242232 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m07:22:36.242709 [info ] [Thread-3 (]: 160 of 262 START test not_null_fct_purchase_orders_order_month ................. [RUN]
[0m07:22:36.243186 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_pricing_history_product_name.8632159ba6, now test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e)
[0m07:22:36.243619 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m07:22:36.247257 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m07:22:36.247770 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m07:22:36.249711 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m07:22:36.250239 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m07:22:36.250548 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: BEGIN
[0m07:22:36.250841 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:37.923149 [debug] [Thread-4 (]: SQL status: BEGIN in 2.574 seconds
[0m07:22:37.923714 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"
[0m07:22:37.924169 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:38.208252 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.284 seconds
[0m07:22:38.210728 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: ROLLBACK
[0m07:22:38.346588 [debug] [Thread-1 (]: SQL status: BEGIN in 3.511 seconds
[0m07:22:38.347134 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"
[0m07:22:38.347564 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_day
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_day is null



  
  
      
    ) dbt_internal_test
[0m07:22:38.486060 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa: Close
[0m07:22:38.486944 [info ] [Thread-4 (]: 159 of 262 PASS not_null_fct_purchase_orders_order_id .......................... [[32mPASS[0m in 3.14s]
[0m07:22:38.487620 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa
[0m07:22:38.488013 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m07:22:38.488470 [info ] [Thread-4 (]: 161 of 262 START test not_null_fct_purchase_orders_order_year .................. [RUN]
[0m07:22:38.488977 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_id.985efd7afa, now test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640)
[0m07:22:38.489407 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m07:22:38.492739 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m07:22:38.493258 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m07:22:38.495092 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m07:22:38.495660 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m07:22:38.496161 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: BEGIN
[0m07:22:38.496531 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:38.580690 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.233 seconds
[0m07:22:38.582030 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: ROLLBACK
[0m07:22:38.799741 [debug] [Thread-3 (]: SQL status: BEGIN in 2.549 seconds
[0m07:22:38.800195 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"
[0m07:22:38.800508 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_month
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_month is null



  
  
      
    ) dbt_internal_test
[0m07:22:38.809912 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa: Close
[0m07:22:38.810640 [info ] [Thread-1 (]: 158 of 262 PASS not_null_fct_purchase_orders_order_day ......................... [[32mPASS[0m in 3.98s]
[0m07:22:38.811169 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa
[0m07:22:38.811622 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m07:22:38.812028 [info ] [Thread-1 (]: 162 of 262 START test not_null_fct_purchase_orders_status ...................... [RUN]
[0m07:22:38.812401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_day.b3ecf021aa, now test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636)
[0m07:22:38.812744 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m07:22:38.815918 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m07:22:38.816420 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m07:22:38.818167 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m07:22:38.818626 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m07:22:38.818914 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: BEGIN
[0m07:22:38.819217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:38.878599 [debug] [Thread-2 (]: SQL status: BEGIN in 4.463 seconds
[0m07:22:38.879059 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"
[0m07:22:38.879392 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_date
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_date is null



  
  
      
    ) dbt_internal_test
[0m07:22:39.072472 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.271 seconds
[0m07:22:39.073799 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: ROLLBACK
[0m07:22:39.142028 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:22:39.143749 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: ROLLBACK
[0m07:22:39.343252 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e: Close
[0m07:22:39.344303 [info ] [Thread-3 (]: 160 of 262 PASS not_null_fct_purchase_orders_order_month ....................... [[32mPASS[0m in 3.10s]
[0m07:22:39.344865 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e
[0m07:22:39.345316 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m07:22:39.345764 [info ] [Thread-3 (]: 163 of 262 START test not_null_fct_purchase_orders_supplier_id ................. [RUN]
[0m07:22:39.346195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_month.9ae7c12a3e, now test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb)
[0m07:22:39.346551 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m07:22:39.349965 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m07:22:39.350543 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m07:22:39.352409 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m07:22:39.352938 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m07:22:39.353269 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: BEGIN
[0m07:22:39.353551 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:39.385733 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960: Close
[0m07:22:39.386486 [info ] [Thread-2 (]: 157 of 262 PASS not_null_fct_purchase_orders_order_date ........................ [[32mPASS[0m in 4.98s]
[0m07:22:39.386990 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960
[0m07:22:39.387349 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m07:22:39.387846 [info ] [Thread-2 (]: 164 of 262 START test not_null_fct_purchase_orders_supplier_name ............... [RUN]
[0m07:22:39.388213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_date.d69ebd4960, now test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e)
[0m07:22:39.388553 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m07:22:39.391701 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m07:22:39.392222 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m07:22:39.395095 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m07:22:39.395625 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m07:22:39.396009 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: BEGIN
[0m07:22:39.396326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:40.935320 [debug] [Thread-1 (]: SQL status: BEGIN in 2.116 seconds
[0m07:22:40.935895 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"
[0m07:22:40.936217 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "postgres"."silver_to_golden"."fct_purchase_orders"
where status is null



  
  
      
    ) dbt_internal_test
[0m07:22:41.012894 [debug] [Thread-4 (]: SQL status: BEGIN in 2.516 seconds
[0m07:22:41.013366 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"
[0m07:22:41.013723 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_year
from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_year is null



  
  
      
    ) dbt_internal_test
[0m07:22:41.283058 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.269 seconds
[0m07:22:41.284669 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: ROLLBACK
[0m07:22:41.555189 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640: Close
[0m07:22:41.556256 [info ] [Thread-4 (]: 161 of 262 PASS not_null_fct_purchase_orders_order_year ........................ [[32mPASS[0m in 3.07s]
[0m07:22:41.557039 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640
[0m07:22:41.557490 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m07:22:41.557930 [info ] [Thread-4 (]: 165 of 262 START test not_null_fct_returns_customer_id ......................... [RUN]
[0m07:22:41.558312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_order_year.5b7ecc0640, now test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5)
[0m07:22:41.558659 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m07:22:41.562129 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m07:22:41.562648 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m07:22:41.564632 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m07:22:41.565152 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m07:22:41.565447 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: BEGIN
[0m07:22:41.565791 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:41.650924 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.714 seconds
[0m07:22:41.652334 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: ROLLBACK
[0m07:22:41.777768 [debug] [Thread-3 (]: SQL status: BEGIN in 2.424 seconds
[0m07:22:41.778343 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"
[0m07:22:41.778768 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."fct_purchase_orders"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:41.886914 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636: Close
[0m07:22:41.887934 [info ] [Thread-1 (]: 162 of 262 PASS not_null_fct_purchase_orders_status ............................ [[32mPASS[0m in 3.08s]
[0m07:22:41.888479 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636
[0m07:22:41.888871 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m07:22:41.889276 [info ] [Thread-1 (]: 166 of 262 START test not_null_fct_returns_item_id ............................. [RUN]
[0m07:22:41.889707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_status.0bda348636, now test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9)
[0m07:22:41.890018 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m07:22:41.893450 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m07:22:41.893994 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m07:22:41.895745 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m07:22:41.896287 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m07:22:41.896588 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: BEGIN
[0m07:22:41.896913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:41.912582 [debug] [Thread-2 (]: SQL status: BEGIN in 2.516 seconds
[0m07:22:41.913213 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"
[0m07:22:41.913573 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_name
from "postgres"."silver_to_golden"."fct_purchase_orders"
where supplier_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:42.046023 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.267 seconds
[0m07:22:42.047446 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: ROLLBACK
[0m07:22:42.190491 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.276 seconds
[0m07:22:42.191910 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: ROLLBACK
[0m07:22:42.313733 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb: Close
[0m07:22:42.314547 [info ] [Thread-3 (]: 163 of 262 PASS not_null_fct_purchase_orders_supplier_id ....................... [[32mPASS[0m in 2.97s]
[0m07:22:42.315078 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb
[0m07:22:42.315451 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m07:22:42.315891 [info ] [Thread-3 (]: 167 of 262 START test not_null_fct_returns_product_id .......................... [RUN]
[0m07:22:42.316318 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_supplier_id.0ea61a31cb, now test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8)
[0m07:22:42.316636 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m07:22:42.319971 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m07:22:42.320504 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m07:22:42.322306 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m07:22:42.322807 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m07:22:42.323133 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: BEGIN
[0m07:22:42.323466 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:42.468641 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e: Close
[0m07:22:42.469500 [info ] [Thread-2 (]: 164 of 262 PASS not_null_fct_purchase_orders_supplier_name ..................... [[32mPASS[0m in 3.08s]
[0m07:22:42.470047 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e
[0m07:22:42.470398 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m07:22:42.470830 [info ] [Thread-2 (]: 168 of 262 START test not_null_fct_returns_product_name ........................ [RUN]
[0m07:22:42.471274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_purchase_orders_supplier_name.672f54587e, now test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c)
[0m07:22:42.471653 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m07:22:42.475851 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m07:22:42.476396 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m07:22:42.478185 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m07:22:42.478670 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m07:22:42.478966 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: BEGIN
[0m07:22:42.479284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:43.804687 [debug] [Thread-4 (]: SQL status: BEGIN in 2.239 seconds
[0m07:22:43.805191 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"
[0m07:22:43.805550 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_returns"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:44.038719 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.233 seconds
[0m07:22:44.040122 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: ROLLBACK
[0m07:22:44.267422 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5: Close
[0m07:22:44.268257 [info ] [Thread-4 (]: 165 of 262 PASS not_null_fct_returns_customer_id ............................... [[32mPASS[0m in 2.71s]
[0m07:22:44.268855 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5
[0m07:22:44.269275 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m07:22:44.269684 [info ] [Thread-4 (]: 169 of 262 START test not_null_fct_returns_reason .............................. [RUN]
[0m07:22:44.270112 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_customer_id.0b988c1fc5, now test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf)
[0m07:22:44.270457 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m07:22:44.274020 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m07:22:44.274537 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m07:22:44.276360 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m07:22:44.276864 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m07:22:44.277187 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: BEGIN
[0m07:22:44.277467 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:44.341250 [debug] [Thread-1 (]: SQL status: BEGIN in 2.444 seconds
[0m07:22:44.341638 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"
[0m07:22:44.342002 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "postgres"."silver_to_golden"."fct_returns"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:44.526330 [debug] [Thread-3 (]: SQL status: BEGIN in 2.203 seconds
[0m07:22:44.526746 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"
[0m07:22:44.527084 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_returns"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:44.611638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.269 seconds
[0m07:22:44.612908 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: ROLLBACK
[0m07:22:44.729223 [debug] [Thread-2 (]: SQL status: BEGIN in 2.250 seconds
[0m07:22:44.729726 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"
[0m07:22:44.730120 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_returns"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:44.775044 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.247 seconds
[0m07:22:44.776426 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: ROLLBACK
[0m07:22:44.890198 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9: Close
[0m07:22:44.891265 [info ] [Thread-1 (]: 166 of 262 PASS not_null_fct_returns_item_id ................................... [[32mPASS[0m in 3.00s]
[0m07:22:44.891948 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9
[0m07:22:44.892326 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m07:22:44.892707 [info ] [Thread-1 (]: 170 of 262 START test not_null_fct_returns_return_date ......................... [RUN]
[0m07:22:44.893411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_item_id.b07181f0c9, now test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2)
[0m07:22:44.893754 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m07:22:44.897353 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m07:22:44.897896 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m07:22:44.899771 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m07:22:44.900275 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m07:22:44.900565 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: BEGIN
[0m07:22:44.900890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:44.966020 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:22:44.967717 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: ROLLBACK
[0m07:22:45.014250 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8: Close
[0m07:22:45.015020 [info ] [Thread-3 (]: 167 of 262 PASS not_null_fct_returns_product_id ................................ [[32mPASS[0m in 2.70s]
[0m07:22:45.015637 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8
[0m07:22:45.016056 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m07:22:45.016476 [info ] [Thread-3 (]: 171 of 262 START test not_null_fct_returns_return_day .......................... [RUN]
[0m07:22:45.017032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_product_id.eac7c2e9a8, now test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e)
[0m07:22:45.017380 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m07:22:45.020763 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m07:22:45.021290 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m07:22:45.024215 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m07:22:45.024727 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m07:22:45.025050 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: BEGIN
[0m07:22:45.025367 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:45.197708 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c: Close
[0m07:22:45.198653 [info ] [Thread-2 (]: 168 of 262 PASS not_null_fct_returns_product_name .............................. [[32mPASS[0m in 2.73s]
[0m07:22:45.199319 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c
[0m07:22:45.199705 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m07:22:45.200141 [info ] [Thread-2 (]: 172 of 262 START test not_null_fct_returns_return_id ........................... [RUN]
[0m07:22:45.200556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_product_name.a9969e8f2c, now test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0)
[0m07:22:45.200897 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m07:22:45.204101 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m07:22:45.204615 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m07:22:45.206487 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m07:22:45.206986 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m07:22:45.207297 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: BEGIN
[0m07:22:45.207609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:46.799198 [debug] [Thread-4 (]: SQL status: BEGIN in 2.522 seconds
[0m07:22:46.799682 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"
[0m07:22:46.800023 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reason
from "postgres"."silver_to_golden"."fct_returns"
where reason is null



  
  
      
    ) dbt_internal_test
[0m07:22:47.076153 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.276 seconds
[0m07:22:47.077529 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: ROLLBACK
[0m07:22:47.341124 [debug] [Thread-1 (]: SQL status: BEGIN in 2.440 seconds
[0m07:22:47.341609 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"
[0m07:22:47.341964 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_date
from "postgres"."silver_to_golden"."fct_returns"
where return_date is null



  
  
      
    ) dbt_internal_test
[0m07:22:47.351469 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf: Close
[0m07:22:47.352356 [info ] [Thread-4 (]: 169 of 262 PASS not_null_fct_returns_reason .................................... [[32mPASS[0m in 3.08s]
[0m07:22:47.352916 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf
[0m07:22:47.353275 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m07:22:47.353777 [info ] [Thread-4 (]: 173 of 262 START test not_null_fct_returns_return_month ........................ [RUN]
[0m07:22:47.354187 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_reason.cfc2bc25cf, now test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54)
[0m07:22:47.354531 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m07:22:47.357712 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m07:22:47.358215 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m07:22:47.359853 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m07:22:47.360334 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m07:22:47.360621 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: BEGIN
[0m07:22:47.360900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:47.493074 [debug] [Thread-3 (]: SQL status: BEGIN in 2.468 seconds
[0m07:22:47.493600 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"
[0m07:22:47.494037 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_day
from "postgres"."silver_to_golden"."fct_returns"
where return_day is null



  
  
      
    ) dbt_internal_test
[0m07:22:47.620487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.278 seconds
[0m07:22:47.621091 [debug] [Thread-2 (]: SQL status: BEGIN in 2.413 seconds
[0m07:22:47.622754 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: ROLLBACK
[0m07:22:47.623216 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"
[0m07:22:47.623737 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_id
from "postgres"."silver_to_golden"."fct_returns"
where return_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:47.760543 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.266 seconds
[0m07:22:47.761869 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: ROLLBACK
[0m07:22:47.886450 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:22:47.887881 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: ROLLBACK
[0m07:22:47.893752 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2: Close
[0m07:22:47.894525 [info ] [Thread-1 (]: 170 of 262 PASS not_null_fct_returns_return_date ............................... [[32mPASS[0m in 3.00s]
[0m07:22:47.895083 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2
[0m07:22:47.895493 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m07:22:47.895928 [info ] [Thread-1 (]: 174 of 262 START test not_null_fct_returns_return_year ......................... [RUN]
[0m07:22:47.896321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_date.68cf4a5dd2, now test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8)
[0m07:22:47.896681 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m07:22:47.900031 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m07:22:47.900574 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m07:22:47.902377 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m07:22:47.902937 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m07:22:47.903257 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: BEGIN
[0m07:22:47.903558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:48.027839 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e: Close
[0m07:22:48.028651 [info ] [Thread-3 (]: 171 of 262 PASS not_null_fct_returns_return_day ................................ [[32mPASS[0m in 3.01s]
[0m07:22:48.029351 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e
[0m07:22:48.029757 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m07:22:48.030168 [info ] [Thread-3 (]: 175 of 262 START test not_null_fct_returns_returned_quantity ................... [RUN]
[0m07:22:48.030816 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_day.04a48b9b1e, now test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150)
[0m07:22:48.031269 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m07:22:48.034749 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m07:22:48.035270 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m07:22:48.096057 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m07:22:48.096718 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m07:22:48.097021 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: BEGIN
[0m07:22:48.097315 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:48.157660 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0: Close
[0m07:22:48.158559 [info ] [Thread-2 (]: 172 of 262 PASS not_null_fct_returns_return_id ................................. [[32mPASS[0m in 2.96s]
[0m07:22:48.159327 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0
[0m07:22:48.159836 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m07:22:48.160343 [info ] [Thread-2 (]: 176 of 262 START test not_null_fct_returns_store_name .......................... [RUN]
[0m07:22:48.160837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_id.f5e79b5df0, now test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0)
[0m07:22:48.161253 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m07:22:48.164946 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m07:22:48.165511 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m07:22:48.167488 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m07:22:48.168028 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m07:22:48.168373 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: BEGIN
[0m07:22:48.168734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:50.088274 [debug] [Thread-4 (]: SQL status: BEGIN in 2.727 seconds
[0m07:22:50.088759 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"
[0m07:22:50.089099 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_month
from "postgres"."silver_to_golden"."fct_returns"
where return_month is null



  
  
      
    ) dbt_internal_test
[0m07:22:50.224231 [debug] [Thread-3 (]: SQL status: BEGIN in 2.127 seconds
[0m07:22:50.224705 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"
[0m07:22:50.225027 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select returned_quantity
from "postgres"."silver_to_golden"."fct_returns"
where returned_quantity is null



  
  
      
    ) dbt_internal_test
[0m07:22:50.307781 [debug] [Thread-2 (]: SQL status: BEGIN in 2.139 seconds
[0m07:22:50.308266 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"
[0m07:22:50.308586 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_returns"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:50.368461 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:22:50.370057 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: ROLLBACK
[0m07:22:50.465917 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:22:50.467176 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: ROLLBACK
[0m07:22:50.540176 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.231 seconds
[0m07:22:50.541485 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: ROLLBACK
[0m07:22:50.638310 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54: Close
[0m07:22:50.639116 [info ] [Thread-4 (]: 173 of 262 PASS not_null_fct_returns_return_month .............................. [[32mPASS[0m in 3.28s]
[0m07:22:50.639725 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54
[0m07:22:50.640107 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m07:22:50.640565 [info ] [Thread-4 (]: 177 of 262 START test not_null_fct_sales_items_business_validation_flag ........ [RUN]
[0m07:22:50.641003 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_month.db1bccbc54, now test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6)
[0m07:22:50.641337 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m07:22:50.644673 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m07:22:50.645200 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m07:22:50.647161 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m07:22:50.647526 [debug] [Thread-1 (]: SQL status: BEGIN in 2.744 seconds
[0m07:22:50.648151 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"
[0m07:22:50.648574 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select return_year
from "postgres"."silver_to_golden"."fct_returns"
where return_year is null



  
  
      
    ) dbt_internal_test
[0m07:22:50.649099 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m07:22:50.649434 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: BEGIN
[0m07:22:50.649735 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:50.697726 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150: Close
[0m07:22:50.698887 [info ] [Thread-3 (]: 175 of 262 PASS not_null_fct_returns_returned_quantity ......................... [[32mPASS[0m in 2.67s]
[0m07:22:50.699394 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150
[0m07:22:50.699824 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m07:22:50.700226 [info ] [Thread-3 (]: 178 of 262 START test not_null_fct_sales_items_category_name ................... [RUN]
[0m07:22:50.700599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_returned_quantity.7832676150, now test.retail_dbt.not_null_fct_sales_items_category_name.3951967161)
[0m07:22:50.700944 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m07:22:50.704140 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m07:22:50.704668 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m07:22:50.706411 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m07:22:50.706894 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m07:22:50.707201 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: BEGIN
[0m07:22:50.707509 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:50.794752 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0: Close
[0m07:22:50.795707 [info ] [Thread-2 (]: 176 of 262 PASS not_null_fct_returns_store_name ................................ [[32mPASS[0m in 2.63s]
[0m07:22:50.796332 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0
[0m07:22:50.796689 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m07:22:50.797095 [info ] [Thread-2 (]: 179 of 262 START test not_null_fct_sales_items_customer_id ..................... [RUN]
[0m07:22:50.797507 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_store_name.ff87589dc0, now test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d)
[0m07:22:50.797841 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m07:22:50.802088 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m07:22:50.802597 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m07:22:50.804358 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m07:22:50.804853 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m07:22:50.805148 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: BEGIN
[0m07:22:50.805475 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:50.955865 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.307 seconds
[0m07:22:50.957377 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: ROLLBACK
[0m07:22:51.258987 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8: Close
[0m07:22:51.259912 [info ] [Thread-1 (]: 174 of 262 PASS not_null_fct_returns_return_year ............................... [[32mPASS[0m in 3.36s]
[0m07:22:51.260571 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8
[0m07:22:51.260999 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m07:22:51.261410 [info ] [Thread-1 (]: 180 of 262 START test not_null_fct_sales_items_discount ........................ [RUN]
[0m07:22:51.261827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_returns_return_year.3559dc73d8, now test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6)
[0m07:22:51.262150 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m07:22:51.265441 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m07:22:51.265949 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m07:22:51.267802 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m07:22:51.268297 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m07:22:51.268587 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: BEGIN
[0m07:22:51.268901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:53.227719 [debug] [Thread-2 (]: SQL status: BEGIN in 2.422 seconds
[0m07:22:53.228253 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"
[0m07:22:53.228708 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_sales_items"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:53.404985 [debug] [Thread-4 (]: SQL status: BEGIN in 2.810 seconds
[0m07:22:53.405550 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"
[0m07:22:53.406043 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select business_validation_flag
from "postgres"."silver_to_golden"."fct_sales_items"
where business_validation_flag is null



  
  
      
    ) dbt_internal_test
[0m07:22:53.456879 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.283 seconds
[0m07:22:53.458385 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: ROLLBACK
[0m07:22:54.898577 [debug] [Thread-1 (]: SQL status: BEGIN in 2.407 seconds
[0m07:22:54.899057 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"
[0m07:22:54.899494 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select discount
from "postgres"."silver_to_golden"."fct_sales_items"
where discount is null



  
  
      
    ) dbt_internal_test
[0m07:22:54.998834 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.315 seconds
[0m07:22:55.000295 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: ROLLBACK
[0m07:22:55.005390 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d: Close
[0m07:22:55.006339 [info ] [Thread-2 (]: 179 of 262 PASS not_null_fct_sales_items_customer_id ........................... [[32mPASS[0m in 4.21s]
[0m07:22:55.007031 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d
[0m07:22:55.007421 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m07:22:55.007807 [info ] [Thread-2 (]: 181 of 262 START test not_null_fct_sales_items_gross_amount .................... [RUN]
[0m07:22:55.008269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_customer_id.ee86af3d0d, now test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261)
[0m07:22:55.008601 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m07:22:55.012232 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m07:22:55.012779 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m07:22:55.014761 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m07:22:55.015279 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m07:22:55.015582 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: BEGIN
[0m07:22:55.015896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:55.175405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:22:55.177530 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: ROLLBACK
[0m07:22:55.314817 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6: Close
[0m07:22:55.315733 [info ] [Thread-4 (]: 177 of 262 PASS not_null_fct_sales_items_business_validation_flag .............. [[32mPASS[0m in 4.67s]
[0m07:22:55.316362 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6
[0m07:22:55.316715 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m07:22:55.317124 [info ] [Thread-4 (]: 182 of 262 START test not_null_fct_sales_items_item_id ......................... [RUN]
[0m07:22:55.317501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_business_validation_flag.b7cc4d94b6, now test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674)
[0m07:22:55.317857 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m07:22:55.321103 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m07:22:55.321613 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m07:22:55.323859 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m07:22:55.324506 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m07:22:55.324926 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: BEGIN
[0m07:22:55.325313 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:55.440527 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6: Close
[0m07:22:55.441510 [info ] [Thread-1 (]: 180 of 262 PASS not_null_fct_sales_items_discount .............................. [[32mPASS[0m in 4.18s]
[0m07:22:55.442278 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6
[0m07:22:55.442641 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m07:22:55.443179 [info ] [Thread-1 (]: 183 of 262 START test not_null_fct_sales_items_net_amount ...................... [RUN]
[0m07:22:55.443729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_discount.e0ac2718d6, now test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c)
[0m07:22:55.444052 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m07:22:55.448797 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m07:22:55.449351 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m07:22:55.451314 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m07:22:55.451880 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m07:22:55.452226 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: BEGIN
[0m07:22:55.452521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:55.847208 [debug] [Thread-3 (]: SQL status: BEGIN in 3.917 seconds
[0m07:22:55.847756 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"
[0m07:22:55.848131 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_category_name.3951967161"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_name
from "postgres"."silver_to_golden"."fct_sales_items"
where category_name is null



  
  
      
    ) dbt_internal_test
[0m07:22:56.136992 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.288 seconds
[0m07:22:56.138616 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: ROLLBACK
[0m07:22:56.414339 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_category_name.3951967161: Close
[0m07:22:56.415331 [info ] [Thread-3 (]: 178 of 262 PASS not_null_fct_sales_items_category_name ......................... [[32mPASS[0m in 5.71s]
[0m07:22:56.416109 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_category_name.3951967161
[0m07:22:56.416605 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m07:22:56.417110 [info ] [Thread-3 (]: 184 of 262 START test not_null_fct_sales_items_product_id ...................... [RUN]
[0m07:22:56.417630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_category_name.3951967161, now test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6)
[0m07:22:56.418004 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m07:22:56.421492 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m07:22:56.422036 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m07:22:56.424104 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m07:22:56.424649 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m07:22:56.424992 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: BEGIN
[0m07:22:56.425325 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:22:57.526798 [debug] [Thread-2 (]: SQL status: BEGIN in 2.511 seconds
[0m07:22:57.527294 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"
[0m07:22:57.527631 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select gross_amount
from "postgres"."silver_to_golden"."fct_sales_items"
where gross_amount is null



  
  
      
    ) dbt_internal_test
[0m07:22:57.562161 [debug] [Thread-1 (]: SQL status: BEGIN in 2.110 seconds
[0m07:22:57.562556 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"
[0m07:22:57.562924 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select net_amount
from "postgres"."silver_to_golden"."fct_sales_items"
where net_amount is null



  
  
      
    ) dbt_internal_test
[0m07:22:57.796506 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.268 seconds
[0m07:22:57.797824 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: ROLLBACK
[0m07:22:58.071628 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261: Close
[0m07:22:58.072475 [info ] [Thread-2 (]: 181 of 262 PASS not_null_fct_sales_items_gross_amount .......................... [[32mPASS[0m in 3.06s]
[0m07:22:58.073050 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261
[0m07:22:58.073461 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m07:22:58.073939 [info ] [Thread-2 (]: 185 of 262 START test not_null_fct_sales_items_product_name .................... [RUN]
[0m07:22:58.074454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_gross_amount.5819b82261, now test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1)
[0m07:22:58.074830 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m07:22:58.078630 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m07:22:58.079142 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m07:22:58.080907 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m07:22:58.081418 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m07:22:58.081766 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: BEGIN
[0m07:22:58.082123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:22:58.281454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.718 seconds
[0m07:22:58.282752 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: ROLLBACK
[0m07:22:58.459797 [debug] [Thread-4 (]: SQL status: BEGIN in 3.134 seconds
[0m07:22:58.460304 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"
[0m07:22:58.460653 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "postgres"."silver_to_golden"."fct_sales_items"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:58.516122 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c: Close
[0m07:22:58.516941 [info ] [Thread-1 (]: 183 of 262 PASS not_null_fct_sales_items_net_amount ............................ [[32mPASS[0m in 3.07s]
[0m07:22:58.517486 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c
[0m07:22:58.517927 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m07:22:58.518330 [info ] [Thread-1 (]: 186 of 262 START test not_null_fct_sales_items_quantity ........................ [RUN]
[0m07:22:58.518769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_net_amount.e75e88a87c, now test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f)
[0m07:22:58.519085 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m07:22:58.522575 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m07:22:58.523100 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m07:22:58.526258 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m07:22:58.526799 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m07:22:58.527139 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: BEGIN
[0m07:22:58.527427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:58.764921 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.304 seconds
[0m07:22:58.766586 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: ROLLBACK
[0m07:22:58.792973 [debug] [Thread-3 (]: SQL status: BEGIN in 2.368 seconds
[0m07:22:58.793391 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"
[0m07:22:58.793826 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_sales_items"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:22:59.037586 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.243 seconds
[0m07:22:59.039141 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: ROLLBACK
[0m07:22:59.076117 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674: Close
[0m07:22:59.076956 [info ] [Thread-4 (]: 182 of 262 PASS not_null_fct_sales_items_item_id ............................... [[32mPASS[0m in 3.76s]
[0m07:22:59.077562 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674
[0m07:22:59.078009 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m07:22:59.078423 [info ] [Thread-4 (]: 187 of 262 START test not_null_fct_sales_items_store_name ...................... [RUN]
[0m07:22:59.078852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_item_id.4222fa4674, now test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422)
[0m07:22:59.079159 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m07:22:59.082606 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m07:22:59.083113 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m07:22:59.085121 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m07:22:59.085634 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m07:22:59.085978 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: BEGIN
[0m07:22:59.086264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:22:59.297785 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6: Close
[0m07:22:59.298587 [info ] [Thread-3 (]: 184 of 262 PASS not_null_fct_sales_items_product_id ............................ [[32mPASS[0m in 2.88s]
[0m07:22:59.299172 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6
[0m07:22:59.299566 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m07:22:59.299943 [info ] [Thread-3 (]: 188 of 262 START test not_null_fct_sales_items_tax ............................. [RUN]
[0m07:22:59.300341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_product_id.994a6131e6, now test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a)
[0m07:22:59.300678 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m07:22:59.303934 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m07:22:59.304450 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m07:22:59.306268 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m07:22:59.306799 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m07:22:59.307094 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: BEGIN
[0m07:22:59.307426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:00.172473 [debug] [Thread-2 (]: SQL status: BEGIN in 2.090 seconds
[0m07:23:00.172910 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"
[0m07:23:00.173243 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_sales_items"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:00.411107 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.237 seconds
[0m07:23:00.412391 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: ROLLBACK
[0m07:23:00.646986 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1: Close
[0m07:23:00.647902 [info ] [Thread-2 (]: 185 of 262 PASS not_null_fct_sales_items_product_name .......................... [[32mPASS[0m in 2.57s]
[0m07:23:00.648467 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1
[0m07:23:00.648829 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m07:23:00.649262 [info ] [Thread-2 (]: 189 of 262 START test not_null_fct_sales_items_transaction_id .................. [RUN]
[0m07:23:00.649660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_product_name.c2ed25d3d1, now test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05)
[0m07:23:00.650077 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m07:23:00.653380 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m07:23:00.653911 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m07:23:00.655886 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m07:23:00.656405 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m07:23:00.656734 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: BEGIN
[0m07:23:00.657022 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:01.060033 [debug] [Thread-1 (]: SQL status: BEGIN in 2.532 seconds
[0m07:23:01.060488 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"
[0m07:23:01.060816 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver_to_golden"."fct_sales_items"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m07:23:01.345609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.284 seconds
[0m07:23:01.347178 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: ROLLBACK
[0m07:23:01.578068 [debug] [Thread-4 (]: SQL status: BEGIN in 2.492 seconds
[0m07:23:01.578613 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"
[0m07:23:01.578951 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_sales_items"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:01.622238 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f: Close
[0m07:23:01.622998 [info ] [Thread-1 (]: 186 of 262 PASS not_null_fct_sales_items_quantity .............................. [[32mPASS[0m in 3.10s]
[0m07:23:01.623548 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f
[0m07:23:01.623925 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m07:23:01.624336 [info ] [Thread-1 (]: 190 of 262 START test not_null_fct_sales_items_transaction_month ............... [RUN]
[0m07:23:01.624714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_quantity.8ac109260f, now test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4)
[0m07:23:01.625069 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m07:23:01.629454 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m07:23:01.629975 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m07:23:01.631715 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m07:23:01.632208 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m07:23:01.632538 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: BEGIN
[0m07:23:01.632860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:01.864265 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.285 seconds
[0m07:23:01.865653 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: ROLLBACK
[0m07:23:02.065387 [debug] [Thread-3 (]: SQL status: BEGIN in 2.758 seconds
[0m07:23:02.065958 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"
[0m07:23:02.066360 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tax
from "postgres"."silver_to_golden"."fct_sales_items"
where tax is null



  
  
      
    ) dbt_internal_test
[0m07:23:02.135011 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422: Close
[0m07:23:02.135727 [info ] [Thread-4 (]: 187 of 262 PASS not_null_fct_sales_items_store_name ............................ [[32mPASS[0m in 3.06s]
[0m07:23:02.136290 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422
[0m07:23:02.136680 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m07:23:02.137101 [info ] [Thread-4 (]: 191 of 262 START test not_null_fct_sales_items_transaction_year ................ [RUN]
[0m07:23:02.137528 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_store_name.e8d3862422, now test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5)
[0m07:23:02.137910 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m07:23:02.141270 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m07:23:02.141778 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m07:23:02.143693 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m07:23:02.144167 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m07:23:02.144453 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: BEGIN
[0m07:23:02.144826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:02.381468 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.315 seconds
[0m07:23:02.382795 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: ROLLBACK
[0m07:23:02.687780 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a: Close
[0m07:23:02.688788 [info ] [Thread-3 (]: 188 of 262 PASS not_null_fct_sales_items_tax ................................... [[32mPASS[0m in 3.39s]
[0m07:23:02.689517 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a
[0m07:23:02.690064 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m07:23:02.690546 [info ] [Thread-3 (]: 192 of 262 START test not_null_fct_sales_items_unit_price ...................... [RUN]
[0m07:23:02.691055 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_tax.80bf57b12a, now test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee)
[0m07:23:02.691463 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m07:23:02.695237 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m07:23:02.695874 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m07:23:02.697725 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m07:23:02.698241 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m07:23:02.698565 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: BEGIN
[0m07:23:02.698844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:03.033250 [debug] [Thread-2 (]: SQL status: BEGIN in 2.376 seconds
[0m07:23:03.033698 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"
[0m07:23:03.034089 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "postgres"."silver_to_golden"."fct_sales_items"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:03.299625 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.265 seconds
[0m07:23:03.301112 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: ROLLBACK
[0m07:23:03.550419 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05: Close
[0m07:23:03.551228 [info ] [Thread-2 (]: 189 of 262 PASS not_null_fct_sales_items_transaction_id ........................ [[32mPASS[0m in 2.90s]
[0m07:23:03.551808 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05
[0m07:23:03.552198 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m07:23:03.552657 [info ] [Thread-2 (]: 193 of 262 START test not_null_fct_sales_transactions_customer_id .............. [RUN]
[0m07:23:03.553170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_transaction_id.64d2810d05, now test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63)
[0m07:23:03.553492 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m07:23:03.556854 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m07:23:03.557362 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m07:23:03.560491 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m07:23:03.560986 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m07:23:03.561315 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: BEGIN
[0m07:23:03.561615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:03.720149 [debug] [Thread-1 (]: SQL status: BEGIN in 2.087 seconds
[0m07:23:03.721152 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"
[0m07:23:03.721999 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_month
from "postgres"."silver_to_golden"."fct_sales_items"
where transaction_month is null



  
  
      
    ) dbt_internal_test
[0m07:23:03.962431 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:23:03.963711 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: ROLLBACK
[0m07:23:04.196766 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4: Close
[0m07:23:04.197593 [info ] [Thread-1 (]: 190 of 262 PASS not_null_fct_sales_items_transaction_month ..................... [[32mPASS[0m in 2.57s]
[0m07:23:04.198190 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4
[0m07:23:04.198546 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m07:23:04.198963 [info ] [Thread-1 (]: 194 of 262 START test not_null_fct_sales_transactions_customer_name ............ [RUN]
[0m07:23:04.199363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_transaction_month.24b38791d4, now test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa)
[0m07:23:04.199689 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m07:23:04.202898 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m07:23:04.203420 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m07:23:04.205205 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m07:23:04.205711 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m07:23:04.206023 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: BEGIN
[0m07:23:04.206339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:04.337137 [debug] [Thread-4 (]: SQL status: BEGIN in 2.192 seconds
[0m07:23:04.337576 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"
[0m07:23:04.337982 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_year
from "postgres"."silver_to_golden"."fct_sales_items"
where transaction_year is null



  
  
      
    ) dbt_internal_test
[0m07:23:04.587135 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.249 seconds
[0m07:23:04.588604 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: ROLLBACK
[0m07:23:04.833393 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5: Close
[0m07:23:04.834324 [info ] [Thread-4 (]: 191 of 262 PASS not_null_fct_sales_items_transaction_year ...................... [[32mPASS[0m in 2.70s]
[0m07:23:04.834887 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5
[0m07:23:04.835295 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m07:23:04.835740 [info ] [Thread-4 (]: 195 of 262 START test not_null_fct_sales_transactions_employee_id .............. [RUN]
[0m07:23:04.836180 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_transaction_year.25032ec5f5, now test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0)
[0m07:23:04.836488 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m07:23:04.839886 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m07:23:04.840395 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m07:23:04.842089 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m07:23:04.842585 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m07:23:04.842911 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: BEGIN
[0m07:23:04.843207 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:04.862533 [debug] [Thread-3 (]: SQL status: BEGIN in 2.164 seconds
[0m07:23:04.862930 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"
[0m07:23:04.863232 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select unit_price
from "postgres"."silver_to_golden"."fct_sales_items"
where unit_price is null



  
  
      
    ) dbt_internal_test
[0m07:23:05.107325 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.244 seconds
[0m07:23:05.108616 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: ROLLBACK
[0m07:23:05.343315 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee: Close
[0m07:23:05.344298 [info ] [Thread-3 (]: 192 of 262 PASS not_null_fct_sales_items_unit_price ............................ [[32mPASS[0m in 2.65s]
[0m07:23:05.344998 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee
[0m07:23:05.345465 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m07:23:05.346038 [info ] [Thread-3 (]: 196 of 262 START test not_null_fct_sales_transactions_employee_name ............ [RUN]
[0m07:23:05.346560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_items_unit_price.70dbf3e9ee, now test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a)
[0m07:23:05.346861 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m07:23:05.350256 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m07:23:05.350794 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m07:23:05.352657 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m07:23:05.353144 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m07:23:05.353437 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: BEGIN
[0m07:23:05.353826 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:06.376735 [debug] [Thread-1 (]: SQL status: BEGIN in 2.170 seconds
[0m07:23:06.377156 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"
[0m07:23:06.377470 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "postgres"."silver_to_golden"."fct_sales_transactions"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:06.613101 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:23:06.614637 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: ROLLBACK
[0m07:23:06.845101 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa: Close
[0m07:23:06.845964 [info ] [Thread-1 (]: 194 of 262 PASS not_null_fct_sales_transactions_customer_name .................. [[32mPASS[0m in 2.65s]
[0m07:23:06.846511 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa
[0m07:23:06.846904 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m07:23:06.847284 [info ] [Thread-1 (]: 197 of 262 START test not_null_fct_sales_transactions_payment_id ............... [RUN]
[0m07:23:06.847704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_customer_name.41e94942fa, now test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8)
[0m07:23:06.848061 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m07:23:06.851220 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m07:23:06.851773 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m07:23:06.854761 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m07:23:06.855255 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m07:23:06.855590 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: BEGIN
[0m07:23:06.855899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:06.874517 [debug] [Thread-2 (]: SQL status: BEGIN in 3.313 seconds
[0m07:23:06.874876 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"
[0m07:23:06.875207 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:06.978815 [debug] [Thread-4 (]: SQL status: BEGIN in 2.136 seconds
[0m07:23:06.979195 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"
[0m07:23:06.979556 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:07.135884 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.260 seconds
[0m07:23:07.137297 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: ROLLBACK
[0m07:23:07.215627 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:23:07.217217 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: ROLLBACK
[0m07:23:07.397133 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63: Close
[0m07:23:07.398075 [info ] [Thread-2 (]: 193 of 262 PASS not_null_fct_sales_transactions_customer_id .................... [[32mPASS[0m in 3.84s]
[0m07:23:07.398625 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63
[0m07:23:07.399014 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m07:23:07.399459 [info ] [Thread-2 (]: 198 of 262 START test not_null_fct_sales_transactions_payment_method ........... [RUN]
[0m07:23:07.399882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_customer_id.a59585ae63, now test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5)
[0m07:23:07.400191 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m07:23:07.403620 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m07:23:07.404139 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m07:23:07.406148 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m07:23:07.406669 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m07:23:07.406994 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: BEGIN
[0m07:23:07.407280 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:07.450126 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0: Close
[0m07:23:07.450789 [info ] [Thread-4 (]: 195 of 262 PASS not_null_fct_sales_transactions_employee_id .................... [[32mPASS[0m in 2.61s]
[0m07:23:07.451431 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0
[0m07:23:07.451774 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m07:23:07.452175 [info ] [Thread-4 (]: 199 of 262 START test not_null_fct_sales_transactions_store_id ................. [RUN]
[0m07:23:07.452567 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_employee_id.e803488ec0, now test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb)
[0m07:23:07.452910 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m07:23:07.456259 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m07:23:07.456764 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m07:23:07.458667 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m07:23:07.459262 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m07:23:07.459599 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: BEGIN
[0m07:23:07.459912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:07.900142 [debug] [Thread-3 (]: SQL status: BEGIN in 2.546 seconds
[0m07:23:07.900627 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"
[0m07:23:07.900994 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_name
from "postgres"."silver_to_golden"."fct_sales_transactions"
where employee_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:08.176501 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:23:08.177858 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: ROLLBACK
[0m07:23:08.443168 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a: Close
[0m07:23:08.444092 [info ] [Thread-3 (]: 196 of 262 PASS not_null_fct_sales_transactions_employee_name .................. [[32mPASS[0m in 3.10s]
[0m07:23:08.444645 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a
[0m07:23:08.444999 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m07:23:08.445408 [info ] [Thread-3 (]: 200 of 262 START test not_null_fct_sales_transactions_store_name ............... [RUN]
[0m07:23:08.445835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_employee_name.48c171139a, now test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b)
[0m07:23:08.446174 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m07:23:08.449441 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m07:23:08.449978 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m07:23:08.451795 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m07:23:08.452280 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m07:23:08.452603 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: BEGIN
[0m07:23:08.452883 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:09.521157 [debug] [Thread-1 (]: SQL status: BEGIN in 2.665 seconds
[0m07:23:09.521668 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"
[0m07:23:09.522148 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:09.676448 [debug] [Thread-4 (]: SQL status: BEGIN in 2.216 seconds
[0m07:23:09.677016 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"
[0m07:23:09.677471 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:09.751031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.228 seconds
[0m07:23:09.752536 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: ROLLBACK
[0m07:23:09.824119 [debug] [Thread-2 (]: SQL status: BEGIN in 2.417 seconds
[0m07:23:09.824638 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"
[0m07:23:09.825112 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_method
from "postgres"."silver_to_golden"."fct_sales_transactions"
where payment_method is null



  
  
      
    ) dbt_internal_test
[0m07:23:09.922675 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:23:09.924199 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: ROLLBACK
[0m07:23:09.983327 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8: Close
[0m07:23:09.984223 [info ] [Thread-1 (]: 197 of 262 PASS not_null_fct_sales_transactions_payment_id ..................... [[32mPASS[0m in 3.14s]
[0m07:23:09.984909 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8
[0m07:23:09.985390 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m07:23:09.985988 [info ] [Thread-1 (]: 201 of 262 START test not_null_fct_sales_transactions_total_amount ............. [RUN]
[0m07:23:09.986547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_payment_id.f38f7868b8, now test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b)
[0m07:23:09.986955 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m07:23:09.992225 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m07:23:09.992745 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m07:23:09.994683 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m07:23:09.995225 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m07:23:09.995526 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: BEGIN
[0m07:23:09.995812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:10.171211 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb: Close
[0m07:23:10.171996 [info ] [Thread-4 (]: 199 of 262 PASS not_null_fct_sales_transactions_store_id ....................... [[32mPASS[0m in 2.72s]
[0m07:23:10.172577 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb
[0m07:23:10.172975 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m07:23:10.173419 [info ] [Thread-4 (]: 202 of 262 START test not_null_fct_sales_transactions_transaction_date ......... [RUN]
[0m07:23:10.174023 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_store_id.f1d1131dbb, now test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61)
[0m07:23:10.174400 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m07:23:10.177669 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m07:23:10.178255 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m07:23:10.180041 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m07:23:10.180639 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m07:23:10.181004 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: BEGIN
[0m07:23:10.181319 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:10.619827 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.794 seconds
[0m07:23:10.621262 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: ROLLBACK
[0m07:23:10.910011 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5: Close
[0m07:23:10.911002 [info ] [Thread-2 (]: 198 of 262 PASS not_null_fct_sales_transactions_payment_method ................. [[32mPASS[0m in 3.51s]
[0m07:23:10.911604 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5
[0m07:23:10.912068 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m07:23:10.912585 [info ] [Thread-2 (]: 203 of 262 START test not_null_fct_sales_transactions_transaction_day .......... [RUN]
[0m07:23:10.913093 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_payment_method.65924986c5, now test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86)
[0m07:23:10.913532 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m07:23:10.917332 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m07:23:10.917877 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m07:23:10.919646 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m07:23:10.920119 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m07:23:10.920458 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: BEGIN
[0m07:23:10.920787 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:10.999832 [debug] [Thread-3 (]: SQL status: BEGIN in 2.547 seconds
[0m07:23:11.000339 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"
[0m07:23:11.000727 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_sales_transactions"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:11.280094 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:23:11.281771 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: ROLLBACK
[0m07:23:11.558677 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b: Close
[0m07:23:11.559505 [info ] [Thread-3 (]: 200 of 262 PASS not_null_fct_sales_transactions_store_name ..................... [[32mPASS[0m in 3.11s]
[0m07:23:11.560023 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b
[0m07:23:11.560413 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m07:23:11.560823 [info ] [Thread-3 (]: 204 of 262 START test not_null_fct_sales_transactions_transaction_id ........... [RUN]
[0m07:23:11.561249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_store_name.e14a622f9b, now test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d)
[0m07:23:11.561570 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m07:23:11.564786 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m07:23:11.565293 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m07:23:11.568249 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m07:23:11.568764 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m07:23:11.569069 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: BEGIN
[0m07:23:11.569389 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:12.364876 [debug] [Thread-4 (]: SQL status: BEGIN in 2.183 seconds
[0m07:23:12.365361 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"
[0m07:23:12.365672 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m07:23:12.608176 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.242 seconds
[0m07:23:12.610882 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: ROLLBACK
[0m07:23:12.812198 [debug] [Thread-1 (]: SQL status: BEGIN in 2.816 seconds
[0m07:23:12.812684 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"
[0m07:23:12.813039 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "postgres"."silver_to_golden"."fct_sales_transactions"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m07:23:12.841720 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61: Close
[0m07:23:12.842443 [info ] [Thread-4 (]: 202 of 262 PASS not_null_fct_sales_transactions_transaction_date ............... [[32mPASS[0m in 2.67s]
[0m07:23:12.843022 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61
[0m07:23:12.843572 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m07:23:12.843982 [info ] [Thread-4 (]: 205 of 262 START test not_null_fct_sales_transactions_transaction_month ........ [RUN]
[0m07:23:12.844399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_date.14a9e3ac61, now test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6)
[0m07:23:12.844736 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m07:23:12.848101 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m07:23:12.848616 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m07:23:12.850569 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m07:23:12.851087 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m07:23:12.851426 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: BEGIN
[0m07:23:12.851741 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:13.004893 [debug] [Thread-2 (]: SQL status: BEGIN in 2.084 seconds
[0m07:23:13.005349 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"
[0m07:23:13.005765 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_day
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_day is null



  
  
      
    ) dbt_internal_test
[0m07:23:13.058228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.245 seconds
[0m07:23:13.059543 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: ROLLBACK
[0m07:23:13.241639 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:23:13.242935 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: ROLLBACK
[0m07:23:13.303826 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b: Close
[0m07:23:13.304679 [info ] [Thread-1 (]: 201 of 262 PASS not_null_fct_sales_transactions_total_amount ................... [[32mPASS[0m in 3.32s]
[0m07:23:13.305338 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b
[0m07:23:13.305738 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m07:23:13.306165 [info ] [Thread-1 (]: 206 of 262 START test not_null_fct_sales_transactions_transaction_year ......... [RUN]
[0m07:23:13.306603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_total_amount.d6bfe3802b, now test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e)
[0m07:23:13.306956 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m07:23:13.310544 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m07:23:13.311066 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m07:23:13.313007 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m07:23:13.313514 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m07:23:13.313875 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: BEGIN
[0m07:23:13.314162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:13.469231 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86: Close
[0m07:23:13.470156 [info ] [Thread-2 (]: 203 of 262 PASS not_null_fct_sales_transactions_transaction_day ................ [[32mPASS[0m in 2.56s]
[0m07:23:13.470716 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86
[0m07:23:13.471120 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m07:23:13.471576 [info ] [Thread-2 (]: 207 of 262 START test not_null_fct_shipments_order_id .......................... [RUN]
[0m07:23:13.471997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_day.ff2426df86, now test.retail_dbt.not_null_fct_shipments_order_id.31824196fb)
[0m07:23:13.472302 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m07:23:13.475732 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m07:23:13.476294 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m07:23:13.478342 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m07:23:13.478859 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m07:23:13.479192 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: BEGIN
[0m07:23:13.479469 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:13.731026 [debug] [Thread-3 (]: SQL status: BEGIN in 2.161 seconds
[0m07:23:13.731504 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"
[0m07:23:13.731829 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:13.974691 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.242 seconds
[0m07:23:13.976057 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: ROLLBACK
[0m07:23:14.216299 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d: Close
[0m07:23:14.217058 [info ] [Thread-3 (]: 204 of 262 PASS not_null_fct_sales_transactions_transaction_id ................. [[32mPASS[0m in 2.66s]
[0m07:23:14.217624 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d
[0m07:23:14.218034 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m07:23:14.218459 [info ] [Thread-3 (]: 208 of 262 START test not_null_fct_shipments_received_date ..................... [RUN]
[0m07:23:14.218850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_id.6aa0a0732d, now test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517)
[0m07:23:14.219182 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m07:23:14.222359 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m07:23:14.222841 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m07:23:14.225809 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m07:23:14.226290 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m07:23:14.226583 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: BEGIN
[0m07:23:14.226905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:14.921565 [debug] [Thread-4 (]: SQL status: BEGIN in 2.070 seconds
[0m07:23:14.922031 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"
[0m07:23:14.922411 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_month
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_month is null



  
  
      
    ) dbt_internal_test
[0m07:23:15.155098 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.232 seconds
[0m07:23:15.156554 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: ROLLBACK
[0m07:23:15.381849 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6: Close
[0m07:23:15.382658 [info ] [Thread-4 (]: 205 of 262 PASS not_null_fct_sales_transactions_transaction_month .............. [[32mPASS[0m in 2.54s]
[0m07:23:15.383239 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6
[0m07:23:15.383646 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m07:23:15.384022 [info ] [Thread-4 (]: 209 of 262 START test not_null_fct_shipments_received_day ...................... [RUN]
[0m07:23:15.384461 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_month.50cb49dcc6, now test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10)
[0m07:23:15.384939 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m07:23:15.388556 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m07:23:15.389072 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m07:23:15.391013 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m07:23:15.391518 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m07:23:15.391813 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: BEGIN
[0m07:23:15.392138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:15.542443 [debug] [Thread-2 (]: SQL status: BEGIN in 2.063 seconds
[0m07:23:15.542908 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"
[0m07:23:15.543236 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_order_id.31824196fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "postgres"."silver_to_golden"."fct_shipments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:15.706029 [debug] [Thread-1 (]: SQL status: BEGIN in 2.392 seconds
[0m07:23:15.706595 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"
[0m07:23:15.706952 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_year
from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_year is null



  
  
      
    ) dbt_internal_test
[0m07:23:15.770252 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.227 seconds
[0m07:23:15.771491 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: ROLLBACK
[0m07:23:15.996728 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_order_id.31824196fb: Close
[0m07:23:15.997544 [info ] [Thread-2 (]: 207 of 262 PASS not_null_fct_shipments_order_id ................................ [[32mPASS[0m in 2.53s]
[0m07:23:15.998172 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_order_id.31824196fb
[0m07:23:15.998592 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m07:23:15.999006 [info ] [Thread-2 (]: 210 of 262 START test not_null_fct_shipments_received_month .................... [RUN]
[0m07:23:15.999436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_order_id.31824196fb, now test.retail_dbt.not_null_fct_shipments_received_month.3a25060656)
[0m07:23:15.999787 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m07:23:16.003183 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m07:23:16.003741 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m07:23:16.005678 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m07:23:16.006208 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m07:23:16.006532 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: BEGIN
[0m07:23:16.006872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:16.493934 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.786 seconds
[0m07:23:16.495217 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: ROLLBACK
[0m07:23:16.759833 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e: Close
[0m07:23:16.760624 [info ] [Thread-1 (]: 206 of 262 PASS not_null_fct_sales_transactions_transaction_year ............... [[32mPASS[0m in 3.45s]
[0m07:23:16.761177 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e
[0m07:23:16.761561 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m07:23:16.762020 [info ] [Thread-1 (]: 211 of 262 START test not_null_fct_shipments_received_year ..................... [RUN]
[0m07:23:16.762403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_sales_transactions_transaction_year.14b2ae0c7e, now test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f)
[0m07:23:16.762739 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m07:23:16.765943 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m07:23:16.766475 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m07:23:16.768254 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m07:23:16.768743 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m07:23:16.769059 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: BEGIN
[0m07:23:16.769337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:16.975782 [debug] [Thread-3 (]: SQL status: BEGIN in 2.749 seconds
[0m07:23:16.976300 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"
[0m07:23:16.976623 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_date
from "postgres"."silver_to_golden"."fct_shipments"
where received_date is null



  
  
      
    ) dbt_internal_test
[0m07:23:17.279527 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.302 seconds
[0m07:23:17.281005 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: ROLLBACK
[0m07:23:17.584525 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517: Close
[0m07:23:17.585474 [info ] [Thread-3 (]: 208 of 262 PASS not_null_fct_shipments_received_date ........................... [[32mPASS[0m in 3.37s]
[0m07:23:17.586029 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517
[0m07:23:17.586400 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m07:23:17.586817 [info ] [Thread-3 (]: 212 of 262 START test not_null_fct_shipments_shipment_duration_days ............ [RUN]
[0m07:23:17.587231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_date.a1d7a60517, now test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0)
[0m07:23:17.587575 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m07:23:17.591995 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m07:23:17.592523 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m07:23:17.594201 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m07:23:17.594702 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m07:23:17.595024 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: BEGIN
[0m07:23:17.595309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:18.540301 [debug] [Thread-2 (]: SQL status: BEGIN in 2.533 seconds
[0m07:23:18.540807 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"
[0m07:23:18.541129 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_month.3a25060656"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_month
from "postgres"."silver_to_golden"."fct_shipments"
where received_month is null



  
  
      
    ) dbt_internal_test
[0m07:23:18.777347 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.236 seconds
[0m07:23:18.778682 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: ROLLBACK
[0m07:23:19.021371 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_received_month.3a25060656: Close
[0m07:23:19.022338 [info ] [Thread-2 (]: 210 of 262 PASS not_null_fct_shipments_received_month .......................... [[32mPASS[0m in 3.02s]
[0m07:23:19.023017 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_month.3a25060656
[0m07:23:19.023462 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m07:23:19.023919 [info ] [Thread-2 (]: 213 of 262 START test not_null_fct_shipments_shipment_id ....................... [RUN]
[0m07:23:19.024452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_month.3a25060656, now test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b)
[0m07:23:19.024872 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m07:23:19.028466 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m07:23:19.028987 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m07:23:19.030887 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m07:23:19.031415 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m07:23:19.031770 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: BEGIN
[0m07:23:19.032086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:19.196494 [debug] [Thread-1 (]: SQL status: BEGIN in 2.427 seconds
[0m07:23:19.196944 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"
[0m07:23:19.197260 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_year
from "postgres"."silver_to_golden"."fct_shipments"
where received_year is null



  
  
      
    ) dbt_internal_test
[0m07:23:19.462351 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.264 seconds
[0m07:23:19.464127 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: ROLLBACK
[0m07:23:19.735897 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f: Close
[0m07:23:19.736746 [info ] [Thread-1 (]: 211 of 262 PASS not_null_fct_shipments_received_year ........................... [[32mPASS[0m in 2.97s]
[0m07:23:19.737509 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f
[0m07:23:19.737956 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m07:23:19.738476 [info ] [Thread-1 (]: 214 of 262 START test not_null_fct_shipments_shipped_date ...................... [RUN]
[0m07:23:19.738918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_year.10db577f8f, now test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a)
[0m07:23:19.739400 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m07:23:19.742879 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m07:23:19.743401 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m07:23:19.745391 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m07:23:19.745946 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m07:23:19.746289 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: BEGIN
[0m07:23:19.746598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:19.795109 [debug] [Thread-3 (]: SQL status: BEGIN in 2.200 seconds
[0m07:23:19.795554 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"
[0m07:23:19.795972 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipment_duration_days
from "postgres"."silver_to_golden"."fct_shipments"
where shipment_duration_days is null



  
  
      
    ) dbt_internal_test
[0m07:23:19.810694 [debug] [Thread-4 (]: SQL status: BEGIN in 4.419 seconds
[0m07:23:19.811021 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"
[0m07:23:19.811391 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select received_day
from "postgres"."silver_to_golden"."fct_shipments"
where received_day is null



  
  
      
    ) dbt_internal_test
[0m07:23:20.039071 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.243 seconds
[0m07:23:20.040652 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: ROLLBACK
[0m07:23:20.083197 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.271 seconds
[0m07:23:20.084670 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: ROLLBACK
[0m07:23:20.281205 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0: Close
[0m07:23:20.282111 [info ] [Thread-3 (]: 212 of 262 PASS not_null_fct_shipments_shipment_duration_days .................. [[32mPASS[0m in 2.69s]
[0m07:23:20.282694 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0
[0m07:23:20.283137 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m07:23:20.283551 [info ] [Thread-3 (]: 215 of 262 START test not_null_fct_shipments_shipped_day ....................... [RUN]
[0m07:23:20.283972 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipment_duration_days.5f1f9fe2d0, now test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843)
[0m07:23:20.284312 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m07:23:20.287743 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m07:23:20.288274 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m07:23:20.291338 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m07:23:20.291865 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m07:23:20.292204 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: BEGIN
[0m07:23:20.292514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:20.346682 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10: Close
[0m07:23:20.347476 [info ] [Thread-4 (]: 209 of 262 PASS not_null_fct_shipments_received_day ............................ [[32mPASS[0m in 4.96s]
[0m07:23:20.348026 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10
[0m07:23:20.348413 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m07:23:20.348816 [info ] [Thread-4 (]: 216 of 262 START test not_null_fct_shipments_shipped_month ..................... [RUN]
[0m07:23:20.349249 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_received_day.e3c9436f10, now test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc)
[0m07:23:20.349559 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m07:23:20.352983 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m07:23:20.353491 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m07:23:20.355348 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m07:23:20.355876 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m07:23:20.356174 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: BEGIN
[0m07:23:20.356501 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:21.179239 [debug] [Thread-2 (]: SQL status: BEGIN in 2.147 seconds
[0m07:23:21.179759 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"
[0m07:23:21.180177 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipment_id
from "postgres"."silver_to_golden"."fct_shipments"
where shipment_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:21.424388 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.244 seconds
[0m07:23:21.425722 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: ROLLBACK
[0m07:23:21.662253 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b: Close
[0m07:23:21.663109 [info ] [Thread-2 (]: 213 of 262 PASS not_null_fct_shipments_shipment_id ............................. [[32mPASS[0m in 2.64s]
[0m07:23:21.663632 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b
[0m07:23:21.663984 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m07:23:21.664419 [info ] [Thread-2 (]: 217 of 262 START test not_null_fct_shipments_shipped_year ...................... [RUN]
[0m07:23:21.664834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipment_id.7b472eaf5b, now test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5)
[0m07:23:21.665183 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m07:23:21.668505 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m07:23:21.669022 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m07:23:21.670927 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m07:23:21.671445 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m07:23:21.671717 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: BEGIN
[0m07:23:21.672043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:21.928595 [debug] [Thread-1 (]: SQL status: BEGIN in 2.182 seconds
[0m07:23:21.929026 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"
[0m07:23:21.929398 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_date
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_date is null



  
  
      
    ) dbt_internal_test
[0m07:23:22.162054 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.232 seconds
[0m07:23:22.163415 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: ROLLBACK
[0m07:23:22.398749 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a: Close
[0m07:23:22.399731 [info ] [Thread-1 (]: 214 of 262 PASS not_null_fct_shipments_shipped_date ............................ [[32mPASS[0m in 2.66s]
[0m07:23:22.400588 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a
[0m07:23:22.401165 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m07:23:22.401736 [info ] [Thread-1 (]: 218 of 262 START test not_null_fct_shipments_store_id .......................... [RUN]
[0m07:23:22.402300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_date.a55e53121a, now test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1)
[0m07:23:22.402677 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m07:23:22.406463 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m07:23:22.407068 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m07:23:22.409074 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m07:23:22.409689 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m07:23:22.410194 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: BEGIN
[0m07:23:22.410642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:22.495094 [debug] [Thread-3 (]: SQL status: BEGIN in 2.202 seconds
[0m07:23:22.495568 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"
[0m07:23:22.495990 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_day
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_day is null



  
  
      
    ) dbt_internal_test
[0m07:23:22.510397 [debug] [Thread-4 (]: SQL status: BEGIN in 2.154 seconds
[0m07:23:22.510857 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"
[0m07:23:22.511294 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_month
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_month is null



  
  
      
    ) dbt_internal_test
[0m07:23:22.736684 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.240 seconds
[0m07:23:22.738104 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: ROLLBACK
[0m07:23:22.759750 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.248 seconds
[0m07:23:22.761043 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: ROLLBACK
[0m07:23:22.979369 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843: Close
[0m07:23:22.980332 [info ] [Thread-3 (]: 215 of 262 PASS not_null_fct_shipments_shipped_day ............................. [[32mPASS[0m in 2.70s]
[0m07:23:22.981097 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843
[0m07:23:22.981612 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m07:23:22.982178 [info ] [Thread-3 (]: 219 of 262 START test not_null_fct_shipments_store_name ........................ [RUN]
[0m07:23:22.982723 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_day.3e35b68843, now test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d)
[0m07:23:22.983139 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m07:23:22.988274 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m07:23:22.988793 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m07:23:23.072925 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc: Close
[0m07:23:23.074813 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m07:23:23.075720 [info ] [Thread-4 (]: 216 of 262 PASS not_null_fct_shipments_shipped_month ........................... [[32mPASS[0m in 2.73s]
[0m07:23:23.076624 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc
[0m07:23:23.077094 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m07:23:23.077677 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m07:23:23.078087 [info ] [Thread-4 (]: 220 of 262 START test not_null_fct_shipments_supplier_id ....................... [RUN]
[0m07:23:23.078562 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: BEGIN
[0m07:23:23.079028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_month.17477a85cc, now test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca)
[0m07:23:23.079413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:23.079891 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m07:23:23.083477 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m07:23:23.083957 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m07:23:23.085796 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m07:23:23.086305 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m07:23:23.086606 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: BEGIN
[0m07:23:23.086892 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:24.005474 [debug] [Thread-2 (]: SQL status: BEGIN in 2.333 seconds
[0m07:23:24.006081 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"
[0m07:23:24.006511 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipped_year
from "postgres"."silver_to_golden"."fct_shipments"
where shipped_year is null



  
  
      
    ) dbt_internal_test
[0m07:23:24.250962 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.244 seconds
[0m07:23:24.252468 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: ROLLBACK
[0m07:23:24.493442 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5: Close
[0m07:23:24.494334 [info ] [Thread-2 (]: 217 of 262 PASS not_null_fct_shipments_shipped_year ............................ [[32mPASS[0m in 2.83s]
[0m07:23:24.494898 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5
[0m07:23:24.495283 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m07:23:24.495693 [info ] [Thread-2 (]: 221 of 262 START test not_null_fct_shipments_supplier_name ..................... [RUN]
[0m07:23:24.496100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_shipped_year.23a61ed5d5, now test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f)
[0m07:23:24.496443 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m07:23:24.499779 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m07:23:24.500296 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m07:23:24.502089 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m07:23:24.502582 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m07:23:24.502928 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: BEGIN
[0m07:23:24.503217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:24.550334 [debug] [Thread-1 (]: SQL status: BEGIN in 2.140 seconds
[0m07:23:24.550902 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"
[0m07:23:24.551264 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_shipments"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:24.845139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.239 seconds
[0m07:23:24.846456 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: ROLLBACK
[0m07:23:26.365676 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1: Close
[0m07:23:26.366485 [info ] [Thread-1 (]: 218 of 262 PASS not_null_fct_shipments_store_id ................................ [[32mPASS[0m in 3.96s]
[0m07:23:26.367118 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1
[0m07:23:26.367512 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m07:23:26.367933 [info ] [Thread-1 (]: 222 of 262 START test not_null_fct_stock_movements_movement_date ............... [RUN]
[0m07:23:26.368431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_store_id.cbaa0193f1, now test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f)
[0m07:23:26.368808 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m07:23:26.372183 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m07:23:26.372710 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m07:23:26.374601 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m07:23:26.375105 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m07:23:26.375434 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: BEGIN
[0m07:23:26.375721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:26.914398 [debug] [Thread-3 (]: SQL status: BEGIN in 2.499 seconds
[0m07:23:26.914919 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"
[0m07:23:26.915366 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_shipments"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:27.056719 [debug] [Thread-4 (]: SQL status: BEGIN in 2.634 seconds
[0m07:23:27.057189 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"
[0m07:23:27.057601 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from "postgres"."silver_to_golden"."fct_shipments"
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:27.188874 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:23:27.190470 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: ROLLBACK
[0m07:23:27.348310 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.290 seconds
[0m07:23:27.349844 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: ROLLBACK
[0m07:23:27.460861 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d: Close
[0m07:23:27.461881 [info ] [Thread-3 (]: 219 of 262 PASS not_null_fct_shipments_store_name .............................. [[32mPASS[0m in 4.48s]
[0m07:23:27.462666 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d
[0m07:23:27.463177 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m07:23:27.463614 [info ] [Thread-3 (]: 223 of 262 START test not_null_fct_stock_movements_movement_id ................. [RUN]
[0m07:23:27.464046 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_store_name.99e48f1e8d, now test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6)
[0m07:23:27.464410 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m07:23:27.469258 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m07:23:27.469860 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m07:23:27.471742 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m07:23:27.472285 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m07:23:27.472666 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: BEGIN
[0m07:23:27.473000 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:27.650206 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca: Close
[0m07:23:27.651186 [info ] [Thread-4 (]: 220 of 262 PASS not_null_fct_shipments_supplier_id ............................. [[32mPASS[0m in 4.57s]
[0m07:23:27.651949 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca
[0m07:23:27.652440 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m07:23:27.652933 [info ] [Thread-4 (]: 224 of 262 START test not_null_fct_stock_movements_movement_month .............. [RUN]
[0m07:23:27.653388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_supplier_id.6a9b9eadca, now test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd)
[0m07:23:27.653785 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m07:23:27.657778 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m07:23:27.658373 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m07:23:27.660636 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m07:23:27.661197 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m07:23:27.661563 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: BEGIN
[0m07:23:27.661921 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:28.337277 [debug] [Thread-2 (]: SQL status: BEGIN in 2.498 seconds
[0m07:23:28.337829 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"
[0m07:23:28.338307 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_name
from "postgres"."silver_to_golden"."fct_shipments"
where supplier_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:28.602231 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.263 seconds
[0m07:23:28.603976 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: ROLLBACK
[0m07:23:28.872094 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f: Close
[0m07:23:28.873021 [info ] [Thread-2 (]: 221 of 262 PASS not_null_fct_shipments_supplier_name ........................... [[32mPASS[0m in 4.38s]
[0m07:23:28.873792 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f
[0m07:23:28.874278 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m07:23:28.874723 [info ] [Thread-2 (]: 225 of 262 START test not_null_fct_stock_movements_movement_type ............... [RUN]
[0m07:23:28.875377 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_shipments_supplier_name.db948b952f, now test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096)
[0m07:23:28.875816 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m07:23:28.879424 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m07:23:28.879947 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m07:23:28.882052 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m07:23:28.882584 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m07:23:28.882888 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: BEGIN
[0m07:23:28.883214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:29.119566 [debug] [Thread-1 (]: SQL status: BEGIN in 2.744 seconds
[0m07:23:29.120010 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"
[0m07:23:29.120396 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_date
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_date is null



  
  
      
    ) dbt_internal_test
[0m07:23:29.426035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.305 seconds
[0m07:23:29.427736 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: ROLLBACK
[0m07:23:29.626321 [debug] [Thread-3 (]: SQL status: BEGIN in 2.153 seconds
[0m07:23:29.626792 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"
[0m07:23:29.627156 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_id
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:29.734956 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f: Close
[0m07:23:29.735917 [info ] [Thread-1 (]: 222 of 262 PASS not_null_fct_stock_movements_movement_date ..................... [[32mPASS[0m in 3.37s]
[0m07:23:29.736604 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f
[0m07:23:29.737026 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m07:23:29.737458 [info ] [Thread-1 (]: 226 of 262 START test not_null_fct_stock_movements_movement_year ............... [RUN]
[0m07:23:29.737910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_date.af4682980f, now test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13)
[0m07:23:29.738244 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m07:23:29.741471 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m07:23:29.742001 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m07:23:29.745129 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m07:23:29.745682 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m07:23:29.746043 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: BEGIN
[0m07:23:29.746331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:29.844105 [debug] [Thread-4 (]: SQL status: BEGIN in 2.182 seconds
[0m07:23:29.844646 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"
[0m07:23:29.845030 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_month
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_month is null



  
  
      
    ) dbt_internal_test
[0m07:23:29.864205 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.237 seconds
[0m07:23:29.865765 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: ROLLBACK
[0m07:23:30.079047 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.234 seconds
[0m07:23:30.080773 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: ROLLBACK
[0m07:23:30.103600 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6: Close
[0m07:23:30.104658 [info ] [Thread-3 (]: 223 of 262 PASS not_null_fct_stock_movements_movement_id ....................... [[32mPASS[0m in 2.64s]
[0m07:23:30.105457 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6
[0m07:23:30.106006 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m07:23:30.106516 [info ] [Thread-3 (]: 227 of 262 START test not_null_fct_stock_movements_product_id .................. [RUN]
[0m07:23:30.107069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_id.5325f52ab6, now test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a)
[0m07:23:30.107488 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m07:23:30.111494 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m07:23:30.112060 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m07:23:30.114224 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m07:23:30.114860 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m07:23:30.115281 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: BEGIN
[0m07:23:30.115646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:30.323903 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd: Close
[0m07:23:30.324775 [info ] [Thread-4 (]: 224 of 262 PASS not_null_fct_stock_movements_movement_month .................... [[32mPASS[0m in 2.67s]
[0m07:23:30.325436 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd
[0m07:23:30.325884 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m07:23:30.326403 [info ] [Thread-4 (]: 228 of 262 START test not_null_fct_stock_movements_product_name ................ [RUN]
[0m07:23:30.326882 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_month.ce0c4afedd, now test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b)
[0m07:23:30.327231 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m07:23:30.330598 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m07:23:30.331137 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m07:23:30.333000 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m07:23:30.333521 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m07:23:30.333825 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: BEGIN
[0m07:23:30.334145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:31.579798 [debug] [Thread-2 (]: SQL status: BEGIN in 2.696 seconds
[0m07:23:31.580210 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"
[0m07:23:31.580561 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_type
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_type is null



  
  
      
    ) dbt_internal_test
[0m07:23:32.440498 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.860 seconds
[0m07:23:32.441936 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: ROLLBACK
[0m07:23:32.450432 [debug] [Thread-1 (]: SQL status: BEGIN in 2.704 seconds
[0m07:23:32.450794 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"
[0m07:23:32.451125 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select movement_year
from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_year is null



  
  
      
    ) dbt_internal_test
[0m07:23:32.728731 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.277 seconds
[0m07:23:32.729196 [debug] [Thread-3 (]: SQL status: BEGIN in 2.614 seconds
[0m07:23:32.730519 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: ROLLBACK
[0m07:23:32.730922 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"
[0m07:23:32.731397 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "postgres"."silver_to_golden"."fct_stock_movements"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:32.745278 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096: Close
[0m07:23:32.746119 [info ] [Thread-2 (]: 225 of 262 PASS not_null_fct_stock_movements_movement_type ..................... [[32mPASS[0m in 3.87s]
[0m07:23:32.746651 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096
[0m07:23:32.747041 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m07:23:32.747445 [info ] [Thread-2 (]: 229 of 262 START test not_null_fct_stock_movements_quantity .................... [RUN]
[0m07:23:32.747825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_type.2f78394096, now test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a)
[0m07:23:32.748176 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m07:23:32.751545 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m07:23:32.752057 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m07:23:32.753877 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m07:23:32.754376 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m07:23:32.754693 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: BEGIN
[0m07:23:32.754975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:32.967219 [debug] [Thread-4 (]: SQL status: BEGIN in 2.633 seconds
[0m07:23:32.967734 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"
[0m07:23:32.968212 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "postgres"."silver_to_golden"."fct_stock_movements"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:33.003772 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13: Close
[0m07:23:33.004280 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:23:33.005872 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: ROLLBACK
[0m07:23:33.006505 [info ] [Thread-1 (]: 226 of 262 PASS not_null_fct_stock_movements_movement_year ..................... [[32mPASS[0m in 3.27s]
[0m07:23:33.007362 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13
[0m07:23:33.007835 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m07:23:33.008340 [info ] [Thread-1 (]: 230 of 262 START test not_null_fct_stock_movements_store_id .................... [RUN]
[0m07:23:33.008847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_movement_year.d2b6fa2c13, now test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385)
[0m07:23:33.009218 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m07:23:33.012636 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m07:23:33.013163 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m07:23:33.016552 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m07:23:33.017101 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m07:23:33.017412 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: BEGIN
[0m07:23:33.017774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:33.227456 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.259 seconds
[0m07:23:33.228817 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: ROLLBACK
[0m07:23:33.275489 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a: Close
[0m07:23:33.276448 [info ] [Thread-3 (]: 227 of 262 PASS not_null_fct_stock_movements_product_id ........................ [[32mPASS[0m in 3.17s]
[0m07:23:33.277083 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a
[0m07:23:33.277588 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m07:23:33.278051 [info ] [Thread-3 (]: 231 of 262 START test not_null_fct_stock_movements_store_name .................. [RUN]
[0m07:23:33.278474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_product_id.ed24f6fe8a, now test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7)
[0m07:23:33.278880 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m07:23:33.283116 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m07:23:33.283870 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m07:23:33.285986 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m07:23:33.286543 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m07:23:33.286847 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: BEGIN
[0m07:23:33.287136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:33.494054 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b: Close
[0m07:23:33.494894 [info ] [Thread-4 (]: 228 of 262 PASS not_null_fct_stock_movements_product_name ...................... [[32mPASS[0m in 3.17s]
[0m07:23:33.495502 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b
[0m07:23:33.495910 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m07:23:33.496335 [info ] [Thread-4 (]: 232 of 262 START test not_null_fct_store_visits_customer_id .................... [RUN]
[0m07:23:33.496775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_product_name.f6fcc3190b, now test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0)
[0m07:23:33.497099 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m07:23:33.500477 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m07:23:33.501007 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m07:23:33.502812 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m07:23:33.503317 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m07:23:33.503647 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: BEGIN
[0m07:23:33.503977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:35.900700 [debug] [Thread-3 (]: SQL status: BEGIN in 2.613 seconds
[0m07:23:35.901176 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"
[0m07:23:35.901533 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_stock_movements"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:36.120548 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.219 seconds
[0m07:23:36.122001 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: ROLLBACK
[0m07:23:36.191134 [debug] [Thread-2 (]: SQL status: BEGIN in 3.436 seconds
[0m07:23:36.191498 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"
[0m07:23:36.191848 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quantity
from "postgres"."silver_to_golden"."fct_stock_movements"
where quantity is null



  
  
      
    ) dbt_internal_test
[0m07:23:36.238830 [debug] [Thread-1 (]: SQL status: BEGIN in 3.221 seconds
[0m07:23:36.239221 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"
[0m07:23:36.239529 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_stock_movements"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:36.342028 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7: Close
[0m07:23:36.342811 [info ] [Thread-3 (]: 231 of 262 PASS not_null_fct_stock_movements_store_name ........................ [[32mPASS[0m in 3.06s]
[0m07:23:36.343327 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7
[0m07:23:36.343685 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m07:23:36.344083 [info ] [Thread-3 (]: 233 of 262 START test not_null_fct_store_visits_customer_name .................. [RUN]
[0m07:23:36.344456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_store_name.3dba1692e7, now test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76)
[0m07:23:36.344791 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m07:23:36.347964 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m07:23:36.348447 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m07:23:36.350225 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m07:23:36.350710 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m07:23:36.351013 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: BEGIN
[0m07:23:36.351361 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:36.443099 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.251 seconds
[0m07:23:36.444283 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: ROLLBACK
[0m07:23:36.494331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.254 seconds
[0m07:23:36.495485 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: ROLLBACK
[0m07:23:36.701982 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a: Close
[0m07:23:36.702723 [info ] [Thread-2 (]: 229 of 262 PASS not_null_fct_stock_movements_quantity .......................... [[32mPASS[0m in 3.95s]
[0m07:23:36.703253 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a
[0m07:23:36.703634 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m07:23:36.704021 [info ] [Thread-2 (]: 234 of 262 START test not_null_fct_store_visits_store_id ....................... [RUN]
[0m07:23:36.704409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_quantity.ed8ca7eb3a, now test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb)
[0m07:23:36.704721 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m07:23:36.709332 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m07:23:36.709839 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m07:23:36.711487 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m07:23:36.711973 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m07:23:36.712299 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: BEGIN
[0m07:23:36.712647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:36.760127 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385: Close
[0m07:23:36.760808 [info ] [Thread-1 (]: 230 of 262 PASS not_null_fct_stock_movements_store_id .......................... [[32mPASS[0m in 3.75s]
[0m07:23:36.761314 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385
[0m07:23:36.761730 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m07:23:36.762125 [info ] [Thread-1 (]: 235 of 262 START test not_null_fct_store_visits_store_name ..................... [RUN]
[0m07:23:36.762487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_stock_movements_store_id.43d1e01385, now test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31)
[0m07:23:36.762814 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m07:23:36.765800 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m07:23:36.766276 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m07:23:36.767945 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m07:23:36.768459 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m07:23:36.768750 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: BEGIN
[0m07:23:36.769061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:36.886003 [debug] [Thread-4 (]: SQL status: BEGIN in 3.382 seconds
[0m07:23:36.886418 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"
[0m07:23:36.886710 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "postgres"."silver_to_golden"."fct_store_visits"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:37.177457 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.290 seconds
[0m07:23:37.178750 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: ROLLBACK
[0m07:23:37.459600 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0: Close
[0m07:23:37.460354 [info ] [Thread-4 (]: 232 of 262 PASS not_null_fct_store_visits_customer_id .......................... [[32mPASS[0m in 3.96s]
[0m07:23:37.460901 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0
[0m07:23:37.461238 [debug] [Thread-4 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m07:23:37.461678 [info ] [Thread-4 (]: 236 of 262 START test not_null_fct_store_visits_visit_date ..................... [RUN]
[0m07:23:37.462040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_customer_id.a7afd7afb0, now test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a)
[0m07:23:37.462369 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m07:23:37.465477 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m07:23:37.466028 [debug] [Thread-4 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m07:23:37.467736 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m07:23:37.468227 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m07:23:37.468544 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: BEGIN
[0m07:23:37.468818 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:38.685302 [debug] [Thread-3 (]: SQL status: BEGIN in 2.334 seconds
[0m07:23:38.685794 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"
[0m07:23:38.686130 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "postgres"."silver_to_golden"."fct_store_visits"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:38.942670 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.256 seconds
[0m07:23:38.943984 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: ROLLBACK
[0m07:23:39.329322 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76: Close
[0m07:23:39.329931 [debug] [Thread-1 (]: SQL status: BEGIN in 2.561 seconds
[0m07:23:39.330411 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"
[0m07:23:39.331386 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_name
from "postgres"."silver_to_golden"."fct_store_visits"
where store_name is null



  
  
      
    ) dbt_internal_test
[0m07:23:39.331053 [error] [Thread-3 (]: 233 of 262 FAIL 902 not_null_fct_store_visits_customer_name .................... [[31mFAIL 902[0m in 2.99s]
[0m07:23:39.332134 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76
[0m07:23:39.332580 [debug] [Thread-3 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m07:23:39.332978 [info ] [Thread-3 (]: 237 of 262 START test not_null_fct_store_visits_visit_day ...................... [RUN]
[0m07:23:39.333502 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_customer_name.210deecb76, now test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48)
[0m07:23:39.333949 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m07:23:39.337255 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m07:23:39.337824 [debug] [Thread-3 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m07:23:39.340734 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m07:23:39.341235 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m07:23:39.341601 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: BEGIN
[0m07:23:39.341880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:39.551557 [debug] [Thread-2 (]: SQL status: BEGIN in 2.839 seconds
[0m07:23:39.552047 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"
[0m07:23:39.552382 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select store_id
from "postgres"."silver_to_golden"."fct_store_visits"
where store_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:39.616406 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.285 seconds
[0m07:23:39.617850 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: ROLLBACK
[0m07:23:39.776261 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.223 seconds
[0m07:23:39.777614 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: ROLLBACK
[0m07:23:39.936834 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31: Close
[0m07:23:39.937793 [info ] [Thread-1 (]: 235 of 262 PASS not_null_fct_store_visits_store_name ........................... [[32mPASS[0m in 3.18s]
[0m07:23:39.938406 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31
[0m07:23:39.938763 [debug] [Thread-1 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m07:23:39.939116 [info ] [Thread-1 (]: 238 of 262 START test not_null_fct_store_visits_visit_id ....................... [RUN]
[0m07:23:39.939634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_store_name.68be67ae31, now test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54)
[0m07:23:39.940012 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m07:23:39.943284 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m07:23:39.943770 [debug] [Thread-1 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m07:23:39.945440 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m07:23:39.945943 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m07:23:39.946256 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: BEGIN
[0m07:23:39.946527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:40.070777 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb: Close
[0m07:23:40.071620 [info ] [Thread-2 (]: 234 of 262 PASS not_null_fct_store_visits_store_id ............................. [[32mPASS[0m in 3.37s]
[0m07:23:40.072222 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb
[0m07:23:40.072689 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m07:23:40.073468 [info ] [Thread-2 (]: 239 of 262 START test not_null_fct_store_visits_visit_month .................... [RUN]
[0m07:23:40.073952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_store_id.7967e95abb, now test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157)
[0m07:23:40.074289 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m07:23:40.077652 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m07:23:40.078171 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m07:23:40.079914 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m07:23:40.080394 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m07:23:40.080713 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: BEGIN
[0m07:23:40.080986 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:41.042443 [debug] [Thread-4 (]: SQL status: BEGIN in 3.574 seconds
[0m07:23:41.042872 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"
[0m07:23:41.043261 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_date
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_date is null



  
  
      
    ) dbt_internal_test
[0m07:23:42.210978 [debug] [Thread-2 (]: SQL status: BEGIN in 2.130 seconds
[0m07:23:42.211529 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"
[0m07:23:42.211897 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_month
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_month is null



  
  
      
    ) dbt_internal_test
[0m07:23:42.474400 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:23:42.476001 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: ROLLBACK
[0m07:23:42.480326 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.437 seconds
[0m07:23:42.481452 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: ROLLBACK
[0m07:23:42.527747 [debug] [Thread-1 (]: SQL status: BEGIN in 2.581 seconds
[0m07:23:42.528345 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"
[0m07:23:42.528723 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m07:23:42.727515 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157: Close
[0m07:23:42.728513 [info ] [Thread-2 (]: 239 of 262 PASS not_null_fct_store_visits_visit_month .......................... [[32mPASS[0m in 2.65s]
[0m07:23:42.729221 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157
[0m07:23:42.729807 [debug] [Thread-2 (]: Began running node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m07:23:42.730368 [info ] [Thread-2 (]: 240 of 262 START test not_null_fct_store_visits_visit_year ..................... [RUN]
[0m07:23:42.730893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_month.64aa632157, now test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227)
[0m07:23:42.731331 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m07:23:42.735260 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m07:23:42.735782 [debug] [Thread-2 (]: Began executing node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m07:23:42.737785 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m07:23:42.738303 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m07:23:42.738638 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: BEGIN
[0m07:23:42.738946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:42.760948 [debug] [Thread-4 (]: On test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a: Close
[0m07:23:42.761794 [info ] [Thread-4 (]: 236 of 262 PASS not_null_fct_store_visits_visit_date ........................... [[32mPASS[0m in 5.30s]
[0m07:23:42.762390 [debug] [Thread-4 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a
[0m07:23:42.762750 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m07:23:42.763160 [info ] [Thread-4 (]: 241 of 262 START test unique_dim_brands_scd_brand_id ........................... [RUN]
[0m07:23:42.763604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_date.888b3ee58a, now test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c)
[0m07:23:42.763928 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m07:23:42.770723 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m07:23:42.771248 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m07:23:42.772994 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m07:23:42.773541 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m07:23:42.773854 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: BEGIN
[0m07:23:42.774228 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:42.805341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.276 seconds
[0m07:23:42.806776 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: ROLLBACK
[0m07:23:43.080535 [debug] [Thread-1 (]: On test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54: Close
[0m07:23:43.081474 [info ] [Thread-1 (]: 238 of 262 PASS not_null_fct_store_visits_visit_id ............................. [[32mPASS[0m in 3.14s]
[0m07:23:43.082274 [debug] [Thread-1 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54
[0m07:23:43.082785 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m07:23:43.083322 [info ] [Thread-1 (]: 242 of 262 START test unique_dim_campaigns_campaign_id ......................... [RUN]
[0m07:23:43.083842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_id.b04eec3a54, now test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300)
[0m07:23:43.084258 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m07:23:43.087923 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m07:23:43.088440 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m07:23:43.090292 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m07:23:43.090820 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m07:23:43.091146 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: BEGIN
[0m07:23:43.091476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:43.101170 [debug] [Thread-3 (]: SQL status: BEGIN in 3.759 seconds
[0m07:23:43.101860 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"
[0m07:23:43.102214 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_day
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_day is null



  
  
      
    ) dbt_internal_test
[0m07:23:43.380113 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.277 seconds
[0m07:23:43.381536 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: ROLLBACK
[0m07:23:43.649602 [debug] [Thread-3 (]: On test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48: Close
[0m07:23:43.650571 [info ] [Thread-3 (]: 237 of 262 PASS not_null_fct_store_visits_visit_day ............................ [[32mPASS[0m in 4.32s]
[0m07:23:43.651209 [debug] [Thread-3 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48
[0m07:23:43.651644 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m07:23:43.652118 [info ] [Thread-3 (]: 243 of 262 START test unique_dim_categories_scd_category_id .................... [RUN]
[0m07:23:43.652606 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_day.6e9b93eb48, now test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa)
[0m07:23:43.652972 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m07:23:43.656654 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m07:23:43.657133 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m07:23:43.659004 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m07:23:43.659515 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m07:23:43.659815 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: BEGIN
[0m07:23:43.660095 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:45.439197 [debug] [Thread-2 (]: SQL status: BEGIN in 2.700 seconds
[0m07:23:45.439748 [debug] [Thread-4 (]: SQL status: BEGIN in 2.666 seconds
[0m07:23:45.440149 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"
[0m07:23:45.440586 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"
[0m07:23:45.441048 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_year
from "postgres"."silver_to_golden"."fct_store_visits"
where visit_year is null



  
  
      
    ) dbt_internal_test
[0m07:23:45.441473 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    brand_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_brands_scd"
where brand_id is not null
group by brand_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:45.711701 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.270 seconds
[0m07:23:45.713116 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: ROLLBACK
[0m07:23:45.714937 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.273 seconds
[0m07:23:45.716039 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: ROLLBACK
[0m07:23:45.828888 [debug] [Thread-1 (]: SQL status: BEGIN in 2.737 seconds
[0m07:23:45.829319 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"
[0m07:23:45.829763 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    campaign_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_campaigns"
where campaign_id is not null
group by campaign_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:46.066464 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c: Close
[0m07:23:46.066890 [debug] [Thread-2 (]: On test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227: Close
[0m07:23:46.067603 [info ] [Thread-2 (]: 240 of 262 PASS not_null_fct_store_visits_visit_year ........................... [[32mPASS[0m in 3.34s]
[0m07:23:46.068607 [debug] [Thread-2 (]: Finished running node test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227
[0m07:23:46.068017 [info ] [Thread-4 (]: 241 of 262 PASS unique_dim_brands_scd_brand_id ................................. [[32mPASS[0m in 3.30s]
[0m07:23:46.069168 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m07:23:46.069860 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c
[0m07:23:46.070256 [info ] [Thread-2 (]: 244 of 262 START test unique_dim_customers_scd_customer_id ..................... [RUN]
[0m07:23:46.071060 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m07:23:46.071514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.not_null_fct_store_visits_visit_year.a29b118227, now test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086)
[0m07:23:46.071917 [info ] [Thread-4 (]: 245 of 262 START test unique_dim_discount_rules_rule_id ........................ [RUN]
[0m07:23:46.072333 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m07:23:46.072801 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_brands_scd_brand_id.559997024c, now test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6)
[0m07:23:46.076397 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m07:23:46.076785 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m07:23:46.080151 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m07:23:46.080647 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m07:23:46.081021 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m07:23:46.084120 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m07:23:46.086192 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m07:23:46.086929 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m07:23:46.087349 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: BEGIN
[0m07:23:46.087809 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m07:23:46.088121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:46.088486 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: BEGIN
[0m07:23:46.088981 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:46.179660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.349 seconds
[0m07:23:46.180978 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: ROLLBACK
[0m07:23:46.253067 [debug] [Thread-3 (]: SQL status: BEGIN in 2.593 seconds
[0m07:23:46.253598 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"
[0m07:23:46.253993 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    category_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_categories_scd"
where category_id is not null
group by category_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:46.476095 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300: Close
[0m07:23:46.476914 [info ] [Thread-1 (]: 242 of 262 PASS unique_dim_campaigns_campaign_id ............................... [[32mPASS[0m in 3.39s]
[0m07:23:46.477456 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300
[0m07:23:46.477913 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m07:23:46.478308 [info ] [Thread-1 (]: 246 of 262 START test unique_dim_employees_scd_employee_id ..................... [RUN]
[0m07:23:46.478737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_campaigns_campaign_id.efba50e300, now test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021)
[0m07:23:46.479235 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m07:23:46.482631 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m07:23:46.483249 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m07:23:46.485156 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m07:23:46.485719 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m07:23:46.486070 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: BEGIN
[0m07:23:46.486388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:46.489409 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.235 seconds
[0m07:23:46.490951 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: ROLLBACK
[0m07:23:46.728772 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa: Close
[0m07:23:46.729610 [info ] [Thread-3 (]: 243 of 262 PASS unique_dim_categories_scd_category_id .......................... [[32mPASS[0m in 3.08s]
[0m07:23:46.730145 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa
[0m07:23:46.730539 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m07:23:46.730964 [info ] [Thread-3 (]: 247 of 262 START test unique_dim_loyalty_programs_scd_loyalty_program_id ....... [RUN]
[0m07:23:46.731397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_categories_scd_category_id.a547519caa, now test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805)
[0m07:23:46.731722 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m07:23:46.735137 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m07:23:46.735648 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m07:23:46.737512 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m07:23:46.738033 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m07:23:46.738329 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: BEGIN
[0m07:23:46.738702 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:48.361803 [debug] [Thread-4 (]: SQL status: BEGIN in 2.273 seconds
[0m07:23:48.362320 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"
[0m07:23:48.362653 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    rule_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_discount_rules"
where rule_id is not null
group by rule_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:48.601400 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.238 seconds
[0m07:23:48.602852 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: ROLLBACK
[0m07:23:48.762588 [debug] [Thread-2 (]: SQL status: BEGIN in 2.674 seconds
[0m07:23:48.763101 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"
[0m07:23:48.763425 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_customers_scd"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:48.900470 [debug] [Thread-3 (]: SQL status: BEGIN in 2.162 seconds
[0m07:23:48.901023 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"
[0m07:23:48.901372 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    loyalty_program_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_loyalty_programs_scd"
where loyalty_program_id is not null
group by loyalty_program_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:49.136089 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.234 seconds
[0m07:23:49.137776 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: ROLLBACK
[0m07:23:49.298542 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6: Close
[0m07:23:49.299529 [info ] [Thread-4 (]: 245 of 262 PASS unique_dim_discount_rules_rule_id .............................. [[32mPASS[0m in 3.23s]
[0m07:23:49.300426 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6
[0m07:23:49.301039 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m07:23:49.301648 [info ] [Thread-4 (]: 248 of 262 START test unique_dim_products_scd_product_id ....................... [RUN]
[0m07:23:49.302095 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_discount_rules_rule_id.2d4022ebb6, now test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989)
[0m07:23:49.302449 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m07:23:49.306318 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m07:23:49.307148 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m07:23:49.312683 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m07:23:49.313407 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m07:23:49.313974 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: BEGIN
[0m07:23:49.314456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:49.371698 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805: Close
[0m07:23:49.372486 [info ] [Thread-3 (]: 247 of 262 PASS unique_dim_loyalty_programs_scd_loyalty_program_id ............. [[32mPASS[0m in 2.64s]
[0m07:23:49.373101 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805
[0m07:23:49.373533 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m07:23:49.373955 [info ] [Thread-3 (]: 249 of 262 START test unique_dim_promotions_scd_promotion_id ................... [RUN]
[0m07:23:49.374362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_loyalty_programs_scd_loyalty_program_id.3e227fa805, now test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe)
[0m07:23:49.374692 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m07:23:49.377950 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m07:23:49.378450 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m07:23:49.380381 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m07:23:49.380887 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m07:23:49.381178 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: BEGIN
[0m07:23:49.381556 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:49.571173 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.807 seconds
[0m07:23:49.572539 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: ROLLBACK
[0m07:23:49.851216 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086: Close
[0m07:23:49.852062 [info ] [Thread-2 (]: 244 of 262 PASS unique_dim_customers_scd_customer_id ........................... [[32mPASS[0m in 3.78s]
[0m07:23:49.852670 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086
[0m07:23:49.853061 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m07:23:49.853457 [info ] [Thread-2 (]: 250 of 262 START test unique_dim_stores_scd_store_id ........................... [RUN]
[0m07:23:49.853893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_customers_scd_customer_id.2b326f2086, now test.retail_dbt.unique_dim_stores_scd_store_id.6625450729)
[0m07:23:49.854209 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m07:23:49.857451 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m07:23:49.857972 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m07:23:49.859749 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m07:23:49.860251 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m07:23:49.860589 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: BEGIN
[0m07:23:49.860920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:50.944142 [debug] [Thread-1 (]: SQL status: BEGIN in 4.458 seconds
[0m07:23:50.944639 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"
[0m07:23:50.944974 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    employee_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_employees_scd"
where employee_id is not null
group by employee_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:51.862397 [debug] [Thread-4 (]: SQL status: BEGIN in 2.548 seconds
[0m07:23:51.862889 [debug] [Thread-3 (]: SQL status: BEGIN in 2.481 seconds
[0m07:23:51.863239 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"
[0m07:23:51.863604 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"
[0m07:23:51.863998 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_products_scd"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:51.864390 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    promotion_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_promotions_scd"
where promotion_id is not null
group by promotion_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:51.960164 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.015 seconds
[0m07:23:51.961444 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: ROLLBACK
[0m07:23:52.143684 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:23:52.144164 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.279 seconds
[0m07:23:52.145357 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: ROLLBACK
[0m07:23:52.146418 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: ROLLBACK
[0m07:23:52.262956 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021: Close
[0m07:23:52.263690 [info ] [Thread-1 (]: 246 of 262 PASS unique_dim_employees_scd_employee_id ........................... [[32mPASS[0m in 5.78s]
[0m07:23:52.264268 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021
[0m07:23:52.264652 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m07:23:52.265024 [info ] [Thread-1 (]: 251 of 262 START test unique_dim_suppliers_scd_supplier_id ..................... [RUN]
[0m07:23:52.265435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_employees_scd_employee_id.60d37e9021, now test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574)
[0m07:23:52.265828 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m07:23:52.269070 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m07:23:52.269594 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m07:23:52.271339 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m07:23:52.271822 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m07:23:52.272113 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: BEGIN
[0m07:23:52.272424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:52.426191 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe: Close
[0m07:23:52.426686 [debug] [Thread-4 (]: On test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989: Close
[0m07:23:52.427360 [info ] [Thread-3 (]: 249 of 262 PASS unique_dim_promotions_scd_promotion_id ......................... [[32mPASS[0m in 3.05s]
[0m07:23:52.427955 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe
[0m07:23:52.428872 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m07:23:52.428445 [info ] [Thread-4 (]: 248 of 262 PASS unique_dim_products_scd_product_id ............................. [[32mPASS[0m in 3.13s]
[0m07:23:52.429581 [info ] [Thread-3 (]: 252 of 262 START test unique_dim_tax_rules_tax_id .............................. [RUN]
[0m07:23:52.430220 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989
[0m07:23:52.430685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_promotions_scd_promotion_id.cd385201fe, now test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360)
[0m07:23:52.431163 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m07:23:52.431645 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m07:23:52.432051 [info ] [Thread-4 (]: 253 of 262 START test unique_fct_customer_feedback_feedback_id ................. [RUN]
[0m07:23:52.435655 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m07:23:52.436089 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_products_scd_product_id.87baa6b989, now test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999)
[0m07:23:52.436669 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m07:23:52.440761 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m07:23:52.441201 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m07:23:52.443219 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m07:23:52.443647 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m07:23:52.445574 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m07:23:52.446032 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m07:23:52.446434 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: BEGIN
[0m07:23:52.446822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:52.447204 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m07:23:52.447669 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: BEGIN
[0m07:23:52.447977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:52.881092 [debug] [Thread-2 (]: SQL status: BEGIN in 3.020 seconds
[0m07:23:52.881653 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"
[0m07:23:52.882118 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_stores_scd_store_id.6625450729"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    store_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_stores_scd"
where store_id is not null
group by store_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:53.139361 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.257 seconds
[0m07:23:53.140840 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: ROLLBACK
[0m07:23:53.408155 [debug] [Thread-2 (]: On test.retail_dbt.unique_dim_stores_scd_store_id.6625450729: Close
[0m07:23:53.409110 [info ] [Thread-2 (]: 250 of 262 PASS unique_dim_stores_scd_store_id ................................. [[32mPASS[0m in 3.56s]
[0m07:23:53.409746 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_dim_stores_scd_store_id.6625450729
[0m07:23:53.410173 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m07:23:53.410596 [info ] [Thread-2 (]: 254 of 262 START test unique_fct_inventory_inventory_id ........................ [RUN]
[0m07:23:53.411018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_stores_scd_store_id.6625450729, now test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e)
[0m07:23:53.411378 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m07:23:53.415240 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m07:23:53.415788 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m07:23:53.418021 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m07:23:53.418669 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m07:23:53.419024 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: BEGIN
[0m07:23:53.419400 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:54.539974 [debug] [Thread-1 (]: SQL status: BEGIN in 2.267 seconds
[0m07:23:54.540439 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"
[0m07:23:54.540789 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    supplier_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_suppliers_scd"
where supplier_id is not null
group by supplier_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:54.787862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.247 seconds
[0m07:23:54.789172 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: ROLLBACK
[0m07:23:54.893652 [debug] [Thread-3 (]: SQL status: BEGIN in 2.447 seconds
[0m07:23:54.894136 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"
[0m07:23:54.894449 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    tax_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."dim_tax_rules"
where tax_id is not null
group by tax_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:55.051851 [debug] [Thread-1 (]: On test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574: Close
[0m07:23:55.052625 [info ] [Thread-1 (]: 251 of 262 PASS unique_dim_suppliers_scd_supplier_id ........................... [[32mPASS[0m in 2.79s]
[0m07:23:55.053157 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574
[0m07:23:55.053593 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m07:23:55.054019 [info ] [Thread-1 (]: 255 of 262 START test unique_fct_pricing_history_history_id .................... [RUN]
[0m07:23:55.054465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_suppliers_scd_supplier_id.d042172574, now test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe)
[0m07:23:55.054788 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m07:23:55.058212 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m07:23:55.058727 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m07:23:55.060491 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m07:23:55.060997 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m07:23:55.061292 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: BEGIN
[0m07:23:55.061645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:55.129160 [debug] [Thread-4 (]: SQL status: BEGIN in 2.681 seconds
[0m07:23:55.129624 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"
[0m07:23:55.129939 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    feedback_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_customer_feedback"
where feedback_id is not null
group by feedback_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:55.170207 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.275 seconds
[0m07:23:55.171480 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: ROLLBACK
[0m07:23:55.392442 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.262 seconds
[0m07:23:55.394158 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: ROLLBACK
[0m07:23:55.442990 [debug] [Thread-3 (]: On test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360: Close
[0m07:23:55.443775 [info ] [Thread-3 (]: 252 of 262 PASS unique_dim_tax_rules_tax_id .................................... [[32mPASS[0m in 3.01s]
[0m07:23:55.444353 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360
[0m07:23:55.444745 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m07:23:55.445157 [info ] [Thread-3 (]: 256 of 262 START test unique_fct_purchase_orders_order_id ...................... [RUN]
[0m07:23:55.445612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_dim_tax_rules_tax_id.dc86f06360, now test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18)
[0m07:23:55.445930 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m07:23:55.450299 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m07:23:55.450796 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m07:23:55.452476 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m07:23:55.452971 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m07:23:55.453367 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: BEGIN
[0m07:23:55.453687 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:23:55.555454 [debug] [Thread-2 (]: SQL status: BEGIN in 2.136 seconds
[0m07:23:55.555848 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"
[0m07:23:55.556199 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    inventory_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_inventory"
where inventory_id is not null
group by inventory_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:55.657265 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999: Close
[0m07:23:55.658166 [info ] [Thread-4 (]: 253 of 262 PASS unique_fct_customer_feedback_feedback_id ....................... [[32mPASS[0m in 3.22s]
[0m07:23:55.658760 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999
[0m07:23:55.659149 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m07:23:55.659543 [info ] [Thread-4 (]: 257 of 262 START test unique_fct_returns_return_id ............................. [RUN]
[0m07:23:55.660082 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_customer_feedback_feedback_id.769d5be999, now test.retail_dbt.unique_fct_returns_return_id.d461048e81)
[0m07:23:55.660443 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m07:23:55.663676 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m07:23:55.664196 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m07:23:55.666111 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m07:23:55.666616 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m07:23:55.666909 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: BEGIN
[0m07:23:55.667233 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:23:55.784457 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.228 seconds
[0m07:23:55.785758 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: ROLLBACK
[0m07:23:56.153432 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e: Close
[0m07:23:56.154197 [info ] [Thread-2 (]: 254 of 262 PASS unique_fct_inventory_inventory_id .............................. [[32mPASS[0m in 2.74s]
[0m07:23:56.154730 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e
[0m07:23:56.155157 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m07:23:56.155558 [info ] [Thread-2 (]: 258 of 262 START test unique_fct_sales_items_item_id ........................... [RUN]
[0m07:23:56.155968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_inventory_inventory_id.1cf54f628e, now test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b)
[0m07:23:56.156271 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m07:23:56.159457 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m07:23:56.159961 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m07:23:56.161810 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m07:23:56.162299 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m07:23:56.162608 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: BEGIN
[0m07:23:56.162889 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:23:58.902086 [debug] [Thread-1 (]: SQL status: BEGIN in 2.423 seconds
[0m07:23:58.902590 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"
[0m07:23:58.903079 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    history_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_pricing_history"
where history_id is not null
group by history_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:59.174282 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.271 seconds
[0m07:23:59.175718 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: ROLLBACK
[0m07:23:59.364174 [debug] [Thread-3 (]: SQL status: BEGIN in 2.493 seconds
[0m07:23:59.364685 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"
[0m07:23:59.365036 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_purchase_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:59.445227 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe: Close
[0m07:23:59.445976 [info ] [Thread-1 (]: 255 of 262 PASS unique_fct_pricing_history_history_id .......................... [[32mPASS[0m in 4.39s]
[0m07:23:59.446622 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe
[0m07:23:59.447050 [debug] [Thread-1 (]: Began running node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m07:23:59.447484 [info ] [Thread-1 (]: 259 of 262 START test unique_fct_sales_transactions_transaction_id ............. [RUN]
[0m07:23:59.447930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_pricing_history_history_id.99c76c96fe, now test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1)
[0m07:23:59.448275 [debug] [Thread-1 (]: Began compiling node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m07:23:59.451702 [debug] [Thread-1 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m07:23:59.452202 [debug] [Thread-1 (]: Began executing node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m07:23:59.454082 [debug] [Thread-1 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m07:23:59.454601 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m07:23:59.454902 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: BEGIN
[0m07:23:59.455233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:59.629958 [debug] [Thread-4 (]: SQL status: BEGIN in 2.545 seconds
[0m07:23:59.630427 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_returns_return_id.d461048e81"
[0m07:23:59.630778 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_returns_return_id.d461048e81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    return_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_returns"
where return_id is not null
group by return_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:59.646264 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.281 seconds
[0m07:23:59.647550 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: ROLLBACK
[0m07:23:59.763614 [debug] [Thread-2 (]: SQL status: BEGIN in 2.323 seconds
[0m07:23:59.764041 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"
[0m07:23:59.764492 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_sales_items"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:23:59.869456 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.238 seconds
[0m07:23:59.870727 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: ROLLBACK
[0m07:23:59.930820 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18: Close
[0m07:23:59.931776 [info ] [Thread-3 (]: 256 of 262 PASS unique_fct_purchase_orders_order_id ............................ [[32mPASS[0m in 4.49s]
[0m07:23:59.932379 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18
[0m07:23:59.932801 [debug] [Thread-3 (]: Began running node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m07:23:59.933212 [info ] [Thread-3 (]: 260 of 262 START test unique_fct_shipments_shipment_id ......................... [RUN]
[0m07:23:59.933670 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_purchase_orders_order_id.9b983fae18, now test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c)
[0m07:23:59.934004 [debug] [Thread-3 (]: Began compiling node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m07:23:59.938976 [debug] [Thread-3 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m07:23:59.939520 [debug] [Thread-3 (]: Began executing node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m07:23:59.941428 [debug] [Thread-3 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m07:23:59.941951 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m07:23:59.942302 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: BEGIN
[0m07:23:59.942608 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m07:24:00.060639 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.296 seconds
[0m07:24:00.062198 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: ROLLBACK
[0m07:24:00.105700 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_returns_return_id.d461048e81: Close
[0m07:24:00.106568 [info ] [Thread-4 (]: 257 of 262 PASS unique_fct_returns_return_id ................................... [[32mPASS[0m in 4.45s]
[0m07:24:00.107234 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fct_returns_return_id.d461048e81
[0m07:24:00.107658 [debug] [Thread-4 (]: Began running node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m07:24:00.108091 [info ] [Thread-4 (]: 261 of 262 START test unique_fct_stock_movements_movement_id ................... [RUN]
[0m07:24:00.108521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_returns_return_id.d461048e81, now test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333)
[0m07:24:00.108897 [debug] [Thread-4 (]: Began compiling node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m07:24:00.112220 [debug] [Thread-4 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m07:24:00.112744 [debug] [Thread-4 (]: Began executing node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m07:24:00.114783 [debug] [Thread-4 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m07:24:00.115324 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m07:24:00.115631 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: BEGIN
[0m07:24:00.115972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:24:00.328388 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b: Close
[0m07:24:00.329196 [info ] [Thread-2 (]: 258 of 262 PASS unique_fct_sales_items_item_id ................................. [[32mPASS[0m in 4.17s]
[0m07:24:00.329836 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b
[0m07:24:00.330210 [debug] [Thread-2 (]: Began running node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m07:24:00.330672 [info ] [Thread-2 (]: 262 of 262 START test unique_fct_store_visits_visit_id ......................... [RUN]
[0m07:24:00.331176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.retail_dbt.unique_fct_sales_items_item_id.5a55da8b8b, now test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28)
[0m07:24:00.331497 [debug] [Thread-2 (]: Began compiling node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m07:24:00.334906 [debug] [Thread-2 (]: Writing injected SQL for node "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m07:24:00.335474 [debug] [Thread-2 (]: Began executing node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m07:24:00.337324 [debug] [Thread-2 (]: Writing runtime sql for node "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m07:24:00.337834 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m07:24:00.338168 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: BEGIN
[0m07:24:00.338528 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:24:01.973100 [debug] [Thread-1 (]: SQL status: BEGIN in 2.518 seconds
[0m07:24:01.973608 [debug] [Thread-1 (]: Using postgres connection "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"
[0m07:24:01.974089 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_sales_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:24:02.173339 [debug] [Thread-3 (]: SQL status: BEGIN in 2.231 seconds
[0m07:24:02.173833 [debug] [Thread-3 (]: Using postgres connection "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"
[0m07:24:02.174262 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    shipment_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_shipments"
where shipment_id is not null
group by shipment_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:24:02.258312 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.284 seconds
[0m07:24:02.259825 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: ROLLBACK
[0m07:24:02.407049 [debug] [Thread-2 (]: SQL status: BEGIN in 2.068 seconds
[0m07:24:02.407489 [debug] [Thread-2 (]: Using postgres connection "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"
[0m07:24:02.407839 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    visit_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_store_visits"
where visit_id is not null
group by visit_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:24:02.412798 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.238 seconds
[0m07:24:02.414067 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: ROLLBACK
[0m07:24:02.529428 [debug] [Thread-1 (]: On test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1: Close
[0m07:24:02.530386 [info ] [Thread-1 (]: 259 of 262 PASS unique_fct_sales_transactions_transaction_id ................... [[32mPASS[0m in 3.08s]
[0m07:24:02.531173 [debug] [Thread-1 (]: Finished running node test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1
[0m07:24:02.610839 [debug] [Thread-4 (]: SQL status: BEGIN in 2.495 seconds
[0m07:24:02.611392 [debug] [Thread-4 (]: Using postgres connection "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"
[0m07:24:02.611854 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    movement_id as unique_field,
    count(*) as n_records

from "postgres"."silver_to_golden"."fct_stock_movements"
where movement_id is not null
group by movement_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m07:24:02.642595 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.234 seconds
[0m07:24:02.644136 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: ROLLBACK
[0m07:24:02.653773 [debug] [Thread-3 (]: On test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c: Close
[0m07:24:02.654574 [info ] [Thread-3 (]: 260 of 262 PASS unique_fct_shipments_shipment_id ............................... [[32mPASS[0m in 2.72s]
[0m07:24:02.655302 [debug] [Thread-3 (]: Finished running node test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c
[0m07:24:02.883709 [debug] [Thread-2 (]: On test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28: Close
[0m07:24:02.884602 [info ] [Thread-2 (]: 262 of 262 PASS unique_fct_store_visits_visit_id ............................... [[32mPASS[0m in 2.55s]
[0m07:24:02.885319 [debug] [Thread-2 (]: Finished running node test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28
[0m07:24:02.908134 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.296 seconds
[0m07:24:02.909601 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: ROLLBACK
[0m07:24:03.197297 [debug] [Thread-4 (]: On test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333: Close
[0m07:24:03.198210 [info ] [Thread-4 (]: 261 of 262 PASS unique_fct_stock_movements_movement_id ......................... [[32mPASS[0m in 3.09s]
[0m07:24:03.198900 [debug] [Thread-4 (]: Finished running node test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333
[0m07:24:03.201200 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:03.201544 [debug] [MainThread]: On master: BEGIN
[0m07:24:03.201858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:24:05.606102 [debug] [MainThread]: SQL status: BEGIN in 2.404 seconds
[0m07:24:05.606637 [debug] [MainThread]: On master: COMMIT
[0m07:24:05.606986 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:05.607492 [debug] [MainThread]: On master: COMMIT
[0m07:24:05.870294 [debug] [MainThread]: SQL status: COMMIT in 0.262 seconds
[0m07:24:05.870796 [debug] [MainThread]: On master: Close
[0m07:24:05.871485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:05.871756 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_sales_transactions_transaction_id.dc29ee08f1' was properly closed.
[0m07:24:05.872038 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_stock_movements_movement_id.4f94955333' was properly closed.
[0m07:24:05.872284 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_shipments_shipment_id.c7c159f82c' was properly closed.
[0m07:24:05.872558 [debug] [MainThread]: Connection 'test.retail_dbt.unique_fct_store_visits_visit_id.182732ac28' was properly closed.
[0m07:24:05.873035 [info ] [MainThread]: 
[0m07:24:05.873379 [info ] [MainThread]: Finished running 262 data tests in 0 hours 3 minutes and 41.71 seconds (221.71s).
[0m07:24:05.897939 [debug] [MainThread]: Command end result
[0m07:24:06.055719 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:24:06.058373 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:24:06.071030 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:24:06.071365 [info ] [MainThread]: 
[0m07:24:06.071699 [info ] [MainThread]: [31mCompleted with 19 errors, 0 partial successes, and 0 warnings:[0m
[0m07:24:06.072003 [info ] [MainThread]: 
[0m07:24:06.072348 [error] [MainThread]: [31mFailure in test not_null_dim_brands_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.072677 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m07:24:06.072972 [info ] [MainThread]: 
[0m07:24:06.073293 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_brands_scd_dbt_valid_to.sql
[0m07:24:06.073577 [info ] [MainThread]: 
[0m07:24:06.073910 [error] [MainThread]: [31mFailure in test not_null_dim_brands_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.074226 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m07:24:06.074494 [info ] [MainThread]: 
[0m07:24:06.074837 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_brands_scd_valid_to.sql
[0m07:24:06.075136 [info ] [MainThread]: 
[0m07:24:06.075493 [error] [MainThread]: [31mFailure in test not_null_dim_categories_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.075831 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m07:24:06.076100 [info ] [MainThread]: 
[0m07:24:06.076415 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_categories_scd_dbt_valid_to.sql
[0m07:24:06.076704 [info ] [MainThread]: 
[0m07:24:06.077184 [error] [MainThread]: [31mFailure in test not_null_dim_categories_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.077553 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m07:24:06.077938 [info ] [MainThread]: 
[0m07:24:06.078325 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_categories_scd_valid_to.sql
[0m07:24:06.078615 [info ] [MainThread]: 
[0m07:24:06.078963 [error] [MainThread]: [31mFailure in test not_null_dim_customers_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.079289 [error] [MainThread]:   Got 902 results, configured to fail if != 0
[0m07:24:06.079576 [info ] [MainThread]: 
[0m07:24:06.079925 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_customers_scd_dbt_valid_to.sql
[0m07:24:06.080201 [info ] [MainThread]: 
[0m07:24:06.080559 [error] [MainThread]: [31mFailure in test not_null_dim_customers_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.080877 [error] [MainThread]:   Got 902 results, configured to fail if != 0
[0m07:24:06.081145 [info ] [MainThread]: 
[0m07:24:06.081486 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_customers_scd_valid_to.sql
[0m07:24:06.081764 [info ] [MainThread]: 
[0m07:24:06.082114 [error] [MainThread]: [31mFailure in test not_null_dim_employees_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.082456 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m07:24:06.082725 [info ] [MainThread]: 
[0m07:24:06.083079 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_employees_scd_dbt_valid_to.sql
[0m07:24:06.083354 [info ] [MainThread]: 
[0m07:24:06.083698 [error] [MainThread]: [31mFailure in test not_null_dim_employees_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.084008 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m07:24:06.084291 [info ] [MainThread]: 
[0m07:24:06.084672 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_employees_scd_valid_to.sql
[0m07:24:06.084962 [info ] [MainThread]: 
[0m07:24:06.085285 [error] [MainThread]: [31mFailure in test not_null_dim_loyalty_programs_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.085600 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m07:24:06.085885 [info ] [MainThread]: 
[0m07:24:06.086197 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_loyalty_programs_scd_dbt_valid_to.sql
[0m07:24:06.086471 [info ] [MainThread]: 
[0m07:24:06.086807 [error] [MainThread]: [31mFailure in test not_null_dim_loyalty_programs_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.087134 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m07:24:06.087399 [info ] [MainThread]: 
[0m07:24:06.087736 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_loyalty_programs_scd_valid_to.sql
[0m07:24:06.088012 [info ] [MainThread]: 
[0m07:24:06.088330 [error] [MainThread]: [31mFailure in test not_null_dim_products_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.088669 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m07:24:06.088936 [info ] [MainThread]: 
[0m07:24:06.089272 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_products_scd_dbt_valid_to.sql
[0m07:24:06.089694 [info ] [MainThread]: 
[0m07:24:06.090015 [error] [MainThread]: [31mFailure in test not_null_dim_products_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.090332 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m07:24:06.090616 [info ] [MainThread]: 
[0m07:24:06.090931 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_products_scd_valid_to.sql
[0m07:24:06.091221 [info ] [MainThread]: 
[0m07:24:06.091562 [error] [MainThread]: [31mFailure in test not_null_dim_promotions_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.091876 [error] [MainThread]:   Got 248 results, configured to fail if != 0
[0m07:24:06.092141 [info ] [MainThread]: 
[0m07:24:06.092474 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_promotions_scd_dbt_valid_to.sql
[0m07:24:06.092753 [info ] [MainThread]: 
[0m07:24:06.093074 [error] [MainThread]: [31mFailure in test not_null_dim_promotions_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.093386 [error] [MainThread]:   Got 248 results, configured to fail if != 0
[0m07:24:06.093683 [info ] [MainThread]: 
[0m07:24:06.093994 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_promotions_scd_valid_to.sql
[0m07:24:06.094265 [info ] [MainThread]: 
[0m07:24:06.094608 [error] [MainThread]: [31mFailure in test not_null_dim_stores_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.094924 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m07:24:06.095215 [info ] [MainThread]: 
[0m07:24:06.095556 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_stores_scd_dbt_valid_to.sql
[0m07:24:06.095827 [info ] [MainThread]: 
[0m07:24:06.096143 [error] [MainThread]: [31mFailure in test not_null_dim_stores_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.096474 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m07:24:06.096739 [info ] [MainThread]: 
[0m07:24:06.097048 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_stores_scd_valid_to.sql
[0m07:24:06.097340 [info ] [MainThread]: 
[0m07:24:06.097656 [error] [MainThread]: [31mFailure in test not_null_dim_suppliers_scd_dbt_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.097969 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m07:24:06.098251 [info ] [MainThread]: 
[0m07:24:06.098561 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_suppliers_scd_dbt_valid_to.sql
[0m07:24:06.098837 [info ] [MainThread]: 
[0m07:24:06.099242 [error] [MainThread]: [31mFailure in test not_null_dim_suppliers_scd_valid_to (models/golden/schema.yml)[0m
[0m07:24:06.099562 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m07:24:06.099827 [info ] [MainThread]: 
[0m07:24:06.100156 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_dim_suppliers_scd_valid_to.sql
[0m07:24:06.100430 [info ] [MainThread]: 
[0m07:24:06.100747 [error] [MainThread]: [31mFailure in test not_null_fct_store_visits_customer_name (models/golden/schema.yml)[0m
[0m07:24:06.101084 [error] [MainThread]:   Got 902 results, configured to fail if != 0
[0m07:24:06.101351 [info ] [MainThread]: 
[0m07:24:06.101661 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/golden/schema.yml/not_null_fct_store_visits_customer_name.sql
[0m07:24:06.102043 [info ] [MainThread]: 
[0m07:24:06.102472 [info ] [MainThread]: Done. PASS=243 WARN=0 ERROR=19 SKIP=0 NO-OP=0 TOTAL=262
[0m07:24:06.103409 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 213.03487, "process_in_blocks": "0", "process_kernel_time": 0.901076, "process_mem_max_rss": "145688", "process_out_blocks": "15784", "process_user_time": 7.345265}
[0m07:24:06.103773 [debug] [MainThread]: Command `dbt test` failed at 07:24:06.103700 after 213.04 seconds
[0m07:24:06.104123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efda43ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd9eca5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72efd9f2ef00>]}
[0m07:24:06.104413 [debug] [MainThread]: Flushing usage events
[0m07:24:07.181362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:15:02.374487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e987e5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e987e5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e98f53cb0>]}


============================== 03:15:02.380708 | 1587cc2f-8876-4c13-8c77-a78e6f6aa2cb ==============================
[0m03:15:02.380708 [info ] [MainThread]: Running with dbt=1.10.9
[0m03:15:02.381245 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging --full-refresh --profiles-dir /home/airflow/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/airflow/.dbt'}
[0m03:15:02.567811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e97b83260>]}
[0m03:15:02.617197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9816b500>]}
[0m03:15:02.617883 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:15:02.709539 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m03:15:02.856553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:15:02.856913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:15:02.913606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9885f440>]}
[0m03:15:03.120920 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m03:15:03.123969 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m03:15:03.185271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e96b02c00>]}
[0m03:15:03.185709 [info ] [MainThread]: Found 88 models, 9 snapshots, 376 data tests, 23 sources, 816 macros
[0m03:15:03.186061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e96b03e30>]}
[0m03:15:03.197678 [info ] [MainThread]: 
[0m03:15:03.198077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:15:03.198393 [info ] [MainThread]: 
[0m03:15:03.198826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:15:03.202669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:15:03.237169 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:15:03.237531 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:15:03.237839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:05.410377 [debug] [ThreadPool]: SQL status: SELECT 3 in 2.172 seconds
[0m03:15:05.411744 [debug] [ThreadPool]: On list_postgres: Close
[0m03:15:05.412739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_silver_staging)
[0m03:15:05.413311 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "silver_staging"
"
[0m03:15:05.418842 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_staging"
[0m03:15:05.419200 [debug] [ThreadPool]: On create_postgres_silver_staging: BEGIN
[0m03:15:05.419527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:07.410639 [debug] [ThreadPool]: SQL status: BEGIN in 1.991 seconds
[0m03:15:07.411729 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_staging"
[0m03:15:07.412537 [debug] [ThreadPool]: On create_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "create_postgres_silver_staging"} */
create schema if not exists "silver_staging"
[0m03:15:07.646214 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.233 seconds
[0m03:15:07.647557 [debug] [ThreadPool]: On create_postgres_silver_staging: COMMIT
[0m03:15:07.647988 [debug] [ThreadPool]: Using postgres connection "create_postgres_silver_staging"
[0m03:15:07.648383 [debug] [ThreadPool]: On create_postgres_silver_staging: COMMIT
[0m03:15:07.867840 [debug] [ThreadPool]: SQL status: COMMIT in 0.219 seconds
[0m03:15:07.868396 [debug] [ThreadPool]: On create_postgres_silver_staging: Close
[0m03:15:07.875086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_silver_staging, now list_postgres_silver_staging)
[0m03:15:07.880912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_invalid'
[0m03:15:07.880561 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m03:15:07.884405 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m03:15:07.884867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver_to_golden'
[0m03:15:07.885442 [debug] [ThreadPool]: On list_postgres_silver_staging: BEGIN
[0m03:15:07.885836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_silver'
[0m03:15:07.886256 [debug] [ThreadPool]: On list_postgres_silver_invalid: BEGIN
[0m03:15:07.888328 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m03:15:07.888762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:07.890592 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m03:15:07.890943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:07.891291 [debug] [ThreadPool]: On list_postgres_silver_to_golden: BEGIN
[0m03:15:07.891758 [debug] [ThreadPool]: On list_postgres_silver: BEGIN
[0m03:15:07.892295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:07.892723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:10.037348 [debug] [ThreadPool]: SQL status: BEGIN in 2.145 seconds
[0m03:15:10.037800 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_to_golden"
[0m03:15:10.038098 [debug] [ThreadPool]: On list_postgres_silver_to_golden: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_to_golden"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_to_golden'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_to_golden'
  
[0m03:15:10.265362 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.227 seconds
[0m03:15:10.266574 [debug] [ThreadPool]: On list_postgres_silver_to_golden: ROLLBACK
[0m03:15:10.316298 [debug] [ThreadPool]: SQL status: BEGIN in 2.427 seconds
[0m03:15:10.316803 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_staging"
[0m03:15:10.317158 [debug] [ThreadPool]: On list_postgres_silver_staging: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_staging"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_staging'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_staging'
  
[0m03:15:10.433904 [debug] [ThreadPool]: SQL status: BEGIN in 2.541 seconds
[0m03:15:10.434287 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver"
[0m03:15:10.434634 [debug] [ThreadPool]: On list_postgres_silver: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m03:15:10.485235 [debug] [ThreadPool]: On list_postgres_silver_to_golden: Close
[0m03:15:10.568279 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.251 seconds
[0m03:15:10.569435 [debug] [ThreadPool]: On list_postgres_silver_staging: ROLLBACK
[0m03:15:10.674455 [debug] [ThreadPool]: SQL status: BEGIN in 2.783 seconds
[0m03:15:10.674933 [debug] [ThreadPool]: Using postgres connection "list_postgres_silver_invalid"
[0m03:15:10.675317 [debug] [ThreadPool]: On list_postgres_silver_invalid: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "list_postgres_silver_invalid"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver_invalid'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver_invalid'
  
[0m03:15:10.699611 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.265 seconds
[0m03:15:10.700684 [debug] [ThreadPool]: On list_postgres_silver: ROLLBACK
[0m03:15:10.823380 [debug] [ThreadPool]: On list_postgres_silver_staging: Close
[0m03:15:10.962454 [debug] [ThreadPool]: On list_postgres_silver: Close
[0m03:15:10.968865 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.293 seconds
[0m03:15:10.970013 [debug] [ThreadPool]: On list_postgres_silver_invalid: ROLLBACK
[0m03:15:11.261364 [debug] [ThreadPool]: On list_postgres_silver_invalid: Close
[0m03:15:11.269843 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:11.270162 [debug] [MainThread]: On master: BEGIN
[0m03:15:11.270444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:15:13.290549 [debug] [MainThread]: SQL status: BEGIN in 2.020 seconds
[0m03:15:13.291034 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:13.291357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:15:13.522495 [debug] [MainThread]: SQL status: SELECT 0 in 0.231 seconds
[0m03:15:13.523570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e973222a0>]}
[0m03:15:13.523987 [debug] [MainThread]: On master: ROLLBACK
[0m03:15:13.743591 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:13.744031 [debug] [MainThread]: On master: BEGIN
[0m03:15:14.191666 [debug] [MainThread]: SQL status: BEGIN in 0.447 seconds
[0m03:15:14.192136 [debug] [MainThread]: On master: COMMIT
[0m03:15:14.192500 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:14.192811 [debug] [MainThread]: On master: COMMIT
[0m03:15:14.415275 [debug] [MainThread]: SQL status: COMMIT in 0.222 seconds
[0m03:15:14.415760 [debug] [MainThread]: On master: Close
[0m03:15:14.421242 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_brands
[0m03:15:14.421654 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_campaigns
[0m03:15:14.422375 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_categories
[0m03:15:14.422086 [info ] [Thread-1 (]: 1 of 23 START sql view model silver_staging.stg_brands ......................... [RUN]
[0m03:15:14.423326 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_customer_feedback
[0m03:15:14.422885 [info ] [Thread-2 (]: 2 of 23 START sql view model silver_staging.stg_campaigns ...................... [RUN]
[0m03:15:14.424301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_silver_invalid, now model.retail_dbt.stg_brands)
[0m03:15:14.423762 [info ] [Thread-3 (]: 3 of 23 START sql view model silver_staging.stg_categories ..................... [RUN]
[0m03:15:14.424856 [info ] [Thread-4 (]: 4 of 23 START sql view model silver_staging.stg_customer_feedback .............. [RUN]
[0m03:15:14.425303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_silver, now model.retail_dbt.stg_campaigns)
[0m03:15:14.425656 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_brands
[0m03:15:14.426110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_silver_staging, now model.retail_dbt.stg_categories)
[0m03:15:14.426449 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_postgres_silver_to_golden, now model.retail_dbt.stg_customer_feedback)
[0m03:15:14.426815 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_campaigns
[0m03:15:14.432640 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_brands"
[0m03:15:14.433019 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_categories
[0m03:15:14.433390 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_customer_feedback
[0m03:15:14.437256 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_campaigns"
[0m03:15:14.439555 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_categories"
[0m03:15:14.442049 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_customer_feedback"
[0m03:15:14.442415 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_brands
[0m03:15:14.448307 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_campaigns
[0m03:15:14.477332 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_brands"
[0m03:15:14.477811 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_customer_feedback
[0m03:15:14.479073 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_campaigns"
[0m03:15:14.479500 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_categories
[0m03:15:14.481989 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_customer_feedback"
[0m03:15:14.485190 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_categories"
[0m03:15:14.485782 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m03:15:14.486535 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m03:15:14.486904 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: BEGIN
[0m03:15:14.487421 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: BEGIN
[0m03:15:14.487864 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m03:15:14.488431 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m03:15:14.488774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:14.489121 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:15:14.489509 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: BEGIN
[0m03:15:14.489855 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: BEGIN
[0m03:15:14.490529 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:15:14.490970 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:15:16.681991 [debug] [Thread-2 (]: SQL status: BEGIN in 2.193 seconds
[0m03:15:16.682440 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_campaigns"
[0m03:15:16.682932 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_campaigns"} */

  create view "postgres"."silver_staging"."stg_campaigns__dbt_tmp"
    
    
  as (
    with source as (
    select * from "postgres"."raw"."campaigns"
),

cleaned as (
    select
        case 
            when campaign_id is null then null
            when trim(campaign_id) = '' then null
            when lower(trim(campaign_id)) in ('null','na','n/a','none') then null
            -- loại bỏ ký tự không phải số rồi cast sang int
            else cast(regexp_replace(trim(campaign_id), '[^0-9]', '', 'g') as int)
        end as campaign_id,

        case 
            when name is null then null
            when trim(name) = '' then null
            when lower(trim(name)) in ('null','na','n/a','none') then null
            else trim(name)
        end as name,

        case
            when budget is null then null
            when trim(budget::text) = '' then null
            when lower(trim(budget::text)) in ('null','na','n/a','none') then null
            else nullif(regexp_replace(trim(budget::text), '[^0-9.\-]', '', 'g'), '')
        end as budget_str,

        nullif(trim(start_date::text), '') as start_date_raw,
        nullif(trim(end_date::text), '') as end_date_raw,

        current_timestamp as staged_at
    from source
),

typed as (
    select
        campaign_id,
        name,
        case
            when budget_str ~ '^-?\d+(\.\d+)?$' then budget_str::numeric
            else null
        end as budget,

        /* Chuẩn hoá dấu phân cách ngày về '-' để dễ regex */
        case when start_date_raw is null then null
             else regexp_replace(lower(start_date_raw), '[./]', '-', 'g') end as start_norm,
        case when end_date_raw   is null then null
             else regexp_replace(lower(end_date_raw),   '[./]', '-', 'g') end as end_norm,

        staged_at
    from cleaned
),

parsed as (
    select
        campaign_id,
        name,
        budget,

        /* START_DATE */
        case
            /* YYYY-MM-DD [optional time] */
            when start_norm ~ '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'YYYY-MM-DD')
            /* DD-MM-YYYY [optional time] */
            when start_norm ~ '^(0[1-9]|[12]\d|3[01])-(0[1-9]|1[0-2])-\d{4}(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'DD-MM-YYYY')
            /* MM-DD-YYYY [optional time] */
            when start_norm ~ '^(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])-\d{4}(\s.*)?$'
                then to_date(split_part(start_norm, ' ', 1), 'MM-DD-YYYY')
            else null
        end as start_date,

        /* END_DATE */
        case
            when end_norm ~ '^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'YYYY-MM-DD')
            when end_norm ~ '^(0[1-9]|[12]\d|3[01])-(0[1-9]|1[0-2])-\d{4}(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'DD-MM-YYYY')
            when end_norm ~ '^(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])-\d{4}(\s.*)?$'
                then to_date(split_part(end_norm, ' ', 1), 'MM-DD-YYYY')
            else null
        end as end_date,

        staged_at
    from typed
),

filtered as (
    select *
    from parsed
    where start_date is not null
      and end_date is not null
      and start_date < end_date
      and start_date < date '2025-08-22'
      and end_date < date '2025-08-22'
      -- Thêm điều kiện loại bỏ tất cả các hàng có giá trị null ở bất kỳ cột nào
      and campaign_id is not null
      and name is not null
      and budget is not null
      and staged_at is not null
)

select
    campaign_id,
    name,
    budget,
    start_date,
    end_date,
    staged_at
from filtered
  );
[0m03:15:16.689088 [debug] [Thread-4 (]: SQL status: BEGIN in 2.198 seconds
[0m03:15:16.689449 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_customer_feedback"
[0m03:15:16.689879 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customer_feedback"} */

  create view "postgres"."silver_staging"."stg_customer_feedback__dbt_tmp"
    
    
  as (
    

WITH source_data AS (
    SELECT
        -- cast các ID về int
        CASE
            WHEN feedback_id IS NULL OR TRIM(feedback_id::text) = '' 
                 OR LOWER(TRIM(feedback_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(feedback_id::text), '[^0-9]', '', 'g') AS int)
        END AS feedback_id,

        CASE
            WHEN customer_id IS NULL OR TRIM(customer_id::text) = '' 
                 OR LOWER(TRIM(customer_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(customer_id::text), '[^0-9]', '', 'g') AS int)
        END AS customer_id,

        CASE
            WHEN store_id IS NULL OR TRIM(store_id::text) = '' 
                 OR LOWER(TRIM(store_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(store_id::text), '[^0-9]', '', 'g') AS int)
        END AS store_id,

        CASE
            WHEN product_id IS NULL OR TRIM(product_id::text) = '' 
                 OR LOWER(TRIM(product_id::text)) IN ('na','null','n/a') 
            THEN NULL
            ELSE CAST(regexp_replace(TRIM(product_id::text), '[^0-9]', '', 'g') AS int)
        END AS product_id,

        CASE
            WHEN rating IS NULL THEN NULL
            WHEN TRIM(LOWER(CAST(rating AS text))) IN ('na', '') THEN NULL
            WHEN TRIM(CAST(rating AS text)) ~ '^[0-9]+$' 
            THEN CAST(TRIM(CAST(rating AS text)) AS integer)
            ELSE NULL
        END AS rating,

        TRIM(CAST(comments AS text)) AS comments,

        CASE
            WHEN feedback_date IS NULL THEN NULL
            WHEN TRIM(LOWER(CAST(feedback_date AS text))) IN ('na', '') THEN NULL
            ELSE TRIM(REPLACE(CAST(feedback_date AS text), E'\r', ''))
        END AS feedback_date_text
    FROM "postgres"."raw"."customer_feedback"
),

dated AS (
    SELECT
        feedback_id,
        customer_id,
        store_id,
        product_id,
        rating,
        comments,
        feedback_date_text,

        (
            feedback_date_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
        ) AS is_valid_date_text,

        CASE
            WHEN feedback_date_text IS NOT NULL
             AND feedback_date_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
            THEN to_timestamp(replace(feedback_date_text, '-', '/'), 'YYYY/FMMM/FMDD')
            ELSE NULL
        END AS feedback_date_ts
    FROM source_data
),

staging_data AS (
    SELECT
        feedback_id::int      AS feedback_id,
        customer_id::int      AS customer_id,
        store_id::int         AS store_id,
        product_id::int       AS product_id,
        rating::integer       AS rating,
        comments::text        AS comments,
        feedback_date_ts      AS feedback_date
    FROM dated
    WHERE
        feedback_id IS NOT NULL
        AND customer_id IS NOT NULL
        AND store_id   IS NOT NULL
        AND product_id IS NOT NULL
        AND rating BETWEEN 1 AND 5
        AND is_valid_date_text
        AND feedback_date_ts IS NOT NULL
        AND feedback_date_ts <= to_timestamp('2025/08/22', 'YYYY/MM/DD')
)

SELECT
    feedback_id,
    customer_id,
    store_id,
    product_id,
    rating,
    comments,
    feedback_date
FROM staging_data
  );
[0m03:15:17.072511 [debug] [Thread-3 (]: SQL status: BEGIN in 2.389 seconds
[0m03:15:17.073070 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_categories"
[0m03:15:17.073506 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_categories"} */

  create view "postgres"."silver_staging"."stg_categories__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."raw"."categories"
),

cleaned as (
    select
        case 
            when trim(category_id) = '' then null
            when lower(trim(category_id)) in ('null', 'na', 'n/a') then null
            -- loại bỏ ký tự không phải số trước khi cast
            else cast(regexp_replace(trim(category_id), '[^0-9]', '', 'g') as int)
        end as category_id,
        
        case 
            when trim(name) = '' then null
            when lower(trim(name)) in ('null', 'na', 'n/a', 'none', 'unknown') then null
            else trim(name)
        end as name,
        
        current_timestamp as staged_at
    from source
)

select * from cleaned
  );
[0m03:15:17.104068 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.campaigns" does not exist
LINE 8:     select * from "postgres"."raw"."campaigns"
                          ^

[0m03:15:17.104564 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: ROLLBACK
[0m03:15:17.110270 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.customer_feedback" does not exist
LINE 55:     FROM "postgres"."raw"."customer_feedback"
                  ^

[0m03:15:17.110701 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: ROLLBACK
[0m03:15:19.567563 [debug] [Thread-1 (]: SQL status: BEGIN in 2.490 seconds
[0m03:15:19.568065 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_brands"
[0m03:15:19.568455 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_brands"} */

  create view "postgres"."silver_staging"."stg_brands__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."raw"."brands"
),

cleaned as (
    select
        case 
            when trim(brand_id) = '' then null
            when lower(trim(brand_id)) in ('null', 'na', 'n/a') then null
            -- loại bỏ ký tự không phải số trước khi cast
            else cast(regexp_replace(trim(brand_id), '[^0-9]', '', 'g') as int)
        end as brand_id,
        
        case 
            when trim(name) = '' then null
            when lower(trim(name)) in ('null', 'na', 'n/a', 'none', 'unknown') then null
            else trim(name)
        end as name,
        
        current_timestamp as staged_at
    from source
)

select * from cleaned
  );
[0m03:15:19.718486 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.categories" does not exist
LINE 10:     select * from "postgres"."raw"."categories"
                           ^

[0m03:15:19.718915 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: ROLLBACK
[0m03:15:19.724487 [debug] [Thread-2 (]: On model.retail_dbt.stg_campaigns: Close
[0m03:15:19.727392 [debug] [Thread-2 (]: Database Error in model stg_campaigns (models/staging/stg_campaigns.sql)
  relation "raw.campaigns" does not exist
  LINE 8:     select * from "postgres"."raw"."campaigns"
                            ^
  compiled code at target/run/retail_dbt/models/staging/stg_campaigns.sql
[0m03:15:19.728707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9557fdd0>]}
[0m03:15:19.729251 [error] [Thread-2 (]: 2 of 23 ERROR creating sql view model silver_staging.stg_campaigns ............. [[31mERROR[0m in 5.30s]
[0m03:15:19.729786 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_campaigns
[0m03:15:19.730137 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_customers
[0m03:15:19.730608 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_campaigns' to be skipped because of status 'error'.  Reason: Database Error in model stg_campaigns (models/staging/stg_campaigns.sql)
  relation "raw.campaigns" does not exist
  LINE 8:     select * from "postgres"."raw"."campaigns"
                            ^
  compiled code at target/run/retail_dbt/models/staging/stg_campaigns.sql.
[0m03:15:19.731130 [info ] [Thread-2 (]: 5 of 23 START sql view model silver_staging.stg_customers ...................... [RUN]
[0m03:15:19.732333 [debug] [Thread-4 (]: On model.retail_dbt.stg_customer_feedback: Close
[0m03:15:19.732751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_campaigns, now model.retail_dbt.stg_customers)
[0m03:15:19.733153 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_customers
[0m03:15:19.736947 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_customers"
[0m03:15:19.738163 [debug] [Thread-4 (]: Database Error in model stg_customer_feedback (models/staging/stg_customer_feedback.sql)
  relation "raw.customer_feedback" does not exist
  LINE 55:     FROM "postgres"."raw"."customer_feedback"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_customer_feedback.sql
[0m03:15:19.738563 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e955abcb0>]}
[0m03:15:19.739289 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_customers
[0m03:15:19.739018 [error] [Thread-4 (]: 4 of 23 ERROR creating sql view model silver_staging.stg_customer_feedback ..... [[31mERROR[0m in 5.31s]
[0m03:15:19.742120 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_customers"
[0m03:15:19.742649 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_customer_feedback
[0m03:15:19.743192 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_discount_rules
[0m03:15:19.743660 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_customer_feedback' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_feedback (models/staging/stg_customer_feedback.sql)
  relation "raw.customer_feedback" does not exist
  LINE 55:     FROM "postgres"."raw"."customer_feedback"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_customer_feedback.sql.
[0m03:15:19.744546 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m03:15:19.744184 [info ] [Thread-4 (]: 6 of 23 START sql view model silver_staging.stg_discount_rules ................. [RUN]
[0m03:15:19.745280 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: BEGIN
[0m03:15:19.745807 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customer_feedback, now model.retail_dbt.stg_discount_rules)
[0m03:15:19.746221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:15:19.746611 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_discount_rules
[0m03:15:19.752026 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_discount_rules"
[0m03:15:19.752716 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_discount_rules
[0m03:15:19.755605 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_discount_rules"
[0m03:15:19.756258 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m03:15:19.756704 [debug] [Thread-4 (]: On model.retail_dbt.stg_discount_rules: BEGIN
[0m03:15:19.757163 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:15:19.826258 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.brands" does not exist
LINE 10:     select * from "postgres"."raw"."brands"
                           ^

[0m03:15:19.826722 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: ROLLBACK
[0m03:15:19.972705 [debug] [Thread-3 (]: On model.retail_dbt.stg_categories: Close
[0m03:15:19.974641 [debug] [Thread-3 (]: Database Error in model stg_categories (models/staging/stg_categories.sql)
  relation "raw.categories" does not exist
  LINE 10:     select * from "postgres"."raw"."categories"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_categories.sql
[0m03:15:19.975057 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9814ebd0>]}
[0m03:15:19.975544 [error] [Thread-3 (]: 3 of 23 ERROR creating sql view model silver_staging.stg_categories ............ [[31mERROR[0m in 5.55s]
[0m03:15:19.976049 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_categories
[0m03:15:19.976372 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_employees
[0m03:15:19.976820 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_categories' to be skipped because of status 'error'.  Reason: Database Error in model stg_categories (models/staging/stg_categories.sql)
  relation "raw.categories" does not exist
  LINE 10:     select * from "postgres"."raw"."categories"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_categories.sql.
[0m03:15:19.977310 [info ] [Thread-3 (]: 7 of 23 START sql view model silver_staging.stg_employees ...................... [RUN]
[0m03:15:19.977910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_categories, now model.retail_dbt.stg_employees)
[0m03:15:19.978241 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_employees
[0m03:15:19.981002 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_employees"
[0m03:15:19.981497 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_employees
[0m03:15:19.986398 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_employees"
[0m03:15:19.987174 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m03:15:19.987627 [debug] [Thread-3 (]: On model.retail_dbt.stg_employees: BEGIN
[0m03:15:19.988057 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:15:20.088368 [debug] [Thread-1 (]: On model.retail_dbt.stg_brands: Close
[0m03:15:20.090365 [debug] [Thread-1 (]: Database Error in model stg_brands (models/staging/stg_brands.sql)
  relation "raw.brands" does not exist
  LINE 10:     select * from "postgres"."raw"."brands"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_brands.sql
[0m03:15:20.090831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e944975c0>]}
[0m03:15:20.091358 [error] [Thread-1 (]: 1 of 23 ERROR creating sql view model silver_staging.stg_brands ................ [[31mERROR[0m in 5.67s]
[0m03:15:20.091875 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_brands
[0m03:15:20.092260 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_inventory
[0m03:15:20.092673 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_brands' to be skipped because of status 'error'.  Reason: Database Error in model stg_brands (models/staging/stg_brands.sql)
  relation "raw.brands" does not exist
  LINE 10:     select * from "postgres"."raw"."brands"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_brands.sql.
[0m03:15:20.093240 [info ] [Thread-1 (]: 8 of 23 START sql view model silver_staging.stg_inventory ...................... [RUN]
[0m03:15:20.093946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_brands, now model.retail_dbt.stg_inventory)
[0m03:15:20.094276 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_inventory
[0m03:15:20.150916 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_inventory"
[0m03:15:20.151548 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_inventory
[0m03:15:20.154330 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_inventory"
[0m03:15:20.154867 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m03:15:20.155211 [debug] [Thread-1 (]: On model.retail_dbt.stg_inventory: BEGIN
[0m03:15:20.155495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:21.784055 [debug] [Thread-2 (]: SQL status: BEGIN in 2.038 seconds
[0m03:15:21.784511 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_customers"
[0m03:15:21.784953 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_customers"} */

  create view "postgres"."silver_staging"."stg_customers__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(customer_id AS text))                        AS customer_id_text,
        TRIM(CAST(name        AS text))                        AS name,
        LOWER(TRIM(CAST(email AS text)))                       AS email,
        TRIM(CAST(phone       AS text))                        AS phone_text,
        TRIM(CAST(loyalty_program_id AS text))                 AS loyalty_program_id_text,
        TRIM(REPLACE(CAST(created_at AS text), E'\r',''))      AS created_at_text
    FROM "postgres"."raw"."customers"
),
typed AS (
    SELECT
        CASE WHEN customer_id_text ~ '^[0-9]+$'
             THEN customer_id_text::integer END                AS customer_id,
        name,
        email,
        phone_text                                             AS phone,
        CASE WHEN loyalty_program_id_text ~ '^[0-9]+$'
             THEN loyalty_program_id_text::integer END         AS loyalty_program_id,

        CASE
            WHEN created_at_text ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
            THEN to_timestamp(replace(created_at_text,'-','/'),'YYYY/FMMM/FMDD')
            ELSE NULL
        END                                                    AS created_at
    FROM src
)
SELECT
    customer_id, name, email, phone, loyalty_program_id, created_at
FROM typed
WHERE created_at IS NOT NULL
  AND created_at <= to_timestamp('2025/08/22','YYYY/MM/DD')
  );
[0m03:15:21.788159 [debug] [Thread-4 (]: SQL status: BEGIN in 2.031 seconds
[0m03:15:21.788589 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_discount_rules"
[0m03:15:21.789114 [debug] [Thread-4 (]: On model.retail_dbt.stg_discount_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_discount_rules"} */

  create view "postgres"."silver_staging"."stg_discount_rules__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(rule_id AS text))          AS rule_id_txt,
        TRIM(CAST(product_id AS text))       AS product_id_txt,
        TRIM(CAST(discount_type AS text))    AS discount_type_txt,
        TRIM(CAST(value AS text))            AS value_txt,
        TRIM(REPLACE(CAST(valid_from AS text), E'\r','')) AS valid_from_txt,
        TRIM(REPLACE(CAST(valid_to   AS text), E'\r','')) AS valid_to_txt
    FROM "postgres"."raw"."discount_rules"
),
norm AS (
    SELECT
        NULLIF(rule_id_txt, '')          AS rule_id_clean,
        NULLIF(product_id_txt, '')       AS product_id_clean,
        NULLIF(discount_type_txt, '')    AS discount_type_clean,
        NULLIF(value_txt, '')            AS value_clean,
        NULLIF(valid_from_txt, '')       AS valid_from_clean,
        NULLIF(valid_to_txt, '')         AS valid_to_clean
    FROM src
),
typed AS (
    SELECT
        CASE WHEN rule_id_clean    ~ '^[0-9]+$'               THEN rule_id_clean::integer END          AS rule_id,
        CASE WHEN product_id_clean ~ '^[0-9]+$'               THEN product_id_clean::integer END       AS product_id,

        -- bỏ (?i) -> dùng ~* để so khớp không phân biệt hoa thường
        CASE WHEN discount_type_clean ~* '^(na|n/a)$' THEN NULL
             ELSE lower(discount_type_clean) END                                                            AS discount_type,

        CASE WHEN value_clean ~* '^(na|n/a)$' THEN NULL
             WHEN value_clean ~ '^[0-9]+(\.[0-9]+)?$' THEN value_clean::numeric
             ELSE NULL END                                                                                  AS value,

        CASE WHEN valid_from_clean ~* '^(na|n/a)$' THEN NULL
             WHEN valid_from_clean ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
                  THEN to_timestamp(replace(valid_from_clean,'-','/'),'YYYY/FMMM/FMDD')
             ELSE NULL END                                                                                  AS valid_from,

        CASE WHEN valid_to_clean ~* '^(na|n/a)$' THEN NULL
             WHEN valid_to_clean ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
                  THEN to_timestamp(replace(valid_to_clean,'-','/'),'YYYY/FMMM/FMDD')
             ELSE NULL END                                                                                  AS valid_to
    FROM norm
),
staging_data AS (
    SELECT rule_id, product_id, discount_type, value, valid_from, valid_to
    FROM typed
    WHERE rule_id IS NOT NULL
      AND product_id IS NOT NULL
      AND discount_type IS NOT NULL
      AND value IS NOT NULL
      AND valid_from IS NOT NULL
      AND valid_to   IS NOT NULL
      AND valid_from < valid_to
)
SELECT * FROM staging_data
  );
[0m03:15:22.004426 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.customers" does not exist
LINE 17:     FROM "postgres"."raw"."customers"
                  ^

[0m03:15:22.004943 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: ROLLBACK
[0m03:15:22.011295 [debug] [Thread-3 (]: SQL status: BEGIN in 2.023 seconds
[0m03:15:22.011768 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_employees"
[0m03:15:22.012101 [debug] [Thread-3 (]: On model.retail_dbt.stg_employees: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_employees"} */

  create view "postgres"."silver_staging"."stg_employees__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(employee_id AS text)) AS employee_id_txt,
        TRIM(CAST(name        AS text)) AS name_txt,
        TRIM(CAST(role        AS text)) AS role_txt,
        TRIM(CAST(store_id    AS text)) AS store_id_txt
    FROM "postgres"."raw"."employees"
),

filtered AS (
    SELECT *
    FROM src
    WHERE employee_id_txt IS NOT NULL AND employee_id_txt <> '' AND lower(employee_id_txt) NOT IN ('na','n/a')
      AND name_txt        IS NOT NULL AND name_txt <> ''        AND lower(name_txt)        NOT IN ('na','n/a')
      AND role_txt        IS NOT NULL AND role_txt <> ''        AND lower(role_txt)        NOT IN ('na','n/a')
      AND store_id_txt    IS NOT NULL AND store_id_txt <> ''    AND lower(store_id_txt)    NOT IN ('na','n/a')
),

typed AS (
    SELECT
        CAST(employee_id_txt AS integer) AS employee_id,
        name_txt  AS name,
        role_txt  AS role,
        CAST(store_id_txt AS integer)    AS store_id
    FROM filtered
)

SELECT *
FROM typed
  );
[0m03:15:22.032893 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.discount_rules" does not exist
LINE 17:     FROM "postgres"."raw"."discount_rules"
                  ^

[0m03:15:22.033410 [debug] [Thread-4 (]: On model.retail_dbt.stg_discount_rules: ROLLBACK
[0m03:15:22.222560 [debug] [Thread-2 (]: On model.retail_dbt.stg_customers: Close
[0m03:15:22.224465 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "raw.customers" does not exist
  LINE 17:     FROM "postgres"."raw"."customers"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_customers.sql
[0m03:15:22.224902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e95792de0>]}
[0m03:15:22.225482 [error] [Thread-2 (]: 5 of 23 ERROR creating sql view model silver_staging.stg_customers ............. [[31mERROR[0m in 2.49s]
[0m03:15:22.226011 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_customers
[0m03:15:22.226353 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_loyalty_programs
[0m03:15:22.226812 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "raw.customers" does not exist
  LINE 17:     FROM "postgres"."raw"."customers"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_customers.sql.
[0m03:15:22.227285 [info ] [Thread-2 (]: 9 of 23 START sql view model silver_staging.stg_loyalty_programs ............... [RUN]
[0m03:15:22.227964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_customers, now model.retail_dbt.stg_loyalty_programs)
[0m03:15:22.228251 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_loyalty_programs
[0m03:15:22.231112 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_loyalty_programs"
[0m03:15:22.231606 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_loyalty_programs
[0m03:15:22.234470 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_loyalty_programs"
[0m03:15:22.234938 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m03:15:22.235244 [debug] [Thread-2 (]: On model.retail_dbt.stg_loyalty_programs: BEGIN
[0m03:15:22.235517 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:15:22.240715 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.employees" does not exist
LINE 15:     FROM "postgres"."raw"."employees"
                  ^

[0m03:15:22.241143 [debug] [Thread-3 (]: On model.retail_dbt.stg_employees: ROLLBACK
[0m03:15:22.271204 [debug] [Thread-4 (]: On model.retail_dbt.stg_discount_rules: Close
[0m03:15:22.273109 [debug] [Thread-4 (]: Database Error in model stg_discount_rules (models/staging/stg_discount_rules.sql)
  relation "raw.discount_rules" does not exist
  LINE 17:     FROM "postgres"."raw"."discount_rules"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_discount_rules.sql
[0m03:15:22.273539 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e973042c0>]}
[0m03:15:22.274033 [error] [Thread-4 (]: 6 of 23 ERROR creating sql view model silver_staging.stg_discount_rules ........ [[31mERROR[0m in 2.53s]
[0m03:15:22.274530 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_discount_rules
[0m03:15:22.275143 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_payments
[0m03:15:22.275618 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_discount_rules' to be skipped because of status 'error'.  Reason: Database Error in model stg_discount_rules (models/staging/stg_discount_rules.sql)
  relation "raw.discount_rules" does not exist
  LINE 17:     FROM "postgres"."raw"."discount_rules"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_discount_rules.sql.
[0m03:15:22.276236 [info ] [Thread-4 (]: 10 of 23 START sql view model silver_staging.stg_payments ...................... [RUN]
[0m03:15:22.276930 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_discount_rules, now model.retail_dbt.stg_payments)
[0m03:15:22.277390 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_payments
[0m03:15:22.280309 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_payments"
[0m03:15:22.280803 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_payments
[0m03:15:22.283296 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_payments"
[0m03:15:22.283769 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m03:15:22.284095 [debug] [Thread-4 (]: On model.retail_dbt.stg_payments: BEGIN
[0m03:15:22.284405 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:15:22.462904 [debug] [Thread-3 (]: On model.retail_dbt.stg_employees: Close
[0m03:15:22.464857 [debug] [Thread-3 (]: Database Error in model stg_employees (models/staging/stg_employees.sql)
  relation "raw.employees" does not exist
  LINE 15:     FROM "postgres"."raw"."employees"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_employees.sql
[0m03:15:22.465345 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e95572300>]}
[0m03:15:22.465873 [error] [Thread-3 (]: 7 of 23 ERROR creating sql view model silver_staging.stg_employees ............. [[31mERROR[0m in 2.49s]
[0m03:15:22.466394 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_employees
[0m03:15:22.466737 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_pricing_history
[0m03:15:22.467161 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_employees' to be skipped because of status 'error'.  Reason: Database Error in model stg_employees (models/staging/stg_employees.sql)
  relation "raw.employees" does not exist
  LINE 15:     FROM "postgres"."raw"."employees"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_employees.sql.
[0m03:15:22.467626 [info ] [Thread-3 (]: 11 of 23 START sql view model silver_staging.stg_pricing_history ............... [RUN]
[0m03:15:22.468231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_employees, now model.retail_dbt.stg_pricing_history)
[0m03:15:22.468541 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_pricing_history
[0m03:15:22.471242 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_pricing_history"
[0m03:15:22.471780 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_pricing_history
[0m03:15:22.475086 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_pricing_history"
[0m03:15:22.475573 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m03:15:22.475858 [debug] [Thread-3 (]: On model.retail_dbt.stg_pricing_history: BEGIN
[0m03:15:22.476131 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:15:22.737427 [debug] [Thread-1 (]: SQL status: BEGIN in 2.582 seconds
[0m03:15:22.737961 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_inventory"
[0m03:15:22.738365 [debug] [Thread-1 (]: On model.retail_dbt.stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_inventory"} */

  create view "postgres"."silver_staging"."stg_inventory__dbt_tmp"
    
    
  as (
    

with source as (
    select * 
    from "postgres"."raw"."inventory"
),

cleaned as (
    select
        case 
            when inventory_id is null or trim(lower(inventory_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(inventory_id as integer) 
        end as inventory_id,

        case 
            when store_id is null or trim(lower(store_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(store_id as integer) 
        end as store_id,

        case 
            when product_id is null or trim(lower(product_id)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(product_id as integer) 
        end as product_id,

        case 
            when quantity is null or trim(lower(quantity)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(quantity as integer) 
        end as quantity,

        case 
            when last_updated is null or trim(lower(last_updated)) in ('', 'null', 'na', 'n/a', 'none') 
            then null else cast(last_updated as timestamp) 
        end as last_updated
    from source
),

filtered as (
    select *
    from cleaned
    where 
        inventory_id is not null
        and store_id is not null
        and product_id is not null
        and quantity is not null
        and last_updated is not null
        and quantity <> 0
        and cast(last_updated as date) <= date('2025-08-22')
)

select * from filtered
  );
[0m03:15:23.017158 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.inventory" does not exist
LINE 11:     from "postgres"."raw"."inventory"
                  ^

[0m03:15:23.017648 [debug] [Thread-1 (]: On model.retail_dbt.stg_inventory: ROLLBACK
[0m03:15:23.294907 [debug] [Thread-1 (]: On model.retail_dbt.stg_inventory: Close
[0m03:15:23.296856 [debug] [Thread-1 (]: Database Error in model stg_inventory (models/staging/stg_inventory.sql)
  relation "raw.inventory" does not exist
  LINE 11:     from "postgres"."raw"."inventory"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_inventory.sql
[0m03:15:23.297263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9551c200>]}
[0m03:15:23.297842 [error] [Thread-1 (]: 8 of 23 ERROR creating sql view model silver_staging.stg_inventory ............. [[31mERROR[0m in 3.20s]
[0m03:15:23.298366 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_inventory
[0m03:15:23.298741 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_products
[0m03:15:23.299197 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_inventory' to be skipped because of status 'error'.  Reason: Database Error in model stg_inventory (models/staging/stg_inventory.sql)
  relation "raw.inventory" does not exist
  LINE 11:     from "postgres"."raw"."inventory"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_inventory.sql.
[0m03:15:23.299741 [info ] [Thread-1 (]: 12 of 23 START sql view model silver_staging.stg_products ...................... [RUN]
[0m03:15:23.300463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_inventory, now model.retail_dbt.stg_products)
[0m03:15:23.300898 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_products
[0m03:15:23.304029 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_products"
[0m03:15:23.304540 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_products
[0m03:15:23.306904 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_products"
[0m03:15:23.307366 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m03:15:23.307661 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: BEGIN
[0m03:15:23.307929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:24.765366 [debug] [Thread-2 (]: SQL status: BEGIN in 2.530 seconds
[0m03:15:24.765841 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_loyalty_programs"
[0m03:15:24.766242 [debug] [Thread-2 (]: On model.retail_dbt.stg_loyalty_programs: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_loyalty_programs"} */

  create view "postgres"."silver_staging"."stg_loyalty_programs__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(loyalty_program_id AS text)) AS loyalty_program_id_txt,
        TRIM(CAST(name               AS text)) AS name_txt,
        TRIM(CAST(points_per_dollar  AS text)) AS points_per_dollar_txt
    FROM "postgres"."raw"."loyalty_programs"
),


filtered AS (
    SELECT *
    FROM src
    WHERE loyalty_program_id_txt IS NOT NULL AND loyalty_program_id_txt <> '' AND lower(loyalty_program_id_txt) NOT IN ('na','n/a')
      AND name_txt               IS NOT NULL AND name_txt               <> '' AND lower(name_txt)               NOT IN ('na','n/a')
      AND points_per_dollar_txt  IS NOT NULL AND points_per_dollar_txt  <> '' AND lower(points_per_dollar_txt)  NOT IN ('na','n/a')
),

typed AS (
    SELECT
        
        CASE
          WHEN loyalty_program_id_txt ~ '^\s*\d+\s*$' THEN loyalty_program_id_txt::integer
        END AS loyalty_program_id,

        name_txt AS name,

        CASE
          WHEN points_per_dollar_txt ~ '^\s*\d+\s*$' THEN points_per_dollar_txt::integer
        END AS points_per_dollar
    FROM filtered
)

SELECT loyalty_program_id, name, points_per_dollar
FROM typed
WHERE loyalty_program_id IS NOT NULL
  AND name IS NOT NULL
  AND points_per_dollar IS NOT NULL
  );
[0m03:15:24.790497 [debug] [Thread-3 (]: SQL status: BEGIN in 2.314 seconds
[0m03:15:24.791004 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_pricing_history"
[0m03:15:24.791348 [debug] [Thread-3 (]: On model.retail_dbt.stg_pricing_history: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_pricing_history"} */

  create view "postgres"."silver_staging"."stg_pricing_history__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(history_id     AS text)) AS history_id_txt,
        TRIM(CAST(product_id     AS text)) AS product_id_txt,
        TRIM(CAST(price          AS text)) AS price_txt,
        TRIM(REPLACE(CAST(effective_date AS text), E'\r','')) AS effective_date_txt
    FROM "postgres"."raw"."pricing_history"
),

typed AS (
    SELECT
        
        CASE WHEN history_id_txt ~ '^\d+$'  THEN history_id_txt::integer  END AS history_id,
        CASE WHEN product_id_txt ~ '^\d+$'  THEN product_id_txt::integer  END AS product_id,

        
        CASE WHEN price_txt ~ '^-?\d+(\.\d+)?$' THEN price_txt::numeric END AS price,

        
        CASE
          WHEN effective_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(effective_date_txt, '-', '/'),'YYYY/FMMM/FMDD')::date
          ELSE NULL
        END AS effective_date
    FROM src
)

SELECT
    history_id,
    product_id,
    price,
    effective_date
FROM typed
WHERE price IS NOT NULL
  AND price > 0
  AND effective_date IS NOT NULL
  AND effective_date <= CURRENT_DATE
  );
[0m03:15:24.804676 [debug] [Thread-4 (]: SQL status: BEGIN in 2.520 seconds
[0m03:15:24.805133 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_payments"
[0m03:15:24.805610 [debug] [Thread-4 (]: On model.retail_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_payments"} */

  create view "postgres"."silver_staging"."stg_payments__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(payment_id AS text))                 AS payment_id_txt,
        TRIM(CAST(method     AS text))                 AS method,
        TRIM(CAST(status     AS text))                 AS status,
        TRIM(REPLACE(CAST(paid_at AS text), E'\r','')) AS paid_at_txt
    FROM "postgres"."raw"."payments"
),

typed AS (
    SELECT
        
        CASE WHEN payment_id_txt ~ '^\s*\d+\s*$' THEN payment_id_txt::integer END AS payment_id,
        method,
        status,

        
        CASE
          WHEN paid_at_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(paid_at_txt,'-','/'),'YYYY/FMMM/FMDD')
          ELSE NULL
        END AS paid_at
    FROM src
)

SELECT
    payment_id,
    method,
    status,
    paid_at
FROM typed
WHERE paid_at IS NOT NULL
  AND paid_at <= to_timestamp('2025/08/22','YYYY/MM/DD')
  );
[0m03:15:25.014595 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.loyalty_programs" does not exist
LINE 14:     FROM "postgres"."raw"."loyalty_programs"
                  ^

[0m03:15:25.015126 [debug] [Thread-2 (]: On model.retail_dbt.stg_loyalty_programs: ROLLBACK
[0m03:15:25.042266 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.pricing_history" does not exist
LINE 15:     FROM "postgres"."raw"."pricing_history"
                  ^

[0m03:15:25.042836 [debug] [Thread-3 (]: On model.retail_dbt.stg_pricing_history: ROLLBACK
[0m03:15:25.058764 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.payments" does not exist
LINE 15:     FROM "postgres"."raw"."payments"
                  ^

[0m03:15:25.059285 [debug] [Thread-4 (]: On model.retail_dbt.stg_payments: ROLLBACK
[0m03:15:25.261453 [debug] [Thread-2 (]: On model.retail_dbt.stg_loyalty_programs: Close
[0m03:15:25.264044 [debug] [Thread-2 (]: Database Error in model stg_loyalty_programs (models/staging/stg_loyalty_programs.sql)
  relation "raw.loyalty_programs" does not exist
  LINE 14:     FROM "postgres"."raw"."loyalty_programs"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_loyalty_programs.sql
[0m03:15:25.264506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e95592f90>]}
[0m03:15:25.265062 [error] [Thread-2 (]: 9 of 23 ERROR creating sql view model silver_staging.stg_loyalty_programs ...... [[31mERROR[0m in 3.04s]
[0m03:15:25.265636 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_loyalty_programs
[0m03:15:25.266052 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_promotions
[0m03:15:25.266545 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_loyalty_programs' to be skipped because of status 'error'.  Reason: Database Error in model stg_loyalty_programs (models/staging/stg_loyalty_programs.sql)
  relation "raw.loyalty_programs" does not exist
  LINE 14:     FROM "postgres"."raw"."loyalty_programs"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_loyalty_programs.sql.
[0m03:15:25.267205 [info ] [Thread-2 (]: 13 of 23 START sql view model silver_staging.stg_promotions .................... [RUN]
[0m03:15:25.267978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_loyalty_programs, now model.retail_dbt.stg_promotions)
[0m03:15:25.268297 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_promotions
[0m03:15:25.271722 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_promotions"
[0m03:15:25.272260 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_promotions
[0m03:15:25.275110 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_promotions"
[0m03:15:25.275632 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m03:15:25.275953 [debug] [Thread-2 (]: On model.retail_dbt.stg_promotions: BEGIN
[0m03:15:25.276233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:15:25.292270 [debug] [Thread-3 (]: On model.retail_dbt.stg_pricing_history: Close
[0m03:15:25.294190 [debug] [Thread-3 (]: Database Error in model stg_pricing_history (models/staging/stg_pricing_history.sql)
  relation "raw.pricing_history" does not exist
  LINE 15:     FROM "postgres"."raw"."pricing_history"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_pricing_history.sql
[0m03:15:25.294599 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9551f7a0>]}
[0m03:15:25.295093 [error] [Thread-3 (]: 11 of 23 ERROR creating sql view model silver_staging.stg_pricing_history ...... [[31mERROR[0m in 2.83s]
[0m03:15:25.295549 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_pricing_history
[0m03:15:25.295883 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_purchase_orders
[0m03:15:25.296288 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_pricing_history' to be skipped because of status 'error'.  Reason: Database Error in model stg_pricing_history (models/staging/stg_pricing_history.sql)
  relation "raw.pricing_history" does not exist
  LINE 15:     FROM "postgres"."raw"."pricing_history"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_pricing_history.sql.
[0m03:15:25.296730 [info ] [Thread-3 (]: 14 of 23 START sql view model silver_staging.stg_purchase_orders ............... [RUN]
[0m03:15:25.297367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_pricing_history, now model.retail_dbt.stg_purchase_orders)
[0m03:15:25.297756 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_purchase_orders
[0m03:15:25.300822 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_purchase_orders"
[0m03:15:25.301443 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_purchase_orders
[0m03:15:25.305032 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_purchase_orders"
[0m03:15:25.305544 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m03:15:25.305836 [debug] [Thread-3 (]: On model.retail_dbt.stg_purchase_orders: BEGIN
[0m03:15:25.306134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:15:25.310192 [debug] [Thread-4 (]: On model.retail_dbt.stg_payments: Close
[0m03:15:25.312454 [debug] [Thread-4 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "raw.payments" does not exist
  LINE 15:     FROM "postgres"."raw"."payments"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_payments.sql
[0m03:15:25.312933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e944595e0>]}
[0m03:15:25.313566 [error] [Thread-4 (]: 10 of 23 ERROR creating sql view model silver_staging.stg_payments ............. [[31mERROR[0m in 3.04s]
[0m03:15:25.314230 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_payments
[0m03:15:25.314655 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_returns
[0m03:15:25.315149 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "raw.payments" does not exist
  LINE 15:     FROM "postgres"."raw"."payments"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_payments.sql.
[0m03:15:25.315606 [info ] [Thread-4 (]: 15 of 23 START sql view model silver_staging.stg_returns ....................... [RUN]
[0m03:15:25.316309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_payments, now model.retail_dbt.stg_returns)
[0m03:15:25.316739 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_returns
[0m03:15:25.320831 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_returns"
[0m03:15:25.321573 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_returns
[0m03:15:25.325316 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_returns"
[0m03:15:25.326081 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m03:15:25.326548 [debug] [Thread-4 (]: On model.retail_dbt.stg_returns: BEGIN
[0m03:15:25.326951 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:15:25.698085 [debug] [Thread-1 (]: SQL status: BEGIN in 2.390 seconds
[0m03:15:25.698606 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_products"
[0m03:15:25.699109 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_products"} */

  create view "postgres"."silver_staging"."stg_products__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    TRIM(CAST(product_id  AS text)) AS product_id_txt,
    TRIM(CAST(name        AS text)) AS name_txt,
    TRIM(CAST(category_id AS text)) AS category_id_txt,
    TRIM(CAST(brand_id    AS text)) AS brand_id_txt,
    TRIM(CAST(supplier_id AS text)) AS supplier_id_txt,
    TRIM(CAST(price       AS text)) AS price_txt,
    TRIM(REPLACE(CAST(created_at AS text), E'\r','')) AS created_at_txt,
    -- 👇 loại \r,\n,\t và collapse space cho season
    TRIM(REGEXP_REPLACE(REPLACE(CAST(season AS text), E'\r',''), '\s+', ' ', 'g')) AS season_txt
  FROM "postgres"."raw"."products"
),

typed AS (
  SELECT
    CASE WHEN product_id_txt  ~ '^\d+$'          THEN product_id_txt::integer  END AS product_id,
    NULLIF(name_txt,'')                                 AS name,
    CASE WHEN category_id_txt ~ '^\d+$'          THEN category_id_txt::integer END AS category_id,
    CASE WHEN brand_id_txt    ~ '^\d+$'          THEN brand_id_txt::integer    END AS brand_id,
    CASE WHEN supplier_id_txt ~ '^\d+$'          THEN supplier_id_txt::integer END AS supplier_id,
    CASE WHEN price_txt       ~ '^\d+(\.\d+)?$'  THEN price_txt::numeric       END AS price,
    CASE
      WHEN created_at_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
      THEN to_timestamp(replace(created_at_txt,'-','/'),'YYYY/FMMM/FMDD')::date
    END AS created_at,

    
    CASE
      WHEN lower(season_txt) ~ '^spring$'                    THEN 'Spring'
      WHEN lower(season_txt) ~ '^summer$'                    THEN 'Summer'
      WHEN lower(season_txt) ~ '^(fall|autumn)$'             THEN 'Fall'
      WHEN lower(season_txt) ~ '^winter$'                    THEN 'Winter'
      WHEN lower(season_txt) ~ '^all[ _-]?year$'             THEN 'All Year'
      ELSE NULL
    END AS season
  FROM src
)

SELECT product_id, name, category_id, brand_id, supplier_id, price, created_at, season
FROM typed
WHERE price IS NOT NULL
  AND created_at IS NOT NULL
  AND created_at < '2025-08-22'
  );
[0m03:15:25.963330 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.products" does not exist
LINE 20:   FROM "postgres"."raw"."products"
                ^

[0m03:15:25.963991 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: ROLLBACK
[0m03:15:26.227159 [debug] [Thread-1 (]: On model.retail_dbt.stg_products: Close
[0m03:15:26.229149 [debug] [Thread-1 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  relation "raw.products" does not exist
  LINE 20:   FROM "postgres"."raw"."products"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_products.sql
[0m03:15:26.229630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e95534260>]}
[0m03:15:26.230158 [error] [Thread-1 (]: 12 of 23 ERROR creating sql view model silver_staging.stg_products ............. [[31mERROR[0m in 2.93s]
[0m03:15:26.230708 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_products
[0m03:15:26.231099 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_sales_items
[0m03:15:26.231544 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models/staging/stg_products.sql)
  relation "raw.products" does not exist
  LINE 20:   FROM "postgres"."raw"."products"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_products.sql.
[0m03:15:26.231999 [info ] [Thread-1 (]: 16 of 23 START sql view model silver_staging.stg_sales_items ................... [RUN]
[0m03:15:26.232760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_products, now model.retail_dbt.stg_sales_items)
[0m03:15:26.233085 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_sales_items
[0m03:15:26.235875 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_sales_items"
[0m03:15:26.236357 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_sales_items
[0m03:15:26.238989 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_sales_items"
[0m03:15:26.239480 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m03:15:26.239759 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_items: BEGIN
[0m03:15:26.240062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:27.387885 [debug] [Thread-3 (]: SQL status: BEGIN in 2.082 seconds
[0m03:15:27.388369 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_purchase_orders"
[0m03:15:27.388711 [debug] [Thread-3 (]: On model.retail_dbt.stg_purchase_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_purchase_orders"} */

  create view "postgres"."silver_staging"."stg_purchase_orders__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(order_id AS text))       AS order_id_txt,
        TRIM(CAST(supplier_id AS text))    AS supplier_id_txt,
        TRIM(CAST(order_date AS text))     AS order_date_txt,
        TRIM(CAST(status AS text))         AS status_txt
    FROM "postgres"."raw"."purchase_orders"
),

typed AS (
    SELECT
        CASE WHEN order_id_txt ~ '^\d+$' THEN order_id_txt::int END        AS order_id,
        CASE WHEN supplier_id_txt ~ '^\d+$' THEN supplier_id_txt::int END  AS supplier_id,

        CASE
          WHEN order_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(order_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS order_date,

        NULLIF(NULLIF(lower(status_txt),'na'),'') AS status_clean
    FROM src
)

SELECT
    order_id,
    supplier_id,
    order_date,
    initcap(status_clean) AS status
FROM typed
WHERE order_id IS NOT NULL
  AND supplier_id IS NOT NULL
  AND order_date IS NOT NULL
  AND status_clean IS NOT NULL
  AND order_date <= DATE '2025-08-22'
  );
[0m03:15:27.614621 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.purchase_orders" does not exist
LINE 15:     FROM "postgres"."raw"."purchase_orders"
                  ^

[0m03:15:27.615039 [debug] [Thread-3 (]: On model.retail_dbt.stg_purchase_orders: ROLLBACK
[0m03:15:27.703673 [debug] [Thread-4 (]: SQL status: BEGIN in 2.377 seconds
[0m03:15:27.704162 [debug] [Thread-2 (]: SQL status: BEGIN in 2.428 seconds
[0m03:15:27.704549 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_returns"
[0m03:15:27.704932 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_promotions"
[0m03:15:27.705400 [debug] [Thread-4 (]: On model.retail_dbt.stg_returns: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_returns"} */

  create view "postgres"."silver_staging"."stg_returns__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(return_id   AS text))                               AS return_id_txt,
        TRIM(CAST(item_id     AS text))                               AS item_id_txt,
    
        TRIM(REGEXP_REPLACE(REPLACE(CAST(reason AS text), E'\r',''), '\s+', ' ', 'g')) AS reason_txt,
        
        TRIM(REPLACE(CAST(return_date AS text), E'\r',''))            AS return_date_txt
    FROM "postgres"."raw"."returns"
),

typed AS (
    SELECT
        CASE WHEN return_id_txt ~ '^\d+$' THEN return_id_txt::int END AS return_id,
        CASE WHEN item_id_txt   ~ '^\d+$' THEN item_id_txt::int   END AS item_id,

        CASE
          WHEN reason_txt IS NULL OR reason_txt = '' THEN NULL
          WHEN lower(reason_txt) IN ('na','n/a') THEN NULL
          ELSE reason_txt
        END AS reason,

        CASE
          WHEN return_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(return_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS return_date
    FROM src
)

SELECT
    return_id,
    item_id,
    reason,
    return_date
FROM typed
WHERE return_id   IS NOT NULL
  AND item_id     IS NOT NULL
  AND reason      IS NOT NULL
  AND return_date IS NOT NULL
  AND return_date <= DATE '2025-08-22'
  );
[0m03:15:27.705863 [debug] [Thread-2 (]: On model.retail_dbt.stg_promotions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_promotions"} */

  create view "postgres"."silver_staging"."stg_promotions__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        TRIM(CAST(promotion_id AS text))                       AS promotion_id_txt,
        TRIM(CAST(name AS text))                               AS name_txt,
        TRIM(REPLACE(CAST(start_date AS text), E'\r',''))      AS start_date_txt,
        TRIM(REPLACE(CAST(end_date   AS text), E'\r',''))      AS end_date_txt
    FROM "postgres"."raw"."promotions"
),

typed AS (
    SELECT
        
        CASE WHEN promotion_id_txt ~ '^\d+$' THEN promotion_id_txt::int END AS promotion_id,

        
        NULLIF(NULLIF(lower(name_txt),'na'),'') AS name_clean,

        
        CASE
          WHEN start_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(start_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS start_date,

        CASE
          WHEN end_date_txt ~ '^[0-9]{4}[-/](0?[1-9]|1[0-2])[-/](0?[1-9]|[12][0-9]|3[01])$'
          THEN to_timestamp(replace(end_date_txt,'-','/'),'YYYY/FMMM/FMDD')::date
        END AS end_date
    FROM src
)

SELECT
    promotion_id,
    initcap(name_clean) AS name,
    start_date,
    end_date
FROM typed
WHERE promotion_id IS NOT NULL
  AND name_clean  IS NOT NULL
  AND start_date  IS NOT NULL
  AND end_date    IS NOT NULL
  AND start_date  < end_date
  );
[0m03:15:27.841602 [debug] [Thread-3 (]: On model.retail_dbt.stg_purchase_orders: Close
[0m03:15:27.843623 [debug] [Thread-3 (]: Database Error in model stg_purchase_orders (models/staging/stg_purchase_orders.sql)
  relation "raw.purchase_orders" does not exist
  LINE 15:     FROM "postgres"."raw"."purchase_orders"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_purchase_orders.sql
[0m03:15:27.844096 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e944c75c0>]}
[0m03:15:27.844634 [error] [Thread-3 (]: 14 of 23 ERROR creating sql view model silver_staging.stg_purchase_orders ...... [[31mERROR[0m in 2.55s]
[0m03:15:27.845226 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_purchase_orders
[0m03:15:27.845597 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_sales_transactions
[0m03:15:27.846063 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_purchase_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_purchase_orders (models/staging/stg_purchase_orders.sql)
  relation "raw.purchase_orders" does not exist
  LINE 15:     FROM "postgres"."raw"."purchase_orders"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_purchase_orders.sql.
[0m03:15:27.846643 [info ] [Thread-3 (]: 17 of 23 START sql view model silver_staging.stg_sales_transactions ............ [RUN]
[0m03:15:27.847326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_purchase_orders, now model.retail_dbt.stg_sales_transactions)
[0m03:15:27.847717 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_sales_transactions
[0m03:15:27.850744 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_sales_transactions"
[0m03:15:27.851221 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_sales_transactions
[0m03:15:27.853804 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_sales_transactions"
[0m03:15:27.854294 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m03:15:27.854578 [debug] [Thread-3 (]: On model.retail_dbt.stg_sales_transactions: BEGIN
[0m03:15:27.854851 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:15:27.971888 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.returns" does not exist
LINE 17:     FROM "postgres"."raw"."returns"
                  ^

[0m03:15:27.972416 [debug] [Thread-4 (]: On model.retail_dbt.stg_returns: ROLLBACK
[0m03:15:27.979021 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.promotions" does not exist
LINE 15:     FROM "postgres"."raw"."promotions"
                  ^

[0m03:15:27.979513 [debug] [Thread-2 (]: On model.retail_dbt.stg_promotions: ROLLBACK
[0m03:15:28.236512 [debug] [Thread-4 (]: On model.retail_dbt.stg_returns: Close
[0m03:15:28.238514 [debug] [Thread-4 (]: Database Error in model stg_returns (models/staging/stg_returns.sql)
  relation "raw.returns" does not exist
  LINE 17:     FROM "postgres"."raw"."returns"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_returns.sql
[0m03:15:28.238965 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e943175c0>]}
[0m03:15:28.239551 [error] [Thread-4 (]: 15 of 23 ERROR creating sql view model silver_staging.stg_returns .............. [[31mERROR[0m in 2.92s]
[0m03:15:28.240069 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_returns
[0m03:15:28.240450 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_shipments
[0m03:15:28.240884 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_returns' to be skipped because of status 'error'.  Reason: Database Error in model stg_returns (models/staging/stg_returns.sql)
  relation "raw.returns" does not exist
  LINE 17:     FROM "postgres"."raw"."returns"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_returns.sql.
[0m03:15:28.241500 [info ] [Thread-4 (]: 18 of 23 START sql view model silver_staging.stg_shipments ..................... [RUN]
[0m03:15:28.242172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_returns, now model.retail_dbt.stg_shipments)
[0m03:15:28.242506 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_shipments
[0m03:15:28.246032 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_shipments"
[0m03:15:28.246520 [debug] [Thread-2 (]: On model.retail_dbt.stg_promotions: Close
[0m03:15:28.247119 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_shipments
[0m03:15:28.250281 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_shipments"
[0m03:15:28.250865 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m03:15:28.251294 [debug] [Thread-4 (]: On model.retail_dbt.stg_shipments: BEGIN
[0m03:15:28.252281 [debug] [Thread-2 (]: Database Error in model stg_promotions (models/staging/stg_promotions.sql)
  relation "raw.promotions" does not exist
  LINE 15:     FROM "postgres"."raw"."promotions"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_promotions.sql
[0m03:15:28.252669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:15:28.253146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e95761430>]}
[0m03:15:28.253900 [error] [Thread-2 (]: 13 of 23 ERROR creating sql view model silver_staging.stg_promotions ........... [[31mERROR[0m in 2.99s]
[0m03:15:28.254644 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_promotions
[0m03:15:28.255074 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_stock_movements
[0m03:15:28.255552 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_promotions' to be skipped because of status 'error'.  Reason: Database Error in model stg_promotions (models/staging/stg_promotions.sql)
  relation "raw.promotions" does not exist
  LINE 15:     FROM "postgres"."raw"."promotions"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_promotions.sql.
[0m03:15:28.256045 [info ] [Thread-2 (]: 19 of 23 START sql view model silver_staging.stg_stock_movements ............... [RUN]
[0m03:15:28.256693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_promotions, now model.retail_dbt.stg_stock_movements)
[0m03:15:28.257122 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_stock_movements
[0m03:15:28.260156 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_stock_movements"
[0m03:15:28.260643 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_stock_movements
[0m03:15:28.262966 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_stock_movements"
[0m03:15:28.263440 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m03:15:28.263723 [debug] [Thread-2 (]: On model.retail_dbt.stg_stock_movements: BEGIN
[0m03:15:28.264007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:15:28.363377 [debug] [Thread-1 (]: SQL status: BEGIN in 2.123 seconds
[0m03:15:28.363871 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_sales_items"
[0m03:15:28.364338 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_items: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_items"} */

  create view "postgres"."silver_staging"."stg_sales_items__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."sales_items"
),

final as (
    select
        
        cast(item_id as int) as item_id,
        cast(transaction_id as int) as transaction_id,
        cast(product_id as int) as product_id,
        

        cast(quantity as int) as quantity,
        
        cast(unit_price as decimal(10,2)) as unit_price,
        cast(discount as decimal(10,2)) as discount,
        cast(tax as decimal(10,2)) as tax,
        
        cast(unit_price as decimal(10,2)) * cast(quantity as int) as gross_amount,
        (cast(unit_price as decimal(10,2)) * cast(quantity as int)) - 
         cast(discount as decimal(10,2)) + 
         cast(tax as decimal(10,2)) as net_amount,
        
        case 
            when cast(quantity as int) > 0 and cast(unit_price as decimal(10,2)) < 0 then 'invalid_positive_qty_negative_price'
            when cast(discount as decimal(10,2)) > cast(unit_price as decimal(10,2)) * cast(quantity as int) then 'discount_exceeds_gross'
            when cast(discount as decimal(10,2)) < 0 then 'negative_discount'
            when cast(tax as decimal(10,2)) < 0 then 'negative_tax'
            when cast(quantity as int) < 0 then 'negative_quantity'
            else 'valid'
        end as business_validation_flag
        
    from source_data
    
    -- Basic validation + Business logic validation
    where item_id is not null
        and transaction_id is not null  
        and product_id is not null
        and quantity is not null
        and unit_price is not null
        and discount is not null
        and tax is not null
        -- Business rules
        and cast(quantity as int) >= 0  -- No negative quantities
        and cast(discount as decimal(10,2)) >= 0  -- No negative discounts
        and cast(tax as decimal(10,2)) >= 0  -- No negative tax
        and cast(discount as decimal(10,2)) <= cast(unit_price as decimal(10,2)) * cast(quantity as int)  -- Discount can't exceed gross amount
        -- Allow unit_price = 0 for free items/samples
        and not (cast(quantity as int) > 0 and cast(unit_price as decimal(10,2)) < 0)  -- If quantity > 0, price can't be negative
)

select * from final
  );
[0m03:15:28.593185 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.sales_items" does not exist
LINE 10:     select * from "postgres"."raw"."sales_items"
                           ^

[0m03:15:28.593711 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_items: ROLLBACK
[0m03:15:28.821715 [debug] [Thread-1 (]: On model.retail_dbt.stg_sales_items: Close
[0m03:15:28.823883 [debug] [Thread-1 (]: Database Error in model stg_sales_items (models/staging/stg_sales_items.sql)
  relation "raw.sales_items" does not exist
  LINE 10:     select * from "postgres"."raw"."sales_items"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_sales_items.sql
[0m03:15:28.824373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e94459f40>]}
[0m03:15:28.824936 [error] [Thread-1 (]: 16 of 23 ERROR creating sql view model silver_staging.stg_sales_items .......... [[31mERROR[0m in 2.59s]
[0m03:15:28.825570 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_sales_items
[0m03:15:28.825966 [debug] [Thread-1 (]: Began running node model.retail_dbt.stg_store_visits
[0m03:15:28.826455 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_sales_items' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales_items (models/staging/stg_sales_items.sql)
  relation "raw.sales_items" does not exist
  LINE 10:     select * from "postgres"."raw"."sales_items"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_sales_items.sql.
[0m03:15:28.826884 [info ] [Thread-1 (]: 20 of 23 START sql view model silver_staging.stg_store_visits .................. [RUN]
[0m03:15:28.827512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_sales_items, now model.retail_dbt.stg_store_visits)
[0m03:15:28.827856 [debug] [Thread-1 (]: Began compiling node model.retail_dbt.stg_store_visits
[0m03:15:28.830999 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_dbt.stg_store_visits"
[0m03:15:28.831522 [debug] [Thread-1 (]: Began executing node model.retail_dbt.stg_store_visits
[0m03:15:28.834008 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_dbt.stg_store_visits"
[0m03:15:28.834478 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m03:15:28.834766 [debug] [Thread-1 (]: On model.retail_dbt.stg_store_visits: BEGIN
[0m03:15:28.835037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:29.898825 [debug] [Thread-3 (]: SQL status: BEGIN in 2.044 seconds
[0m03:15:29.899312 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_sales_transactions"
[0m03:15:29.899767 [debug] [Thread-3 (]: On model.retail_dbt.stg_sales_transactions: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_sales_transactions"} */

  create view "postgres"."silver_staging"."stg_sales_transactions__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."sales_transactions"
),

final as (
    select
        cast(transaction_id as int) as transaction_id,
        cast(customer_id as int) as customer_id,
        cast(store_id as int) as store_id,
        cast(employee_id as int) as employee_id,
        cast(transaction_date as timestamp) as transaction_date,
        case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end as total_amount,
        cast(payment_id as int) as payment_id
    from source_data
    where transaction_id is not null
        and customer_id is not null
        and store_id is not null
        and employee_id is not null
        and transaction_date is not null
        and case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end is not null
        and payment_id is not null
        and case
            when trim(upper(total_amount)) = 'N/A' then null
            else cast(total_amount as decimal(15,2))
        end != 0
        and transaction_id != 'N/A'
        and customer_id != 'N/A'
        and store_id != 'N/A'
        and employee_id != 'N/A'
        and payment_id != 'N/A'
)

select * from final
  );
[0m03:15:30.121953 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.sales_transactions" does not exist
LINE 10:     select * from "postgres"."raw"."sales_transactions"
                           ^

[0m03:15:30.122417 [debug] [Thread-3 (]: On model.retail_dbt.stg_sales_transactions: ROLLBACK
[0m03:15:30.234239 [debug] [Thread-2 (]: SQL status: BEGIN in 1.970 seconds
[0m03:15:30.234703 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_stock_movements"
[0m03:15:30.235191 [debug] [Thread-2 (]: On model.retail_dbt.stg_stock_movements: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stock_movements"} */

  create view "postgres"."silver_staging"."stg_stock_movements__dbt_tmp"
    
    
  as (
    


WITH src AS (
  SELECT
    TRIM(CAST(movement_id   AS text)) AS movement_id_txt,
    TRIM(CAST(product_id    AS text)) AS product_id_txt,
    TRIM(CAST(store_id      AS text)) AS store_id_txt,
    TRIM(CAST(movement_type AS text)) AS movement_type_txt,
    TRIM(CAST(quantity      AS text)) AS quantity_txt,
    TRIM(REPLACE(CAST(movement_date AS text), E'\r','')) AS movement_date_txt
  FROM "postgres"."raw"."stock_movements"
),


typed AS (
  SELECT
    CASE WHEN movement_id_txt  ~ '^\d+$' THEN movement_id_txt::int  END AS movement_id,
    CASE WHEN product_id_txt   ~ '^\d+$' THEN product_id_txt::int   END AS product_id,
    CASE WHEN store_id_txt     ~ '^\d+$' THEN store_id_txt::int     END AS store_id,

    CASE
      WHEN upper(TRIM(movement_type_txt)) IN ('IN','OUT','TRANSFER')
      THEN upper(TRIM(movement_type_txt))
      ELSE NULL
    END AS movement_type,

    CASE
      WHEN quantity_txt IS NULL OR quantity_txt = '' THEN NULL
      WHEN lower(quantity_txt) IN ('unknown','na','n/a') THEN NULL
      WHEN quantity_txt ~ '^-?\d+$' THEN quantity_txt::int
      ELSE NULL
    END AS quantity,

  
    CASE
      WHEN movement_date_txt ~ '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
      THEN to_date(movement_date_txt,'YYYY-MM-DD')
    END AS movement_date_raw,

    movement_date_txt
  FROM src
),


dated AS (
  SELECT
    movement_id, product_id, store_id, movement_type, quantity,
    CASE
      WHEN movement_date_raw IS NOT NULL
       AND to_char(movement_date_raw,'YYYY-MM-DD') = movement_date_txt
      THEN movement_date_raw
    END AS movement_date
  FROM typed
)

SELECT
  movement_id,
  product_id,
  store_id,
  movement_type,
  quantity,
  movement_date
FROM dated
WHERE movement_id   IS NOT NULL AND movement_id   > 0
  AND product_id    IS NOT NULL AND product_id    > 0
  AND store_id      IS NOT NULL AND store_id      > 0
  AND movement_type IS NOT NULL
  AND quantity      IS NOT NULL AND quantity      > 0
  AND movement_date IS NOT NULL
  AND movement_date <= DATE '2025-08-22'
  );
[0m03:15:30.346138 [debug] [Thread-3 (]: On model.retail_dbt.stg_sales_transactions: Close
[0m03:15:30.348482 [debug] [Thread-3 (]: Database Error in model stg_sales_transactions (models/staging/stg_sales_transactions.sql)
  relation "raw.sales_transactions" does not exist
  LINE 10:     select * from "postgres"."raw"."sales_transactions"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_sales_transactions.sql
[0m03:15:30.349132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9556b140>]}
[0m03:15:30.350201 [error] [Thread-3 (]: 17 of 23 ERROR creating sql view model silver_staging.stg_sales_transactions ... [[31mERROR[0m in 2.50s]
[0m03:15:30.351159 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_sales_transactions
[0m03:15:30.351686 [debug] [Thread-3 (]: Began running node model.retail_dbt.stg_stores
[0m03:15:30.352226 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_sales_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales_transactions (models/staging/stg_sales_transactions.sql)
  relation "raw.sales_transactions" does not exist
  LINE 10:     select * from "postgres"."raw"."sales_transactions"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_sales_transactions.sql.
[0m03:15:30.352906 [info ] [Thread-3 (]: 21 of 23 START sql view model silver_staging.stg_stores ........................ [RUN]
[0m03:15:30.353756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_sales_transactions, now model.retail_dbt.stg_stores)
[0m03:15:30.354215 [debug] [Thread-3 (]: Began compiling node model.retail_dbt.stg_stores
[0m03:15:30.356722 [debug] [Thread-3 (]: Writing injected SQL for node "model.retail_dbt.stg_stores"
[0m03:15:30.357245 [debug] [Thread-3 (]: Began executing node model.retail_dbt.stg_stores
[0m03:15:30.360484 [debug] [Thread-3 (]: Writing runtime sql for node "model.retail_dbt.stg_stores"
[0m03:15:30.360972 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m03:15:30.361366 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: BEGIN
[0m03:15:30.361673 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m03:15:30.459831 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.stock_movements" does not exist
LINE 18:   FROM "postgres"."raw"."stock_movements"
                ^

[0m03:15:30.460350 [debug] [Thread-2 (]: On model.retail_dbt.stg_stock_movements: ROLLBACK
[0m03:15:30.634166 [debug] [Thread-4 (]: SQL status: BEGIN in 2.381 seconds
[0m03:15:30.634610 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_shipments"
[0m03:15:30.634992 [debug] [Thread-4 (]: On model.retail_dbt.stg_shipments: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_shipments"} */

  create view "postgres"."silver_staging"."stg_shipments__dbt_tmp"
    
    
  as (
    

with source_data as (
    select * from "postgres"."raw"."shipments"
),

final as (
    select
        cast(shipment_id as int) as shipment_id,
        cast(order_id as int) as order_id,
        cast(store_id as int) as store_id,
        cast(shipped_date as timestamp) as shipped_date,
        cast(received_date as timestamp) as received_date
    from source_data
    where shipment_id is not null
        and order_id is not null
        and store_id is not null
        and shipped_date is not null
        and received_date is not null
        and shipped_date < received_date
        and shipped_date <= '2025-08-22 00:00:00'
        and received_date <= '2025-08-22 00:00:00'
        and shipment_id != 'N/A'
        and order_id != 'N/A'
        and store_id != 'N/A'
        and shipped_date != 'N/A'
        and received_date != 'N/A'
)

select * from final
  );
[0m03:15:30.680031 [debug] [Thread-2 (]: On model.retail_dbt.stg_stock_movements: Close
[0m03:15:30.681917 [debug] [Thread-2 (]: Database Error in model stg_stock_movements (models/staging/stg_stock_movements.sql)
  relation "raw.stock_movements" does not exist
  LINE 18:   FROM "postgres"."raw"."stock_movements"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_stock_movements.sql
[0m03:15:30.682303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e94476780>]}
[0m03:15:30.682824 [error] [Thread-2 (]: 19 of 23 ERROR creating sql view model silver_staging.stg_stock_movements ...... [[31mERROR[0m in 2.43s]
[0m03:15:30.683331 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_stock_movements
[0m03:15:30.683693 [debug] [Thread-2 (]: Began running node model.retail_dbt.stg_suppliers
[0m03:15:30.684128 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_stock_movements' to be skipped because of status 'error'.  Reason: Database Error in model stg_stock_movements (models/staging/stg_stock_movements.sql)
  relation "raw.stock_movements" does not exist
  LINE 18:   FROM "postgres"."raw"."stock_movements"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_stock_movements.sql.
[0m03:15:30.684568 [info ] [Thread-2 (]: 22 of 23 START sql view model silver_staging.stg_suppliers ..................... [RUN]
[0m03:15:30.685175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_stock_movements, now model.retail_dbt.stg_suppliers)
[0m03:15:30.685566 [debug] [Thread-2 (]: Began compiling node model.retail_dbt.stg_suppliers
[0m03:15:30.688146 [debug] [Thread-2 (]: Writing injected SQL for node "model.retail_dbt.stg_suppliers"
[0m03:15:30.688653 [debug] [Thread-2 (]: Began executing node model.retail_dbt.stg_suppliers
[0m03:15:30.691039 [debug] [Thread-2 (]: Writing runtime sql for node "model.retail_dbt.stg_suppliers"
[0m03:15:30.691488 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m03:15:30.691788 [debug] [Thread-2 (]: On model.retail_dbt.stg_suppliers: BEGIN
[0m03:15:30.692060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m03:15:30.894920 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.shipments" does not exist
LINE 10:     select * from "postgres"."raw"."shipments"
                           ^

[0m03:15:30.895351 [debug] [Thread-4 (]: On model.retail_dbt.stg_shipments: ROLLBACK
[0m03:15:31.161220 [debug] [Thread-4 (]: On model.retail_dbt.stg_shipments: Close
[0m03:15:31.163243 [debug] [Thread-4 (]: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  relation "raw.shipments" does not exist
  LINE 10:     select * from "postgres"."raw"."shipments"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_shipments.sql
[0m03:15:31.163695 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9430f290>]}
[0m03:15:31.164215 [error] [Thread-4 (]: 18 of 23 ERROR creating sql view model silver_staging.stg_shipments ............ [[31mERROR[0m in 2.92s]
[0m03:15:31.164714 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_shipments
[0m03:15:31.165092 [debug] [Thread-4 (]: Began running node model.retail_dbt.stg_tax_rules
[0m03:15:31.165534 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_shipments' to be skipped because of status 'error'.  Reason: Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  relation "raw.shipments" does not exist
  LINE 10:     select * from "postgres"."raw"."shipments"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_shipments.sql.
[0m03:15:31.166000 [info ] [Thread-4 (]: 23 of 23 START sql view model silver_staging.stg_tax_rules ..................... [RUN]
[0m03:15:31.166617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.retail_dbt.stg_shipments, now model.retail_dbt.stg_tax_rules)
[0m03:15:31.167029 [debug] [Thread-4 (]: Began compiling node model.retail_dbt.stg_tax_rules
[0m03:15:31.169700 [debug] [Thread-4 (]: Writing injected SQL for node "model.retail_dbt.stg_tax_rules"
[0m03:15:31.170173 [debug] [Thread-4 (]: Began executing node model.retail_dbt.stg_tax_rules
[0m03:15:31.172540 [debug] [Thread-4 (]: Writing runtime sql for node "model.retail_dbt.stg_tax_rules"
[0m03:15:31.173015 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m03:15:31.173312 [debug] [Thread-4 (]: On model.retail_dbt.stg_tax_rules: BEGIN
[0m03:15:31.173615 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m03:15:31.226284 [debug] [Thread-1 (]: SQL status: BEGIN in 2.391 seconds
[0m03:15:31.226741 [debug] [Thread-1 (]: Using postgres connection "model.retail_dbt.stg_store_visits"
[0m03:15:31.227113 [debug] [Thread-1 (]: On model.retail_dbt.stg_store_visits: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_store_visits"} */

  create view "postgres"."silver_staging"."stg_store_visits__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    TRIM(CAST(visit_id    AS text)) AS visit_id_txt,
    TRIM(CAST(customer_id AS text)) AS customer_id_txt,
    TRIM(CAST(store_id    AS text)) AS store_id_txt,
    TRIM(REPLACE(CAST(visit_date AS text), E'\r','')) AS visit_date_txt
  FROM "postgres"."raw"."store_visits"
),

typed AS (
  SELECT
    
    CASE WHEN visit_id_txt    ~ '^\d+$' THEN visit_id_txt::int    END AS visit_id,
    CASE WHEN customer_id_txt ~ '^\d+$' THEN customer_id_txt::int END AS customer_id,
    CASE WHEN store_id_txt    ~ '^\d+$' THEN store_id_txt::int    END AS store_id,

    
    CASE
      WHEN visit_date_txt ~ '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$'
      THEN to_date(visit_date_txt,'YYYY-MM-DD')
    END AS visit_date_raw,

    visit_date_txt
  FROM src
),


validated AS (
  SELECT
    visit_id, customer_id, store_id,
    CASE
      WHEN visit_date_raw IS NOT NULL
       AND to_char(visit_date_raw,'YYYY-MM-DD') = visit_date_txt
      THEN visit_date_raw
    END AS visit_date
  FROM typed
)

SELECT
  visit_id,
  customer_id,
  store_id,
  visit_date
FROM validated
WHERE visit_id    IS NOT NULL
  AND customer_id IS NOT NULL
  AND store_id    IS NOT NULL
  AND visit_date  IS NOT NULL
  AND visit_date <= DATE '2025-08-22'
  );
[0m03:15:31.492886 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.store_visits" does not exist
LINE 15:   FROM "postgres"."raw"."store_visits"
                ^

[0m03:15:31.493355 [debug] [Thread-1 (]: On model.retail_dbt.stg_store_visits: ROLLBACK
[0m03:15:31.757920 [debug] [Thread-1 (]: On model.retail_dbt.stg_store_visits: Close
[0m03:15:31.759913 [debug] [Thread-1 (]: Database Error in model stg_store_visits (models/staging/stg_store_visits.sql)
  relation "raw.store_visits" does not exist
  LINE 15:   FROM "postgres"."raw"."store_visits"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_store_visits.sql
[0m03:15:31.760365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9430cd10>]}
[0m03:15:31.760908 [error] [Thread-1 (]: 20 of 23 ERROR creating sql view model silver_staging.stg_store_visits ......... [[31mERROR[0m in 2.93s]
[0m03:15:31.761467 [debug] [Thread-1 (]: Finished running node model.retail_dbt.stg_store_visits
[0m03:15:31.761943 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_store_visits' to be skipped because of status 'error'.  Reason: Database Error in model stg_store_visits (models/staging/stg_store_visits.sql)
  relation "raw.store_visits" does not exist
  LINE 15:   FROM "postgres"."raw"."store_visits"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_store_visits.sql.
[0m03:15:32.696735 [debug] [Thread-3 (]: SQL status: BEGIN in 2.335 seconds
[0m03:15:32.697209 [debug] [Thread-3 (]: Using postgres connection "model.retail_dbt.stg_stores"
[0m03:15:32.697549 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_stores"} */

  create view "postgres"."silver_staging"."stg_stores__dbt_tmp"
    
    
  as (
    

WITH src AS (
  SELECT
    store_id::int      AS store_id,
    NULLIF(TRIM(name), '')     AS name,
    NULLIF(TRIM(location), '') AS location,
    manager_id::int    AS manager_id
  FROM raw.stores
)

SELECT
  store_id,
  name,
  location,
  manager_id
FROM src
  );
[0m03:15:32.779707 [debug] [Thread-2 (]: SQL status: BEGIN in 2.088 seconds
[0m03:15:32.780170 [debug] [Thread-2 (]: Using postgres connection "model.retail_dbt.stg_suppliers"
[0m03:15:32.780496 [debug] [Thread-2 (]: On model.retail_dbt.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_suppliers"} */

  create view "postgres"."silver_staging"."stg_suppliers__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        supplier_id::int                               AS supplier_id,
        NULLIF(TRIM(name), '')                         AS name,
        NULLIF(TRIM(contact_info), '')                 AS contact_info
    FROM raw.suppliers
)

SELECT
    supplier_id,
    name,
    contact_info
FROM src
  );
[0m03:15:32.955492 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.stores" does not exist
LINE 15:   FROM raw.stores
                ^

[0m03:15:32.955942 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: ROLLBACK
[0m03:15:33.009430 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.suppliers" does not exist
LINE 14:     FROM raw.suppliers
                  ^

[0m03:15:33.009890 [debug] [Thread-2 (]: On model.retail_dbt.stg_suppliers: ROLLBACK
[0m03:15:33.211092 [debug] [Thread-3 (]: On model.retail_dbt.stg_stores: Close
[0m03:15:33.212965 [debug] [Thread-3 (]: Database Error in model stg_stores (models/staging/stg_stores.sql)
  relation "raw.stores" does not exist
  LINE 15:   FROM raw.stores
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_stores.sql
[0m03:15:33.213418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e944f2fc0>]}
[0m03:15:33.213917 [error] [Thread-3 (]: 21 of 23 ERROR creating sql view model silver_staging.stg_stores ............... [[31mERROR[0m in 2.86s]
[0m03:15:33.214411 [debug] [Thread-3 (]: Finished running node model.retail_dbt.stg_stores
[0m03:15:33.214886 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_stores' to be skipped because of status 'error'.  Reason: Database Error in model stg_stores (models/staging/stg_stores.sql)
  relation "raw.stores" does not exist
  LINE 15:   FROM raw.stores
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_stores.sql.
[0m03:15:33.237327 [debug] [Thread-2 (]: On model.retail_dbt.stg_suppliers: Close
[0m03:15:33.239122 [debug] [Thread-2 (]: Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  relation "raw.suppliers" does not exist
  LINE 14:     FROM raw.suppliers
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_suppliers.sql
[0m03:15:33.239490 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e94450590>]}
[0m03:15:33.239952 [error] [Thread-2 (]: 22 of 23 ERROR creating sql view model silver_staging.stg_suppliers ............ [[31mERROR[0m in 2.55s]
[0m03:15:33.240438 [debug] [Thread-2 (]: Finished running node model.retail_dbt.stg_suppliers
[0m03:15:33.240879 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_suppliers' to be skipped because of status 'error'.  Reason: Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  relation "raw.suppliers" does not exist
  LINE 14:     FROM raw.suppliers
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_suppliers.sql.
[0m03:15:33.541124 [debug] [Thread-4 (]: SQL status: BEGIN in 2.367 seconds
[0m03:15:33.541613 [debug] [Thread-4 (]: Using postgres connection "model.retail_dbt.stg_tax_rules"
[0m03:15:33.541946 [debug] [Thread-4 (]: On model.retail_dbt.stg_tax_rules: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "retail_dbt", "target_name": "dev", "node_id": "model.retail_dbt.stg_tax_rules"} */

  create view "postgres"."silver_staging"."stg_tax_rules__dbt_tmp"
    
    
  as (
    

WITH src AS (
    SELECT
        tax_id::int                                    AS tax_id,
        product_id::int                                AS product_id,
        NULLIF(NULLIF(NULLIF(LOWER(TRIM(tax_rate)), 'none'), 'n/a'), '') AS tax_rate_clean,
        TRIM(region)                                   AS region
    FROM raw.tax_rules
),

typed AS (
    SELECT
        tax_id,
        product_id,
        CASE
            WHEN tax_rate_clean ~ '^[0-9]+(\.[0-9]+)?$'
                 AND tax_rate_clean::numeric > 0
            THEN tax_rate_clean::numeric
        END AS tax_rate,
        region
    FROM src
)

SELECT *
FROM typed
WHERE tax_rate IS NOT NULL
  );
[0m03:15:33.795627 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.tax_rules" does not exist
LINE 15:     FROM raw.tax_rules
                  ^

[0m03:15:33.796175 [debug] [Thread-4 (]: On model.retail_dbt.stg_tax_rules: ROLLBACK
[0m03:15:34.049739 [debug] [Thread-4 (]: On model.retail_dbt.stg_tax_rules: Close
[0m03:15:34.051680 [debug] [Thread-4 (]: Database Error in model stg_tax_rules (models/staging/stg_tax_rules.sql)
  relation "raw.tax_rules" does not exist
  LINE 15:     FROM raw.tax_rules
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_tax_rules.sql
[0m03:15:34.052087 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1587cc2f-8876-4c13-8c77-a78e6f6aa2cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e94309bb0>]}
[0m03:15:35.485578 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m03:15:35.486493 [error] [Thread-4 (]: 23 of 23 ERROR creating sql view model silver_staging.stg_tax_rules ............ [[31mERROR[0m in 2.89s]
[0m03:15:35.487137 [debug] [Thread-4 (]: Finished running node model.retail_dbt.stg_tax_rules
[0m03:15:35.487751 [debug] [Thread-7 (]: Marking all children of 'model.retail_dbt.stg_tax_rules' to be skipped because of status 'error'.  Reason: Database Error in model stg_tax_rules (models/staging/stg_tax_rules.sql)
  relation "raw.tax_rules" does not exist
  LINE 15:     FROM raw.tax_rules
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_tax_rules.sql.
[0m03:15:35.489657 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:35.490040 [debug] [MainThread]: On master: BEGIN
[0m03:15:35.490433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:15:37.631272 [debug] [MainThread]: SQL status: BEGIN in 2.141 seconds
[0m03:15:37.631701 [debug] [MainThread]: On master: COMMIT
[0m03:15:37.632066 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:37.632371 [debug] [MainThread]: On master: COMMIT
[0m03:15:37.864381 [debug] [MainThread]: SQL status: COMMIT in 0.232 seconds
[0m03:15:37.864867 [debug] [MainThread]: On master: Close
[0m03:15:37.865640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:37.865975 [debug] [MainThread]: Connection 'model.retail_dbt.stg_stores' was properly closed.
[0m03:15:37.866274 [debug] [MainThread]: Connection 'model.retail_dbt.stg_store_visits' was properly closed.
[0m03:15:37.866571 [debug] [MainThread]: Connection 'model.retail_dbt.stg_tax_rules' was properly closed.
[0m03:15:37.866857 [debug] [MainThread]: Connection 'model.retail_dbt.stg_suppliers' was properly closed.
[0m03:15:37.867268 [info ] [MainThread]: 
[0m03:15:37.867659 [info ] [MainThread]: Finished running 23 view models in 0 hours 0 minutes and 34.67 seconds (34.67s).
[0m03:15:37.870694 [debug] [MainThread]: Command end result
[0m03:15:37.963915 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m03:15:37.966327 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m03:15:37.971115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m03:15:37.971378 [info ] [MainThread]: 
[0m03:15:37.971705 [info ] [MainThread]: [31mCompleted with 23 errors, 0 partial successes, and 0 warnings:[0m
[0m03:15:37.972030 [info ] [MainThread]: 
[0m03:15:37.972368 [error] [MainThread]: [31mFailure in model stg_campaigns (models/staging/stg_campaigns.sql)[0m
[0m03:15:37.972711 [error] [MainThread]:   Database Error in model stg_campaigns (models/staging/stg_campaigns.sql)
  relation "raw.campaigns" does not exist
  LINE 8:     select * from "postgres"."raw"."campaigns"
                            ^
  compiled code at target/run/retail_dbt/models/staging/stg_campaigns.sql
[0m03:15:37.973021 [info ] [MainThread]: 
[0m03:15:37.973305 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_campaigns.sql
[0m03:15:37.973580 [info ] [MainThread]: 
[0m03:15:37.973922 [error] [MainThread]: [31mFailure in model stg_customer_feedback (models/staging/stg_customer_feedback.sql)[0m
[0m03:15:37.974240 [error] [MainThread]:   Database Error in model stg_customer_feedback (models/staging/stg_customer_feedback.sql)
  relation "raw.customer_feedback" does not exist
  LINE 55:     FROM "postgres"."raw"."customer_feedback"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_customer_feedback.sql
[0m03:15:37.974507 [info ] [MainThread]: 
[0m03:15:37.974794 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_customer_feedback.sql
[0m03:15:37.975058 [info ] [MainThread]: 
[0m03:15:37.975372 [error] [MainThread]: [31mFailure in model stg_categories (models/staging/stg_categories.sql)[0m
[0m03:15:37.975698 [error] [MainThread]:   Database Error in model stg_categories (models/staging/stg_categories.sql)
  relation "raw.categories" does not exist
  LINE 10:     select * from "postgres"."raw"."categories"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_categories.sql
[0m03:15:37.975964 [info ] [MainThread]: 
[0m03:15:37.976226 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_categories.sql
[0m03:15:37.976508 [info ] [MainThread]: 
[0m03:15:37.976835 [error] [MainThread]: [31mFailure in model stg_brands (models/staging/stg_brands.sql)[0m
[0m03:15:37.977151 [error] [MainThread]:   Database Error in model stg_brands (models/staging/stg_brands.sql)
  relation "raw.brands" does not exist
  LINE 10:     select * from "postgres"."raw"."brands"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_brands.sql
[0m03:15:37.977462 [info ] [MainThread]: 
[0m03:15:37.977722 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_brands.sql
[0m03:15:37.977984 [info ] [MainThread]: 
[0m03:15:37.978306 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m03:15:37.978618 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "raw.customers" does not exist
  LINE 17:     FROM "postgres"."raw"."customers"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_customers.sql
[0m03:15:37.978883 [info ] [MainThread]: 
[0m03:15:37.979148 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_customers.sql
[0m03:15:37.979443 [info ] [MainThread]: 
[0m03:15:37.979756 [error] [MainThread]: [31mFailure in model stg_discount_rules (models/staging/stg_discount_rules.sql)[0m
[0m03:15:37.980065 [error] [MainThread]:   Database Error in model stg_discount_rules (models/staging/stg_discount_rules.sql)
  relation "raw.discount_rules" does not exist
  LINE 17:     FROM "postgres"."raw"."discount_rules"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_discount_rules.sql
[0m03:15:37.980356 [info ] [MainThread]: 
[0m03:15:37.980616 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_discount_rules.sql
[0m03:15:37.980895 [info ] [MainThread]: 
[0m03:15:37.981235 [error] [MainThread]: [31mFailure in model stg_employees (models/staging/stg_employees.sql)[0m
[0m03:15:37.981568 [error] [MainThread]:   Database Error in model stg_employees (models/staging/stg_employees.sql)
  relation "raw.employees" does not exist
  LINE 15:     FROM "postgres"."raw"."employees"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_employees.sql
[0m03:15:37.981833 [info ] [MainThread]: 
[0m03:15:37.982142 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_employees.sql
[0m03:15:37.982405 [info ] [MainThread]: 
[0m03:15:37.982715 [error] [MainThread]: [31mFailure in model stg_inventory (models/staging/stg_inventory.sql)[0m
[0m03:15:37.983040 [error] [MainThread]:   Database Error in model stg_inventory (models/staging/stg_inventory.sql)
  relation "raw.inventory" does not exist
  LINE 11:     from "postgres"."raw"."inventory"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_inventory.sql
[0m03:15:37.983304 [info ] [MainThread]: 
[0m03:15:37.983563 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_inventory.sql
[0m03:15:37.983886 [info ] [MainThread]: 
[0m03:15:37.984270 [error] [MainThread]: [31mFailure in model stg_loyalty_programs (models/staging/stg_loyalty_programs.sql)[0m
[0m03:15:37.984620 [error] [MainThread]:   Database Error in model stg_loyalty_programs (models/staging/stg_loyalty_programs.sql)
  relation "raw.loyalty_programs" does not exist
  LINE 14:     FROM "postgres"."raw"."loyalty_programs"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_loyalty_programs.sql
[0m03:15:37.984891 [info ] [MainThread]: 
[0m03:15:37.985158 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_loyalty_programs.sql
[0m03:15:37.985466 [info ] [MainThread]: 
[0m03:15:37.985779 [error] [MainThread]: [31mFailure in model stg_pricing_history (models/staging/stg_pricing_history.sql)[0m
[0m03:15:37.986089 [error] [MainThread]:   Database Error in model stg_pricing_history (models/staging/stg_pricing_history.sql)
  relation "raw.pricing_history" does not exist
  LINE 15:     FROM "postgres"."raw"."pricing_history"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_pricing_history.sql
[0m03:15:37.986397 [info ] [MainThread]: 
[0m03:15:37.986655 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_pricing_history.sql
[0m03:15:37.986916 [info ] [MainThread]: 
[0m03:15:37.987243 [error] [MainThread]: [31mFailure in model stg_payments (models/staging/stg_payments.sql)[0m
[0m03:15:37.987550 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "raw.payments" does not exist
  LINE 15:     FROM "postgres"."raw"."payments"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_payments.sql
[0m03:15:37.987812 [info ] [MainThread]: 
[0m03:15:37.988099 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_payments.sql
[0m03:15:37.988365 [info ] [MainThread]: 
[0m03:15:37.988676 [error] [MainThread]: [31mFailure in model stg_products (models/staging/stg_products.sql)[0m
[0m03:15:37.989011 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  relation "raw.products" does not exist
  LINE 20:   FROM "postgres"."raw"."products"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_products.sql
[0m03:15:37.989308 [info ] [MainThread]: 
[0m03:15:37.989599 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_products.sql
[0m03:15:37.989883 [info ] [MainThread]: 
[0m03:15:37.990196 [error] [MainThread]: [31mFailure in model stg_purchase_orders (models/staging/stg_purchase_orders.sql)[0m
[0m03:15:37.990503 [error] [MainThread]:   Database Error in model stg_purchase_orders (models/staging/stg_purchase_orders.sql)
  relation "raw.purchase_orders" does not exist
  LINE 15:     FROM "postgres"."raw"."purchase_orders"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_purchase_orders.sql
[0m03:15:37.990792 [info ] [MainThread]: 
[0m03:15:37.991079 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_purchase_orders.sql
[0m03:15:37.991342 [info ] [MainThread]: 
[0m03:15:37.991676 [error] [MainThread]: [31mFailure in model stg_returns (models/staging/stg_returns.sql)[0m
[0m03:15:37.991985 [error] [MainThread]:   Database Error in model stg_returns (models/staging/stg_returns.sql)
  relation "raw.returns" does not exist
  LINE 17:     FROM "postgres"."raw"."returns"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_returns.sql
[0m03:15:37.992247 [info ] [MainThread]: 
[0m03:15:37.992532 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_returns.sql
[0m03:15:37.992819 [info ] [MainThread]: 
[0m03:15:37.993135 [error] [MainThread]: [31mFailure in model stg_promotions (models/staging/stg_promotions.sql)[0m
[0m03:15:37.993508 [error] [MainThread]:   Database Error in model stg_promotions (models/staging/stg_promotions.sql)
  relation "raw.promotions" does not exist
  LINE 15:     FROM "postgres"."raw"."promotions"
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_promotions.sql
[0m03:15:37.993775 [info ] [MainThread]: 
[0m03:15:37.994033 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_promotions.sql
[0m03:15:37.994294 [info ] [MainThread]: 
[0m03:15:37.994628 [error] [MainThread]: [31mFailure in model stg_sales_items (models/staging/stg_sales_items.sql)[0m
[0m03:15:37.994937 [error] [MainThread]:   Database Error in model stg_sales_items (models/staging/stg_sales_items.sql)
  relation "raw.sales_items" does not exist
  LINE 10:     select * from "postgres"."raw"."sales_items"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_sales_items.sql
[0m03:15:37.995199 [info ] [MainThread]: 
[0m03:15:37.995498 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_sales_items.sql
[0m03:15:37.995764 [info ] [MainThread]: 
[0m03:15:37.996075 [error] [MainThread]: [31mFailure in model stg_sales_transactions (models/staging/stg_sales_transactions.sql)[0m
[0m03:15:37.996391 [error] [MainThread]:   Database Error in model stg_sales_transactions (models/staging/stg_sales_transactions.sql)
  relation "raw.sales_transactions" does not exist
  LINE 10:     select * from "postgres"."raw"."sales_transactions"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_sales_transactions.sql
[0m03:15:37.996655 [info ] [MainThread]: 
[0m03:15:37.996940 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_sales_transactions.sql
[0m03:15:37.997233 [info ] [MainThread]: 
[0m03:15:37.997563 [error] [MainThread]: [31mFailure in model stg_stock_movements (models/staging/stg_stock_movements.sql)[0m
[0m03:15:37.997888 [error] [MainThread]:   Database Error in model stg_stock_movements (models/staging/stg_stock_movements.sql)
  relation "raw.stock_movements" does not exist
  LINE 18:   FROM "postgres"."raw"."stock_movements"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_stock_movements.sql
[0m03:15:37.998196 [info ] [MainThread]: 
[0m03:15:37.998457 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_stock_movements.sql
[0m03:15:37.998749 [info ] [MainThread]: 
[0m03:15:37.999109 [error] [MainThread]: [31mFailure in model stg_shipments (models/staging/stg_shipments.sql)[0m
[0m03:15:37.999421 [error] [MainThread]:   Database Error in model stg_shipments (models/staging/stg_shipments.sql)
  relation "raw.shipments" does not exist
  LINE 10:     select * from "postgres"."raw"."shipments"
                             ^
  compiled code at target/run/retail_dbt/models/staging/stg_shipments.sql
[0m03:15:37.999684 [info ] [MainThread]: 
[0m03:15:37.999954 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_shipments.sql
[0m03:15:38.000247 [info ] [MainThread]: 
[0m03:15:38.000558 [error] [MainThread]: [31mFailure in model stg_store_visits (models/staging/stg_store_visits.sql)[0m
[0m03:15:38.000865 [error] [MainThread]:   Database Error in model stg_store_visits (models/staging/stg_store_visits.sql)
  relation "raw.store_visits" does not exist
  LINE 15:   FROM "postgres"."raw"."store_visits"
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_store_visits.sql
[0m03:15:38.001161 [info ] [MainThread]: 
[0m03:15:38.001442 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_store_visits.sql
[0m03:15:38.001709 [info ] [MainThread]: 
[0m03:15:38.002054 [error] [MainThread]: [31mFailure in model stg_stores (models/staging/stg_stores.sql)[0m
[0m03:15:38.002361 [error] [MainThread]:   Database Error in model stg_stores (models/staging/stg_stores.sql)
  relation "raw.stores" does not exist
  LINE 15:   FROM raw.stores
                  ^
  compiled code at target/run/retail_dbt/models/staging/stg_stores.sql
[0m03:15:38.002623 [info ] [MainThread]: 
[0m03:15:38.002932 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_stores.sql
[0m03:15:38.003195 [info ] [MainThread]: 
[0m03:15:38.003503 [error] [MainThread]: [31mFailure in model stg_suppliers (models/staging/stg_suppliers.sql)[0m
[0m03:15:38.003813 [error] [MainThread]:   Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  relation "raw.suppliers" does not exist
  LINE 14:     FROM raw.suppliers
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_suppliers.sql
[0m03:15:38.004077 [info ] [MainThread]: 
[0m03:15:38.004363 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_suppliers.sql
[0m03:15:38.004645 [info ] [MainThread]: 
[0m03:15:38.004960 [error] [MainThread]: [31mFailure in model stg_tax_rules (models/staging/stg_tax_rules.sql)[0m
[0m03:15:38.005272 [error] [MainThread]:   Database Error in model stg_tax_rules (models/staging/stg_tax_rules.sql)
  relation "raw.tax_rules" does not exist
  LINE 15:     FROM raw.tax_rules
                    ^
  compiled code at target/run/retail_dbt/models/staging/stg_tax_rules.sql
[0m03:15:38.005596 [info ] [MainThread]: 
[0m03:15:38.005881 [info ] [MainThread]:   compiled code at target/compiled/retail_dbt/models/staging/stg_tax_rules.sql
[0m03:15:38.006151 [info ] [MainThread]: 
[0m03:15:38.006452 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=23 SKIP=0 NO-OP=0 TOTAL=23
[0m03:15:38.007199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 33.092377, "process_in_blocks": "8784", "process_kernel_time": 0.500698, "process_mem_max_rss": "143012", "process_out_blocks": "12512", "process_user_time": 3.452643}
[0m03:15:38.007577 [debug] [MainThread]: Command `dbt run` failed at 03:15:38.007506 after 33.09 seconds
[0m03:15:38.007867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e988c2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e98b42fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0e9432b830>]}
[0m03:15:38.008151 [debug] [MainThread]: Flushing usage events
[0m03:15:38.909452 [debug] [MainThread]: An error was encountered while trying to flush usage events
